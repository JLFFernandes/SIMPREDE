{"timestamp":"2025-06-10T16:47:14.468498","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-10T16:47:14.469413","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/sql_queries_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-10T16:47:14.507668Z","level":"info","event":"✅ PostgresHook imported successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:14.514554Z","level":"info","event":"✅ PostgresOperator imported successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:14.514726Z","level":"info","event":"✅ PostgreSQL provider fully available","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:14.577452Z","level":"info","event":"✅ Recreated environment variable: AIRFLOW_CONN_SUPABASE_POSTGRES","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:14.577969Z","level":"info","event":"🔄 Creating google_scraper_eventos table with georeference data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:14.578094Z","level":"info","event":"📋 Executing: create_eventos_table","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:15.003100Z","level":"info","event":"✅ create_eventos_table: executed successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:15.004264Z","level":"info","event":"📋 Executing: check_centroids_table","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:15.371591Z","level":"info","event":"✅ check_centroids_table: [(1,)]","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:15.373769Z","level":"info","event":"✅ public.centroids table found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:15.373938Z","level":"info","event":"📋 Executing: check_staging_table","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:15.719746Z","level":"info","event":"✅ check_staging_table: [(1,)]","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:15.720033Z","level":"info","event":"✅ Source table google_scraper.artigos_filtrados_staging found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:15.720546Z","level":"info","event":"📋 Executing: check_source_columns","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:16.115560Z","level":"info","event":"✅ check_source_columns: [('ID', 'text'), ('type', 'text'), ('subtype', 'text'), ('date', 'text'), ('year', 'integer'), ('month', 'integer'), ('day', 'integer'), ('hour', 'text'), ('georef', 'text'), ('district', 'text'), ('municipali', 'text'), ('parish', 'text'), ('DICOFREG', 'double precision'), ('source', 'text'), ('sourcedate', 'text'), ('sourcetype', 'text'), ('page', 'text'), ('fatalities', 'integer'), ('injured', 'integer'), ('evacuated', 'integer'), ('displaced', 'integer'), ('missing', 'integer'), ('relevance_score', 'integer'), ('evento_nome', 'text')]","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:16.117124Z","level":"info","event":"📋 Executing: check_centroids_columns","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:16.497648Z","level":"info","event":"✅ check_centroids_columns: [('id', 'integer'), ('latitude', 'double precision'), ('longitude', 'double precision'), ('name', 'character varying'), ('region', 'character varying'), ('distrito', 'character varying'), ('concelho', 'character varying'), ('freguesia', 'character varying'), ('dicofre', 'character varying'), ('area_ha', 'double precision'), ('cluster_id', 'integer'), ('centroid_type', 'character varying'), ('created_at', 'timestamp without time zone'), ('updated_at', 'timestamp without time zone')]","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:16.498074Z","level":"info","event":"📋 Executing: check_source_data_count","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:16.850594Z","level":"info","event":"❌ Direct SQL execution failed: syntax error at or near \"{\"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:16.851018Z","level":"info","event":"LINE 1: SELECT COUNT(*) FROM {source_table}","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:16.851222Z","level":"info","event":"                             ^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:16.851424Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:16.851578Z","level":"info","event":"❌ check_source_data_count failed: syntax error at or near \"{\"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:16.851770Z","level":"info","event":"LINE 1: SELECT COUNT(*) FROM {source_table}","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:16.851932Z","level":"info","event":"                             ^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:16.852111Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:16.852306Z","level":"info","event":"📋 Executing: debug_source_table_content","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.275410Z","level":"info","event":"❌ Direct SQL execution failed: syntax error at or near \"{\"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.276530Z","level":"info","event":"LINE 1: ...te IS NOT NULL THEN 1 END) as rows_with_date FROM {source_ta...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.276806Z","level":"info","event":"                                                             ^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.277184Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.277718Z","level":"info","event":"❌ debug_source_table_content failed: syntax error at or near \"{\"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.278031Z","level":"info","event":"LINE 1: ...te IS NOT NULL THEN 1 END) as rows_with_date FROM {source_ta...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.278237Z","level":"info","event":"                                                             ^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.278471Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.278752Z","level":"info","event":"📋 Executing: debug_sample_source_data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.707597Z","level":"info","event":"❌ Direct SQL execution failed: syntax error at or near \"{\"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.708139Z","level":"info","event":"LINE 1: SELECT * FROM {source_table} LIMIT 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.708426Z","level":"info","event":"                      ^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.708701Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.709028Z","level":"info","event":"❌ debug_sample_source_data failed: syntax error at or near \"{\"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.709227Z","level":"info","event":"LINE 1: SELECT * FROM {source_table} LIMIT 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.709401Z","level":"info","event":"                      ^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.709623Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:17.710018Z","level":"info","event":"📋 Executing: clear_existing_eventos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:18.088886Z","level":"info","event":"✅ clear_existing_eventos: executed successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:18.089434Z","level":"info","event":"📋 Executing: populate_eventos_table_simple","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:18.534031Z","level":"info","event":"✅ populate_eventos_table_simple: executed successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:18.534941Z","level":"info","event":"📋 Executing: add_coordinates_to_eventos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:22.512021Z","level":"info","event":"❌ Direct SQL execution failed: invalid input syntax for type double precision: \"0302FA\"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:22.513553Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:22.513967Z","level":"info","event":"❌ add_coordinates_to_eventos failed: invalid input syntax for type double precision: \"0302FA\"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:22.514365Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:22.527517Z","level":"info","event":"📋 Executing: debug_coordinate_lookup","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:22.890035Z","level":"info","event":"✅ debug_coordinate_lookup: [('Coordinate Lookup Debug', 253, 0, 253, 3551)]","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:22.890398Z","level":"info","event":"📋 Executing: sample_coordinate_matches","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:23.288107Z","level":"info","event":"✅ sample_coordinate_matches: [('Évora', 'Borba', 'borba', None, None, 'borba', 'Missing coordinates'), ('Aveiro', 'Estarreja', 'estarreja', None, None, 'estarreja', 'Missing coordinates'), ('Lisboa', 'Lisboa', 'lisboa', None, None, 'lisboa', 'Missing coordinates'), ('Portalegre', 'Avis', 'avis', None, None, 'avis', 'Missing coordinates'), ('Braga', 'Braga', 'braga', None, None, 'braga', 'Missing coordinates'), ('Braga', 'Braga', 'braga', None, None, 'braga', 'Missing coordinates'), ('Évora', 'Mourão', 'mourão', None, None, 'mourão', 'Missing coordinates'), ('Lisboa', 'Lisboa', 'lisboa', None, None, 'lisboa', 'Missing coordinates'), ('Portalegre', 'Elvas', 'elvas', None, None, 'elvas', 'Missing coordinates'), ('Portalegre', 'Avis', 'avis', None, None, 'avis', 'Missing coordinates')]","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:23.288312Z","level":"info","event":"📋 Executing: verify_eventos_count","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:23.722587Z","level":"info","event":"✅ verify_eventos_count: [(253,)]","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:23.723298Z","level":"info","event":"📋 Executing: sample_eventos_data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:24.103206Z","level":"info","event":"✅ sample_eventos_data: [('445068a6975028726c52a341b510f745', 'Other', 'Other', 'Évora', 'Borba', None, None, 'borba', 0, 'radiocampanario', datetime.datetime(2025, 6, 10, 16, 47, 18, 511255)), ('7cfed55cd70b06bddebf125afaf38779', 'Other', 'Other', 'Aveiro', 'Estarreja', None, None, 'estarreja', 0, 'cmjornal', datetime.datetime(2025, 6, 10, 16, 47, 18, 511255)), ('0e0fae160166f756123193afdccf7c8b', 'Other', 'Other', 'Lisboa', 'Lisboa', None, None, 'lisboa', 0, 'dn', datetime.datetime(2025, 6, 10, 16, 47, 18, 511255)), ('51dff00e7adcabe4230ed38e28a1dcef', 'Other', 'Other', 'Portalegre', 'Avis', None, None, 'avis', 0, 'sicnoticias', datetime.datetime(2025, 6, 10, 16, 47, 18, 511255)), ('fe002a37cf23d7c497694dbbf9170888', 'Other', 'Other', 'Portalegre', 'Avis', None, None, 'avis', 0, 'dnoticias', datetime.datetime(2025, 6, 10, 16, 47, 18, 511255))]","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:24.103452Z","level":"info","event":"📊 Eventos Table Creation Summary:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:24.103550Z","level":"info","event":"  - Centroids table available: ✅","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:24.103629Z","level":"info","event":"  - Staging table available: ✅","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:24.103722Z","level":"info","event":"  - Total eventos created: 253","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:24.104201Z","level":"info","event":"🎉 google_scraper_eventos table creation completed!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:24.104367Z","level":"info","event":"👉 Check your Supabase dashboard to see the new table with georeference data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T16:47:24.103772","level":"info","event":"Done. Returned value was: None","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
