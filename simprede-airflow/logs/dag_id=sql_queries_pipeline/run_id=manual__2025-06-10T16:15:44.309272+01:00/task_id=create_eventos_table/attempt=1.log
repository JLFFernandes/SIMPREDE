{"timestamp":"2025-06-10T15:15:47.274706","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-10T15:15:47.275125","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/sql_queries_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-10T15:15:47.322649Z","level":"info","event":"âœ… PostgresHook imported successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:47.327163Z","level":"info","event":"âœ… PostgresOperator imported successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:47.327292Z","level":"info","event":"âœ… PostgreSQL provider fully available","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:47.362379Z","level":"info","event":"âœ… Recreated environment variable: AIRFLOW_CONN_SUPABASE_POSTGRES","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:47.363616Z","level":"info","event":"ðŸ”„ Creating google_scraper_eventos table with georeference data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:47.363751Z","level":"info","event":"ðŸ“‹ Executing: create_eventos_table","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:47.772585Z","level":"info","event":"âœ… create_eventos_table: executed successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:47.774273Z","level":"info","event":"ðŸ“‹ Executing: check_centroids_table","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:48.122766Z","level":"info","event":"âœ… check_centroids_table: [(1,)]","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:48.123146Z","level":"info","event":"âœ… public.centroids table found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:48.123354Z","level":"info","event":"ðŸ“‹ Executing: check_staging_table","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:48.515501Z","level":"info","event":"âœ… check_staging_table: [(1,)]","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:48.515746Z","level":"info","event":"âœ… Source table google_scraper.artigos_filtrados_staging found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:48.515913Z","level":"info","event":"ðŸ“‹ Executing: check_source_columns","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:48.863140Z","level":"info","event":"âœ… check_source_columns: [('ID', 'text'), ('type', 'text'), ('subtype', 'text'), ('date', 'text'), ('year', 'integer'), ('month', 'integer'), ('day', 'integer'), ('hour', 'text'), ('georef', 'text'), ('district', 'text'), ('municipali', 'text'), ('parish', 'text'), ('DICOFREG', 'double precision'), ('source', 'text'), ('sourcedate', 'text'), ('sourcetype', 'text'), ('page', 'text'), ('fatalities', 'integer'), ('injured', 'integer'), ('evacuated', 'integer'), ('displaced', 'integer'), ('missing', 'integer'), ('relevance_score', 'integer'), ('evento_nome', 'text')]","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:48.864719Z","level":"info","event":"ðŸ“‹ Executing: check_centroids_columns","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:49.247457Z","level":"info","event":"âœ… check_centroids_columns: [('id', 'integer'), ('latitude', 'double precision'), ('longitude', 'double precision'), ('name', 'character varying'), ('region', 'character varying'), ('distrito', 'character varying'), ('concelho', 'character varying'), ('freguesia', 'character varying'), ('dicofre', 'character varying'), ('area_ha', 'double precision'), ('cluster_id', 'integer'), ('centroid_type', 'character varying'), ('created_at', 'timestamp without time zone'), ('updated_at', 'timestamp without time zone')]","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:49.248196Z","level":"info","event":"ðŸ“‹ Executing: check_source_data_count","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:49.630084Z","level":"info","event":"âœ… check_source_data_count: [(253,)]","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:49.630481Z","level":"info","event":"ðŸ“Š Source table has 253 records","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:49.631353Z","level":"info","event":"âœ… Ready to process 253 records","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:49.632016Z","level":"info","event":"ðŸ“‹ Executing: populate_eventos_table","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:50.020434Z","level":"info","event":"âœ… populate_eventos_table: executed successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:50.021695Z","level":"info","event":"ðŸ“‹ Executing: populate_eventos_table_with_georef","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:51.986924Z","level":"info","event":"âœ… populate_eventos_table_with_georef: executed successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:51.987250Z","level":"info","event":"ðŸ“‹ Executing: verify_eventos_count","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:52.334191Z","level":"info","event":"âœ… verify_eventos_count: [(36337,)]","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:52.335156Z","level":"info","event":"ðŸ“‹ Executing: sample_eventos_data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:52.713292Z","level":"info","event":"âœ… sample_eventos_data: [('245617f38ae54dfe89c524b2e74a7701', 'Other', 'Other', 'Braga', 'Amares', 41.6528772789048, -8.3936914770031, 'distrito', 0, 'e', datetime.datetime(2025, 6, 10, 15, 15, 50, 369301)), ('936d6c04990a8e3b1c8919e77bdb4517', 'Other', 'Other', 'Aveiro', 'Aveiro', 40.5802356040399, -8.56621973110386, 'distrito', 0, 'cnnportugal', datetime.datetime(2025, 6, 10, 15, 15, 50, 369301)), ('245617f38ae54dfe89c524b2e74a7701', 'Other', 'Other', 'Braga', 'Amares', 41.379620032524, -8.05690798281021, 'distrito', 0, 'e', datetime.datetime(2025, 6, 10, 15, 15, 50, 369301)), ('245617f38ae54dfe89c524b2e74a7701', 'Other', 'Other', 'Braga', 'Amares', 41.3788394147365, -8.27970365603229, 'distrito', 0, 'e', datetime.datetime(2025, 6, 10, 15, 15, 50, 369301)), ('936d6c04990a8e3b1c8919e77bdb4517', 'Other', 'Other', 'Aveiro', 'Aveiro', 40.6225183042527, -8.56521761316979, 'distrito', 0, 'cnnportugal', datetime.datetime(2025, 6, 10, 15, 15, 50, 369301))]","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:52.714396Z","level":"info","event":"ðŸ“Š Eventos Table Creation Summary:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:52.714897Z","level":"info","event":"  - Centroids table available: âœ…","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:52.715149Z","level":"info","event":"  - Staging table available: âœ…","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:52.715399Z","level":"info","event":"  - Total eventos created: 36337","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:52.715747Z","level":"info","event":"ðŸŽ‰ google_scraper_eventos table creation completed!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:52.715978Z","level":"info","event":"ðŸ‘‰ Check your Supabase dashboard to see the new table with georeference data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T15:15:52.715484","level":"info","event":"Done. Returned value was: None","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
