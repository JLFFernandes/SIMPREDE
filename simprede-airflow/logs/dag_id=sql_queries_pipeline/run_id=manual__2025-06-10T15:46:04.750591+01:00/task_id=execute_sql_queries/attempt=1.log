{"timestamp":"2025-06-10T14:48:33.745817","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-10T14:48:33.746132","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/sql_queries_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-10T14:48:33.764799Z","level":"info","event":"‚úÖ PostgresHook imported successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:33.768988Z","level":"info","event":"‚úÖ PostgresOperator imported successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:33.769091Z","level":"info","event":"‚úÖ PostgreSQL provider fully available","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:33.784509Z","level":"info","event":"‚úÖ Recreated environment variable: AIRFLOW_CONN_SUPABASE_POSTGRES","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:33.784605Z","level":"info","event":"‚úÖ Using connection URI from setup task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:33.784656Z","level":"info","event":"üîç Executing 3 SQL queries...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:33.784728Z","level":"info","event":"üìã Executing query: schema_check","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.126209Z","level":"info","event":"‚úÖ Query 'schema_check' returned 1 rows","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.130427Z","level":"info","event":"  Result: (11,)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.131119Z","level":"info","event":"üìã Executing query: articles_count","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.517989Z","level":"info","event":"‚ùå Direct SQL execution failed: relation \"google_scraper.artigos_filtrados\" does not exist","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.519209Z","level":"info","event":"LINE 1: SELECT COUNT(*) as total_articles FROM google_scraper.artigo...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.520024Z","level":"info","event":"                                               ^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.520503Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.520770Z","level":"info","event":"‚ùå Query 'articles_count' failed: relation \"google_scraper.artigos_filtrados\" does not exist","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.520999Z","level":"info","event":"LINE 1: SELECT COUNT(*) as total_articles FROM google_scraper.artigo...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.521298Z","level":"info","event":"                                               ^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.521699Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.521947Z","level":"info","event":"üìã Executing query: insert_test_article","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.857299Z","level":"info","event":"‚ùå Direct SQL execution failed: relation \"google_scraper.artigos_filtrados\" does not exist","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.860192Z","level":"info","event":"LINE 2:                     INSERT INTO google_scraper.artigos_filtr...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.860495Z","level":"info","event":"                                        ^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.860704Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.860883Z","level":"info","event":"‚ùå Query 'insert_test_article' failed: relation \"google_scraper.artigos_filtrados\" does not exist","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.861032Z","level":"info","event":"LINE 2:                     INSERT INTO google_scraper.artigos_filtr...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.861369Z","level":"info","event":"                                        ^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.861524Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.861829Z","level":"info","event":"‚úÖ SQL query execution completed. Results stored in XCom.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T14:48:34.858344","level":"info","event":"Done. Returned value was: {'schema_check': [(11,)], 'articles_count': 'error: relation \"google_scraper.artigos_filtrados\" does not exist\\nLINE 1: SELECT COUNT(*) as total_articles FROM google_scraper.artigo...\\n                                               ^\\n', 'insert_test_article': 'error: relation \"google_scraper.artigos_filtrados\" does not exist\\nLINE 2:                     INSERT INTO google_scraper.artigos_filtr...\\n                                        ^\\n'}","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-10T14:48:34.858739","level":"info","event":"Pushing xcom","ti":"RuntimeTaskInstance(id=UUID('01975a4e-36ec-7cdf-800f-d3d5f7bd659a'), task_id='execute_sql_queries', dag_id='sql_queries_pipeline', run_id='manual__2025-06-10T15:46:04.750591+01:00', try_number=1, map_index=-1, hostname='aa05a188031b', context_carrier=None, task=<Task(PythonOperator): execute_sql_queries>, bundle_instance=LocalDagBundle(name=dags-folder), max_tries=1, start_date=datetime.datetime(2025, 6, 10, 14, 48, 33, 707883, tzinfo=TzInfo(UTC)), end_date=None, state=<TaskInstanceState.RUNNING: 'running'>, is_mapped=False, rendered_map_index=None)","logger":"task"}
