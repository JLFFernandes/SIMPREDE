{"timestamp":"2025-06-10T20:53:43.768415","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-10T20:53:43.768698","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/daily_eventos_processing_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-10T20:53:43.778560Z","level":"info","event":"âœ… PostgresHook imported successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:43.806259Z","level":"info","event":"ðŸ”„ Appending staging data to eventos table...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:43.809300Z","level":"info","event":"ðŸ“‹ Processing 26 rows from google_scraper.artigos_filtrados_20250610_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:44.166834Z","level":"info","event":"ðŸ“Š Initial eventos count: 279","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:44.215095Z","level":"info","event":"ðŸ“‹ Available columns in staging table: created_at, date, day, dicofreg, displaced, district, evacuated, fatalities, georef, hour, id, injured, missing, month, municipali, page, parish, source, sourcedate, sourcetype, subtype, type, updated_at, year","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:44.262142Z","level":"info","event":"ðŸ“‹ Date column type: date","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:44.307223Z","level":"info","event":"ðŸ”§ Set PostgreSQL datestyle to DMY (DD/MM/YYYY)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:44.307505Z","level":"info","event":"ðŸ”§ Using direct date column (already date type)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:44.434612Z","level":"info","event":"âœ… Inserted 0 new records from staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:44.518828Z","level":"info","event":"ðŸ“Š Processing Summary:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:44.519556Z","level":"info","event":"  - Staging rows processed: 26","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:44.520590Z","level":"info","event":"  - New records inserted: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:44.520956Z","level":"info","event":"  - Duplicate records skipped: 26","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:44.521173Z","level":"info","event":"  - Total eventos before: 279","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:44.521863Z","level":"info","event":"  - Total eventos after: 279","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:44.563804","level":"info","event":"Done. Returned value was: {'staging_table': 'google_scraper.artigos_filtrados_20250610_staging', 'staging_rows': 26, 'inserted_rows': 0, 'skipped_duplicates': 26, 'initial_count': 279, 'final_count': 279}","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-10T20:53:44.564112","level":"info","event":"Pushing xcom","ti":"RuntimeTaskInstance(id=UUID('01975b9e-c4cb-74e3-8c92-e1693519e4a3'), task_id='append_staging_to_eventos', dag_id='daily_eventos_processing', run_id='manual__2025-06-10T21:53:41.160154+01:00', try_number=1, map_index=-1, hostname='2ce8e97552d8', context_carrier=None, task=<Task(PythonOperator): append_staging_to_eventos>, bundle_instance=LocalDagBundle(name=dags-folder), max_tries=2, start_date=datetime.datetime(2025, 6, 10, 20, 53, 43, 728607, tzinfo=TzInfo(UTC)), end_date=None, state=<TaskInstanceState.RUNNING: 'running'>, is_mapped=False, rendered_map_index=None)","logger":"task"}
