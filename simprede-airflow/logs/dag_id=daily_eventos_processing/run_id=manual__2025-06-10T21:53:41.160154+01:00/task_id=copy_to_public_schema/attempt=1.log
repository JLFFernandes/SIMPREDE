{"timestamp":"2025-06-10T20:53:47.551708","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-10T20:53:47.552007","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/daily_eventos_processing_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-10T20:53:47.569549Z","level":"info","event":"âœ… PostgresHook imported successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:47.585202Z","level":"info","event":"ðŸ“‹ Copying eventos data to public schema...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:47.857180Z","level":"info","event":"ðŸ“‹ Step 1: Check source table status","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:47.941136Z","level":"info","event":"ðŸ“Š Source table status:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:47.942765Z","level":"info","event":"  - Total eventos: 279","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:47.943098Z","level":"info","event":"  - With coordinates: 279","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:47.943372Z","level":"info","event":"  - With geometry: 279","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:47.943518Z","level":"info","event":"ðŸ“‹ Step 2: Drop existing public table if it exists","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:47.996638Z","level":"info","event":"âœ… Dropped existing public.google_scraper_ocorrencias table","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:47.997065Z","level":"info","event":"ðŸ“‹ Step 3: Create new table structure in public schema","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.077963Z","level":"info","event":"âœ… Created public.google_scraper_ocorrencias table with complete structure","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.078466Z","level":"info","event":"ðŸ“‹ Step 4: Copy all data from source table","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.184839Z","level":"info","event":"âœ… Copied 279 rows to public.google_scraper_ocorrencias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.185184Z","level":"info","event":"ðŸ“‹ Step 5: Verify copy operation","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.271338Z","level":"info","event":"ðŸ“Š Final verification:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.271825Z","level":"info","event":"  - Source table rows: 279","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.272155Z","level":"info","event":"  - Copied rows: 279","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.272546Z","level":"info","event":"  - Final public table rows: 279","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.272839Z","level":"info","event":"ðŸŽ‰ SUCCESS! All eventos successfully copied to public schema","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.273090Z","level":"info","event":"ðŸ“‹ Step 6: Adding indexes for better query performance","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.506854Z","level":"info","event":"âœ… Added performance indexes to public table","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.507364Z","level":"info","event":"ðŸ“‹ Step 7: Sample data from public table","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.592232Z","level":"info","event":"ðŸ“‹ Latest eventos in public table:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.592592Z","level":"info","event":"  - f9e6d6843dc811a271c7f1a2bb878002: Other on 31/03/2025 in Lisboa/Oeiras [coords: Yes] (0 fatalities, 0 injured)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.592756Z","level":"info","event":"  - a22481c0ec5bbbc4a1ecc7fe267cdf68: Other on 31/03/2025 in Coimbra/Coimbra [coords: Yes] (0 fatalities, 0 injured)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.592922Z","level":"info","event":"  - 1069626ef35d9111a3d11a81e2589119: Other on 31/01/2025 in Portalegre/Avis [coords: Yes] (0 fatalities, 0 injured)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.593186Z","level":"info","event":"  - 5c75c49fc92a58f7175b71c31d153aae: Other on 30/04/2025 in Portalegre/Avis [coords: Yes] (0 fatalities, 0 injured)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.593349Z","level":"info","event":"  - 5728e3b5307083c1a6fbe722a0f1357b: Other on 30/03/2025 in Lisboa/Lisboa [coords: Yes] (0 fatalities, 0 injured)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.593523Z","level":"info","event":"ðŸŽ‰ Public schema copy operation completed!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.593719Z","level":"info","event":"ðŸ‘‰ Data is now available at: public.google_scraper_ocorrencias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.593904Z","level":"info","event":"ðŸ‘‰ This table can be easily queried and accessed by other applications","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:53:48.633926","level":"info","event":"Done. Returned value was: {'copied_rows': 279, 'final_count': 279}","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-10T20:53:48.634387","level":"info","event":"Pushing xcom","ti":"RuntimeTaskInstance(id=UUID('01975b9e-c4cf-75db-b74c-43e60934f3f2'), task_id='copy_to_public_schema', dag_id='daily_eventos_processing', run_id='manual__2025-06-10T21:53:41.160154+01:00', try_number=1, map_index=-1, hostname='2ce8e97552d8', context_carrier=None, task=<Task(PythonOperator): copy_to_public_schema>, bundle_instance=LocalDagBundle(name=dags-folder), max_tries=2, start_date=datetime.datetime(2025, 6, 10, 20, 53, 47, 513162, tzinfo=TzInfo(UTC)), end_date=None, state=<TaskInstanceState.RUNNING: 'running'>, is_mapped=False, rendered_map_index=None)","logger":"task"}
