{"timestamp":"2025-06-10T20:45:37.674193","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-10T20:45:37.674577","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/daily_eventos_processing_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-10T20:45:37.683620Z","level":"info","event":"âœ… PostgresHook imported successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:45:37.721081Z","level":"info","event":"ðŸ”„ Appending staging data to eventos table...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:45:37.723822Z","level":"info","event":"ðŸ“‹ Processing 26 rows from google_scraper.artigos_filtrados_20250610_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:45:38.033899Z","level":"info","event":"ðŸ“Š Initial eventos count: 279","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:45:38.075452Z","level":"info","event":"ðŸ“‹ Available columns in staging table: created_at, date, day, dicofreg, displaced, district, evacuated, fatalities, georef, hour, id, injured, missing, month, municipali, page, parish, source, sourcedate, sourcetype, subtype, type, updated_at, year","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:45:38.113195Z","level":"info","event":"ðŸ“‹ Date column type: date","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:45:38.148966Z","level":"info","event":"ðŸ”§ Set PostgreSQL datestyle to DMY (DD/MM/YYYY)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:45:38.149178Z","level":"info","event":"ðŸ”§ Using direct date column (already date type)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:45:38.261163Z","level":"info","event":"âœ… Inserted 0 new records from staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:45:38.336113Z","level":"info","event":"ðŸ“Š Processing Summary:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:45:38.336729Z","level":"info","event":"  - Staging rows processed: 26","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:45:38.337093Z","level":"info","event":"  - New records inserted: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:45:38.337523Z","level":"info","event":"  - Duplicate records skipped: 26","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:45:38.337716Z","level":"info","event":"  - Total eventos before: 279","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:45:38.337891Z","level":"info","event":"  - Total eventos after: 279","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-10T20:45:38.372544","level":"info","event":"Done. Returned value was: {'staging_table': 'google_scraper.artigos_filtrados_20250610_staging', 'staging_rows': 26, 'inserted_rows': 0, 'skipped_duplicates': 26, 'initial_count': 279, 'final_count': 279}","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-10T20:45:38.373083","level":"info","event":"Pushing xcom","ti":"RuntimeTaskInstance(id=UUID('01975b97-5998-7531-b4f2-c61e74a17b15'), task_id='append_staging_to_eventos', dag_id='daily_eventos_processing', run_id='scheduled__2025-06-10T05:00:00+01:00', try_number=24, map_index=-1, hostname='2ce8e97552d8', context_carrier=None, task=<Task(PythonOperator): append_staging_to_eventos>, bundle_instance=LocalDagBundle(name=dags-folder), max_tries=25, start_date=datetime.datetime(2025, 6, 10, 20, 45, 37, 619498, tzinfo=TzInfo(UTC)), end_date=None, state=<TaskInstanceState.RUNNING: 'running'>, is_mapped=False, rendered_map_index=None)","logger":"task"}
