{"timestamp":"2025-06-11T14:25:20.332656","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-11T14:25:20.333027","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/daily_eventos_processing_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-11T14:25:20.342500Z","level":"info","event":"âœ… PostgresHook imported successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:20.359013Z","level":"info","event":"ðŸ”„ Appending staging data to eventos table...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:20.362321Z","level":"info","event":"ðŸ“‹ Processing 21 rows from google_scraper.artigos_filtrados_20250611_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:20.763669Z","level":"info","event":"ðŸ“Š Initial eventos count: 279","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:20.824451Z","level":"info","event":"ðŸ“‹ Available columns in staging table: created_at, date, day, dicofreg, displaced, district, evacuated, fatalities, georef, hour, id, injured, missing, month, municipali, page, parish, source, sourcedate, sourcetype, subtype, type, updated_at, year","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:20.872793Z","level":"info","event":"ðŸ“‹ Date column type: date","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:20.921764Z","level":"info","event":"ðŸ”§ Set PostgreSQL datestyle to DMY (DD/MM/YYYY)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:20.922427Z","level":"info","event":"ðŸ”§ Using direct date column (already date type)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:21.093402Z","level":"info","event":"âœ… Inserted 21 new records from staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:21.204003Z","level":"info","event":"ðŸ“Š Processing Summary:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:21.206075Z","level":"info","event":"  - Staging rows processed: 21","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:21.206275Z","level":"info","event":"  - New records inserted: 21","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:21.206401Z","level":"info","event":"  - Duplicate records skipped: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:21.206487Z","level":"info","event":"  - Total eventos before: 279","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:21.206566Z","level":"info","event":"  - Total eventos after: 300","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:21.259468","level":"info","event":"Done. Returned value was: {'staging_table': 'google_scraper.artigos_filtrados_20250611_staging', 'staging_rows': 21, 'inserted_rows': 21, 'skipped_duplicates': 0, 'initial_count': 279, 'final_count': 300}","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-11T14:25:21.259918","level":"info","event":"Pushing xcom","ti":"RuntimeTaskInstance(id=UUID('01975f61-8922-7774-aa0f-88a287ead459'), task_id='append_staging_to_eventos', dag_id='daily_eventos_processing', run_id='manual__2025-06-11T15:25:17.070503+01:00', try_number=1, map_index=-1, hostname='de20cda29541', context_carrier=None, task=<Task(PythonOperator): append_staging_to_eventos>, bundle_instance=LocalDagBundle(name=dags-folder), max_tries=2, start_date=datetime.datetime(2025, 6, 11, 14, 25, 20, 271796, tzinfo=TzInfo(UTC)), end_date=None, state=<TaskInstanceState.RUNNING: 'running'>, is_mapped=False, rendered_map_index=None)","logger":"task"}
