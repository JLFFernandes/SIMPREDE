{"timestamp":"2025-06-05T23:00:10.340975","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T23:00:10.341290","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T23:00:10.364988Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T23:00:10.366389Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T23:00:10.367579Z","level":"info","event":"📅 Using provided execution date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T23:00:10.368040Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/06', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/06', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/06']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T23:00:10.368133Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T23:00:10.368204Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T23:00:10.368296Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T23:00:10.371331Z","level":"info","event":"  - Target date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T23:00:10.371402Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T23:00:10.371457Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T23:00:10.371664Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/intermediate_google_news_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T23:00:10.371717Z","level":"info","event":"❌ No input file found from scraper task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T23:00:10.371766Z","level":"info","event":"🔍 Checking legacy path: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/intermediate_google_news_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T23:00:10.371824Z","level":"info","event":"🔍 Checking legacy path: /opt/airflow/scripts/google_scraper/data/raw/intermediate_google_news.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T23:00:10.368381","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"Exception","exc_value":"No input file found. Checked: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv', '/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/intermediate_google_news_20250606.csv', '/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/intermediate_google_news_20250606.csv', '/opt/airflow/scripts/google_scraper/data/raw/intermediate_google_news.csv']","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":838,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1130,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":212,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":235,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/google_scraper_dag.py","lineno":377,"name":"processar_relevantes_task"}]}]}
{"timestamp":"2025-06-06T09:38:22.355679","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-06T09:38:22.355985","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-06T09:38:22.384528Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:22.386989Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:22.387100Z","level":"info","event":"📅 Using provided execution date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:22.387469Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/06', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/06', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/06']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:22.387684Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:22.387989Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:22.388072Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:22.388303Z","level":"info","event":"  - Target date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:22.388431Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:22.388502Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:22.388612Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:22.388689Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:22.388767Z","level":"info","event":"  - relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:22.388833Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_irrelevantes_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:22.388901Z","level":"info","event":"  - processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_log_20250606.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:22.388971Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:22.389046Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv --output_dir /opt/airflow/scripts/google_scraper/data/structured/2025/06/06 --date_str 2025-06-06 --date 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:22.389126Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.585760Z","level":"info","event":"📋 [2025-06-06 10:38:23] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.586441Z","level":"info","event":"📋 2025-06-06 10:38:23,585 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.586674Z","level":"info","event":"📋 [2025-06-06 10:38:23] Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.586798Z","level":"info","event":"📋 2025-06-06 10:38:23,585 - INFO - Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.586998Z","level":"info","event":"📋 [2025-06-06 10:38:23] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.587155Z","level":"info","event":"📋 2025-06-06 10:38:23,586 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.587315Z","level":"info","event":"📋 [2025-06-06 10:38:23] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.587526Z","level":"info","event":"📋 2025-06-06 10:38:23,586 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.588200Z","level":"info","event":"📋 [2025-06-06 10:38:23] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.588761Z","level":"info","event":"📋 2025-06-06 10:38:23,586 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.589160Z","level":"info","event":"📋 [2025-06-06 10:38:23] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.589269Z","level":"info","event":"📋 2025-06-06 10:38:23,586 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.589555Z","level":"info","event":"📋 [2025-06-06 10:38:23] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.589654Z","level":"info","event":"📋 2025-06-06 10:38:23,586 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.589770Z","level":"info","event":"📋 [2025-06-06 10:38:23] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.590026Z","level":"info","event":"📋 2025-06-06 10:38:23,586 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.590154Z","level":"info","event":"📋 [2025-06-06 10:38:23] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.591595Z","level":"info","event":"📋 2025-06-06 10:38:23,586 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.592460Z","level":"info","event":"📋 [2025-06-06 10:38:23] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.592648Z","level":"info","event":"📋 2025-06-06 10:38:23,586 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.593470Z","level":"info","event":"📋 [2025-06-06 10:38:23] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.593526Z","level":"info","event":"📋 2025-06-06 10:38:23,587 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.593565Z","level":"info","event":"📋 [2025-06-06 10:38:23] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.593608Z","level":"info","event":"📋 2025-06-06 10:38:23,587 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.593647Z","level":"info","event":"📋 [2025-06-06 10:38:23] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.593684Z","level":"info","event":"📋 2025-06-06 10:38:23,589 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.593720Z","level":"info","event":"📋 [2025-06-06 10:38:23] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.593756Z","level":"info","event":"📋 2025-06-06 10:38:23,589 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.593851Z","level":"info","event":"📋 [2025-06-06 10:38:23] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.595492Z","level":"info","event":"📋 2025-06-06 10:38:23,589 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.595792Z","level":"info","event":"📋 [2025-06-06 10:38:23] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.595931Z","level":"info","event":"📋 2025-06-06 10:38:23,595 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.595975Z","level":"info","event":"📋 [2025-06-06 10:38:23] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.596013Z","level":"info","event":"📋 2025-06-06 10:38:23,595 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.596050Z","level":"info","event":"📋 [2025-06-06 10:38:23] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.596668Z","level":"info","event":"📋 2025-06-06 10:38:23,595 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.596714Z","level":"info","event":"📋 [2025-06-06 10:38:23] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.596750Z","level":"info","event":"📋 2025-06-06 10:38:23,595 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.596785Z","level":"info","event":"📋 [2025-06-06 10:38:23]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.596819Z","level":"info","event":"📋 2025-06-06 10:38:23,595 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.596853Z","level":"info","event":"📋 [2025-06-06 10:38:23]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.596887Z","level":"info","event":"📋 2025-06-06 10:38:23,595 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.596972Z","level":"info","event":"📋 [2025-06-06 10:38:23]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.597032Z","level":"info","event":"📋 2025-06-06 10:38:23,595 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.597088Z","level":"info","event":"📋 [2025-06-06 10:38:23]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.597145Z","level":"info","event":"📋 2025-06-06 10:38:23,595 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.597203Z","level":"info","event":"📋 [2025-06-06 10:38:23]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.597764Z","level":"info","event":"📋 2025-06-06 10:38:23,595 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.598109Z","level":"info","event":"📋 [2025-06-06 10:38:23] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.598154Z","level":"info","event":"📋 2025-06-06 10:38:23,595 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.598210Z","level":"info","event":"📋 [2025-06-06 10:38:23] ✅ Ficheiro CSV válido com 4 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.598248Z","level":"info","event":"📋 2025-06-06 10:38:23,597 - INFO - ✅ Ficheiro CSV válido com 4 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.598291Z","level":"info","event":"📋 [2025-06-06 10:38:23] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.598330Z","level":"info","event":"📋 2025-06-06 10:38:23,597 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.598367Z","level":"info","event":"📋 [2025-06-06 10:38:23] 📅 Filtrado para artigos dos últimos 1 dias: 4 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.598411Z","level":"info","event":"📋 2025-06-06 10:38:23,597 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 4 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.598449Z","level":"info","event":"📋 [2025-06-06 10:38:23] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.598485Z","level":"info","event":"📋 2025-06-06 10:38:23,597 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.600456Z","level":"info","event":"📋 [2025-06-06 10:38:23] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.601204Z","level":"info","event":"📋 2025-06-06 10:38:23,597 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.601298Z","level":"info","event":"📋 [2025-06-06 10:38:23] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.601354Z","level":"info","event":"📋 2025-06-06 10:38:23,597 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.601413Z","level":"info","event":"📋 [2025-06-06 10:38:23]   Total de Artigos para Processar: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.601476Z","level":"info","event":"📋 2025-06-06 10:38:23,597 - INFO -   Total de Artigos para Processar: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.601558Z","level":"info","event":"📋 [2025-06-06 10:38:23]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.601642Z","level":"info","event":"📋 2025-06-06 10:38:23,597 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.601697Z","level":"info","event":"📋 [2025-06-06 10:38:23]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.601763Z","level":"info","event":"📋 2025-06-06 10:38:23,597 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.601804Z","level":"info","event":"📋 [2025-06-06 10:38:23]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.601866Z","level":"info","event":"📋 2025-06-06 10:38:23,597 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.601979Z","level":"info","event":"📋 [2025-06-06 10:38:23]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.602038Z","level":"info","event":"📋 2025-06-06 10:38:23,597 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.602080Z","level":"info","event":"📋 [2025-06-06 10:38:23] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.602119Z","level":"info","event":"📋 2025-06-06 10:38:23,597 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.602174Z","level":"info","event":"📋 [2025-06-06 10:38:23] 📦 A processar lote 1/1 (4 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:23.602210Z","level":"info","event":"📋 2025-06-06 10:38:23,598 - INFO - 📦 A processar lote 1/1 (4 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:26.264143Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:26.527973Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:26.530153Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:26.900598Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:41.358102Z","level":"info","event":"📋 [2025-06-06 10:38:41] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:41.358502Z","level":"info","event":"📋 2025-06-06 10:38:41,357 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:41.360081Z","level":"info","event":"📋 [2025-06-06 10:38:41] 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:41.360200Z","level":"info","event":"📋 2025-06-06 10:38:41,360 - INFO - 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:42.726979Z","level":"info","event":"📋 [2025-06-06 10:38:42] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: VÍDEOS: as notícias que foram ao ar na TV Rio Sul | Sul do Rio e Costa Verde - G1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:42.727230Z","level":"info","event":"📋 2025-06-06 10:38:42,726 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: VÍDEOS: as notícias que foram ao ar na TV Rio Sul | Sul do Rio e Costa Verde - G1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:42.733582Z","level":"info","event":"📋 [2025-06-06 10:38:42] 🔄 Processado: VÍDEOS: as notícias que foram ao ar na TV Rio Sul ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:42.733684Z","level":"info","event":"📋 2025-06-06 10:38:42,727 - INFO - 🔄 Processado: VÍDEOS: as notícias que foram ao ar na TV Rio Sul ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:47.049124Z","level":"info","event":"📋 [2025-06-06 10:38:47] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia chuvoso hoje (06) para Resende (RJ) - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:47.049334Z","level":"info","event":"📋 2025-06-06 10:38:47,048 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia chuvoso hoje (06) para Resende (RJ) - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:47.050088Z","level":"info","event":"📋 [2025-06-06 10:38:47] 🔄 Processado: Previsão do tempo aponta dia chuvoso hoje (06) par...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:47.050206Z","level":"info","event":"📋 2025-06-06 10:38:47,049 - INFO - 🔄 Processado: Previsão do tempo aponta dia chuvoso hoje (06) par...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.630081Z","level":"info","event":"📋 [2025-06-06 10:38:48] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (05) para Resende (RJ) - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.630266Z","level":"info","event":"📋 2025-06-06 10:38:48,629 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (05) para Resende (RJ) - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.639688Z","level":"info","event":"📋 [2025-06-06 10:38:48] 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (05) ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.639787Z","level":"info","event":"📋 2025-06-06 10:38:48,631 - INFO - 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (05) ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.639847Z","level":"info","event":"📋 📥 Novos artigos recebidos: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.639902Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.639957Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.640009Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.640058Z","level":"info","event":"📋 💾 Guardados 4 artigos no arquivo /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.640114Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.640169Z","level":"info","event":"📋 📥 Novos artigos recebidos: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.640259Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.640309Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.640355Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.640425Z","level":"info","event":"📋 💾 Guardados 4 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.640531Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.640640Z","level":"info","event":"📋 [2025-06-06 10:38:48] ✅ Relevant articles saved: 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.640731Z","level":"info","event":"📋 2025-06-06 10:38:48,634 - INFO - ✅ Relevant articles saved: 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.640788Z","level":"info","event":"📋 [2025-06-06 10:38:48] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.640846Z","level":"info","event":"📋 2025-06-06 10:38:48,634 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.640907Z","level":"info","event":"📋 [2025-06-06 10:38:48] ✅ Lote 1 concluído: 4 artigos (total: 4)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:48.640957Z","level":"info","event":"📋 2025-06-06 10:38:48,635 - INFO - ✅ Lote 1 concluído: 4 artigos (total: 4)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.683599Z","level":"info","event":"📋 📥 Novos artigos recebidos: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.684797Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.685907Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.686115Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.686292Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.686536Z","level":"info","event":"📋 📥 Novos artigos recebidos: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.686723Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.687393Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.687765Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.687909Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.688078Z","level":"info","event":"📋 [2025-06-06 10:38:51] ✅ Relevant articles saved: 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.688378Z","level":"info","event":"📋 2025-06-06 10:38:51,687 - INFO - ✅ Relevant articles saved: 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.690543Z","level":"info","event":"📋 [2025-06-06 10:38:51] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.691569Z","level":"info","event":"📋 2025-06-06 10:38:51,688 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.692553Z","level":"info","event":"📋 [2025-06-06 10:38:51] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.694453Z","level":"info","event":"📋 2025-06-06 10:38:51,688 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.695451Z","level":"info","event":"📋 [2025-06-06 10:38:51] Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.698498Z","level":"info","event":"📋 2025-06-06 10:38:51,688 - INFO - Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.699430Z","level":"info","event":"📋 [2025-06-06 10:38:51] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.699904Z","level":"info","event":"📋 2025-06-06 10:38:51,688 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.700186Z","level":"info","event":"📋 [2025-06-06 10:38:51]   Total de Artigos Processados: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.700498Z","level":"info","event":"📋 2025-06-06 10:38:51,688 - INFO -   Total de Artigos Processados: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.700857Z","level":"info","event":"📋 [2025-06-06 10:38:51]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.702358Z","level":"info","event":"📋 2025-06-06 10:38:51,688 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.702458Z","level":"info","event":"📋 [2025-06-06 10:38:51]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.702547Z","level":"info","event":"📋 2025-06-06 10:38:51,689 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.702640Z","level":"info","event":"📋 [2025-06-06 10:38:51]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.702726Z","level":"info","event":"📋 2025-06-06 10:38:51,689 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.702811Z","level":"info","event":"📋 [2025-06-06 10:38:51]   Taxa de Sucesso: 100.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.702894Z","level":"info","event":"📋 2025-06-06 10:38:51,689 - INFO -   Taxa de Sucesso: 100.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.702976Z","level":"info","event":"📋 [2025-06-06 10:38:51] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.703121Z","level":"info","event":"📋 2025-06-06 10:38:51,689 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.703210Z","level":"info","event":"📋 [2025-06-06 10:38:51] ✅ Processing completed. Processed 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.703294Z","level":"info","event":"📋 2025-06-06 10:38:51,690 - INFO - ✅ Processing completed. Processed 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.843389Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.843637Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:51.843819Z","level":"info","event":"✅ relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (1157 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:52.461669Z","level":"info","event":"📊 Number of processed articles: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:52.461979Z","level":"info","event":"📊 Columns: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:52.462126Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_irrelevantes_2025-06-06.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:52.462832Z","level":"info","event":"⚠️ processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_log_20250606.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:52.462940Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:52.462419","level":"info","event":"Done. Returned value was: [2025-06-06 10:38:23] Starting processar_relevantes_airflow\n2025-06-06 10:38:23,585 - INFO - Starting processar_relevantes_airflow\n[2025-06-06 10:38:23] Parameters: dias=1, date=2025-06-06\n2025-06-06 10:38:23,585 - INFO - Parameters: dias=1, date=2025-06-06\n[2025-06-06 10:38:23] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06, date_str=2025-06-06\n2025-06-06 10:38:23,586 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06, date_str=2025-06-06\n[2025-06-06 10:38:23] 🚀 A iniciar processar_relevantes_airflow\n2025-06-06 10:38:23,586 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-06 10:38:23] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06\n2025-06-06 10:38:23,586 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06\n[2025-06-06 10:38:23] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv\n2025-06-06 10:38:23,586 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv\n[2025-06-06 10:38:23] 🔧 A carregar ficheiros de configuração...\n2025-06-06 10:38:23,586 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-06 10:38:23] 🔍 Checking config path: /opt/airflow/config\n2025-06-06 10:38:23,586 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-06 10:38:23] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-06 10:38:23,586 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-06 10:38:23] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-06 10:38:23,586 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-06 10:38:23] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-06 10:38:23,587 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-06 10:38:23] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-06 10:38:23,587 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-06 10:38:23] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-06 10:38:23,589 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-06 10:38:23] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-06 10:38:23,589 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-06 10:38:23] ✅ Loaded 6 keywords\n2025-06-06 10:38:23,589 - INFO - ✅ Loaded 6 keywords\n[2025-06-06 10:38:23] ✅ Loaded 3614 DICOFREG codes\n2025-06-06 10:38:23,595 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-06 10:38:23] ==================================================\n2025-06-06 10:38:23,595 - INFO - ==================================================\n[2025-06-06 10:38:23] Configuration Loaded\n2025-06-06 10:38:23,595 - INFO - Configuration Loaded\n[2025-06-06 10:38:23] ==================================================\n2025-06-06 10:38:23,595 - INFO - ==================================================\n[2025-06-06 10:38:23]   Parishes: 306\n2025-06-06 10:38:23,595 - INFO -   Parishes: 306\n[2025-06-06 10:38:23]   Municipalities: 306\n2025-06-06 10:38:23,595 - INFO -   Municipalities: 306\n[2025-06-06 10:38:23]   Districts: 29\n2025-06-06 10:38:23,595 - INFO -   Districts: 29\n[2025-06-06 10:38:23]   Keywords: 6\n2025-06-06 10:38:23,595 - INFO -   Keywords: 6\n[2025-06-06 10:38:23]   DICOFREG Codes: 3614\n2025-06-06 10:38:23,595 - INFO -   DICOFREG Codes: 3614\n[2025-06-06 10:38:23] ==================================================\n2025-06-06 10:38:23,595 - INFO - ==================================================\n[2025-06-06 10:38:23] ✅ Ficheiro CSV válido com 4 artigos\n2025-06-06 10:38:23,597 - INFO - ✅ Ficheiro CSV válido com 4 artigos\n[2025-06-06 10:38:23] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-06 10:38:23,597 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-06 10:38:23] 📅 Filtrado para artigos dos últimos 1 dias: 4 artigos\n2025-06-06 10:38:23,597 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 4 artigos\n[2025-06-06 10:38:23] ==================================================\n2025-06-06 10:38:23,597 - INFO - ==================================================\n[2025-06-06 10:38:23] Processamento Iniciado\n2025-06-06 10:38:23,597 - INFO - Processamento Iniciado\n[2025-06-06 10:38:23] ==================================================\n2025-06-06 10:38:23,597 - INFO - ==================================================\n[2025-06-06 10:38:23]   Total de Artigos para Processar: 4\n2025-06-06 10:38:23,597 - INFO -   Total de Artigos para Processar: 4\n[2025-06-06 10:38:23]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv\n2025-06-06 10:38:23,597 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv\n[2025-06-06 10:38:23]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 10:38:23,597 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 10:38:23]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06\n2025-06-06 10:38:23,597 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06\n[2025-06-06 10:38:23]   Filtro de Dias: 1\n2025-06-06 10:38:23,597 - INFO -   Filtro de Dias: 1\n[2025-06-06 10:38:23] ==================================================\n2025-06-06 10:38:23,597 - INFO - ==================================================\n[2025-06-06 10:38:23] 📦 A processar lote 1/1 (4 artigos)\n2025-06-06 10:38:23,598 - INFO - 📦 A processar lote 1/1 (4 artigos)\n[2025-06-06 10:38:41] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro\n2025-06-06 10:38:41,357 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro\n[2025-06-06 10:38:41] 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...\n2025-06-06 10:38:41,360 - INFO - 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...\n[2025-06-06 10:38:42] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: VÍDEOS: as notícias que foram ao ar na TV Rio Sul | Sul do Rio e Costa Verde - G1\n2025-06-06 10:38:42,726 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: VÍDEOS: as notícias que foram ao ar na TV Rio Sul | Sul do Rio e Costa Verde - G1\n[2025-06-06 10:38:42] 🔄 Processado: VÍDEOS: as notícias que foram ao ar na TV Rio Sul ...\n2025-06-06 10:38:42,727 - INFO - 🔄 Processado: VÍDEOS: as notícias que foram ao ar na TV Rio Sul ...\n[2025-06-06 10:38:47] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia chuvoso hoje (06) para Resende (RJ) - UOL Notícias\n2025-06-06 10:38:47,048 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia chuvoso hoje (06) para Resende (RJ) - UOL Notícias\n[2025-06-06 10:38:47] 🔄 Processado: Previsão do tempo aponta dia chuvoso hoje (06) par...\n2025-06-06 10:38:47,049 - INFO - 🔄 Processado: Previsão do tempo aponta dia chuvoso hoje (06) par...\n[2025-06-06 10:38:48] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (05) para Resende (RJ) - UOL Notícias\n2025-06-06 10:38:48,629 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (05) para Resende (RJ) - UOL Notícias\n[2025-06-06 10:38:48] 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (05) ...\n2025-06-06 10:38:48,631 - INFO - 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (05) ...\n📥 Novos artigos recebidos: 4\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 4\n💾 Guardados 4 artigos no arquivo /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📥 Novos artigos recebidos: 4\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 4\n💾 Guardados 4 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 10:38:48] ✅ Relevant articles saved: 4 articles\n2025-06-06 10:38:48,634 - INFO - ✅ Relevant articles saved: 4 articles\n[2025-06-06 10:38:48] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n2025-06-06 10:38:48,634 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n[2025-06-06 10:38:48] ✅ Lote 1 concluído: 4 artigos (total: 4)\n2025-06-06 10:38:48,635 - INFO - ✅ Lote 1 concluído: 4 artigos (total: 4)\n📥 Novos artigos recebidos: 4\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📂 IDs existentes no arquivo: 4\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 4\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📂 IDs existentes no arquivo: 4\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-06 10:38:51] ✅ Relevant articles saved: 4 articles\n2025-06-06 10:38:51,687 - INFO - ✅ Relevant articles saved: 4 articles\n[2025-06-06 10:38:51] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n2025-06-06 10:38:51,688 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n[2025-06-06 10:38:51] ==================================================\n2025-06-06 10:38:51,688 - INFO - ==================================================\n[2025-06-06 10:38:51] Processamento Concluído com Sucesso\n2025-06-06 10:38:51,688 - INFO - Processamento Concluído com Sucesso\n[2025-06-06 10:38:51] ==================================================\n2025-06-06 10:38:51,688 - INFO - ==================================================\n[2025-06-06 10:38:51]   Total de Artigos Processados: 4\n2025-06-06 10:38:51,688 - INFO -   Total de Artigos Processados: 4\n[2025-06-06 10:38:51]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 10:38:51,688 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 10:38:51]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 10:38:51,689 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 10:38:51]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n2025-06-06 10:38:51,689 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n[2025-06-06 10:38:51]   Taxa de Sucesso: 100.0%\n2025-06-06 10:38:51,689 - INFO -   Taxa de Sucesso: 100.0%\n[2025-06-06 10:38:51] ==================================================\n2025-06-06 10:38:51,689 - INFO - ==================================================\n[2025-06-06 10:38:51] ✅ Processing completed. Processed 4 articles\n2025-06-06 10:38:51,690 - INFO - ✅ Processing completed. Processed 4 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-06T11:03:25.282911","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-06T11:03:25.283269","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-06T11:03:25.331323Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:25.332892Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:25.337631Z","level":"info","event":"📅 Using provided execution date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:25.339387Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/06', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/06', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/06']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:25.339914Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:25.340079Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:25.340425Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:25.340672Z","level":"info","event":"  - Target date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:25.340941Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:25.341075Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:25.341250Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:25.341368Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:25.341450Z","level":"info","event":"  - relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:25.341517Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_irrelevantes_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:25.341578Z","level":"info","event":"  - processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_log_20250606.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:25.341633Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:25.341699Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv --output_dir /opt/airflow/scripts/google_scraper/data/structured/2025/06/06 --date_str 2025-06-06 --date 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:25.341806Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.636501Z","level":"info","event":"📋 [2025-06-06 12:03:26] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.636750Z","level":"info","event":"📋 2025-06-06 12:03:26,636 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.637025Z","level":"info","event":"📋 [2025-06-06 12:03:26] Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.637093Z","level":"info","event":"📋 2025-06-06 12:03:26,636 - INFO - Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.637162Z","level":"info","event":"📋 [2025-06-06 12:03:26] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.637369Z","level":"info","event":"📋 2025-06-06 12:03:26,636 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.637477Z","level":"info","event":"📋 [2025-06-06 12:03:26] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.637577Z","level":"info","event":"📋 2025-06-06 12:03:26,636 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.637631Z","level":"info","event":"📋 [2025-06-06 12:03:26] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.638334Z","level":"info","event":"📋 2025-06-06 12:03:26,636 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.638955Z","level":"info","event":"📋 [2025-06-06 12:03:26] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.639306Z","level":"info","event":"📋 2025-06-06 12:03:26,636 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.639386Z","level":"info","event":"📋 [2025-06-06 12:03:26] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.639597Z","level":"info","event":"📋 2025-06-06 12:03:26,636 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.639690Z","level":"info","event":"📋 [2025-06-06 12:03:26] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.639737Z","level":"info","event":"📋 2025-06-06 12:03:26,636 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.639807Z","level":"info","event":"📋 [2025-06-06 12:03:26] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.639859Z","level":"info","event":"📋 2025-06-06 12:03:26,637 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.640410Z","level":"info","event":"📋 [2025-06-06 12:03:26] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.641609Z","level":"info","event":"📋 2025-06-06 12:03:26,637 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.644830Z","level":"info","event":"📋 [2025-06-06 12:03:26] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.645629Z","level":"info","event":"📋 2025-06-06 12:03:26,637 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.646586Z","level":"info","event":"📋 [2025-06-06 12:03:26] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.648646Z","level":"info","event":"📋 2025-06-06 12:03:26,637 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.648702Z","level":"info","event":"📋 [2025-06-06 12:03:26] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.648741Z","level":"info","event":"📋 2025-06-06 12:03:26,639 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.648779Z","level":"info","event":"📋 [2025-06-06 12:03:26] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.648848Z","level":"info","event":"📋 2025-06-06 12:03:26,639 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.648894Z","level":"info","event":"📋 [2025-06-06 12:03:26] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.648931Z","level":"info","event":"📋 2025-06-06 12:03:26,639 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.653091Z","level":"info","event":"📋 [2025-06-06 12:03:26] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.653360Z","level":"info","event":"📋 2025-06-06 12:03:26,653 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.653696Z","level":"info","event":"📋 [2025-06-06 12:03:26] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.653861Z","level":"info","event":"📋 2025-06-06 12:03:26,653 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.654394Z","level":"info","event":"📋 [2025-06-06 12:03:26] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.654442Z","level":"info","event":"📋 2025-06-06 12:03:26,653 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.654481Z","level":"info","event":"📋 [2025-06-06 12:03:26] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.654518Z","level":"info","event":"📋 2025-06-06 12:03:26,653 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.654554Z","level":"info","event":"📋 [2025-06-06 12:03:26]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.654609Z","level":"info","event":"📋 2025-06-06 12:03:26,653 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.654653Z","level":"info","event":"📋 [2025-06-06 12:03:26]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.654689Z","level":"info","event":"📋 2025-06-06 12:03:26,653 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.654724Z","level":"info","event":"📋 [2025-06-06 12:03:26]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.654776Z","level":"info","event":"📋 2025-06-06 12:03:26,653 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.654836Z","level":"info","event":"📋 [2025-06-06 12:03:26]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.654881Z","level":"info","event":"📋 2025-06-06 12:03:26,653 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.655119Z","level":"info","event":"📋 [2025-06-06 12:03:26]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.655174Z","level":"info","event":"📋 2025-06-06 12:03:26,653 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.655239Z","level":"info","event":"📋 [2025-06-06 12:03:26] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.655275Z","level":"info","event":"📋 2025-06-06 12:03:26,653 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.663474Z","level":"info","event":"📋 [2025-06-06 12:03:26] ✅ Ficheiro CSV válido com 7 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.663926Z","level":"info","event":"📋 2025-06-06 12:03:26,663 - INFO - ✅ Ficheiro CSV válido com 7 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.664070Z","level":"info","event":"📋 [2025-06-06 12:03:26] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.664655Z","level":"info","event":"📋 2025-06-06 12:03:26,663 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.664709Z","level":"info","event":"📋 [2025-06-06 12:03:26] 📅 Filtrado para artigos dos últimos 1 dias: 7 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.664748Z","level":"info","event":"📋 2025-06-06 12:03:26,663 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 7 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.664785Z","level":"info","event":"📋 [2025-06-06 12:03:26] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.664820Z","level":"info","event":"📋 2025-06-06 12:03:26,663 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.664856Z","level":"info","event":"📋 [2025-06-06 12:03:26] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.664894Z","level":"info","event":"📋 2025-06-06 12:03:26,663 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.664932Z","level":"info","event":"📋 [2025-06-06 12:03:26] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.664972Z","level":"info","event":"📋 2025-06-06 12:03:26,663 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.665006Z","level":"info","event":"📋 [2025-06-06 12:03:26]   Total de Artigos para Processar: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.665041Z","level":"info","event":"📋 2025-06-06 12:03:26,663 - INFO -   Total de Artigos para Processar: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.665075Z","level":"info","event":"📋 [2025-06-06 12:03:26]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.665126Z","level":"info","event":"📋 2025-06-06 12:03:26,663 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.665162Z","level":"info","event":"📋 [2025-06-06 12:03:26]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.665200Z","level":"info","event":"📋 2025-06-06 12:03:26,663 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.665260Z","level":"info","event":"📋 [2025-06-06 12:03:26]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.665300Z","level":"info","event":"📋 2025-06-06 12:03:26,663 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.665334Z","level":"info","event":"📋 [2025-06-06 12:03:26]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.665652Z","level":"info","event":"📋 2025-06-06 12:03:26,663 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.665700Z","level":"info","event":"📋 [2025-06-06 12:03:26] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.665737Z","level":"info","event":"📋 2025-06-06 12:03:26,663 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.666595Z","level":"info","event":"📋 [2025-06-06 12:03:26] ⚠️ Último ID não encontrado em relevantes. A começar do início.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.666870Z","level":"info","event":"📋 2025-06-06 12:03:26,666 - WARNING - ⚠️ Último ID não encontrado em relevantes. A começar do início.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.667588Z","level":"info","event":"📋 [2025-06-06 12:03:26] 📦 A processar lote 1/1 (7 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:26.671016Z","level":"info","event":"📋 2025-06-06 12:03:26,667 - INFO - 📦 A processar lote 1/1 (7 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:31.788675Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:32.857961Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:32.906393Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:32.920545Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:33.032887Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:33.157739Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:33.240444Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:41.070196Z","level":"info","event":"📋 [2025-06-06 12:03:41] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:41.071161Z","level":"info","event":"📋 2025-06-06 12:03:41,069 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:41.075333Z","level":"info","event":"📋 [2025-06-06 12:03:41] 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:41.076054Z","level":"info","event":"📋 2025-06-06 12:03:41,075 - INFO - 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:41.981764Z","level":"info","event":"📋 [2025-06-06 12:03:41] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuviscos no Minho e Douro Litoral e subida de temperatura no Algarve - Renascença","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:41.982211Z","level":"info","event":"📋 2025-06-06 12:03:41,980 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuviscos no Minho e Douro Litoral e subida de temperatura no Algarve - Renascença","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:41.982681Z","level":"info","event":"📋 [2025-06-06 12:03:41] 🔄 Processado: Chuviscos no Minho e Douro Litoral e subida de tem...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:41.982822Z","level":"info","event":"📋 2025-06-06 12:03:41,982 - INFO - 🔄 Processado: Chuviscos no Minho e Douro Litoral e subida de tem...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:42.577946Z","level":"info","event":"📋 [2025-06-06 12:03:42] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:42.578169Z","level":"info","event":"📋 2025-06-06 12:03:42,577 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:42.578595Z","level":"info","event":"📋 [2025-06-06 12:03:42] 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:42.578702Z","level":"info","event":"📋 2025-06-06 12:03:42,578 - INFO - 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:42.699007Z","level":"info","event":"📋 [2025-06-06 12:03:42] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:42.699185Z","level":"info","event":"📋 2025-06-06 12:03:42,698 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:42.699541Z","level":"info","event":"📋 [2025-06-06 12:03:42] 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:42.699692Z","level":"info","event":"📋 2025-06-06 12:03:42,699 - INFO - 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:51.592854Z","level":"info","event":"⚠️ ❌ Erro ao resolver URL do Google News: Message:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:51.595033Z","level":"info","event":"⚠️","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:51.595450Z","level":"info","event":"⚠️ ❌ Erro ao resolver URL do Google News: Message:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:51.595656Z","level":"info","event":"⚠️","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:51.662828Z","level":"info","event":"📋 [2025-06-06 12:03:51] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiygFBVV95cUxNTHRaRGZuZmJBcUlEcndMdHdoOTI3VG9UVE1vbUVHcndneHE4Mm9FQlN1NGtDOHM0R2NpVnMteldzalVXT3NRM0pxbXY4eURMdlNjRlVDT2pnQWNfZTFzWG5WYWlWTDRxSEk2djVjQ3NlOGN5SktnN0Fab3BZUTEwczFhaGNCMmpXTHdGZ2xxZWlQNk1peGF2UEhtS3F6STFBNUJGbVRqRHVxYzI4MFVUazB1eFUweHlZYnVLY3ROZU9JWG1HMnd6Rld3?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:51.663471Z","level":"info","event":"📋 2025-06-06 12:03:51,662 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiygFBVV95cUxNTHRaRGZuZmJBcUlEcndMdHdoOTI3VG9UVE1vbUVHcndneHE4Mm9FQlN1NGtDOHM0R2NpVnMteldzalVXT3NRM0pxbXY4eURMdlNjRlVDT2pnQWNfZTFzWG5WYWlWTDRxSEk2djVjQ3NlOGN5SktnN0Fab3BZUTEwczFhaGNCMmpXTHdGZ2xxZWlQNk1peGF2UEhtS3F6STFBNUJGbVRqRHVxYzI4MFVUazB1eFUweHlZYnVLY3ROZU9JWG1HMnd6Rld3?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:51.666297Z","level":"info","event":"📋 [2025-06-06 12:03:51] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMinAFBVV95cUxPLTBoMFZaeVMxMXQ2T093dG1kbTJ4N3prcjU1UVpBalppWGZ2Um9ZT0tBSnBJOUg5U3d6OEE5QTNPRTlCVnJxd1Y2WUpZSGNVUmFoMlVIcWRnZTlIa25DMVZubGt6VVd2SHdtM25ycksyczVsRWdaanctVjBhSkNmcHl6aXd3d01NNWpDRkJSV2tCcnF1Nl96SXdNc0s?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:51.666447Z","level":"info","event":"📋 2025-06-06 12:03:51,666 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMinAFBVV95cUxPLTBoMFZaeVMxMXQ2T093dG1kbTJ4N3prcjU1UVpBalppWGZ2Um9ZT0tBSnBJOUg5U3d6OEE5QTNPRTlCVnJxd1Y2WUpZSGNVUmFoMlVIcWRnZTlIa25DMVZubGt6VVd2SHdtM25ycksyczVsRWdaanctVjBhSkNmcHl6aXd3d01NNWpDRkJSV2tCcnF1Nl96SXdNc0s?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.052918Z","level":"info","event":"⚠️ ❌ Erro ao resolver URL do Google News: Message:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.053910Z","level":"info","event":"⚠️","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.124577Z","level":"info","event":"📋 [2025-06-06 12:03:52] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiuwFBVV95cUxQa192THRSN19Lb1paMWIyeVpvbDJMWVFZdW84emFJN1QxclZoQlNfQm43d0p6ZFNfLWNkeGpYYVpUWG5oSm9mbU10bXk1WjFVRm85TVIyR3J2N21ISUNCT2I0aW13c2J1S0tXWlFRS2lzLVA1OU9JRnExVGVMLVAxaFB3dUNwRHVoQWVFeElWVmh6ZXk4QWlMSW9ZMW8xRXo2OURkendWU25pM3dQOHV4aWZ1b2w2WF92a1NN0gG7AUFVX3lxTFBrX3ZMdFI3X0tvWloxYjJ5Wm9sMkxZUVl1bzh6YUk3VDFyVmhCU19Cbjd3SnpkU18tY2R4alhhWlRYbmhKb2ZtTXRteTVaMVVGbzlNUjJHcnY3bUhJQ0JPYjRpbXdzYnVLS1daUVFLaXMtUDU5T0lGcTFUZUwtUDFoUHd1Q3BEdWhBZUV4SVZWaHpleThBaUxJb1kxbzFFejY5RGR6d1ZTbmkzd1A4dXhpZnVvbDZYX3ZrU00?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.124868Z","level":"info","event":"📋 2025-06-06 12:03:52,124 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiuwFBVV95cUxQa192THRSN19Lb1paMWIyeVpvbDJMWVFZdW84emFJN1QxclZoQlNfQm43d0p6ZFNfLWNkeGpYYVpUWG5oSm9mbU10bXk1WjFVRm85TVIyR3J2N21ISUNCT2I0aW13c2J1S0tXWlFRS2lzLVA1OU9JRnExVGVMLVAxaFB3dUNwRHVoQWVFeElWVmh6ZXk4QWlMSW9ZMW8xRXo2OURkendWU25pM3dQOHV4aWZ1b2w2WF92a1NN0gG7AUFVX3lxTFBrX3ZMdFI3X0tvWloxYjJ5Wm9sMkxZUVl1bzh6YUk3VDFyVmhCU19Cbjd3SnpkU18tY2R4alhhWlRYbmhKb2ZtTXRteTVaMVVGbzlNUjJHcnY3bUhJQ0JPYjRpbXdzYnVLS1daUVFLaXMtUDU5T0lGcTFUZUwtUDFoUHd1Q3BEdWhBZUV4SVZWaHpleThBaUxJb1kxbzFFejY5RGR6d1ZTbmkzd1A4dXhpZnVvbDZYX3ZrU00?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.126177Z","level":"info","event":"📋 📥 Novos artigos recebidos: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.127496Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.128226Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.128514Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.129127Z","level":"info","event":"📋 💾 Guardados 1 artigos no arquivo /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.129556Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.129656Z","level":"info","event":"📋 📥 Novos artigos recebidos: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.129852Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.130655Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.130949Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.131490Z","level":"info","event":"📋 💾 Guardados 1 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.131840Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.132036Z","level":"info","event":"📋 [2025-06-06 12:03:52] ✅ Relevant articles saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.132724Z","level":"info","event":"📋 2025-06-06 12:03:52,131 - INFO - ✅ Relevant articles saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.137748Z","level":"info","event":"📋 [2025-06-06 12:03:52] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.138253Z","level":"info","event":"📋 2025-06-06 12:03:52,136 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.138399Z","level":"info","event":"📋 [2025-06-06 12:03:52] ✅ Lote 1 concluído: 1 artigos (total: 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:52.138568Z","level":"info","event":"📋 2025-06-06 12:03:52,136 - INFO - ✅ Lote 1 concluído: 1 artigos (total: 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.335360Z","level":"info","event":"📋 📥 Novos artigos recebidos: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.371786Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.373017Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.374981Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375053Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375102Z","level":"info","event":"📋 📥 Novos artigos recebidos: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375141Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375189Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375237Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375278Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375353Z","level":"info","event":"📋 [2025-06-06 12:03:56] ✅ Relevant articles saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375389Z","level":"info","event":"📋 2025-06-06 12:03:56,337 - INFO - ✅ Relevant articles saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375423Z","level":"info","event":"📋 [2025-06-06 12:03:56] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375476Z","level":"info","event":"📋 2025-06-06 12:03:56,338 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375511Z","level":"info","event":"📋 [2025-06-06 12:03:56] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375553Z","level":"info","event":"📋 2025-06-06 12:03:56,338 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375594Z","level":"info","event":"📋 [2025-06-06 12:03:56] Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375628Z","level":"info","event":"📋 2025-06-06 12:03:56,338 - INFO - Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375666Z","level":"info","event":"📋 [2025-06-06 12:03:56] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375704Z","level":"info","event":"📋 2025-06-06 12:03:56,338 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375739Z","level":"info","event":"📋 [2025-06-06 12:03:56]   Total de Artigos Processados: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375780Z","level":"info","event":"📋 2025-06-06 12:03:56,338 - INFO -   Total de Artigos Processados: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375833Z","level":"info","event":"📋 [2025-06-06 12:03:56]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375883Z","level":"info","event":"📋 2025-06-06 12:03:56,338 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375941Z","level":"info","event":"📋 [2025-06-06 12:03:56]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.375990Z","level":"info","event":"📋 2025-06-06 12:03:56,338 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.376025Z","level":"info","event":"📋 [2025-06-06 12:03:56]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.376063Z","level":"info","event":"📋 2025-06-06 12:03:56,338 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.376103Z","level":"info","event":"📋 [2025-06-06 12:03:56]   Taxa de Sucesso: 14.3%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.376170Z","level":"info","event":"📋 2025-06-06 12:03:56,338 - INFO -   Taxa de Sucesso: 14.3%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.376209Z","level":"info","event":"📋 [2025-06-06 12:03:56] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.376242Z","level":"info","event":"📋 2025-06-06 12:03:56,338 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.376279Z","level":"info","event":"📋 [2025-06-06 12:03:56] ✅ Processing completed. Processed 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.376319Z","level":"info","event":"📋 2025-06-06 12:03:56,340 - INFO - ✅ Processing completed. Processed 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.506516Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.506722Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:56.507524Z","level":"info","event":"✅ relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (1413 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:57.559235Z","level":"info","event":"📊 Number of processed articles: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:57.566242Z","level":"info","event":"📊 Columns: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:57.567156Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_irrelevantes_2025-06-06.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:57.568173Z","level":"info","event":"⚠️ processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_log_20250606.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:57.569404Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:57.559397","level":"info","event":"Done. Returned value was: [2025-06-06 12:03:26] Starting processar_relevantes_airflow\n2025-06-06 12:03:26,636 - INFO - Starting processar_relevantes_airflow\n[2025-06-06 12:03:26] Parameters: dias=1, date=2025-06-06\n2025-06-06 12:03:26,636 - INFO - Parameters: dias=1, date=2025-06-06\n[2025-06-06 12:03:26] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06, date_str=2025-06-06\n2025-06-06 12:03:26,636 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06, date_str=2025-06-06\n[2025-06-06 12:03:26] 🚀 A iniciar processar_relevantes_airflow\n2025-06-06 12:03:26,636 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-06 12:03:26] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06\n2025-06-06 12:03:26,636 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06\n[2025-06-06 12:03:26] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv\n2025-06-06 12:03:26,636 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv\n[2025-06-06 12:03:26] 🔧 A carregar ficheiros de configuração...\n2025-06-06 12:03:26,636 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-06 12:03:26] 🔍 Checking config path: /opt/airflow/config\n2025-06-06 12:03:26,636 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-06 12:03:26] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-06 12:03:26,637 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-06 12:03:26] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-06 12:03:26,637 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-06 12:03:26] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-06 12:03:26,637 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-06 12:03:26] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-06 12:03:26,637 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-06 12:03:26] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-06 12:03:26,639 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-06 12:03:26] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-06 12:03:26,639 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-06 12:03:26] ✅ Loaded 6 keywords\n2025-06-06 12:03:26,639 - INFO - ✅ Loaded 6 keywords\n[2025-06-06 12:03:26] ✅ Loaded 3614 DICOFREG codes\n2025-06-06 12:03:26,653 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-06 12:03:26] ==================================================\n2025-06-06 12:03:26,653 - INFO - ==================================================\n[2025-06-06 12:03:26] Configuration Loaded\n2025-06-06 12:03:26,653 - INFO - Configuration Loaded\n[2025-06-06 12:03:26] ==================================================\n2025-06-06 12:03:26,653 - INFO - ==================================================\n[2025-06-06 12:03:26]   Parishes: 306\n2025-06-06 12:03:26,653 - INFO -   Parishes: 306\n[2025-06-06 12:03:26]   Municipalities: 306\n2025-06-06 12:03:26,653 - INFO -   Municipalities: 306\n[2025-06-06 12:03:26]   Districts: 29\n2025-06-06 12:03:26,653 - INFO -   Districts: 29\n[2025-06-06 12:03:26]   Keywords: 6\n2025-06-06 12:03:26,653 - INFO -   Keywords: 6\n[2025-06-06 12:03:26]   DICOFREG Codes: 3614\n2025-06-06 12:03:26,653 - INFO -   DICOFREG Codes: 3614\n[2025-06-06 12:03:26] ==================================================\n2025-06-06 12:03:26,653 - INFO - ==================================================\n[2025-06-06 12:03:26] ✅ Ficheiro CSV válido com 7 artigos\n2025-06-06 12:03:26,663 - INFO - ✅ Ficheiro CSV válido com 7 artigos\n[2025-06-06 12:03:26] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-06 12:03:26,663 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-06 12:03:26] 📅 Filtrado para artigos dos últimos 1 dias: 7 artigos\n2025-06-06 12:03:26,663 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 7 artigos\n[2025-06-06 12:03:26] ==================================================\n2025-06-06 12:03:26,663 - INFO - ==================================================\n[2025-06-06 12:03:26] Processamento Iniciado\n2025-06-06 12:03:26,663 - INFO - Processamento Iniciado\n[2025-06-06 12:03:26] ==================================================\n2025-06-06 12:03:26,663 - INFO - ==================================================\n[2025-06-06 12:03:26]   Total de Artigos para Processar: 7\n2025-06-06 12:03:26,663 - INFO -   Total de Artigos para Processar: 7\n[2025-06-06 12:03:26]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv\n2025-06-06 12:03:26,663 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv\n[2025-06-06 12:03:26]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 12:03:26,663 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 12:03:26]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06\n2025-06-06 12:03:26,663 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06\n[2025-06-06 12:03:26]   Filtro de Dias: 1\n2025-06-06 12:03:26,663 - INFO -   Filtro de Dias: 1\n[2025-06-06 12:03:26] ==================================================\n2025-06-06 12:03:26,663 - INFO - ==================================================\n[2025-06-06 12:03:26] ⚠️ Último ID não encontrado em relevantes. A começar do início.\n2025-06-06 12:03:26,666 - WARNING - ⚠️ Último ID não encontrado em relevantes. A começar do início.\n[2025-06-06 12:03:26] 📦 A processar lote 1/1 (7 artigos)\n2025-06-06 12:03:26,667 - INFO - 📦 A processar lote 1/1 (7 artigos)\n[2025-06-06 12:03:41] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro\n2025-06-06 12:03:41,069 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro\n[2025-06-06 12:03:41] 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...\n2025-06-06 12:03:41,075 - INFO - 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...\n[2025-06-06 12:03:41] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuviscos no Minho e Douro Litoral e subida de temperatura no Algarve - Renascença\n2025-06-06 12:03:41,980 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuviscos no Minho e Douro Litoral e subida de temperatura no Algarve - Renascença\n[2025-06-06 12:03:41] 🔄 Processado: Chuviscos no Minho e Douro Litoral e subida de tem...\n2025-06-06 12:03:41,982 - INFO - 🔄 Processado: Chuviscos no Minho e Douro Litoral e subida de tem...\n[2025-06-06 12:03:42] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro\n2025-06-06 12:03:42,577 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro\n[2025-06-06 12:03:42] 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...\n2025-06-06 12:03:42,578 - INFO - 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...\n[2025-06-06 12:03:42] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro\n2025-06-06 12:03:42,698 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro\n[2025-06-06 12:03:42] 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...\n2025-06-06 12:03:42,699 - INFO - 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...\n[2025-06-06 12:03:51] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiygFBVV95cUxNTHRaRGZuZmJBcUlEcndMdHdoOTI3VG9UVE1vbUVHcndneHE4Mm9FQlN1NGtDOHM0R2NpVnMteldzalVXT3NRM0pxbXY4eURMdlNjRlVDT2pnQWNfZTFzWG5WYWlWTDRxSEk2djVjQ3NlOGN5SktnN0Fab3BZUTEwczFhaGNCMmpXTHdGZ2xxZWlQNk1peGF2UEhtS3F6STFBNUJGbVRqRHVxYzI4MFVUazB1eFUweHlZYnVLY3ROZU9JWG1HMnd6Rld3?oc=5\n2025-06-06 12:03:51,662 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiygFBVV95cUxNTHRaRGZuZmJBcUlEcndMdHdoOTI3VG9UVE1vbUVHcndneHE4Mm9FQlN1NGtDOHM0R2NpVnMteldzalVXT3NRM0pxbXY4eURMdlNjRlVDT2pnQWNfZTFzWG5WYWlWTDRxSEk2djVjQ3NlOGN5SktnN0Fab3BZUTEwczFhaGNCMmpXTHdGZ2xxZWlQNk1peGF2UEhtS3F6STFBNUJGbVRqRHVxYzI4MFVUazB1eFUweHlZYnVLY3ROZU9JWG1HMnd6Rld3?oc=5\n[2025-06-06 12:03:51] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMinAFBVV95cUxPLTBoMFZaeVMxMXQ2T093dG1kbTJ4N3prcjU1UVpBalppWGZ2Um9ZT0tBSnBJOUg5U3d6OEE5QTNPRTlCVnJxd1Y2WUpZSGNVUmFoMlVIcWRnZTlIa25DMVZubGt6VVd2SHdtM25ycksyczVsRWdaanctVjBhSkNmcHl6aXd3d01NNWpDRkJSV2tCcnF1Nl96SXdNc0s?oc=5\n2025-06-06 12:03:51,666 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMinAFBVV95cUxPLTBoMFZaeVMxMXQ2T093dG1kbTJ4N3prcjU1UVpBalppWGZ2Um9ZT0tBSnBJOUg5U3d6OEE5QTNPRTlCVnJxd1Y2WUpZSGNVUmFoMlVIcWRnZTlIa25DMVZubGt6VVd2SHdtM25ycksyczVsRWdaanctVjBhSkNmcHl6aXd3d01NNWpDRkJSV2tCcnF1Nl96SXdNc0s?oc=5\n[2025-06-06 12:03:52] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiuwFBVV95cUxQa192THRSN19Lb1paMWIyeVpvbDJMWVFZdW84emFJN1QxclZoQlNfQm43d0p6ZFNfLWNkeGpYYVpUWG5oSm9mbU10bXk1WjFVRm85TVIyR3J2N21ISUNCT2I0aW13c2J1S0tXWlFRS2lzLVA1OU9JRnExVGVMLVAxaFB3dUNwRHVoQWVFeElWVmh6ZXk4QWlMSW9ZMW8xRXo2OURkendWU25pM3dQOHV4aWZ1b2w2WF92a1NN0gG7AUFVX3lxTFBrX3ZMdFI3X0tvWloxYjJ5Wm9sMkxZUVl1bzh6YUk3VDFyVmhCU19Cbjd3SnpkU18tY2R4alhhWlRYbmhKb2ZtTXRteTVaMVVGbzlNUjJHcnY3bUhJQ0JPYjRpbXdzYnVLS1daUVFLaXMtUDU5T0lGcTFUZUwtUDFoUHd1Q3BEdWhBZUV4SVZWaHpleThBaUxJb1kxbzFFejY5RGR6d1ZTbmkzd1A4dXhpZnVvbDZYX3ZrU00?oc=5\n2025-06-06 12:03:52,124 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiuwFBVV95cUxQa192THRSN19Lb1paMWIyeVpvbDJMWVFZdW84emFJN1QxclZoQlNfQm43d0p6ZFNfLWNkeGpYYVpUWG5oSm9mbU10bXk1WjFVRm85TVIyR3J2N21ISUNCT2I0aW13c2J1S0tXWlFRS2lzLVA1OU9JRnExVGVMLVAxaFB3dUNwRHVoQWVFeElWVmh6ZXk4QWlMSW9ZMW8xRXo2OURkendWU25pM3dQOHV4aWZ1b2w2WF92a1NN0gG7AUFVX3lxTFBrX3ZMdFI3X0tvWloxYjJ5Wm9sMkxZUVl1bzh6YUk3VDFyVmhCU19Cbjd3SnpkU18tY2R4alhhWlRYbmhKb2ZtTXRteTVaMVVGbzlNUjJHcnY3bUhJQ0JPYjRpbXdzYnVLS1daUVFLaXMtUDU5T0lGcTFUZUwtUDFoUHd1Q3BEdWhBZUV4SVZWaHpleThBaUxJb1kxbzFFejY5RGR6d1ZTbmkzd1A4dXhpZnVvbDZYX3ZrU00?oc=5\n📥 Novos artigos recebidos: 1\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📂 IDs existentes no arquivo: 4\n🆕 Artigos únicos para salvar: 1\n💾 Guardados 1 artigos no arquivo /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📥 Novos artigos recebidos: 1\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📂 IDs existentes no arquivo: 4\n🆕 Artigos únicos para salvar: 1\n💾 Guardados 1 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 12:03:52] ✅ Relevant articles saved: 1 articles\n2025-06-06 12:03:52,131 - INFO - ✅ Relevant articles saved: 1 articles\n[2025-06-06 12:03:52] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n2025-06-06 12:03:52,136 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n[2025-06-06 12:03:52] ✅ Lote 1 concluído: 1 artigos (total: 1)\n2025-06-06 12:03:52,136 - INFO - ✅ Lote 1 concluído: 1 artigos (total: 1)\n📥 Novos artigos recebidos: 1\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📂 IDs existentes no arquivo: 5\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 1\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📂 IDs existentes no arquivo: 5\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-06 12:03:56] ✅ Relevant articles saved: 1 articles\n2025-06-06 12:03:56,337 - INFO - ✅ Relevant articles saved: 1 articles\n[2025-06-06 12:03:56] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n2025-06-06 12:03:56,338 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n[2025-06-06 12:03:56] ==================================================\n2025-06-06 12:03:56,338 - INFO - ==================================================\n[2025-06-06 12:03:56] Processamento Concluído com Sucesso\n2025-06-06 12:03:56,338 - INFO - Processamento Concluído com Sucesso\n[2025-06-06 12:03:56] ==================================================\n2025-06-06 12:03:56,338 - INFO - ==================================================\n[2025-06-06 12:03:56]   Total de Artigos Processados: 1\n2025-06-06 12:03:56,338 - INFO -   Total de Artigos Processados: 1\n[2025-06-06 12:03:56]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 12:03:56,338 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 12:03:56]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 12:03:56,338 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 12:03:56]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n2025-06-06 12:03:56,338 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n[2025-06-06 12:03:56]   Taxa de Sucesso: 14.3%\n2025-06-06 12:03:56,338 - INFO -   Taxa de Sucesso: 14.3%\n[2025-06-06 12:03:56] ==================================================\n2025-06-06 12:03:56,338 - INFO - ==================================================\n[2025-06-06 12:03:56] ✅ Processing completed. Processed 1 articles\n2025-06-06 12:03:56,340 - INFO - ✅ Processing completed. Processed 1 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-06T13:59:13.387964","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-06T13:59:13.388841","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-06T13:59:13.462182Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:13.462525Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:13.466942Z","level":"info","event":"📅 Using provided execution date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:13.467772Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/06', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/06', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/06']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:13.467903Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:13.468061Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:13.468287Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:13.468384Z","level":"info","event":"  - Target date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:13.468492Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:13.468663Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:13.468840Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:13.469086Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:13.469206Z","level":"info","event":"  - relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:13.469337Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_irrelevantes_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:13.469489Z","level":"info","event":"  - processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_log_20250606.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:13.469623Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:13.469750Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv --output_dir /opt/airflow/scripts/google_scraper/data/structured/2025/06/06 --date_str 2025-06-06 --date 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:13.469929Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.677774Z","level":"info","event":"📋 [2025-06-06 14:59:15] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.679699Z","level":"info","event":"📋 2025-06-06 14:59:15,677 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.679817Z","level":"info","event":"📋 [2025-06-06 14:59:15] Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.679939Z","level":"info","event":"📋 2025-06-06 14:59:15,677 - INFO - Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.680085Z","level":"info","event":"📋 [2025-06-06 14:59:15] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.680236Z","level":"info","event":"📋 2025-06-06 14:59:15,677 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.680493Z","level":"info","event":"📋 [2025-06-06 14:59:15] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.680596Z","level":"info","event":"📋 2025-06-06 14:59:15,677 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.681015Z","level":"info","event":"📋 [2025-06-06 14:59:15] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.681127Z","level":"info","event":"📋 2025-06-06 14:59:15,677 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.681235Z","level":"info","event":"📋 [2025-06-06 14:59:15] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.681356Z","level":"info","event":"📋 2025-06-06 14:59:15,679 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.681445Z","level":"info","event":"📋 [2025-06-06 14:59:15] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.681545Z","level":"info","event":"📋 2025-06-06 14:59:15,679 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.681645Z","level":"info","event":"📋 [2025-06-06 14:59:15] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.681716Z","level":"info","event":"📋 2025-06-06 14:59:15,679 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.681810Z","level":"info","event":"📋 [2025-06-06 14:59:15] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.681888Z","level":"info","event":"📋 2025-06-06 14:59:15,680 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.681972Z","level":"info","event":"📋 [2025-06-06 14:59:15] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.682058Z","level":"info","event":"📋 2025-06-06 14:59:15,680 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.682232Z","level":"info","event":"📋 [2025-06-06 14:59:15] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.682366Z","level":"info","event":"📋 2025-06-06 14:59:15,680 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.682617Z","level":"info","event":"📋 [2025-06-06 14:59:15] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.682704Z","level":"info","event":"📋 2025-06-06 14:59:15,680 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.682928Z","level":"info","event":"📋 [2025-06-06 14:59:15] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.683009Z","level":"info","event":"📋 2025-06-06 14:59:15,682 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.683406Z","level":"info","event":"📋 [2025-06-06 14:59:15] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.684009Z","level":"info","event":"📋 2025-06-06 14:59:15,682 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.684147Z","level":"info","event":"📋 [2025-06-06 14:59:15] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.684244Z","level":"info","event":"📋 2025-06-06 14:59:15,682 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.691286Z","level":"info","event":"📋 [2025-06-06 14:59:15] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.691865Z","level":"info","event":"📋 2025-06-06 14:59:15,691 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.692199Z","level":"info","event":"📋 [2025-06-06 14:59:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.692390Z","level":"info","event":"📋 2025-06-06 14:59:15,691 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.692548Z","level":"info","event":"📋 [2025-06-06 14:59:15] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.692746Z","level":"info","event":"📋 2025-06-06 14:59:15,691 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.692941Z","level":"info","event":"📋 [2025-06-06 14:59:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.693240Z","level":"info","event":"📋 2025-06-06 14:59:15,691 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.693609Z","level":"info","event":"📋 [2025-06-06 14:59:15]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.693746Z","level":"info","event":"📋 2025-06-06 14:59:15,691 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.693959Z","level":"info","event":"📋 [2025-06-06 14:59:15]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.694218Z","level":"info","event":"📋 2025-06-06 14:59:15,691 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.694381Z","level":"info","event":"📋 [2025-06-06 14:59:15]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.694526Z","level":"info","event":"📋 2025-06-06 14:59:15,691 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.694679Z","level":"info","event":"📋 [2025-06-06 14:59:15]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.694876Z","level":"info","event":"📋 2025-06-06 14:59:15,691 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.695112Z","level":"info","event":"📋 [2025-06-06 14:59:15]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.695309Z","level":"info","event":"📋 2025-06-06 14:59:15,691 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.695483Z","level":"info","event":"📋 [2025-06-06 14:59:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.695589Z","level":"info","event":"📋 2025-06-06 14:59:15,691 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.702676Z","level":"info","event":"📋 [2025-06-06 14:59:15] ✅ Ficheiro CSV válido com 9 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.702919Z","level":"info","event":"📋 2025-06-06 14:59:15,702 - INFO - ✅ Ficheiro CSV válido com 9 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.703031Z","level":"info","event":"📋 [2025-06-06 14:59:15] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.703182Z","level":"info","event":"📋 2025-06-06 14:59:15,702 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.703373Z","level":"info","event":"📋 [2025-06-06 14:59:15] 📅 Filtrado para artigos dos últimos 1 dias: 9 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.703491Z","level":"info","event":"📋 2025-06-06 14:59:15,703 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 9 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.703571Z","level":"info","event":"📋 [2025-06-06 14:59:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.703665Z","level":"info","event":"📋 2025-06-06 14:59:15,703 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.703754Z","level":"info","event":"📋 [2025-06-06 14:59:15] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.703845Z","level":"info","event":"📋 2025-06-06 14:59:15,703 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.703904Z","level":"info","event":"📋 [2025-06-06 14:59:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.703961Z","level":"info","event":"📋 2025-06-06 14:59:15,703 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.704022Z","level":"info","event":"📋 [2025-06-06 14:59:15]   Total de Artigos para Processar: 9","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.704084Z","level":"info","event":"📋 2025-06-06 14:59:15,703 - INFO -   Total de Artigos para Processar: 9","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.704141Z","level":"info","event":"📋 [2025-06-06 14:59:15]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.704213Z","level":"info","event":"📋 2025-06-06 14:59:15,703 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.704299Z","level":"info","event":"📋 [2025-06-06 14:59:15]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.704371Z","level":"info","event":"📋 2025-06-06 14:59:15,703 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.704430Z","level":"info","event":"📋 [2025-06-06 14:59:15]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.704486Z","level":"info","event":"📋 2025-06-06 14:59:15,703 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.704543Z","level":"info","event":"📋 [2025-06-06 14:59:15]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.704598Z","level":"info","event":"📋 2025-06-06 14:59:15,703 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.704699Z","level":"info","event":"📋 [2025-06-06 14:59:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.704756Z","level":"info","event":"📋 2025-06-06 14:59:15,703 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.705993Z","level":"info","event":"📋 [2025-06-06 14:59:15] ⏩ A retomar do índice 7 após o ID: ee6e338472a9a52558377d3a7a289be7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.706074Z","level":"info","event":"📋 2025-06-06 14:59:15,705 - INFO - ⏩ A retomar do índice 7 após o ID: ee6e338472a9a52558377d3a7a289be7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.707515Z","level":"info","event":"📋 [2025-06-06 14:59:15] 📦 A processar lote 1/1 (2 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:15.707616Z","level":"info","event":"📋 2025-06-06 14:59:15,707 - INFO - 📦 A processar lote 1/1 (2 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:23.187124Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:23.190546Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:26.321599Z","level":"info","event":"📋 [2025-06-06 14:59:26] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas disparam no fim-de-semana. Domingo será o dia mais quente - Renascença","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:26.323128Z","level":"info","event":"📋 2025-06-06 14:59:26,318 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas disparam no fim-de-semana. Domingo será o dia mais quente - Renascença","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:26.359230Z","level":"info","event":"📋 [2025-06-06 14:59:26] 🔄 Processado: Temperaturas disparam no fim-de-semana. Domingo se...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:26.360264Z","level":"info","event":"📋 2025-06-06 14:59:26,339 - INFO - 🔄 Processado: Temperaturas disparam no fim-de-semana. Domingo se...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.283584Z","level":"info","event":"📋 [2025-06-06 14:59:28] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: TEMPO - Calor está de regresso. Temperaturas disparam este domingo - O Vilaverdense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.284071Z","level":"info","event":"📋 2025-06-06 14:59:28,283 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: TEMPO - Calor está de regresso. Temperaturas disparam este domingo - O Vilaverdense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.284745Z","level":"info","event":"📋 [2025-06-06 14:59:28] 🔄 Processado: TEMPO - Calor está de regresso. Temperaturas dispa...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.284952Z","level":"info","event":"📋 2025-06-06 14:59:28,284 - INFO - 🔄 Processado: TEMPO - Calor está de regresso. Temperaturas dispa...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.285350Z","level":"info","event":"📋 📥 Novos artigos recebidos: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.287046Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.287680Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.287809Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.288798Z","level":"info","event":"📋 💾 Guardados 2 artigos no arquivo /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.289216Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.289355Z","level":"info","event":"📋 📥 Novos artigos recebidos: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.289676Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.290510Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.290643Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.291018Z","level":"info","event":"📋 💾 Guardados 2 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.291316Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.291872Z","level":"info","event":"📋 [2025-06-06 14:59:28] ✅ Relevant articles saved: 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.292050Z","level":"info","event":"📋 2025-06-06 14:59:28,291 - INFO - ✅ Relevant articles saved: 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.292494Z","level":"info","event":"📋 [2025-06-06 14:59:28] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.292672Z","level":"info","event":"📋 2025-06-06 14:59:28,292 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.292779Z","level":"info","event":"📋 [2025-06-06 14:59:28] ✅ Lote 1 concluído: 2 artigos (total: 2)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:28.292892Z","level":"info","event":"📋 2025-06-06 14:59:28,292 - INFO - ✅ Lote 1 concluído: 2 artigos (total: 2)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.079805Z","level":"info","event":"📋 📥 Novos artigos recebidos: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.170192Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.170455Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.170582Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.170685Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.170823Z","level":"info","event":"📋 📥 Novos artigos recebidos: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.170919Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.171089Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.171187Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.171293Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.171382Z","level":"info","event":"📋 [2025-06-06 14:59:32] ✅ Relevant articles saved: 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.171471Z","level":"info","event":"📋 2025-06-06 14:59:32,083 - INFO - ✅ Relevant articles saved: 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.171566Z","level":"info","event":"📋 [2025-06-06 14:59:32] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.171707Z","level":"info","event":"📋 2025-06-06 14:59:32,085 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.171838Z","level":"info","event":"📋 [2025-06-06 14:59:32] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.171995Z","level":"info","event":"📋 2025-06-06 14:59:32,085 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.172105Z","level":"info","event":"📋 [2025-06-06 14:59:32] Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.172209Z","level":"info","event":"📋 2025-06-06 14:59:32,085 - INFO - Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.172319Z","level":"info","event":"📋 [2025-06-06 14:59:32] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.172420Z","level":"info","event":"📋 2025-06-06 14:59:32,085 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.172524Z","level":"info","event":"📋 [2025-06-06 14:59:32]   Total de Artigos Processados: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.172647Z","level":"info","event":"📋 2025-06-06 14:59:32,085 - INFO -   Total de Artigos Processados: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.172758Z","level":"info","event":"📋 [2025-06-06 14:59:32]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.172898Z","level":"info","event":"📋 2025-06-06 14:59:32,085 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.173017Z","level":"info","event":"📋 [2025-06-06 14:59:32]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.173105Z","level":"info","event":"📋 2025-06-06 14:59:32,086 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.173202Z","level":"info","event":"📋 [2025-06-06 14:59:32]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.173323Z","level":"info","event":"📋 2025-06-06 14:59:32,086 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.173531Z","level":"info","event":"📋 [2025-06-06 14:59:32]   Taxa de Sucesso: 22.2%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.173641Z","level":"info","event":"📋 2025-06-06 14:59:32,086 - INFO -   Taxa de Sucesso: 22.2%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.173745Z","level":"info","event":"📋 [2025-06-06 14:59:32] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.173891Z","level":"info","event":"📋 2025-06-06 14:59:32,086 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.173989Z","level":"info","event":"📋 [2025-06-06 14:59:32] ✅ Processing completed. Processed 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.174086Z","level":"info","event":"📋 2025-06-06 14:59:32,088 - INFO - ✅ Processing completed. Processed 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.356044Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.356327Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:32.356581Z","level":"info","event":"✅ relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (1870 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.364276Z","level":"info","event":"📊 Number of processed articles: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.364631Z","level":"info","event":"📊 Columns: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.364841Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_irrelevantes_2025-06-06.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.365023Z","level":"info","event":"⚠️ processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_log_20250606.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.365166Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.366466","level":"info","event":"Done. Returned value was: [2025-06-06 14:59:15] Starting processar_relevantes_airflow\n2025-06-06 14:59:15,677 - INFO - Starting processar_relevantes_airflow\n[2025-06-06 14:59:15] Parameters: dias=1, date=2025-06-06\n2025-06-06 14:59:15,677 - INFO - Parameters: dias=1, date=2025-06-06\n[2025-06-06 14:59:15] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06, date_str=2025-06-06\n2025-06-06 14:59:15,677 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06, date_str=2025-06-06\n[2025-06-06 14:59:15] 🚀 A iniciar processar_relevantes_airflow\n2025-06-06 14:59:15,677 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-06 14:59:15] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06\n2025-06-06 14:59:15,677 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06\n[2025-06-06 14:59:15] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv\n2025-06-06 14:59:15,679 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv\n[2025-06-06 14:59:15] 🔧 A carregar ficheiros de configuração...\n2025-06-06 14:59:15,679 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-06 14:59:15] 🔍 Checking config path: /opt/airflow/config\n2025-06-06 14:59:15,679 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-06 14:59:15] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-06 14:59:15,680 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-06 14:59:15] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-06 14:59:15,680 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-06 14:59:15] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-06 14:59:15,680 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-06 14:59:15] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-06 14:59:15,680 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-06 14:59:15] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-06 14:59:15,682 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-06 14:59:15] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-06 14:59:15,682 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-06 14:59:15] ✅ Loaded 6 keywords\n2025-06-06 14:59:15,682 - INFO - ✅ Loaded 6 keywords\n[2025-06-06 14:59:15] ✅ Loaded 3614 DICOFREG codes\n2025-06-06 14:59:15,691 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-06 14:59:15] ==================================================\n2025-06-06 14:59:15,691 - INFO - ==================================================\n[2025-06-06 14:59:15] Configuration Loaded\n2025-06-06 14:59:15,691 - INFO - Configuration Loaded\n[2025-06-06 14:59:15] ==================================================\n2025-06-06 14:59:15,691 - INFO - ==================================================\n[2025-06-06 14:59:15]   Parishes: 306\n2025-06-06 14:59:15,691 - INFO -   Parishes: 306\n[2025-06-06 14:59:15]   Municipalities: 306\n2025-06-06 14:59:15,691 - INFO -   Municipalities: 306\n[2025-06-06 14:59:15]   Districts: 29\n2025-06-06 14:59:15,691 - INFO -   Districts: 29\n[2025-06-06 14:59:15]   Keywords: 6\n2025-06-06 14:59:15,691 - INFO -   Keywords: 6\n[2025-06-06 14:59:15]   DICOFREG Codes: 3614\n2025-06-06 14:59:15,691 - INFO -   DICOFREG Codes: 3614\n[2025-06-06 14:59:15] ==================================================\n2025-06-06 14:59:15,691 - INFO - ==================================================\n[2025-06-06 14:59:15] ✅ Ficheiro CSV válido com 9 artigos\n2025-06-06 14:59:15,702 - INFO - ✅ Ficheiro CSV válido com 9 artigos\n[2025-06-06 14:59:15] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-06 14:59:15,702 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-06 14:59:15] 📅 Filtrado para artigos dos últimos 1 dias: 9 artigos\n2025-06-06 14:59:15,703 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 9 artigos\n[2025-06-06 14:59:15] ==================================================\n2025-06-06 14:59:15,703 - INFO - ==================================================\n[2025-06-06 14:59:15] Processamento Iniciado\n2025-06-06 14:59:15,703 - INFO - Processamento Iniciado\n[2025-06-06 14:59:15] ==================================================\n2025-06-06 14:59:15,703 - INFO - ==================================================\n[2025-06-06 14:59:15]   Total de Artigos para Processar: 9\n2025-06-06 14:59:15,703 - INFO -   Total de Artigos para Processar: 9\n[2025-06-06 14:59:15]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv\n2025-06-06 14:59:15,703 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv\n[2025-06-06 14:59:15]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 14:59:15,703 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 14:59:15]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06\n2025-06-06 14:59:15,703 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06\n[2025-06-06 14:59:15]   Filtro de Dias: 1\n2025-06-06 14:59:15,703 - INFO -   Filtro de Dias: 1\n[2025-06-06 14:59:15] ==================================================\n2025-06-06 14:59:15,703 - INFO - ==================================================\n[2025-06-06 14:59:15] ⏩ A retomar do índice 7 após o ID: ee6e338472a9a52558377d3a7a289be7\n2025-06-06 14:59:15,705 - INFO - ⏩ A retomar do índice 7 após o ID: ee6e338472a9a52558377d3a7a289be7\n[2025-06-06 14:59:15] 📦 A processar lote 1/1 (2 artigos)\n2025-06-06 14:59:15,707 - INFO - 📦 A processar lote 1/1 (2 artigos)\n[2025-06-06 14:59:26] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas disparam no fim-de-semana. Domingo será o dia mais quente - Renascença\n2025-06-06 14:59:26,318 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas disparam no fim-de-semana. Domingo será o dia mais quente - Renascença\n[2025-06-06 14:59:26] 🔄 Processado: Temperaturas disparam no fim-de-semana. Domingo se...\n2025-06-06 14:59:26,339 - INFO - 🔄 Processado: Temperaturas disparam no fim-de-semana. Domingo se...\n[2025-06-06 14:59:28] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: TEMPO - Calor está de regresso. Temperaturas disparam este domingo - O Vilaverdense\n2025-06-06 14:59:28,283 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: TEMPO - Calor está de regresso. Temperaturas disparam este domingo - O Vilaverdense\n[2025-06-06 14:59:28] 🔄 Processado: TEMPO - Calor está de regresso. Temperaturas dispa...\n2025-06-06 14:59:28,284 - INFO - 🔄 Processado: TEMPO - Calor está de regresso. Temperaturas dispa...\n📥 Novos artigos recebidos: 2\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📂 IDs existentes no arquivo: 5\n🆕 Artigos únicos para salvar: 2\n💾 Guardados 2 artigos no arquivo /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📥 Novos artigos recebidos: 2\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📂 IDs existentes no arquivo: 5\n🆕 Artigos únicos para salvar: 2\n💾 Guardados 2 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 14:59:28] ✅ Relevant articles saved: 2 articles\n2025-06-06 14:59:28,291 - INFO - ✅ Relevant articles saved: 2 articles\n[2025-06-06 14:59:28] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n2025-06-06 14:59:28,292 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n[2025-06-06 14:59:28] ✅ Lote 1 concluído: 2 artigos (total: 2)\n2025-06-06 14:59:28,292 - INFO - ✅ Lote 1 concluído: 2 artigos (total: 2)\n📥 Novos artigos recebidos: 2\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📂 IDs existentes no arquivo: 7\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 2\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📂 IDs existentes no arquivo: 7\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-06 14:59:32] ✅ Relevant articles saved: 2 articles\n2025-06-06 14:59:32,083 - INFO - ✅ Relevant articles saved: 2 articles\n[2025-06-06 14:59:32] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n2025-06-06 14:59:32,085 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n[2025-06-06 14:59:32] ==================================================\n2025-06-06 14:59:32,085 - INFO - ==================================================\n[2025-06-06 14:59:32] Processamento Concluído com Sucesso\n2025-06-06 14:59:32,085 - INFO - Processamento Concluído com Sucesso\n[2025-06-06 14:59:32] ==================================================\n2025-06-06 14:59:32,085 - INFO - ==================================================\n[2025-06-06 14:59:32]   Total de Artigos Processados: 2\n2025-06-06 14:59:32,085 - INFO -   Total de Artigos Processados: 2\n[2025-06-06 14:59:32]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 14:59:32,085 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 14:59:32]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 14:59:32,086 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 14:59:32]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n2025-06-06 14:59:32,086 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n[2025-06-06 14:59:32]   Taxa de Sucesso: 22.2%\n2025-06-06 14:59:32,086 - INFO -   Taxa de Sucesso: 22.2%\n[2025-06-06 14:59:32] ==================================================\n2025-06-06 14:59:32,086 - INFO - ==================================================\n[2025-06-06 14:59:32] ✅ Processing completed. Processed 2 articles\n2025-06-06 14:59:32,088 - INFO - ✅ Processing completed. Processed 2 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-06T14:15:16.122913","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-06T14:15:16.123489","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-06T14:15:16.181854Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:16.184493Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:16.185937Z","level":"info","event":"📅 Using provided execution date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:16.186539Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/06', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/06', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/06']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:16.187204Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:16.187353Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:16.187802Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:16.187973Z","level":"info","event":"  - Target date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:16.188151Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:16.188284Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:16.188405Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:16.188499Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:16.188593Z","level":"info","event":"  - relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:16.188693Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_irrelevantes_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:16.188796Z","level":"info","event":"  - processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_log_20250606.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:16.188891Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:16.188989Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv --output_dir /opt/airflow/scripts/google_scraper/data/structured/2025/06/06 --date_str 2025-06-06 --date 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:16.189119Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.238277Z","level":"info","event":"📋 [2025-06-06 15:15:18] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.240490Z","level":"info","event":"📋 2025-06-06 15:15:18,238 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.240625Z","level":"info","event":"📋 [2025-06-06 15:15:18] Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.241224Z","level":"info","event":"📋 2025-06-06 15:15:18,238 - INFO - Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.241333Z","level":"info","event":"📋 [2025-06-06 15:15:18] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.241685Z","level":"info","event":"📋 2025-06-06 15:15:18,238 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.241860Z","level":"info","event":"📋 [2025-06-06 15:15:18] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.242002Z","level":"info","event":"📋 2025-06-06 15:15:18,238 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.242120Z","level":"info","event":"📋 [2025-06-06 15:15:18] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.242790Z","level":"info","event":"📋 2025-06-06 15:15:18,238 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.242887Z","level":"info","event":"📋 [2025-06-06 15:15:18] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.242949Z","level":"info","event":"📋 2025-06-06 15:15:18,240 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.243007Z","level":"info","event":"📋 [2025-06-06 15:15:18] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.243063Z","level":"info","event":"📋 2025-06-06 15:15:18,240 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.243118Z","level":"info","event":"📋 [2025-06-06 15:15:18] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.243173Z","level":"info","event":"📋 2025-06-06 15:15:18,240 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.243227Z","level":"info","event":"📋 [2025-06-06 15:15:18] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.243283Z","level":"info","event":"📋 2025-06-06 15:15:18,241 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.243348Z","level":"info","event":"📋 [2025-06-06 15:15:18] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.243436Z","level":"info","event":"📋 2025-06-06 15:15:18,241 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.243492Z","level":"info","event":"📋 [2025-06-06 15:15:18] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.243547Z","level":"info","event":"📋 2025-06-06 15:15:18,241 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.243909Z","level":"info","event":"📋 [2025-06-06 15:15:18] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.244001Z","level":"info","event":"📋 2025-06-06 15:15:18,241 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.244334Z","level":"info","event":"📋 [2025-06-06 15:15:18] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.244455Z","level":"info","event":"📋 2025-06-06 15:15:18,243 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.244552Z","level":"info","event":"📋 [2025-06-06 15:15:18] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.244905Z","level":"info","event":"📋 2025-06-06 15:15:18,243 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.247884Z","level":"info","event":"📋 [2025-06-06 15:15:18] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.247975Z","level":"info","event":"📋 2025-06-06 15:15:18,244 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.250850Z","level":"info","event":"📋 [2025-06-06 15:15:18] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.250946Z","level":"info","event":"📋 2025-06-06 15:15:18,250 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.251036Z","level":"info","event":"📋 [2025-06-06 15:15:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.251118Z","level":"info","event":"📋 2025-06-06 15:15:18,250 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.251235Z","level":"info","event":"📋 [2025-06-06 15:15:18] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.251309Z","level":"info","event":"📋 2025-06-06 15:15:18,251 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.251430Z","level":"info","event":"📋 [2025-06-06 15:15:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.251494Z","level":"info","event":"📋 2025-06-06 15:15:18,251 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.251604Z","level":"info","event":"📋 [2025-06-06 15:15:18]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.251665Z","level":"info","event":"📋 2025-06-06 15:15:18,251 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.251814Z","level":"info","event":"📋 [2025-06-06 15:15:18]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.251947Z","level":"info","event":"📋 2025-06-06 15:15:18,251 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.252012Z","level":"info","event":"📋 [2025-06-06 15:15:18]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.252124Z","level":"info","event":"📋 2025-06-06 15:15:18,251 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.252185Z","level":"info","event":"📋 [2025-06-06 15:15:18]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.252288Z","level":"info","event":"📋 2025-06-06 15:15:18,252 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.252349Z","level":"info","event":"📋 [2025-06-06 15:15:18]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.252506Z","level":"info","event":"📋 2025-06-06 15:15:18,252 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.252617Z","level":"info","event":"📋 [2025-06-06 15:15:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.252768Z","level":"info","event":"📋 2025-06-06 15:15:18,252 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.258038Z","level":"info","event":"📋 [2025-06-06 15:15:18] ✅ Ficheiro CSV válido com 14 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.258728Z","level":"info","event":"📋 2025-06-06 15:15:18,257 - INFO - ✅ Ficheiro CSV válido com 14 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.258936Z","level":"info","event":"📋 [2025-06-06 15:15:18] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.259879Z","level":"info","event":"📋 2025-06-06 15:15:18,258 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.259962Z","level":"info","event":"📋 [2025-06-06 15:15:18] 📅 Filtrado para artigos dos últimos 1 dias: 14 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.260025Z","level":"info","event":"📋 2025-06-06 15:15:18,258 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 14 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.260086Z","level":"info","event":"📋 [2025-06-06 15:15:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.260142Z","level":"info","event":"📋 2025-06-06 15:15:18,258 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.260201Z","level":"info","event":"📋 [2025-06-06 15:15:18] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.260256Z","level":"info","event":"📋 2025-06-06 15:15:18,258 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.260321Z","level":"info","event":"📋 [2025-06-06 15:15:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.260388Z","level":"info","event":"📋 2025-06-06 15:15:18,258 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.260472Z","level":"info","event":"📋 [2025-06-06 15:15:18]   Total de Artigos para Processar: 14","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.260538Z","level":"info","event":"📋 2025-06-06 15:15:18,258 - INFO -   Total de Artigos para Processar: 14","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.260626Z","level":"info","event":"📋 [2025-06-06 15:15:18]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.260757Z","level":"info","event":"📋 2025-06-06 15:15:18,258 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.260842Z","level":"info","event":"📋 [2025-06-06 15:15:18]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.260904Z","level":"info","event":"📋 2025-06-06 15:15:18,258 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.260966Z","level":"info","event":"📋 [2025-06-06 15:15:18]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.261056Z","level":"info","event":"📋 2025-06-06 15:15:18,258 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.261114Z","level":"info","event":"📋 [2025-06-06 15:15:18]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.261180Z","level":"info","event":"📋 2025-06-06 15:15:18,258 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.261249Z","level":"info","event":"📋 [2025-06-06 15:15:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.261352Z","level":"info","event":"📋 2025-06-06 15:15:18,258 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.261436Z","level":"info","event":"📋 [2025-06-06 15:15:18] ⚠️ Último ID não encontrado em relevantes. A começar do início.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.261495Z","level":"info","event":"📋 2025-06-06 15:15:18,260 - WARNING - ⚠️ Último ID não encontrado em relevantes. A começar do início.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.262617Z","level":"info","event":"📋 [2025-06-06 15:15:18] 📦 A processar lote 1/1 (14 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:18.266485Z","level":"info","event":"📋 2025-06-06 15:15:18,262 - INFO - 📦 A processar lote 1/1 (14 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:23.696787Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:23.756199Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:23.780567Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:23.852907Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:23.921591Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:24.000882Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:25.016270Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:25.034364Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:35.169240Z","level":"info","event":"📋 [2025-06-06 15:15:35] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Educação à Escuta - Ep. 08 Rosa Madeira - terranova.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:35.190997Z","level":"info","event":"📋 2025-06-06 15:15:35,162 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Educação à Escuta - Ep. 08 Rosa Madeira - terranova.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:35.624305Z","level":"info","event":"📋 [2025-06-06 15:15:35] 🔄 Processado: Educação à Escuta - Ep. 08 Rosa Madeira - terranov...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:35.624743Z","level":"info","event":"📋 2025-06-06 15:15:35,301 - INFO - 🔄 Processado: Educação à Escuta - Ep. 08 Rosa Madeira - terranov...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:37.371162Z","level":"info","event":"📋 [2025-06-06 15:15:37] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Crato (CE) terá dia ensolarado hoje (06); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:37.372142Z","level":"info","event":"📋 2025-06-06 15:15:37,370 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Crato (CE) terá dia ensolarado hoje (06); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:37.374192Z","level":"info","event":"📋 [2025-06-06 15:15:37] 🔄 Processado: Crato (CE) terá dia ensolarado hoje (06); veja pre...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:37.374459Z","level":"info","event":"📋 2025-06-06 15:15:37,373 - INFO - 🔄 Processado: Crato (CE) terá dia ensolarado hoje (06); veja pre...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:37.822462Z","level":"info","event":"📋 [2025-06-06 15:15:37] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Luís Portugal - Estarrejazz 2020 - terranova.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:37.826464Z","level":"info","event":"📋 2025-06-06 15:15:37,809 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Luís Portugal - Estarrejazz 2020 - terranova.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:37.827679Z","level":"info","event":"📋 [2025-06-06 15:15:37] 🔄 Processado: Luís Portugal - Estarrejazz 2020 - terranova.pt...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:37.834590Z","level":"info","event":"📋 2025-06-06 15:15:37,815 - INFO - 🔄 Processado: Luís Portugal - Estarrejazz 2020 - terranova.pt...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:39.457940Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:39.931429Z","level":"info","event":"📋 [2025-06-06 15:15:39] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: 23Milhas - Voucher de Natal - terranova.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:39.940042Z","level":"info","event":"📋 2025-06-06 15:15:39,929 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: 23Milhas - Voucher de Natal - terranova.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:39.970171Z","level":"info","event":"📋 [2025-06-06 15:15:39] 🔄 Processado: 23Milhas - Voucher de Natal - terranova.pt...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:39.991386Z","level":"info","event":"📋 2025-06-06 15:15:39,959 - INFO - 🔄 Processado: 23Milhas - Voucher de Natal - terranova.pt...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:41.235432Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:44.069381Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:44.070771Z","level":"info","event":"📋 [2025-06-06 15:15:42] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:44.071681Z","level":"info","event":"📋 2025-06-06 15:15:42,722 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:44.072145Z","level":"info","event":"📋 [2025-06-06 15:15:42] 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:44.075704Z","level":"info","event":"📋 2025-06-06 15:15:42,725 - INFO - 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:44.875698Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:47.182105Z","level":"info","event":"📋 [2025-06-06 15:15:47] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Passo Fundo (RS) terá dia de chuva hoje (05); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:47.592868Z","level":"info","event":"📋 2025-06-06 15:15:47,181 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Passo Fundo (RS) terá dia de chuva hoje (05); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:47.605650Z","level":"info","event":"📋 [2025-06-06 15:15:47] 🔄 Processado: Passo Fundo (RS) terá dia de chuva hoje (05); veja...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:47.608983Z","level":"info","event":"📋 2025-06-06 15:15:47,221 - INFO - 🔄 Processado: Passo Fundo (RS) terá dia de chuva hoje (05); veja...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:48.017803Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:52.611153Z","level":"info","event":"📋 [2025-06-06 15:15:52] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Passo Fundo (RS) terá dia nublado hoje (06); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:52.655825Z","level":"info","event":"📋 2025-06-06 15:15:52,573 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Passo Fundo (RS) terá dia nublado hoje (06); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:53.699738Z","level":"info","event":"📋 [2025-06-06 15:15:52] 🔄 Processado: Passo Fundo (RS) terá dia nublado hoje (06); veja ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:53.708810Z","level":"info","event":"📋 2025-06-06 15:15:52,613 - INFO - 🔄 Processado: Passo Fundo (RS) terá dia nublado hoje (06); veja ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:54.479341Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:54.557320Z","level":"info","event":"⚠️ ⚠️ Error fetching URL https://tasabendo.com.br/emprego/confira-as-vagas-de-emprego-da-agencia-do-trabalhador-para-esta-sexta-feira05-06-2025/: 403 Client Error: Forbidden for url: https://tasabendo.com.br/emprego/confira-as-vagas-de-emprego-da-agencia-do-trabalhador-para-esta-sexta-feira05-06-2025/","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:54.561706Z","level":"info","event":"📋 [2025-06-06 15:15:54] ⚠️ Artigo ignorado após extração: Confira as vagas de emprego da Agência do Trabalhador para esta sexta-feira - Tásabendo","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:54.573057Z","level":"info","event":"📋 2025-06-06 15:15:54,553 - WARNING - ⚠️ Artigo ignorado após extração: Confira as vagas de emprego da Agência do Trabalhador para esta sexta-feira - Tásabendo","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:59.188120Z","level":"info","event":"📋 [2025-06-06 15:15:59] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia chuvoso hoje (06) para Resende (RJ) - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:59.198365Z","level":"info","event":"📋 2025-06-06 15:15:59,172 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia chuvoso hoje (06) para Resende (RJ) - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:59.379106Z","level":"info","event":"📋 [2025-06-06 15:15:59] 🔄 Processado: Previsão do tempo aponta dia chuvoso hoje (06) par...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:59.380298Z","level":"info","event":"📋 2025-06-06 15:15:59,203 - INFO - 🔄 Processado: Previsão do tempo aponta dia chuvoso hoje (06) par...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:59.586207Z","level":"info","event":"📋 [2025-06-06 15:15:59] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Governo Ronaldo confirma financiamento para obras que visam eliminar alagamentos em Feira de Santana - Jornal Grande Bahia","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:59.586919Z","level":"info","event":"📋 2025-06-06 15:15:59,585 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Governo Ronaldo confirma financiamento para obras que visam eliminar alagamentos em Feira de Santana - Jornal Grande Bahia","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:59.588358Z","level":"info","event":"📋 [2025-06-06 15:15:59] 🔄 Processado: Governo Ronaldo confirma financiamento para obras ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:59.589803Z","level":"info","event":"📋 2025-06-06 15:15:59,588 - INFO - 🔄 Processado: Governo Ronaldo confirma financiamento para obras ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:59.903730Z","level":"info","event":"📋 [2025-06-06 15:15:59] ⚠️ Artigo ignorado após extração: VÍDEOS: as notícias que foram ao ar na TV Rio Sul | Sul do Rio e Costa Verde - G1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:15:59.905828Z","level":"info","event":"📋 2025-06-06 15:15:59,902 - WARNING - ⚠️ Artigo ignorado após extração: VÍDEOS: as notícias que foram ao ar na TV Rio Sul | Sul do Rio e Costa Verde - G1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:00.897629Z","level":"info","event":"📋 [2025-06-06 15:16:00] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (05) para Resende (RJ) - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:00.897933Z","level":"info","event":"📋 2025-06-06 15:16:00,897 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (05) para Resende (RJ) - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:00.898984Z","level":"info","event":"📋 [2025-06-06 15:16:00] 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (05) ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:00.899152Z","level":"info","event":"📋 2025-06-06 15:16:00,898 - INFO - 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (05) ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:00.947836Z","level":"info","event":"📋 [2025-06-06 15:16:00] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Sertãozinho (SP) terá dia ensolarado hoje (05); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:00.948057Z","level":"info","event":"📋 2025-06-06 15:16:00,947 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Sertãozinho (SP) terá dia ensolarado hoje (05); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:00.948571Z","level":"info","event":"📋 [2025-06-06 15:16:00] 🔄 Processado: Sertãozinho (SP) terá dia ensolarado hoje (05); ve...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:00.948728Z","level":"info","event":"📋 2025-06-06 15:16:00,948 - INFO - 🔄 Processado: Sertãozinho (SP) terá dia ensolarado hoje (05); ve...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.301198Z","level":"info","event":"📋 [2025-06-06 15:16:01] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.301395Z","level":"info","event":"📋 2025-06-06 15:16:01,301 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.301834Z","level":"info","event":"📋 [2025-06-06 15:16:01] 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.301964Z","level":"info","event":"📋 2025-06-06 15:16:01,301 - INFO - 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.303269Z","level":"info","event":"📋 📥 Novos artigos recebidos: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.304710Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.305440Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.305827Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.306309Z","level":"info","event":"📋 💾 Guardados 8 artigos no arquivo /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.306651Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.306781Z","level":"info","event":"📋 📥 Novos artigos recebidos: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.307091Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.307717Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.307958Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.308333Z","level":"info","event":"📋 💾 Guardados 8 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.308700Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.309371Z","level":"info","event":"📋 [2025-06-06 15:16:01] ✅ Relevant articles saved: 8 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.309494Z","level":"info","event":"📋 2025-06-06 15:16:01,308 - INFO - ✅ Relevant articles saved: 8 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.310051Z","level":"info","event":"📋 [2025-06-06 15:16:01] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.310150Z","level":"info","event":"📋 2025-06-06 15:16:01,309 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.310264Z","level":"info","event":"📋 [2025-06-06 15:16:01] ✅ Lote 1 concluído: 8 artigos (total: 8)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:01.310325Z","level":"info","event":"📋 2025-06-06 15:16:01,309 - INFO - ✅ Lote 1 concluído: 8 artigos (total: 8)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.162264Z","level":"info","event":"📋 📥 Novos artigos recebidos: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.205609Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.206557Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 15","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.206852Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.208476Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.208637Z","level":"info","event":"📋 📥 Novos artigos recebidos: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.208743Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.208836Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 15","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.208926Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.209071Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.209170Z","level":"info","event":"📋 [2025-06-06 15:16:05] ✅ Relevant articles saved: 8 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.209265Z","level":"info","event":"📋 2025-06-06 15:16:05,181 - INFO - ✅ Relevant articles saved: 8 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.209381Z","level":"info","event":"📋 [2025-06-06 15:16:05] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.209536Z","level":"info","event":"📋 2025-06-06 15:16:05,183 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.209639Z","level":"info","event":"📋 [2025-06-06 15:16:05] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.209820Z","level":"info","event":"📋 2025-06-06 15:16:05,183 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.210297Z","level":"info","event":"📋 [2025-06-06 15:16:05] Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.210766Z","level":"info","event":"📋 2025-06-06 15:16:05,183 - INFO - Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.211260Z","level":"info","event":"📋 [2025-06-06 15:16:05] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.211568Z","level":"info","event":"📋 2025-06-06 15:16:05,183 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.213507Z","level":"info","event":"📋 [2025-06-06 15:16:05]   Total de Artigos Processados: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.213788Z","level":"info","event":"📋 2025-06-06 15:16:05,183 - INFO -   Total de Artigos Processados: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.213917Z","level":"info","event":"📋 [2025-06-06 15:16:05]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.214069Z","level":"info","event":"📋 2025-06-06 15:16:05,183 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.214188Z","level":"info","event":"📋 [2025-06-06 15:16:05]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.214296Z","level":"info","event":"📋 2025-06-06 15:16:05,183 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.214546Z","level":"info","event":"📋 [2025-06-06 15:16:05]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.214641Z","level":"info","event":"📋 2025-06-06 15:16:05,183 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.214754Z","level":"info","event":"📋 [2025-06-06 15:16:05]   Taxa de Sucesso: 57.1%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.214854Z","level":"info","event":"📋 2025-06-06 15:16:05,183 - INFO -   Taxa de Sucesso: 57.1%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.214962Z","level":"info","event":"📋 [2025-06-06 15:16:05] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.215068Z","level":"info","event":"📋 2025-06-06 15:16:05,183 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.215190Z","level":"info","event":"📋 [2025-06-06 15:16:05] ✅ Processing completed. Processed 8 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.215309Z","level":"info","event":"📋 2025-06-06 15:16:05,191 - INFO - ✅ Processing completed. Processed 8 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.539531Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.540777Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:05.541046Z","level":"info","event":"✅ relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (3808 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.104984Z","level":"info","event":"📊 Number of processed articles: 15","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.105748Z","level":"info","event":"📊 Columns: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.107550Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_irrelevantes_2025-06-06.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.107703Z","level":"info","event":"⚠️ processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_log_20250606.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.107918Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.106655","level":"info","event":"Done. Returned value was: [2025-06-06 15:15:18] Starting processar_relevantes_airflow\n2025-06-06 15:15:18,238 - INFO - Starting processar_relevantes_airflow\n[2025-06-06 15:15:18] Parameters: dias=1, date=2025-06-06\n2025-06-06 15:15:18,238 - INFO - Parameters: dias=1, date=2025-06-06\n[2025-06-06 15:15:18] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06, date_str=2025-06-06\n2025-06-06 15:15:18,238 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06, date_str=2025-06-06\n[2025-06-06 15:15:18] 🚀 A iniciar processar_relevantes_airflow\n2025-06-06 15:15:18,238 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-06 15:15:18] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06\n2025-06-06 15:15:18,238 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06\n[2025-06-06 15:15:18] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv\n2025-06-06 15:15:18,240 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv\n[2025-06-06 15:15:18] 🔧 A carregar ficheiros de configuração...\n2025-06-06 15:15:18,240 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-06 15:15:18] 🔍 Checking config path: /opt/airflow/config\n2025-06-06 15:15:18,240 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-06 15:15:18] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-06 15:15:18,241 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-06 15:15:18] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-06 15:15:18,241 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-06 15:15:18] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-06 15:15:18,241 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-06 15:15:18] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-06 15:15:18,241 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-06 15:15:18] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-06 15:15:18,243 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-06 15:15:18] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-06 15:15:18,243 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-06 15:15:18] ✅ Loaded 6 keywords\n2025-06-06 15:15:18,244 - INFO - ✅ Loaded 6 keywords\n[2025-06-06 15:15:18] ✅ Loaded 3614 DICOFREG codes\n2025-06-06 15:15:18,250 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-06 15:15:18] ==================================================\n2025-06-06 15:15:18,250 - INFO - ==================================================\n[2025-06-06 15:15:18] Configuration Loaded\n2025-06-06 15:15:18,251 - INFO - Configuration Loaded\n[2025-06-06 15:15:18] ==================================================\n2025-06-06 15:15:18,251 - INFO - ==================================================\n[2025-06-06 15:15:18]   Parishes: 306\n2025-06-06 15:15:18,251 - INFO -   Parishes: 306\n[2025-06-06 15:15:18]   Municipalities: 306\n2025-06-06 15:15:18,251 - INFO -   Municipalities: 306\n[2025-06-06 15:15:18]   Districts: 29\n2025-06-06 15:15:18,251 - INFO -   Districts: 29\n[2025-06-06 15:15:18]   Keywords: 6\n2025-06-06 15:15:18,252 - INFO -   Keywords: 6\n[2025-06-06 15:15:18]   DICOFREG Codes: 3614\n2025-06-06 15:15:18,252 - INFO -   DICOFREG Codes: 3614\n[2025-06-06 15:15:18] ==================================================\n2025-06-06 15:15:18,252 - INFO - ==================================================\n[2025-06-06 15:15:18] ✅ Ficheiro CSV válido com 14 artigos\n2025-06-06 15:15:18,257 - INFO - ✅ Ficheiro CSV válido com 14 artigos\n[2025-06-06 15:15:18] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-06 15:15:18,258 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-06 15:15:18] 📅 Filtrado para artigos dos últimos 1 dias: 14 artigos\n2025-06-06 15:15:18,258 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 14 artigos\n[2025-06-06 15:15:18] ==================================================\n2025-06-06 15:15:18,258 - INFO - ==================================================\n[2025-06-06 15:15:18] Processamento Iniciado\n2025-06-06 15:15:18,258 - INFO - Processamento Iniciado\n[2025-06-06 15:15:18] ==================================================\n2025-06-06 15:15:18,258 - INFO - ==================================================\n[2025-06-06 15:15:18]   Total de Artigos para Processar: 14\n2025-06-06 15:15:18,258 - INFO -   Total de Artigos para Processar: 14\n[2025-06-06 15:15:18]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv\n2025-06-06 15:15:18,258 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/06/google_news_articles_20250606.csv\n[2025-06-06 15:15:18]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 15:15:18,258 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 15:15:18]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06\n2025-06-06 15:15:18,258 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06\n[2025-06-06 15:15:18]   Filtro de Dias: 1\n2025-06-06 15:15:18,258 - INFO -   Filtro de Dias: 1\n[2025-06-06 15:15:18] ==================================================\n2025-06-06 15:15:18,258 - INFO - ==================================================\n[2025-06-06 15:15:18] ⚠️ Último ID não encontrado em relevantes. A começar do início.\n2025-06-06 15:15:18,260 - WARNING - ⚠️ Último ID não encontrado em relevantes. A começar do início.\n[2025-06-06 15:15:18] 📦 A processar lote 1/1 (14 artigos)\n2025-06-06 15:15:18,262 - INFO - 📦 A processar lote 1/1 (14 artigos)\n[2025-06-06 15:15:35] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Educação à Escuta - Ep. 08 Rosa Madeira - terranova.pt\n2025-06-06 15:15:35,162 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Educação à Escuta - Ep. 08 Rosa Madeira - terranova.pt\n[2025-06-06 15:15:35] 🔄 Processado: Educação à Escuta - Ep. 08 Rosa Madeira - terranov...\n2025-06-06 15:15:35,301 - INFO - 🔄 Processado: Educação à Escuta - Ep. 08 Rosa Madeira - terranov...\n[2025-06-06 15:15:37] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Crato (CE) terá dia ensolarado hoje (06); veja previsão do tempo - UOL Notícias\n2025-06-06 15:15:37,370 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Crato (CE) terá dia ensolarado hoje (06); veja previsão do tempo - UOL Notícias\n[2025-06-06 15:15:37] 🔄 Processado: Crato (CE) terá dia ensolarado hoje (06); veja pre...\n2025-06-06 15:15:37,373 - INFO - 🔄 Processado: Crato (CE) terá dia ensolarado hoje (06); veja pre...\n[2025-06-06 15:15:37] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Luís Portugal - Estarrejazz 2020 - terranova.pt\n2025-06-06 15:15:37,809 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Luís Portugal - Estarrejazz 2020 - terranova.pt\n[2025-06-06 15:15:37] 🔄 Processado: Luís Portugal - Estarrejazz 2020 - terranova.pt...\n2025-06-06 15:15:37,815 - INFO - 🔄 Processado: Luís Portugal - Estarrejazz 2020 - terranova.pt...\n[2025-06-06 15:15:39] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: 23Milhas - Voucher de Natal - terranova.pt\n2025-06-06 15:15:39,929 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: 23Milhas - Voucher de Natal - terranova.pt\n[2025-06-06 15:15:39] 🔄 Processado: 23Milhas - Voucher de Natal - terranova.pt...\n2025-06-06 15:15:39,959 - INFO - 🔄 Processado: 23Milhas - Voucher de Natal - terranova.pt...\n[2025-06-06 15:15:42] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro\n2025-06-06 15:15:42,722 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro\n[2025-06-06 15:15:42] 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...\n2025-06-06 15:15:42,725 - INFO - 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...\n[2025-06-06 15:15:47] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Passo Fundo (RS) terá dia de chuva hoje (05); veja previsão do tempo - UOL Notícias\n2025-06-06 15:15:47,181 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Passo Fundo (RS) terá dia de chuva hoje (05); veja previsão do tempo - UOL Notícias\n[2025-06-06 15:15:47] 🔄 Processado: Passo Fundo (RS) terá dia de chuva hoje (05); veja...\n2025-06-06 15:15:47,221 - INFO - 🔄 Processado: Passo Fundo (RS) terá dia de chuva hoje (05); veja...\n[2025-06-06 15:15:52] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Passo Fundo (RS) terá dia nublado hoje (06); veja previsão do tempo - UOL Notícias\n2025-06-06 15:15:52,573 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Passo Fundo (RS) terá dia nublado hoje (06); veja previsão do tempo - UOL Notícias\n[2025-06-06 15:15:52] 🔄 Processado: Passo Fundo (RS) terá dia nublado hoje (06); veja ...\n2025-06-06 15:15:52,613 - INFO - 🔄 Processado: Passo Fundo (RS) terá dia nublado hoje (06); veja ...\n[2025-06-06 15:15:54] ⚠️ Artigo ignorado após extração: Confira as vagas de emprego da Agência do Trabalhador para esta sexta-feira - Tásabendo\n2025-06-06 15:15:54,553 - WARNING - ⚠️ Artigo ignorado após extração: Confira as vagas de emprego da Agência do Trabalhador para esta sexta-feira - Tásabendo\n[2025-06-06 15:15:59] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia chuvoso hoje (06) para Resende (RJ) - UOL Notícias\n2025-06-06 15:15:59,172 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia chuvoso hoje (06) para Resende (RJ) - UOL Notícias\n[2025-06-06 15:15:59] 🔄 Processado: Previsão do tempo aponta dia chuvoso hoje (06) par...\n2025-06-06 15:15:59,203 - INFO - 🔄 Processado: Previsão do tempo aponta dia chuvoso hoje (06) par...\n[2025-06-06 15:15:59] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Governo Ronaldo confirma financiamento para obras que visam eliminar alagamentos em Feira de Santana - Jornal Grande Bahia\n2025-06-06 15:15:59,585 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Governo Ronaldo confirma financiamento para obras que visam eliminar alagamentos em Feira de Santana - Jornal Grande Bahia\n[2025-06-06 15:15:59] 🔄 Processado: Governo Ronaldo confirma financiamento para obras ...\n2025-06-06 15:15:59,588 - INFO - 🔄 Processado: Governo Ronaldo confirma financiamento para obras ...\n[2025-06-06 15:15:59] ⚠️ Artigo ignorado após extração: VÍDEOS: as notícias que foram ao ar na TV Rio Sul | Sul do Rio e Costa Verde - G1\n2025-06-06 15:15:59,902 - WARNING - ⚠️ Artigo ignorado após extração: VÍDEOS: as notícias que foram ao ar na TV Rio Sul | Sul do Rio e Costa Verde - G1\n[2025-06-06 15:16:00] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (05) para Resende (RJ) - UOL Notícias\n2025-06-06 15:16:00,897 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (05) para Resende (RJ) - UOL Notícias\n[2025-06-06 15:16:00] 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (05) ...\n2025-06-06 15:16:00,898 - INFO - 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (05) ...\n[2025-06-06 15:16:00] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Sertãozinho (SP) terá dia ensolarado hoje (05); veja previsão do tempo - UOL Notícias\n2025-06-06 15:16:00,947 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Sertãozinho (SP) terá dia ensolarado hoje (05); veja previsão do tempo - UOL Notícias\n[2025-06-06 15:16:00] 🔄 Processado: Sertãozinho (SP) terá dia ensolarado hoje (05); ve...\n2025-06-06 15:16:00,948 - INFO - 🔄 Processado: Sertãozinho (SP) terá dia ensolarado hoje (05); ve...\n[2025-06-06 15:16:01] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro\n2025-06-06 15:16:01,301 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Temperaturas voltam a subir em Viseu, mas há previsão de chuva no Dia de Portugal - Jornal do Centro\n[2025-06-06 15:16:01] 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...\n2025-06-06 15:16:01,301 - INFO - 🔄 Processado: Temperaturas voltam a subir em Viseu, mas há previ...\n📥 Novos artigos recebidos: 8\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📂 IDs existentes no arquivo: 7\n🆕 Artigos únicos para salvar: 8\n💾 Guardados 8 artigos no arquivo /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📥 Novos artigos recebidos: 8\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📂 IDs existentes no arquivo: 7\n🆕 Artigos únicos para salvar: 8\n💾 Guardados 8 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 15:16:01] ✅ Relevant articles saved: 8 articles\n2025-06-06 15:16:01,308 - INFO - ✅ Relevant articles saved: 8 articles\n[2025-06-06 15:16:01] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n2025-06-06 15:16:01,309 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n[2025-06-06 15:16:01] ✅ Lote 1 concluído: 8 artigos (total: 8)\n2025-06-06 15:16:01,309 - INFO - ✅ Lote 1 concluído: 8 artigos (total: 8)\n📥 Novos artigos recebidos: 8\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📂 IDs existentes no arquivo: 15\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 8\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n📂 IDs existentes no arquivo: 15\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-06 15:16:05] ✅ Relevant articles saved: 8 articles\n2025-06-06 15:16:05,181 - INFO - ✅ Relevant articles saved: 8 articles\n[2025-06-06 15:16:05] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n2025-06-06 15:16:05,183 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n[2025-06-06 15:16:05] ==================================================\n2025-06-06 15:16:05,183 - INFO - ==================================================\n[2025-06-06 15:16:05] Processamento Concluído com Sucesso\n2025-06-06 15:16:05,183 - INFO - Processamento Concluído com Sucesso\n[2025-06-06 15:16:05] ==================================================\n2025-06-06 15:16:05,183 - INFO - ==================================================\n[2025-06-06 15:16:05]   Total de Artigos Processados: 8\n2025-06-06 15:16:05,183 - INFO -   Total de Artigos Processados: 8\n[2025-06-06 15:16:05]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 15:16:05,183 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 15:16:05]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 15:16:05,183 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 15:16:05]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n2025-06-06 15:16:05,183 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json\n[2025-06-06 15:16:05]   Taxa de Sucesso: 57.1%\n2025-06-06 15:16:05,183 - INFO -   Taxa de Sucesso: 57.1%\n[2025-06-06 15:16:05] ==================================================\n2025-06-06 15:16:05,183 - INFO - ==================================================\n[2025-06-06 15:16:05] ✅ Processing completed. Processed 8 articles\n2025-06-06 15:16:05,191 - INFO - ✅ Processing completed. Processed 8 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
