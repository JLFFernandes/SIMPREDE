{"timestamp":"2025-06-06T14:24:22.384269","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-06T14:24:22.387400","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-06T14:24:22.483322Z","level":"info","event":"🔄 Starting export_to_gcs task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:22.484192Z","level":"info","event":"📁 Using paths from export_supabase task: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:22.488929Z","level":"info","event":"📅 Using provided execution date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:22.491398Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/06', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/06', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/06']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:22.491602Z","level":"info","event":"📅 GCS Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:22.492296Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:22.492527Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:22.492760Z","level":"info","event":"  - Target date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:22.492863Z","level":"info","event":"  - Base data directory: /opt/airflow/scripts/google_scraper/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:22.492942Z","level":"info","event":"  - GCS Project ID: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:22.493015Z","level":"info","event":"  - GCS Bucket: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:22.493118Z","level":"info","event":"🔄 Running GCS export command: python /opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py --date 2025-06-06 --base_data_dir /opt/airflow/scripts/google_scraper/data --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:22.493232Z","level":"info","event":"⏰ Waiting for GCS export completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:23.771868Z","level":"info","event":"📋 2025-06-06 15:24:23,771 - INFO - 2025-06-06 15:24:23 - Starting export_to_gcs_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:23.772540Z","level":"info","event":"📋 2025-06-06 15:24:23,771 - INFO - 2025-06-06 15:24:23 - Parameters: date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:23.772741Z","level":"info","event":"📋 2025-06-06 15:24:23,771 - INFO - 2025-06-06 15:24:23 - Paths: base_data_dir=/opt/airflow/scripts/google_scraper/data, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:23.772912Z","level":"info","event":"📋 2025-06-06 15:24:23,771 - INFO - 2025-06-06 15:24:23 - GCS: project_id=None, bucket=None","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:23.773307Z","level":"info","event":"📋 2025-06-06 15:24:23,771 - INFO - 2025-06-06 15:24:23 - Airflow logs: include=True, dir=/opt/airflow/logs","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:23.774104Z","level":"info","event":"📋 2025-06-06 15:24:23,771 - INFO - 2025-06-06 15:24:23 - 🚀 Starting GCS export for date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:23.777064Z","level":"info","event":"📋 2025-06-06 15:24:23,771 - INFO - 2025-06-06 15:24:23 - 📁 Base data directory: /opt/airflow/scripts/google_scraper/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:23.777238Z","level":"info","event":"📋 2025-06-06 15:24:23,771 - INFO - 2025-06-06 15:24:23 - 📋 Include Airflow logs: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:23.777307Z","level":"info","event":"📋 2025-06-06 15:24:23,772 - INFO - 2025-06-06 15:24:23 - 🔧 GCS Configuration:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:23.777364Z","level":"info","event":"📋 2025-06-06 15:24:23,772 - INFO - 2025-06-06 15:24:23 -   - Project ID: simprede-461309","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:23.777422Z","level":"info","event":"📋 2025-06-06 15:24:23,772 - INFO - 2025-06-06 15:24:23 -   - Bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:23.777483Z","level":"info","event":"📋 2025-06-06 15:24:23,772 - INFO - 2025-06-06 15:24:23 -   - Credentials: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:23.833230Z","level":"info","event":"📋 2025-06-06 15:24:23,833 - INFO - 2025-06-06 15:24:23 - ✅ Initialized GCS client with service account: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:24.883166Z","level":"info","event":"📋 2025-06-06 15:24:24,882 - ERROR - 2025-06-06 15:24:24 - ❌ Failed to create bucket 'simprede-data-pipeline': 403 POST https://storage.googleapis.com/storage/v1/b?project=simprede-461309&prettyPrint=false: bucket@simprede-461309.iam.gserviceaccount.com does not have storage.buckets.create access to the Google Cloud project. Permission 'storage.buckets.create' denied on resource (or it may not exist).","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:24.884309Z","level":"info","event":"📋 2025-06-06 15:24:24,882 - ERROR - 2025-06-06 15:24:24 - ❌ Failed to create or access bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:24.884840Z","level":"info","event":"📋 2025-06-06 15:24:24,882 - ERROR - 2025-06-06 15:24:24 - ❌ GCS export failed: Cannot access GCS bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:24.886752Z","level":"info","event":"📋 2025-06-06 15:24:24,886 - ERROR - 2025-06-06 15:24:24 - ❌ Full traceback: Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:24.889207Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 620, in main","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:24.891255Z","level":"info","event":"📋     result = export_to_gcs(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:24.893107Z","level":"info","event":"📋              ^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:24.893375Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 480, in export_to_gcs","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:24.893521Z","level":"info","event":"📋     raise Exception(f\"Cannot access GCS bucket: {gcs_config['bucket_name']}\")","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:24.893642Z","level":"info","event":"📋 Exception: Cannot access GCS bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:24.893744Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:24.973216Z","level":"info","event":"❌ GCS export failed with return code 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:24.973628Z","level":"info","event":"❌ Unexpected error in GCS export task: GCS export failed with return code 1:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:24:24.973731","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"Exception","exc_value":"GCS export failed with return code 1: ","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":838,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1130,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":212,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":235,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/google_scraper_dag.py","lineno":1091,"name":"export_to_gcs_task"}]}]}
