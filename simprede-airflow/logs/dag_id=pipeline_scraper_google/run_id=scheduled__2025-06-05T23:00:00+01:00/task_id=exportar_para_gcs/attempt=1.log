{"timestamp":"2025-06-06T11:04:04.311799","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-06T11:04:04.312375","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-06T11:04:04.341721Z","level":"info","event":"🔄 Starting export_to_gcs task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:04.343223Z","level":"info","event":"📁 Using paths from export_supabase task: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:04.345992Z","level":"info","event":"📅 Using provided execution date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:04.348069Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/06', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/06', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/06']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:04.348555Z","level":"info","event":"📅 GCS Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:04.348661Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:04.348800Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:04.348892Z","level":"info","event":"  - Target date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:04.349083Z","level":"info","event":"  - Base data directory: /opt/airflow/scripts/google_scraper/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:04.349333Z","level":"info","event":"  - GCS Project ID: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:04.350724Z","level":"info","event":"  - GCS Bucket: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:04.351690Z","level":"info","event":"🔄 Running GCS export command: python /opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py --date 2025-06-06 --base_data_dir /opt/airflow/scripts/google_scraper/data --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:04.352317Z","level":"info","event":"⏰ Waiting for GCS export completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.050143Z","level":"info","event":"📋 2025-06-06 12:04:05,050 - INFO - 2025-06-06 12:04:05 - Starting export_to_gcs_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.050367Z","level":"info","event":"📋 2025-06-06 12:04:05,050 - INFO - 2025-06-06 12:04:05 - Parameters: date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.050443Z","level":"info","event":"📋 2025-06-06 12:04:05,050 - INFO - 2025-06-06 12:04:05 - Paths: base_data_dir=/opt/airflow/scripts/google_scraper/data, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.050518Z","level":"info","event":"📋 2025-06-06 12:04:05,050 - INFO - 2025-06-06 12:04:05 - GCS: project_id=None, bucket=None","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.051178Z","level":"info","event":"📋 2025-06-06 12:04:05,050 - INFO - 2025-06-06 12:04:05 - 🚀 Starting GCS export for date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.051295Z","level":"info","event":"📋 2025-06-06 12:04:05,050 - INFO - 2025-06-06 12:04:05 - 📁 Base data directory: /opt/airflow/scripts/google_scraper/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.051403Z","level":"info","event":"📋 2025-06-06 12:04:05,050 - INFO - 2025-06-06 12:04:05 - 🔧 GCS Configuration:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.053010Z","level":"info","event":"📋 2025-06-06 12:04:05,050 - INFO - 2025-06-06 12:04:05 -   - Project ID: simprede-461309","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.055013Z","level":"info","event":"📋 2025-06-06 12:04:05,050 - INFO - 2025-06-06 12:04:05 -   - Bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.058991Z","level":"info","event":"📋 2025-06-06 12:04:05,050 - INFO - 2025-06-06 12:04:05 -   - Credentials: Default credentials","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059091Z","level":"info","event":"📋 2025-06-06 12:04:05,050 - WARNING - 2025-06-06 12:04:05 - ⚠️ Application default credentials failed: File  was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059136Z","level":"info","event":"📋 2025-06-06 12:04:05,050 - ERROR - 2025-06-06 12:04:05 - ❌ All authentication methods failed:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059174Z","level":"info","event":"📋 2025-06-06 12:04:05,050 - ERROR - 2025-06-06 12:04:05 -    - Service account: Not provided","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059211Z","level":"info","event":"📋 2025-06-06 12:04:05,050 - ERROR - 2025-06-06 12:04:05 -    - Default credentials: File  was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059250Z","level":"info","event":"📋 2025-06-06 12:04:05,050 - ERROR - 2025-06-06 12:04:05 -    - Auto-detection: File  was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059288Z","level":"info","event":"📋 2025-06-06 12:04:05,050 - ERROR - 2025-06-06 12:04:05 - ❌ Failed to initialize GCS client: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059325Z","level":"info","event":"📋 2025-06-06 12:04:05,051 - ERROR - 2025-06-06 12:04:05 - ❌ Failed to initialize GCS exporter: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059359Z","level":"info","event":"📋 2025-06-06 12:04:05,051 - ERROR - 2025-06-06 12:04:05 - ❌ GCS export failed: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059439Z","level":"info","event":"📋 2025-06-06 12:04:05,052 - ERROR - 2025-06-06 12:04:05 - ❌ Full traceback: Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059487Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 83, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059523Z","level":"info","event":"📋     self.client = storage.Client(project=project_id)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059560Z","level":"info","event":"📋                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059595Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/storage/client.py\", line 228, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059631Z","level":"info","event":"📋     super(Client, self).__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059665Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 339, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059700Z","level":"info","event":"📋     Client.__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059734Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 196, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059769Z","level":"info","event":"📋     credentials, _ = google.auth.default(scopes=scopes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059843Z","level":"info","event":"📋                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059879Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 651, in default","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059916Z","level":"info","event":"📋     credentials, project_id = checker()","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059948Z","level":"info","event":"📋                               ^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.059990Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 644, in <lambda>","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060026Z","level":"info","event":"📋     lambda: _get_explicit_environ_credentials(quota_project_id=quota_project_id),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060060Z","level":"info","event":"📋             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060092Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 293, in _get_explicit_environ_credentials","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060127Z","level":"info","event":"📋     credentials, project_id = load_credentials_from_file(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060159Z","level":"info","event":"📋                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060202Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 125, in load_credentials_from_file","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060234Z","level":"info","event":"📋     raise exceptions.DefaultCredentialsError(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060268Z","level":"info","event":"📋 google.auth.exceptions.DefaultCredentialsError: File  was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060301Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060334Z","level":"info","event":"📋 During handling of the above exception, another exception occurred:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060367Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060398Z","level":"info","event":"📋 Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060432Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 90, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060465Z","level":"info","event":"📋     self.client = storage.Client()","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060496Z","level":"info","event":"📋                   ^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060527Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/storage/client.py\", line 228, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060561Z","level":"info","event":"📋     super(Client, self).__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060592Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 339, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060626Z","level":"info","event":"📋     Client.__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060690Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 196, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060726Z","level":"info","event":"📋     credentials, _ = google.auth.default(scopes=scopes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060757Z","level":"info","event":"📋                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060792Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 651, in default","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060823Z","level":"info","event":"📋     credentials, project_id = checker()","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060854Z","level":"info","event":"📋                               ^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060885Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 644, in <lambda>","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060919Z","level":"info","event":"📋     lambda: _get_explicit_environ_credentials(quota_project_id=quota_project_id),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060961Z","level":"info","event":"📋             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.060994Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 293, in _get_explicit_environ_credentials","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061029Z","level":"info","event":"📋     credentials, project_id = load_credentials_from_file(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061061Z","level":"info","event":"📋                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061096Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 125, in load_credentials_from_file","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061127Z","level":"info","event":"📋     raise exceptions.DefaultCredentialsError(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061158Z","level":"info","event":"📋 google.auth.exceptions.DefaultCredentialsError: File  was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061190Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061221Z","level":"info","event":"📋 During handling of the above exception, another exception occurred:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061254Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061286Z","level":"info","event":"📋 Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061317Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 464, in main","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061348Z","level":"info","event":"📋     result = export_to_gcs(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061379Z","level":"info","event":"📋              ^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061425Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 339, in export_to_gcs","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061493Z","level":"info","event":"📋     exporter = GCSExporter(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061525Z","level":"info","event":"📋                ^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061556Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 98, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061590Z","level":"info","event":"📋     raise Exception(\"No valid GCP authentication method found\")","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061623Z","level":"info","event":"📋 Exception: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.061655Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.086484Z","level":"info","event":"❌ GCS export failed with return code 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.086636Z","level":"info","event":"❌ Unexpected error in GCS export task: GCS export failed with return code 1:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:05.086557","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"Exception","exc_value":"GCS export failed with return code 1: ","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":838,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1130,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":212,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":235,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/google_scraper_dag.py","lineno":1091,"name":"export_to_gcs_task"}]}]}
{"timestamp":"2025-06-06T13:59:39.515149","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-06T13:59:39.515909","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-06T13:59:39.572294Z","level":"info","event":"🔄 Starting export_to_gcs task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:39.572542Z","level":"info","event":"📁 Using paths from export_supabase task: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:39.577238Z","level":"info","event":"📅 Using provided execution date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:39.578341Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/06', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/06', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/06']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:39.578514Z","level":"info","event":"📅 GCS Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:39.578825Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:39.578999Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:39.579163Z","level":"info","event":"  - Target date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:39.579346Z","level":"info","event":"  - Base data directory: /opt/airflow/scripts/google_scraper/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:39.579661Z","level":"info","event":"  - GCS Project ID: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:39.579836Z","level":"info","event":"  - GCS Bucket: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:39.580006Z","level":"info","event":"🔄 Running GCS export command: python /opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py --date 2025-06-06 --base_data_dir /opt/airflow/scripts/google_scraper/data --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:39.580207Z","level":"info","event":"⏰ Waiting for GCS export completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.856370Z","level":"info","event":"📋 2025-06-06 14:59:40,856 - INFO - 2025-06-06 14:59:40 - Starting export_to_gcs_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.856602Z","level":"info","event":"📋 2025-06-06 14:59:40,856 - INFO - 2025-06-06 14:59:40 - Parameters: date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.856755Z","level":"info","event":"📋 2025-06-06 14:59:40,856 - INFO - 2025-06-06 14:59:40 - Paths: base_data_dir=/opt/airflow/scripts/google_scraper/data, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.856930Z","level":"info","event":"📋 2025-06-06 14:59:40,856 - INFO - 2025-06-06 14:59:40 - GCS: project_id=None, bucket=None","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.857048Z","level":"info","event":"📋 2025-06-06 14:59:40,856 - INFO - 2025-06-06 14:59:40 - 🚀 Starting GCS export for date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.857186Z","level":"info","event":"📋 2025-06-06 14:59:40,856 - INFO - 2025-06-06 14:59:40 - 📁 Base data directory: /opt/airflow/scripts/google_scraper/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.857347Z","level":"info","event":"📋 2025-06-06 14:59:40,856 - INFO - 2025-06-06 14:59:40 - 🔧 GCS Configuration:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.857439Z","level":"info","event":"📋 2025-06-06 14:59:40,856 - INFO - 2025-06-06 14:59:40 -   - Project ID: simprede-461309","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.857516Z","level":"info","event":"📋 2025-06-06 14:59:40,856 - INFO - 2025-06-06 14:59:40 -   - Bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.857654Z","level":"info","event":"📋 2025-06-06 14:59:40,856 - INFO - 2025-06-06 14:59:40 -   - Credentials: /root/.config/gcloud/application_default_credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.857850Z","level":"info","event":"📋 2025-06-06 14:59:40,857 - WARNING - 2025-06-06 14:59:40 - ⚠️ Application default credentials failed: File /root/.config/gcloud/application_default_credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.858039Z","level":"info","event":"📋 2025-06-06 14:59:40,857 - ERROR - 2025-06-06 14:59:40 - ❌ All authentication methods failed:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.858172Z","level":"info","event":"📋 2025-06-06 14:59:40,857 - ERROR - 2025-06-06 14:59:40 -    - Service account: /root/.config/gcloud/application_default_credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.858320Z","level":"info","event":"📋 2025-06-06 14:59:40,857 - ERROR - 2025-06-06 14:59:40 -    - Default credentials: File /root/.config/gcloud/application_default_credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.858441Z","level":"info","event":"📋 2025-06-06 14:59:40,857 - ERROR - 2025-06-06 14:59:40 -    - Auto-detection: File /root/.config/gcloud/application_default_credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.858625Z","level":"info","event":"📋 2025-06-06 14:59:40,857 - ERROR - 2025-06-06 14:59:40 - ❌ Failed to initialize GCS client: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.858738Z","level":"info","event":"📋 2025-06-06 14:59:40,857 - ERROR - 2025-06-06 14:59:40 - ❌ Failed to initialize GCS exporter: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.858879Z","level":"info","event":"📋 2025-06-06 14:59:40,857 - ERROR - 2025-06-06 14:59:40 - ❌ GCS export failed: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.859844Z","level":"info","event":"📋 2025-06-06 14:59:40,859 - ERROR - 2025-06-06 14:59:40 - ❌ Full traceback: Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.859982Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 83, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.860066Z","level":"info","event":"📋     self.client = storage.Client(project=project_id)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.860129Z","level":"info","event":"📋                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.860189Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/storage/client.py\", line 228, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.860268Z","level":"info","event":"📋     super(Client, self).__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.860326Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 339, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.860383Z","level":"info","event":"📋     Client.__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.860439Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 196, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.860498Z","level":"info","event":"📋     credentials, _ = google.auth.default(scopes=scopes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.860602Z","level":"info","event":"📋                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.860667Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 651, in default","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.860725Z","level":"info","event":"📋     credentials, project_id = checker()","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.860781Z","level":"info","event":"📋                               ^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.860838Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 644, in <lambda>","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.860895Z","level":"info","event":"📋     lambda: _get_explicit_environ_credentials(quota_project_id=quota_project_id),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.860951Z","level":"info","event":"📋             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.861010Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 293, in _get_explicit_environ_credentials","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.861126Z","level":"info","event":"📋     credentials, project_id = load_credentials_from_file(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.861204Z","level":"info","event":"📋                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.861359Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 125, in load_credentials_from_file","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.861433Z","level":"info","event":"📋     raise exceptions.DefaultCredentialsError(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.861490Z","level":"info","event":"📋 google.auth.exceptions.DefaultCredentialsError: File /root/.config/gcloud/application_default_credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.861548Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.861605Z","level":"info","event":"📋 During handling of the above exception, another exception occurred:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.861662Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.861719Z","level":"info","event":"📋 Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.861775Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 90, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.861832Z","level":"info","event":"📋     self.client = storage.Client()","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.861887Z","level":"info","event":"📋                   ^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.861944Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/storage/client.py\", line 228, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.862002Z","level":"info","event":"📋     super(Client, self).__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.862060Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 339, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.862118Z","level":"info","event":"📋     Client.__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.862175Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 196, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.862245Z","level":"info","event":"📋     credentials, _ = google.auth.default(scopes=scopes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.862314Z","level":"info","event":"📋                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.862375Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 651, in default","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.862433Z","level":"info","event":"📋     credentials, project_id = checker()","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.862491Z","level":"info","event":"📋                               ^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.862548Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 644, in <lambda>","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.862650Z","level":"info","event":"📋     lambda: _get_explicit_environ_credentials(quota_project_id=quota_project_id),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.862719Z","level":"info","event":"📋             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.862785Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 293, in _get_explicit_environ_credentials","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.862851Z","level":"info","event":"📋     credentials, project_id = load_credentials_from_file(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.862918Z","level":"info","event":"📋                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.862974Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 125, in load_credentials_from_file","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.863030Z","level":"info","event":"📋     raise exceptions.DefaultCredentialsError(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.863086Z","level":"info","event":"📋 google.auth.exceptions.DefaultCredentialsError: File /root/.config/gcloud/application_default_credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.863159Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.863223Z","level":"info","event":"📋 During handling of the above exception, another exception occurred:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.863282Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.863340Z","level":"info","event":"📋 Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.863399Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 464, in main","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.863457Z","level":"info","event":"📋     result = export_to_gcs(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.863514Z","level":"info","event":"📋              ^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.863586Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 339, in export_to_gcs","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.863647Z","level":"info","event":"📋     exporter = GCSExporter(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.863703Z","level":"info","event":"📋                ^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.863760Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 98, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.863816Z","level":"info","event":"📋     raise Exception(\"No valid GCP authentication method found\")","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.863874Z","level":"info","event":"📋 Exception: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.863930Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.929275Z","level":"info","event":"❌ GCS export failed with return code 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.930535Z","level":"info","event":"❌ Unexpected error in GCS export task: GCS export failed with return code 1:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:40.925512","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"Exception","exc_value":"GCS export failed with return code 1: ","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":838,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1130,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":212,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":235,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/google_scraper_dag.py","lineno":1091,"name":"export_to_gcs_task"}]}]}
{"timestamp":"2025-06-06T14:16:14.761051","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-06T14:16:14.761646","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-06T14:16:16.103890Z","level":"info","event":"🔄 Starting export_to_gcs task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:16.104822Z","level":"info","event":"📁 Using paths from export_supabase task: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:16.112180Z","level":"info","event":"📅 Using provided execution date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:16.112740Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/06', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/06', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/06']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:16.112909Z","level":"info","event":"📅 GCS Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:16.113049Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:16.113165Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:16.113279Z","level":"info","event":"  - Target date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:16.113463Z","level":"info","event":"  - Base data directory: /opt/airflow/scripts/google_scraper/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:16.113572Z","level":"info","event":"  - GCS Project ID: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:16.113731Z","level":"info","event":"  - GCS Bucket: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:16.113842Z","level":"info","event":"🔄 Running GCS export command: python /opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py --date 2025-06-06 --base_data_dir /opt/airflow/scripts/google_scraper/data --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:16.115385Z","level":"info","event":"⏰ Waiting for GCS export completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:17.434531Z","level":"info","event":"📋 2025-06-06 15:16:17,433 - INFO - 2025-06-06 15:16:17 - Starting export_to_gcs_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:17.435328Z","level":"info","event":"📋 2025-06-06 15:16:17,433 - INFO - 2025-06-06 15:16:17 - Parameters: date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:17.435602Z","level":"info","event":"📋 2025-06-06 15:16:17,434 - INFO - 2025-06-06 15:16:17 - Paths: base_data_dir=/opt/airflow/scripts/google_scraper/data, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:17.435828Z","level":"info","event":"📋 2025-06-06 15:16:17,434 - INFO - 2025-06-06 15:16:17 - GCS: project_id=None, bucket=None","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:17.435917Z","level":"info","event":"📋 2025-06-06 15:16:17,434 - INFO - 2025-06-06 15:16:17 - Airflow logs: include=True, dir=/opt/airflow/logs","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:17.436343Z","level":"info","event":"📋 2025-06-06 15:16:17,434 - INFO - 2025-06-06 15:16:17 - 🚀 Starting GCS export for date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:17.436437Z","level":"info","event":"📋 2025-06-06 15:16:17,434 - INFO - 2025-06-06 15:16:17 - 📁 Base data directory: /opt/airflow/scripts/google_scraper/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:17.436607Z","level":"info","event":"📋 2025-06-06 15:16:17,434 - INFO - 2025-06-06 15:16:17 - 📋 Include Airflow logs: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:17.437047Z","level":"info","event":"📋 2025-06-06 15:16:17,434 - INFO - 2025-06-06 15:16:17 - 🔧 GCS Configuration:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:17.437125Z","level":"info","event":"📋 2025-06-06 15:16:17,434 - INFO - 2025-06-06 15:16:17 -   - Project ID: simprede-461309","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:17.437188Z","level":"info","event":"📋 2025-06-06 15:16:17,434 - INFO - 2025-06-06 15:16:17 -   - Bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:17.437289Z","level":"info","event":"📋 2025-06-06 15:16:17,434 - INFO - 2025-06-06 15:16:17 -   - Credentials: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:17.500865Z","level":"info","event":"📋 2025-06-06 15:16:17,500 - INFO - 2025-06-06 15:16:17 - ✅ Initialized GCS client with service account: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:18.584508Z","level":"info","event":"📋 2025-06-06 15:16:18,583 - ERROR - 2025-06-06 15:16:18 - ❌ Failed to create bucket 'simprede-data-pipeline': 403 POST https://storage.googleapis.com/storage/v1/b?project=simprede-461309&prettyPrint=false: bucket@simprede-461309.iam.gserviceaccount.com does not have storage.buckets.create access to the Google Cloud project. Permission 'storage.buckets.create' denied on resource (or it may not exist).","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:18.585598Z","level":"info","event":"📋 2025-06-06 15:16:18,583 - ERROR - 2025-06-06 15:16:18 - ❌ Failed to create or access bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:18.586331Z","level":"info","event":"📋 2025-06-06 15:16:18,583 - ERROR - 2025-06-06 15:16:18 - ❌ GCS export failed: Cannot access GCS bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:18.590089Z","level":"info","event":"📋 2025-06-06 15:16:18,586 - ERROR - 2025-06-06 15:16:18 - ❌ Full traceback: Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:18.592727Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 620, in main","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:18.593669Z","level":"info","event":"📋     result = export_to_gcs(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:18.596861Z","level":"info","event":"📋              ^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:18.598312Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 480, in export_to_gcs","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:18.598653Z","level":"info","event":"📋     raise Exception(f\"Cannot access GCS bucket: {gcs_config['bucket_name']}\")","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:18.599139Z","level":"info","event":"📋 Exception: Cannot access GCS bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:18.599401Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:18.761329Z","level":"info","event":"❌ GCS export failed with return code 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:18.761951Z","level":"info","event":"❌ Unexpected error in GCS export task: GCS export failed with return code 1:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:18.763362","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"Exception","exc_value":"GCS export failed with return code 1: ","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":838,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1130,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":212,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":235,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/google_scraper_dag.py","lineno":1091,"name":"export_to_gcs_task"}]}]}
