{"timestamp":"2025-06-06T14:39:58.568788","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-06T14:39:58.569409","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-06T14:39:58.683269Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:39:58.686772Z","level":"info","event":"📁 Using paths from processar task: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:39:58.690305Z","level":"info","event":"📅 Using provided execution date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:39:58.691286Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/06', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/06', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/06']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:39:58.691429Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:39:58.691646Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:39:58.691940Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:39:58.692148Z","level":"info","event":"  - Target date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:39:58.692425Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:39:58.701951Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:39:58.707601Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:39:58.710640Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:39:58.711170Z","level":"info","event":"  - victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:39:58.711348Z","level":"info","event":"  - no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_sem_vitimas_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:39:58.711995Z","level":"info","event":"  - filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_log_20250606.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:39:58.712632Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:39:58.712738Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/06 --date_str 2025-06-06 --date 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:39:58.712889Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.522949Z","level":"info","event":"📋 [2025-06-06 15:40:02] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.530658Z","level":"info","event":"📋 2025-06-06 15:40:02,519 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.535235Z","level":"info","event":"📋 [2025-06-06 15:40:02] Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.536206Z","level":"info","event":"📋 2025-06-06 15:40:02,519 - INFO - Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.536686Z","level":"info","event":"📋 [2025-06-06 15:40:02] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.540108Z","level":"info","event":"📋 2025-06-06 15:40:02,519 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.544038Z","level":"info","event":"📋 [2025-06-06 15:40:02] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.545005Z","level":"info","event":"📋 2025-06-06 15:40:02,519 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.551505Z","level":"info","event":"📋 [2025-06-06 15:40:02] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.552149Z","level":"info","event":"📋 2025-06-06 15:40:02,520 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.552553Z","level":"info","event":"📋 [2025-06-06 15:40:02]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.552926Z","level":"info","event":"📋 2025-06-06 15:40:02,521 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.553260Z","level":"info","event":"📋 [2025-06-06 15:40:02]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.553748Z","level":"info","event":"📋 2025-06-06 15:40:02,521 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.554309Z","level":"info","event":"📋 [2025-06-06 15:40:02] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.554992Z","level":"info","event":"📋 2025-06-06 15:40:02,521 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.555486Z","level":"info","event":"📋 [2025-06-06 15:40:02] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.556436Z","level":"info","event":"📋 2025-06-06 15:40:02,522 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.557356Z","level":"info","event":"📋 [2025-06-06 15:40:02] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.557671Z","level":"info","event":"📋 2025-06-06 15:40:02,522 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.578702Z","level":"info","event":"📋 [2025-06-06 15:40:02] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.579282Z","level":"info","event":"📋 2025-06-06 15:40:02,576 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.579454Z","level":"info","event":"📋 [2025-06-06 15:40:02] Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.579711Z","level":"info","event":"📋 2025-06-06 15:40:02,576 - INFO - Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.580240Z","level":"info","event":"📋 [2025-06-06 15:40:02] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.580641Z","level":"info","event":"📋 2025-06-06 15:40:02,576 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.580869Z","level":"info","event":"📋 [2025-06-06 15:40:02]   Total Articles Loaded: 15","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.581059Z","level":"info","event":"📋 2025-06-06 15:40:02,576 - INFO -   Total Articles Loaded: 15","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.581991Z","level":"info","event":"📋 [2025-06-06 15:40:02]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.583363Z","level":"info","event":"📋 2025-06-06 15:40:02,576 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.583535Z","level":"info","event":"📋 [2025-06-06 15:40:02]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.583717Z","level":"info","event":"📋 2025-06-06 15:40:02,576 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.583941Z","level":"info","event":"📋 [2025-06-06 15:40:02]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.584136Z","level":"info","event":"📋 2025-06-06 15:40:02,577 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.584359Z","level":"info","event":"📋 [2025-06-06 15:40:02]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.584573Z","level":"info","event":"📋 2025-06-06 15:40:02,577 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.584743Z","level":"info","event":"📋 [2025-06-06 15:40:02] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.584995Z","level":"info","event":"📋 2025-06-06 15:40:02,577 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.585939Z","level":"info","event":"📋 [2025-06-06 15:40:02] 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.589920Z","level":"info","event":"📋 2025-06-06 15:40:02,577 - INFO - 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.591626Z","level":"info","event":"📋 [2025-06-06 15:40:02] 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.592336Z","level":"info","event":"📋 2025-06-06 15:40:02,577 - INFO - 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.594461Z","level":"info","event":"📋 [2025-06-06 15:40:02] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.594991Z","level":"info","event":"📋 2025-06-06 15:40:02,577 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.595443Z","level":"info","event":"📋 [2025-06-06 15:40:02]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.595878Z","level":"info","event":"📋 2025-06-06 15:40:02,577 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.596059Z","level":"info","event":"📋 [2025-06-06 15:40:02]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.596197Z","level":"info","event":"📋 2025-06-06 15:40:02,577 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.596327Z","level":"info","event":"📋 [2025-06-06 15:40:02]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.596452Z","level":"info","event":"📋 2025-06-06 15:40:02,577 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.596825Z","level":"info","event":"📋 [2025-06-06 15:40:02]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.597047Z","level":"info","event":"📋 2025-06-06 15:40:02,577 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.597298Z","level":"info","event":"📋 [2025-06-06 15:40:02] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.597416Z","level":"info","event":"📋 2025-06-06 15:40:02,580 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.597546Z","level":"info","event":"📋 [2025-06-06 15:40:02]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.597665Z","level":"info","event":"📋 2025-06-06 15:40:02,580 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.597894Z","level":"info","event":"📋 [2025-06-06 15:40:02]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.598209Z","level":"info","event":"📋 2025-06-06 15:40:02,580 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.598417Z","level":"info","event":"📋 [2025-06-06 15:40:02] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.598535Z","level":"info","event":"📋 2025-06-06 15:40:02,583 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.598628Z","level":"info","event":"📋 [2025-06-06 15:40:02] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.598717Z","level":"info","event":"📋 2025-06-06 15:40:02,586 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.598852Z","level":"info","event":"📋 [2025-06-06 15:40:02] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.599222Z","level":"info","event":"📋 2025-06-06 15:40:02,586 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.599411Z","level":"info","event":"📋 [2025-06-06 15:40:02] 📊 Starting enhanced comprehensive filtering with 15 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.599707Z","level":"info","event":"📋 2025-06-06 15:40:02,586 - INFO - 📊 Starting enhanced comprehensive filtering with 15 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.602611Z","level":"info","event":"📋 [2025-06-06 15:40:02] 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.603131Z","level":"info","event":"📋 2025-06-06 15:40:02,602 - INFO - 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.608518Z","level":"info","event":"📋 [2025-06-06 15:40:02]    After enhanced geographic filter: 14 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.609184Z","level":"info","event":"📋 2025-06-06 15:40:02,608 - INFO -    After enhanced geographic filter: 14 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.610236Z","level":"info","event":"📋 [2025-06-06 15:40:02] ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.610914Z","level":"info","event":"📋 2025-06-06 15:40:02,608 - INFO - ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.621281Z","level":"info","event":"📋 [2025-06-06 15:40:02]    After quality filter: 11 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.622562Z","level":"info","event":"📋 2025-06-06 15:40:02,619 - INFO -    After quality filter: 11 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.622869Z","level":"info","event":"📋 [2025-06-06 15:40:02] 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.623485Z","level":"info","event":"📋 2025-06-06 15:40:02,622 - INFO - 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.626293Z","level":"info","event":"📋 [2025-06-06 15:40:02]    After enhanced keyword filter: 0 articles (removed 11)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.626692Z","level":"info","event":"📋 2025-06-06 15:40:02,626 - INFO -    After enhanced keyword filter: 0 articles (removed 11)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.626968Z","level":"info","event":"📋 [2025-06-06 15:40:02] 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.627253Z","level":"info","event":"📋 2025-06-06 15:40:02,626 - INFO - 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.632495Z","level":"info","event":"📋 [2025-06-06 15:40:02]    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.632967Z","level":"info","event":"📋 2025-06-06 15:40:02,632 - INFO -    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.635237Z","level":"info","event":"📋 [2025-06-06 15:40:02] 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.635769Z","level":"info","event":"📋 2025-06-06 15:40:02,632 - INFO - 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.636224Z","level":"info","event":"📋 [2025-06-06 15:40:02]    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.636652Z","level":"info","event":"📋 2025-06-06 15:40:02,634 - INFO -    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.637146Z","level":"info","event":"📋 [2025-06-06 15:40:02] ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.637453Z","level":"info","event":"📋 2025-06-06 15:40:02,634 - INFO - ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.638419Z","level":"info","event":"📋 [2025-06-06 15:40:02]    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.638653Z","level":"info","event":"📋 2025-06-06 15:40:02,638 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.638914Z","level":"info","event":"📋 [2025-06-06 15:40:02] 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.639260Z","level":"info","event":"📋 2025-06-06 15:40:02,638 - INFO - 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.641885Z","level":"info","event":"📋 [2025-06-06 15:40:02] 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.642593Z","level":"info","event":"📋 2025-06-06 15:40:02,641 - INFO - 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.643170Z","level":"info","event":"📋 [2025-06-06 15:40:02] ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.643495Z","level":"info","event":"📋 2025-06-06 15:40:02,641 - WARNING - ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.643752Z","level":"info","event":"📋 [2025-06-06 15:40:02] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:02.644023Z","level":"info","event":"📋 2025-06-06 15:40:02,642 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:03.688978Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:03.690024Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:03.813757Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_20250606.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:03.814045Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_sem_vitimas_20250606.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:03.814276Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_log_20250606.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:03.814575Z","level":"info","event":"⚠️ stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_stats_20250606.json (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:03.712144","level":"info","event":"Done. Returned value was: [2025-06-06 15:40:02] Starting filtrar_artigos_vitimas_airflow\n2025-06-06 15:40:02,519 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-06 15:40:02] Parameters: dias=1, date=2025-06-06\n2025-06-06 15:40:02,519 - INFO - Parameters: dias=1, date=2025-06-06\n[2025-06-06 15:40:02] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06\n2025-06-06 15:40:02,519 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06\n[2025-06-06 15:40:02] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n2025-06-06 15:40:02,519 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n[2025-06-06 15:40:02] 🔍 Path setup:\n2025-06-06 15:40:02,520 - INFO - 🔍 Path setup:\n[2025-06-06 15:40:02]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-06 15:40:02,521 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-06 15:40:02]    Project root: /opt/airflow\n2025-06-06 15:40:02,521 - INFO -    Project root: /opt/airflow\n[2025-06-06 15:40:02] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n2025-06-06 15:40:02,521 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n[2025-06-06 15:40:02] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 15:40:02,522 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 15:40:02] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 15:40:02,522 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 15:40:02] ==================================================\n2025-06-06 15:40:02,576 - INFO - ==================================================\n[2025-06-06 15:40:02] Enhanced Filtering Started\n2025-06-06 15:40:02,576 - INFO - Enhanced Filtering Started\n[2025-06-06 15:40:02] ==================================================\n2025-06-06 15:40:02,576 - INFO - ==================================================\n[2025-06-06 15:40:02]   Total Articles Loaded: 15\n2025-06-06 15:40:02,576 - INFO -   Total Articles Loaded: 15\n[2025-06-06 15:40:02]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 15:40:02,576 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 15:40:02]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv\n2025-06-06 15:40:02,576 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv\n[2025-06-06 15:40:02]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n2025-06-06 15:40:02,577 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n[2025-06-06 15:40:02]   Days Filter: 1\n2025-06-06 15:40:02,577 - INFO -   Days Filter: 1\n[2025-06-06 15:40:02] ==================================================\n2025-06-06 15:40:02,577 - INFO - ==================================================\n[2025-06-06 15:40:02] 🔍 Applying enhanced comprehensive filtering logic...\n2025-06-06 15:40:02,577 - INFO - 🔍 Applying enhanced comprehensive filtering logic...\n[2025-06-06 15:40:02] 🔧 Loading configuration data for enhanced filtering...\n2025-06-06 15:40:02,577 - INFO - 🔧 Loading configuration data for enhanced filtering...\n[2025-06-06 15:40:02] 🔍 Looking for config files in multiple paths:\n2025-06-06 15:40:02,577 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-06 15:40:02]    Checking: /opt/airflow/config\n2025-06-06 15:40:02,577 - INFO -    Checking: /opt/airflow/config\n[2025-06-06 15:40:02]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-06 15:40:02,577 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-06 15:40:02]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-06 15:40:02,577 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-06 15:40:02]    Checking: config\n2025-06-06 15:40:02,577 - INFO -    Checking: config\n[2025-06-06 15:40:02] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-06 15:40:02,580 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-06 15:40:02]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-06 15:40:02,580 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-06 15:40:02]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-06 15:40:02,580 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-06 15:40:02] ✅ Loaded municipios config with 29 districts\n2025-06-06 15:40:02,583 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-06 15:40:02] ✅ Loaded eventos config with 14 events\n2025-06-06 15:40:02,586 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-06 15:40:02] 📊 Config summary: 29 districts, 306 parishes\n2025-06-06 15:40:02,586 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-06 15:40:02] 📊 Starting enhanced comprehensive filtering with 15 articles\n2025-06-06 15:40:02,586 - INFO - 📊 Starting enhanced comprehensive filtering with 15 articles\n[2025-06-06 15:40:02] 🇵🇹 Applying enhanced geographic filter...\n2025-06-06 15:40:02,602 - INFO - 🇵🇹 Applying enhanced geographic filter...\n[2025-06-06 15:40:02]    After enhanced geographic filter: 14 articles (removed 1)\n2025-06-06 15:40:02,608 - INFO -    After enhanced geographic filter: 14 articles (removed 1)\n[2025-06-06 15:40:02] ✨ Applying content quality filter...\n2025-06-06 15:40:02,608 - INFO - ✨ Applying content quality filter...\n[2025-06-06 15:40:02]    After quality filter: 11 articles (removed 3)\n2025-06-06 15:40:02,619 - INFO -    After quality filter: 11 articles (removed 3)\n[2025-06-06 15:40:02] 🔍 Applying enhanced keyword filtering...\n2025-06-06 15:40:02,622 - INFO - 🔍 Applying enhanced keyword filtering...\n[2025-06-06 15:40:02]    After enhanced keyword filter: 0 articles (removed 11)\n2025-06-06 15:40:02,626 - INFO -    After enhanced keyword filter: 0 articles (removed 11)\n[2025-06-06 15:40:02] 📅 Applying temporal relevance filter...\n2025-06-06 15:40:02,626 - INFO - 📅 Applying temporal relevance filter...\n[2025-06-06 15:40:02]    After temporal filter: 0 articles (removed 0)\n2025-06-06 15:40:02,632 - INFO -    After temporal filter: 0 articles (removed 0)\n[2025-06-06 15:40:02] 👥 Applying enhanced victim validation...\n2025-06-06 15:40:02,632 - INFO - 👥 Applying enhanced victim validation...\n[2025-06-06 15:40:02]    After victim validation: 0 articles (removed 0)\n2025-06-06 15:40:02,634 - INFO -    After victim validation: 0 articles (removed 0)\n[2025-06-06 15:40:02] ⭐ Calculating enhanced relevance scores...\n2025-06-06 15:40:02,634 - INFO - ⭐ Calculating enhanced relevance scores...\n[2025-06-06 15:40:02]    After relevance score filter (min 2): 0 articles (removed 0)\n2025-06-06 15:40:02,638 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)\n[2025-06-06 15:40:02] 🔄 Removing duplicates with enhanced logic...\n2025-06-06 15:40:02,638 - INFO - 🔄 Removing duplicates with enhanced logic...\n[2025-06-06 15:40:02] 🌦️ Enhanced climate event identification...\n2025-06-06 15:40:02,641 - INFO - 🌦️ Enhanced climate event identification...\n[2025-06-06 15:40:02] ⚠️ No articles remaining after enhanced filtering.\n2025-06-06 15:40:02,641 - WARNING - ⚠️ No articles remaining after enhanced filtering.\n[2025-06-06 15:40:02] ✅ Filtering completed. Found 0 articles with victims\n2025-06-06 15:40:02,642 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
