{"timestamp":"2025-06-06T09:38:53.421990","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-06T09:38:53.422299","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-06T09:38:53.445499Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:53.446399Z","level":"info","event":"📁 Using paths from processar task: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:53.447878Z","level":"info","event":"📅 Using provided execution date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:53.448016Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/06', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/06', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/06']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:53.448111Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:53.448154Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:53.448191Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:53.448240Z","level":"info","event":"  - Target date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:53.448277Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:53.451131Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:53.451209Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:53.451414Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:53.451510Z","level":"info","event":"  - victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:53.451576Z","level":"info","event":"  - no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_sem_vitimas_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:53.451669Z","level":"info","event":"  - filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_log_20250606.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:53.451735Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:53.451799Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/06 --date_str 2025-06-06 --date 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:53.451886Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.670068Z","level":"info","event":"📋 [2025-06-06 10:38:54] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.670343Z","level":"info","event":"📋 2025-06-06 10:38:54,669 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.670808Z","level":"info","event":"📋 [2025-06-06 10:38:54] Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.670863Z","level":"info","event":"📋 2025-06-06 10:38:54,670 - INFO - Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.670908Z","level":"info","event":"📋 [2025-06-06 10:38:54] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.671769Z","level":"info","event":"📋 2025-06-06 10:38:54,670 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.671873Z","level":"info","event":"📋 [2025-06-06 10:38:54] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.671919Z","level":"info","event":"📋 2025-06-06 10:38:54,670 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.671956Z","level":"info","event":"📋 [2025-06-06 10:38:54] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.671992Z","level":"info","event":"📋 2025-06-06 10:38:54,670 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672028Z","level":"info","event":"📋 [2025-06-06 10:38:54]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672067Z","level":"info","event":"📋 2025-06-06 10:38:54,670 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672107Z","level":"info","event":"📋 [2025-06-06 10:38:54]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672144Z","level":"info","event":"📋 2025-06-06 10:38:54,670 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672183Z","level":"info","event":"📋 [2025-06-06 10:38:54] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672219Z","level":"info","event":"📋 2025-06-06 10:38:54,670 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672256Z","level":"info","event":"📋 [2025-06-06 10:38:54] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672293Z","level":"info","event":"📋 2025-06-06 10:38:54,670 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672338Z","level":"info","event":"📋 [2025-06-06 10:38:54] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672375Z","level":"info","event":"📋 2025-06-06 10:38:54,670 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672428Z","level":"info","event":"📋 [2025-06-06 10:38:54] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672490Z","level":"info","event":"📋 2025-06-06 10:38:54,672 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672537Z","level":"info","event":"📋 [2025-06-06 10:38:54] Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672575Z","level":"info","event":"📋 2025-06-06 10:38:54,672 - INFO - Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672643Z","level":"info","event":"📋 [2025-06-06 10:38:54] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672689Z","level":"info","event":"📋 2025-06-06 10:38:54,672 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672758Z","level":"info","event":"📋 [2025-06-06 10:38:54]   Total Articles Loaded: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672802Z","level":"info","event":"📋 2025-06-06 10:38:54,672 - INFO -   Total Articles Loaded: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672875Z","level":"info","event":"📋 [2025-06-06 10:38:54]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.672914Z","level":"info","event":"📋 2025-06-06 10:38:54,672 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.673139Z","level":"info","event":"📋 [2025-06-06 10:38:54]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.673188Z","level":"info","event":"📋 2025-06-06 10:38:54,672 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.673253Z","level":"info","event":"📋 [2025-06-06 10:38:54]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.673356Z","level":"info","event":"📋 2025-06-06 10:38:54,672 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.673417Z","level":"info","event":"📋 [2025-06-06 10:38:54]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.673470Z","level":"info","event":"📋 2025-06-06 10:38:54,672 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.673871Z","level":"info","event":"📋 [2025-06-06 10:38:54] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.673908Z","level":"info","event":"📋 2025-06-06 10:38:54,672 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.673942Z","level":"info","event":"📋 [2025-06-06 10:38:54] 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.673980Z","level":"info","event":"📋 2025-06-06 10:38:54,673 - INFO - 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.674017Z","level":"info","event":"📋 [2025-06-06 10:38:54] 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.674055Z","level":"info","event":"📋 2025-06-06 10:38:54,673 - INFO - 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.674125Z","level":"info","event":"📋 [2025-06-06 10:38:54] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.674201Z","level":"info","event":"📋 2025-06-06 10:38:54,673 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.675379Z","level":"info","event":"📋 [2025-06-06 10:38:54]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677342Z","level":"info","event":"📋 2025-06-06 10:38:54,673 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677401Z","level":"info","event":"📋 [2025-06-06 10:38:54]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677439Z","level":"info","event":"📋 2025-06-06 10:38:54,673 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677476Z","level":"info","event":"📋 [2025-06-06 10:38:54]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677511Z","level":"info","event":"📋 2025-06-06 10:38:54,673 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677548Z","level":"info","event":"📋 [2025-06-06 10:38:54]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677583Z","level":"info","event":"📋 2025-06-06 10:38:54,673 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677641Z","level":"info","event":"📋 [2025-06-06 10:38:54] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677680Z","level":"info","event":"📋 2025-06-06 10:38:54,673 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677715Z","level":"info","event":"📋 [2025-06-06 10:38:54]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677750Z","level":"info","event":"📋 2025-06-06 10:38:54,673 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677785Z","level":"info","event":"📋 [2025-06-06 10:38:54]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677820Z","level":"info","event":"📋 2025-06-06 10:38:54,673 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677855Z","level":"info","event":"📋 [2025-06-06 10:38:54] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677890Z","level":"info","event":"📋 2025-06-06 10:38:54,674 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677923Z","level":"info","event":"📋 [2025-06-06 10:38:54] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677958Z","level":"info","event":"📋 2025-06-06 10:38:54,674 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.677991Z","level":"info","event":"📋 [2025-06-06 10:38:54] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678047Z","level":"info","event":"📋 2025-06-06 10:38:54,674 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678083Z","level":"info","event":"📋 [2025-06-06 10:38:54] 📊 Starting enhanced comprehensive filtering with 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678116Z","level":"info","event":"📋 2025-06-06 10:38:54,674 - INFO - 📊 Starting enhanced comprehensive filtering with 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678150Z","level":"info","event":"📋 [2025-06-06 10:38:54] 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678183Z","level":"info","event":"📋 2025-06-06 10:38:54,675 - INFO - 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678216Z","level":"info","event":"📋 [2025-06-06 10:38:54]    After enhanced geographic filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678249Z","level":"info","event":"📋 2025-06-06 10:38:54,675 - INFO -    After enhanced geographic filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678282Z","level":"info","event":"📋 [2025-06-06 10:38:54] ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678315Z","level":"info","event":"📋 2025-06-06 10:38:54,675 - INFO - ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678364Z","level":"info","event":"📋 [2025-06-06 10:38:54]    After quality filter: 3 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678399Z","level":"info","event":"📋 2025-06-06 10:38:54,675 - INFO -    After quality filter: 3 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678433Z","level":"info","event":"📋 [2025-06-06 10:38:54] 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678469Z","level":"info","event":"📋 2025-06-06 10:38:54,676 - INFO - 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678503Z","level":"info","event":"📋 [2025-06-06 10:38:54]    After enhanced keyword filter: 0 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678545Z","level":"info","event":"📋 2025-06-06 10:38:54,676 - INFO -    After enhanced keyword filter: 0 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678581Z","level":"info","event":"📋 [2025-06-06 10:38:54] 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678617Z","level":"info","event":"📋 2025-06-06 10:38:54,676 - INFO - 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678653Z","level":"info","event":"📋 [2025-06-06 10:38:54]    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678688Z","level":"info","event":"📋 2025-06-06 10:38:54,676 - INFO -    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678722Z","level":"info","event":"📋 [2025-06-06 10:38:54] 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678759Z","level":"info","event":"📋 2025-06-06 10:38:54,676 - INFO - 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678794Z","level":"info","event":"📋 [2025-06-06 10:38:54]    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678830Z","level":"info","event":"📋 2025-06-06 10:38:54,676 - INFO -    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678891Z","level":"info","event":"📋 [2025-06-06 10:38:54] ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678926Z","level":"info","event":"📋 2025-06-06 10:38:54,676 - INFO - ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678959Z","level":"info","event":"📋 [2025-06-06 10:38:54]    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.678993Z","level":"info","event":"📋 2025-06-06 10:38:54,677 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.679029Z","level":"info","event":"📋 [2025-06-06 10:38:54] 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.679087Z","level":"info","event":"📋 2025-06-06 10:38:54,677 - INFO - 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.679164Z","level":"info","event":"📋 [2025-06-06 10:38:54] 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.679208Z","level":"info","event":"📋 2025-06-06 10:38:54,678 - INFO - 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.679246Z","level":"info","event":"📋 [2025-06-06 10:38:54] ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.679283Z","level":"info","event":"📋 2025-06-06 10:38:54,678 - WARNING - ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.679319Z","level":"info","event":"📋 [2025-06-06 10:38:54] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.679396Z","level":"info","event":"📋 2025-06-06 10:38:54,679 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.788231Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.788466Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.788618Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_20250606.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.788693Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_sem_vitimas_20250606.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.788894Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_log_20250606.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.789291Z","level":"info","event":"⚠️ stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_stats_20250606.json (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T09:38:54.789010","level":"info","event":"Done. Returned value was: [2025-06-06 10:38:54] Starting filtrar_artigos_vitimas_airflow\n2025-06-06 10:38:54,669 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-06 10:38:54] Parameters: dias=1, date=2025-06-06\n2025-06-06 10:38:54,670 - INFO - Parameters: dias=1, date=2025-06-06\n[2025-06-06 10:38:54] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06\n2025-06-06 10:38:54,670 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06\n[2025-06-06 10:38:54] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n2025-06-06 10:38:54,670 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n[2025-06-06 10:38:54] 🔍 Path setup:\n2025-06-06 10:38:54,670 - INFO - 🔍 Path setup:\n[2025-06-06 10:38:54]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-06 10:38:54,670 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-06 10:38:54]    Project root: /opt/airflow\n2025-06-06 10:38:54,670 - INFO -    Project root: /opt/airflow\n[2025-06-06 10:38:54] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n2025-06-06 10:38:54,670 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n[2025-06-06 10:38:54] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 10:38:54,670 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 10:38:54] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 10:38:54,670 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 10:38:54] ==================================================\n2025-06-06 10:38:54,672 - INFO - ==================================================\n[2025-06-06 10:38:54] Enhanced Filtering Started\n2025-06-06 10:38:54,672 - INFO - Enhanced Filtering Started\n[2025-06-06 10:38:54] ==================================================\n2025-06-06 10:38:54,672 - INFO - ==================================================\n[2025-06-06 10:38:54]   Total Articles Loaded: 4\n2025-06-06 10:38:54,672 - INFO -   Total Articles Loaded: 4\n[2025-06-06 10:38:54]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 10:38:54,672 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 10:38:54]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv\n2025-06-06 10:38:54,672 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv\n[2025-06-06 10:38:54]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n2025-06-06 10:38:54,672 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n[2025-06-06 10:38:54]   Days Filter: 1\n2025-06-06 10:38:54,672 - INFO -   Days Filter: 1\n[2025-06-06 10:38:54] ==================================================\n2025-06-06 10:38:54,672 - INFO - ==================================================\n[2025-06-06 10:38:54] 🔍 Applying enhanced comprehensive filtering logic...\n2025-06-06 10:38:54,673 - INFO - 🔍 Applying enhanced comprehensive filtering logic...\n[2025-06-06 10:38:54] 🔧 Loading configuration data for enhanced filtering...\n2025-06-06 10:38:54,673 - INFO - 🔧 Loading configuration data for enhanced filtering...\n[2025-06-06 10:38:54] 🔍 Looking for config files in multiple paths:\n2025-06-06 10:38:54,673 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-06 10:38:54]    Checking: /opt/airflow/config\n2025-06-06 10:38:54,673 - INFO -    Checking: /opt/airflow/config\n[2025-06-06 10:38:54]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-06 10:38:54,673 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-06 10:38:54]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-06 10:38:54,673 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-06 10:38:54]    Checking: config\n2025-06-06 10:38:54,673 - INFO -    Checking: config\n[2025-06-06 10:38:54] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-06 10:38:54,673 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-06 10:38:54]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-06 10:38:54,673 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-06 10:38:54]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-06 10:38:54,673 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-06 10:38:54] ✅ Loaded municipios config with 29 districts\n2025-06-06 10:38:54,674 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-06 10:38:54] ✅ Loaded eventos config with 14 events\n2025-06-06 10:38:54,674 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-06 10:38:54] 📊 Config summary: 29 districts, 306 parishes\n2025-06-06 10:38:54,674 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-06 10:38:54] 📊 Starting enhanced comprehensive filtering with 4 articles\n2025-06-06 10:38:54,674 - INFO - 📊 Starting enhanced comprehensive filtering with 4 articles\n[2025-06-06 10:38:54] 🇵🇹 Applying enhanced geographic filter...\n2025-06-06 10:38:54,675 - INFO - 🇵🇹 Applying enhanced geographic filter...\n[2025-06-06 10:38:54]    After enhanced geographic filter: 4 articles (removed 0)\n2025-06-06 10:38:54,675 - INFO -    After enhanced geographic filter: 4 articles (removed 0)\n[2025-06-06 10:38:54] ✨ Applying content quality filter...\n2025-06-06 10:38:54,675 - INFO - ✨ Applying content quality filter...\n[2025-06-06 10:38:54]    After quality filter: 3 articles (removed 1)\n2025-06-06 10:38:54,675 - INFO -    After quality filter: 3 articles (removed 1)\n[2025-06-06 10:38:54] 🔍 Applying enhanced keyword filtering...\n2025-06-06 10:38:54,676 - INFO - 🔍 Applying enhanced keyword filtering...\n[2025-06-06 10:38:54]    After enhanced keyword filter: 0 articles (removed 3)\n2025-06-06 10:38:54,676 - INFO -    After enhanced keyword filter: 0 articles (removed 3)\n[2025-06-06 10:38:54] 📅 Applying temporal relevance filter...\n2025-06-06 10:38:54,676 - INFO - 📅 Applying temporal relevance filter...\n[2025-06-06 10:38:54]    After temporal filter: 0 articles (removed 0)\n2025-06-06 10:38:54,676 - INFO -    After temporal filter: 0 articles (removed 0)\n[2025-06-06 10:38:54] 👥 Applying enhanced victim validation...\n2025-06-06 10:38:54,676 - INFO - 👥 Applying enhanced victim validation...\n[2025-06-06 10:38:54]    After victim validation: 0 articles (removed 0)\n2025-06-06 10:38:54,676 - INFO -    After victim validation: 0 articles (removed 0)\n[2025-06-06 10:38:54] ⭐ Calculating enhanced relevance scores...\n2025-06-06 10:38:54,676 - INFO - ⭐ Calculating enhanced relevance scores...\n[2025-06-06 10:38:54]    After relevance score filter (min 2): 0 articles (removed 0)\n2025-06-06 10:38:54,677 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)\n[2025-06-06 10:38:54] 🔄 Removing duplicates with enhanced logic...\n2025-06-06 10:38:54,677 - INFO - 🔄 Removing duplicates with enhanced logic...\n[2025-06-06 10:38:54] 🌦️ Enhanced climate event identification...\n2025-06-06 10:38:54,678 - INFO - 🌦️ Enhanced climate event identification...\n[2025-06-06 10:38:54] ⚠️ No articles remaining after enhanced filtering.\n2025-06-06 10:38:54,678 - WARNING - ⚠️ No articles remaining after enhanced filtering.\n[2025-06-06 10:38:54] ✅ Filtering completed. Found 0 articles with victims\n2025-06-06 10:38:54,679 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-06T11:03:58.766006","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-06T11:03:58.766382","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-06T11:03:58.804236Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:58.806044Z","level":"info","event":"📁 Using paths from processar task: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:58.807376Z","level":"info","event":"📅 Using provided execution date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:58.807688Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/06', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/06', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/06']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:58.807778Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:58.807840Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:58.807888Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:58.807934Z","level":"info","event":"  - Target date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:58.807989Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:58.812726Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:58.813197Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:58.813291Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:58.813388Z","level":"info","event":"  - victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:58.813658Z","level":"info","event":"  - no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_sem_vitimas_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:58.813868Z","level":"info","event":"  - filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_log_20250606.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:58.813966Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:58.814097Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/06 --date_str 2025-06-06 --date 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:03:58.814177Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.967751Z","level":"info","event":"📋 [2025-06-06 12:04:00] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.970242Z","level":"info","event":"📋 2025-06-06 12:04:00,966 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.970376Z","level":"info","event":"📋 [2025-06-06 12:04:00] Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.970490Z","level":"info","event":"📋 2025-06-06 12:04:00,966 - INFO - Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.970597Z","level":"info","event":"📋 [2025-06-06 12:04:00] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.970798Z","level":"info","event":"📋 2025-06-06 12:04:00,966 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.970875Z","level":"info","event":"📋 [2025-06-06 12:04:00] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.971719Z","level":"info","event":"📋 2025-06-06 12:04:00,966 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.971776Z","level":"info","event":"📋 [2025-06-06 12:04:00] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.971832Z","level":"info","event":"📋 2025-06-06 12:04:00,967 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.971926Z","level":"info","event":"📋 [2025-06-06 12:04:00]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.974133Z","level":"info","event":"📋 2025-06-06 12:04:00,967 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.975023Z","level":"info","event":"📋 [2025-06-06 12:04:00]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.976458Z","level":"info","event":"📋 2025-06-06 12:04:00,967 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.976549Z","level":"info","event":"📋 [2025-06-06 12:04:00] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.976623Z","level":"info","event":"📋 2025-06-06 12:04:00,967 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.976702Z","level":"info","event":"📋 [2025-06-06 12:04:00] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.976794Z","level":"info","event":"📋 2025-06-06 12:04:00,967 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.976874Z","level":"info","event":"📋 [2025-06-06 12:04:00] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.976968Z","level":"info","event":"📋 2025-06-06 12:04:00,967 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.977995Z","level":"info","event":"📋 [2025-06-06 12:04:00] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.979163Z","level":"info","event":"📋 2025-06-06 12:04:00,969 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.979246Z","level":"info","event":"📋 [2025-06-06 12:04:00] Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.979299Z","level":"info","event":"📋 2025-06-06 12:04:00,969 - INFO - Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.979342Z","level":"info","event":"📋 [2025-06-06 12:04:00] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.979384Z","level":"info","event":"📋 2025-06-06 12:04:00,969 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.979447Z","level":"info","event":"📋 [2025-06-06 12:04:00]   Total Articles Loaded: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.979523Z","level":"info","event":"📋 2025-06-06 12:04:00,969 - INFO -   Total Articles Loaded: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.979599Z","level":"info","event":"📋 [2025-06-06 12:04:00]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.979686Z","level":"info","event":"📋 2025-06-06 12:04:00,969 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.979751Z","level":"info","event":"📋 [2025-06-06 12:04:00]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.979801Z","level":"info","event":"📋 2025-06-06 12:04:00,969 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.979861Z","level":"info","event":"📋 [2025-06-06 12:04:00]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.979919Z","level":"info","event":"📋 2025-06-06 12:04:00,969 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.979975Z","level":"info","event":"📋 [2025-06-06 12:04:00]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.980024Z","level":"info","event":"📋 2025-06-06 12:04:00,969 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.980065Z","level":"info","event":"📋 [2025-06-06 12:04:00] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.980110Z","level":"info","event":"📋 2025-06-06 12:04:00,970 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.980205Z","level":"info","event":"📋 [2025-06-06 12:04:00] 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.980272Z","level":"info","event":"📋 2025-06-06 12:04:00,970 - INFO - 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.980332Z","level":"info","event":"📋 [2025-06-06 12:04:00] 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.980444Z","level":"info","event":"📋 2025-06-06 12:04:00,970 - INFO - 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.980502Z","level":"info","event":"📋 [2025-06-06 12:04:00] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.980575Z","level":"info","event":"📋 2025-06-06 12:04:00,970 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.980741Z","level":"info","event":"📋 [2025-06-06 12:04:00]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.980792Z","level":"info","event":"📋 2025-06-06 12:04:00,970 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.980865Z","level":"info","event":"📋 [2025-06-06 12:04:00]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.980931Z","level":"info","event":"📋 2025-06-06 12:04:00,970 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.981011Z","level":"info","event":"📋 [2025-06-06 12:04:00]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.981062Z","level":"info","event":"📋 2025-06-06 12:04:00,970 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.981105Z","level":"info","event":"📋 [2025-06-06 12:04:00]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.981147Z","level":"info","event":"📋 2025-06-06 12:04:00,970 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.981188Z","level":"info","event":"📋 [2025-06-06 12:04:00] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.981266Z","level":"info","event":"📋 2025-06-06 12:04:00,970 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.981332Z","level":"info","event":"📋 [2025-06-06 12:04:00]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.981374Z","level":"info","event":"📋 2025-06-06 12:04:00,970 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.981432Z","level":"info","event":"📋 [2025-06-06 12:04:00]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.981489Z","level":"info","event":"📋 2025-06-06 12:04:00,970 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.981557Z","level":"info","event":"📋 [2025-06-06 12:04:00] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.981623Z","level":"info","event":"📋 2025-06-06 12:04:00,971 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.981683Z","level":"info","event":"📋 [2025-06-06 12:04:00] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.981743Z","level":"info","event":"📋 2025-06-06 12:04:00,974 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.981864Z","level":"info","event":"📋 [2025-06-06 12:04:00] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.981922Z","level":"info","event":"📋 2025-06-06 12:04:00,974 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.981984Z","level":"info","event":"📋 [2025-06-06 12:04:00] 📊 Starting enhanced comprehensive filtering with 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982036Z","level":"info","event":"📋 2025-06-06 12:04:00,974 - INFO - 📊 Starting enhanced comprehensive filtering with 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982085Z","level":"info","event":"📋 [2025-06-06 12:04:00] 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982138Z","level":"info","event":"📋 2025-06-06 12:04:00,975 - INFO - 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982199Z","level":"info","event":"📋 [2025-06-06 12:04:00]    After enhanced geographic filter: 5 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982260Z","level":"info","event":"📋 2025-06-06 12:04:00,975 - INFO -    After enhanced geographic filter: 5 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982321Z","level":"info","event":"📋 [2025-06-06 12:04:00] ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982378Z","level":"info","event":"📋 2025-06-06 12:04:00,975 - INFO - ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982429Z","level":"info","event":"📋 [2025-06-06 12:04:00]    After quality filter: 4 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982477Z","level":"info","event":"📋 2025-06-06 12:04:00,977 - INFO -    After quality filter: 4 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982525Z","level":"info","event":"📋 [2025-06-06 12:04:00] 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982574Z","level":"info","event":"📋 2025-06-06 12:04:00,977 - INFO - 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982624Z","level":"info","event":"📋 [2025-06-06 12:04:00]    After enhanced keyword filter: 0 articles (removed 4)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982681Z","level":"info","event":"📋 2025-06-06 12:04:00,977 - INFO -    After enhanced keyword filter: 0 articles (removed 4)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982735Z","level":"info","event":"📋 [2025-06-06 12:04:00] 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982790Z","level":"info","event":"📋 2025-06-06 12:04:00,977 - INFO - 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982849Z","level":"info","event":"📋 [2025-06-06 12:04:00]    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982898Z","level":"info","event":"📋 2025-06-06 12:04:00,978 - INFO -    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.982945Z","level":"info","event":"📋 [2025-06-06 12:04:00] 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.983101Z","level":"info","event":"📋 2025-06-06 12:04:00,978 - INFO - 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.983164Z","level":"info","event":"📋 [2025-06-06 12:04:00]    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.983270Z","level":"info","event":"📋 2025-06-06 12:04:00,978 - INFO -    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.983320Z","level":"info","event":"📋 [2025-06-06 12:04:00] ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.987034Z","level":"info","event":"📋 2025-06-06 12:04:00,978 - INFO - ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.988006Z","level":"info","event":"📋 [2025-06-06 12:04:00]    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.990978Z","level":"info","event":"📋 2025-06-06 12:04:00,978 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.991101Z","level":"info","event":"📋 [2025-06-06 12:04:00] 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.991281Z","level":"info","event":"📋 2025-06-06 12:04:00,978 - INFO - 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.991481Z","level":"info","event":"📋 [2025-06-06 12:04:00] 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.991533Z","level":"info","event":"📋 2025-06-06 12:04:00,983 - INFO - 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.991572Z","level":"info","event":"📋 [2025-06-06 12:04:00] ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.991619Z","level":"info","event":"📋 2025-06-06 12:04:00,983 - WARNING - ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.991671Z","level":"info","event":"📋 [2025-06-06 12:04:00] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:00.991752Z","level":"info","event":"📋 2025-06-06 12:04:00,983 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:01.074314Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:01.074458Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:01.074597Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_20250606.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:01.074723Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_sem_vitimas_20250606.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:01.074861Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_log_20250606.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:01.074946Z","level":"info","event":"⚠️ stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_stats_20250606.json (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T11:04:01.077019","level":"info","event":"Done. Returned value was: [2025-06-06 12:04:00] Starting filtrar_artigos_vitimas_airflow\n2025-06-06 12:04:00,966 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-06 12:04:00] Parameters: dias=1, date=2025-06-06\n2025-06-06 12:04:00,966 - INFO - Parameters: dias=1, date=2025-06-06\n[2025-06-06 12:04:00] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06\n2025-06-06 12:04:00,966 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06\n[2025-06-06 12:04:00] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n2025-06-06 12:04:00,966 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n[2025-06-06 12:04:00] 🔍 Path setup:\n2025-06-06 12:04:00,967 - INFO - 🔍 Path setup:\n[2025-06-06 12:04:00]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-06 12:04:00,967 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-06 12:04:00]    Project root: /opt/airflow\n2025-06-06 12:04:00,967 - INFO -    Project root: /opt/airflow\n[2025-06-06 12:04:00] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n2025-06-06 12:04:00,967 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n[2025-06-06 12:04:00] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 12:04:00,967 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 12:04:00] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 12:04:00,967 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 12:04:00] ==================================================\n2025-06-06 12:04:00,969 - INFO - ==================================================\n[2025-06-06 12:04:00] Enhanced Filtering Started\n2025-06-06 12:04:00,969 - INFO - Enhanced Filtering Started\n[2025-06-06 12:04:00] ==================================================\n2025-06-06 12:04:00,969 - INFO - ==================================================\n[2025-06-06 12:04:00]   Total Articles Loaded: 5\n2025-06-06 12:04:00,969 - INFO -   Total Articles Loaded: 5\n[2025-06-06 12:04:00]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 12:04:00,969 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 12:04:00]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv\n2025-06-06 12:04:00,969 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv\n[2025-06-06 12:04:00]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n2025-06-06 12:04:00,969 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n[2025-06-06 12:04:00]   Days Filter: 1\n2025-06-06 12:04:00,969 - INFO -   Days Filter: 1\n[2025-06-06 12:04:00] ==================================================\n2025-06-06 12:04:00,970 - INFO - ==================================================\n[2025-06-06 12:04:00] 🔍 Applying enhanced comprehensive filtering logic...\n2025-06-06 12:04:00,970 - INFO - 🔍 Applying enhanced comprehensive filtering logic...\n[2025-06-06 12:04:00] 🔧 Loading configuration data for enhanced filtering...\n2025-06-06 12:04:00,970 - INFO - 🔧 Loading configuration data for enhanced filtering...\n[2025-06-06 12:04:00] 🔍 Looking for config files in multiple paths:\n2025-06-06 12:04:00,970 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-06 12:04:00]    Checking: /opt/airflow/config\n2025-06-06 12:04:00,970 - INFO -    Checking: /opt/airflow/config\n[2025-06-06 12:04:00]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-06 12:04:00,970 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-06 12:04:00]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-06 12:04:00,970 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-06 12:04:00]    Checking: config\n2025-06-06 12:04:00,970 - INFO -    Checking: config\n[2025-06-06 12:04:00] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-06 12:04:00,970 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-06 12:04:00]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-06 12:04:00,970 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-06 12:04:00]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-06 12:04:00,970 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-06 12:04:00] ✅ Loaded municipios config with 29 districts\n2025-06-06 12:04:00,971 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-06 12:04:00] ✅ Loaded eventos config with 14 events\n2025-06-06 12:04:00,974 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-06 12:04:00] 📊 Config summary: 29 districts, 306 parishes\n2025-06-06 12:04:00,974 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-06 12:04:00] 📊 Starting enhanced comprehensive filtering with 5 articles\n2025-06-06 12:04:00,974 - INFO - 📊 Starting enhanced comprehensive filtering with 5 articles\n[2025-06-06 12:04:00] 🇵🇹 Applying enhanced geographic filter...\n2025-06-06 12:04:00,975 - INFO - 🇵🇹 Applying enhanced geographic filter...\n[2025-06-06 12:04:00]    After enhanced geographic filter: 5 articles (removed 0)\n2025-06-06 12:04:00,975 - INFO -    After enhanced geographic filter: 5 articles (removed 0)\n[2025-06-06 12:04:00] ✨ Applying content quality filter...\n2025-06-06 12:04:00,975 - INFO - ✨ Applying content quality filter...\n[2025-06-06 12:04:00]    After quality filter: 4 articles (removed 1)\n2025-06-06 12:04:00,977 - INFO -    After quality filter: 4 articles (removed 1)\n[2025-06-06 12:04:00] 🔍 Applying enhanced keyword filtering...\n2025-06-06 12:04:00,977 - INFO - 🔍 Applying enhanced keyword filtering...\n[2025-06-06 12:04:00]    After enhanced keyword filter: 0 articles (removed 4)\n2025-06-06 12:04:00,977 - INFO -    After enhanced keyword filter: 0 articles (removed 4)\n[2025-06-06 12:04:00] 📅 Applying temporal relevance filter...\n2025-06-06 12:04:00,977 - INFO - 📅 Applying temporal relevance filter...\n[2025-06-06 12:04:00]    After temporal filter: 0 articles (removed 0)\n2025-06-06 12:04:00,978 - INFO -    After temporal filter: 0 articles (removed 0)\n[2025-06-06 12:04:00] 👥 Applying enhanced victim validation...\n2025-06-06 12:04:00,978 - INFO - 👥 Applying enhanced victim validation...\n[2025-06-06 12:04:00]    After victim validation: 0 articles (removed 0)\n2025-06-06 12:04:00,978 - INFO -    After victim validation: 0 articles (removed 0)\n[2025-06-06 12:04:00] ⭐ Calculating enhanced relevance scores...\n2025-06-06 12:04:00,978 - INFO - ⭐ Calculating enhanced relevance scores...\n[2025-06-06 12:04:00]    After relevance score filter (min 2): 0 articles (removed 0)\n2025-06-06 12:04:00,978 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)\n[2025-06-06 12:04:00] 🔄 Removing duplicates with enhanced logic...\n2025-06-06 12:04:00,978 - INFO - 🔄 Removing duplicates with enhanced logic...\n[2025-06-06 12:04:00] 🌦️ Enhanced climate event identification...\n2025-06-06 12:04:00,983 - INFO - 🌦️ Enhanced climate event identification...\n[2025-06-06 12:04:00] ⚠️ No articles remaining after enhanced filtering.\n2025-06-06 12:04:00,983 - WARNING - ⚠️ No articles remaining after enhanced filtering.\n[2025-06-06 12:04:00] ✅ Filtering completed. Found 0 articles with victims\n2025-06-06 12:04:00,983 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-06T13:59:33.546917","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-06T13:59:33.547612","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-06T13:59:33.612090Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.613227Z","level":"info","event":"📁 Using paths from processar task: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.617893Z","level":"info","event":"📅 Using provided execution date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.618592Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/06', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/06', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/06']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.618765Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.618870Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.618943Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.619008Z","level":"info","event":"  - Target date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.619088Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.625121Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.625324Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.625510Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.625614Z","level":"info","event":"  - victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.625684Z","level":"info","event":"  - no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_sem_vitimas_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.625797Z","level":"info","event":"  - filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_log_20250606.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.625929Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.626033Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/06 --date_str 2025-06-06 --date 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:33.627141Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.644855Z","level":"info","event":"📋 [2025-06-06 14:59:35] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.645775Z","level":"info","event":"📋 2025-06-06 14:59:35,644 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.645959Z","level":"info","event":"📋 [2025-06-06 14:59:35] Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.646153Z","level":"info","event":"📋 2025-06-06 14:59:35,644 - INFO - Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.646363Z","level":"info","event":"📋 [2025-06-06 14:59:35] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.646525Z","level":"info","event":"📋 2025-06-06 14:59:35,644 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.646694Z","level":"info","event":"📋 [2025-06-06 14:59:35] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.646812Z","level":"info","event":"📋 2025-06-06 14:59:35,644 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.646918Z","level":"info","event":"📋 [2025-06-06 14:59:35] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.647030Z","level":"info","event":"📋 2025-06-06 14:59:35,645 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.647128Z","level":"info","event":"📋 [2025-06-06 14:59:35]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.647230Z","level":"info","event":"📋 2025-06-06 14:59:35,645 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.647330Z","level":"info","event":"📋 [2025-06-06 14:59:35]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.647435Z","level":"info","event":"📋 2025-06-06 14:59:35,645 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.647534Z","level":"info","event":"📋 [2025-06-06 14:59:35] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.647638Z","level":"info","event":"📋 2025-06-06 14:59:35,645 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.647739Z","level":"info","event":"📋 [2025-06-06 14:59:35] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.647851Z","level":"info","event":"📋 2025-06-06 14:59:35,645 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.647957Z","level":"info","event":"📋 [2025-06-06 14:59:35] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.648115Z","level":"info","event":"📋 2025-06-06 14:59:35,645 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.648532Z","level":"info","event":"📋 [2025-06-06 14:59:35] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.648668Z","level":"info","event":"📋 2025-06-06 14:59:35,648 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.648807Z","level":"info","event":"📋 [2025-06-06 14:59:35] Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.648902Z","level":"info","event":"📋 2025-06-06 14:59:35,648 - INFO - Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.649002Z","level":"info","event":"📋 [2025-06-06 14:59:35] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.649096Z","level":"info","event":"📋 2025-06-06 14:59:35,648 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.649242Z","level":"info","event":"📋 [2025-06-06 14:59:35]   Total Articles Loaded: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.649339Z","level":"info","event":"📋 2025-06-06 14:59:35,648 - INFO -   Total Articles Loaded: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.649464Z","level":"info","event":"📋 [2025-06-06 14:59:35]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.649576Z","level":"info","event":"📋 2025-06-06 14:59:35,648 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.649645Z","level":"info","event":"📋 [2025-06-06 14:59:35]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.649716Z","level":"info","event":"📋 2025-06-06 14:59:35,648 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.649789Z","level":"info","event":"📋 [2025-06-06 14:59:35]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.649873Z","level":"info","event":"📋 2025-06-06 14:59:35,648 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.649949Z","level":"info","event":"📋 [2025-06-06 14:59:35]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.650026Z","level":"info","event":"📋 2025-06-06 14:59:35,648 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.650096Z","level":"info","event":"📋 [2025-06-06 14:59:35] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.650157Z","level":"info","event":"📋 2025-06-06 14:59:35,648 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.650238Z","level":"info","event":"📋 [2025-06-06 14:59:35] 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.650308Z","level":"info","event":"📋 2025-06-06 14:59:35,648 - INFO - 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.650415Z","level":"info","event":"📋 [2025-06-06 14:59:35] 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.650510Z","level":"info","event":"📋 2025-06-06 14:59:35,648 - INFO - 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.650593Z","level":"info","event":"📋 [2025-06-06 14:59:35] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.650681Z","level":"info","event":"📋 2025-06-06 14:59:35,648 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.650830Z","level":"info","event":"📋 [2025-06-06 14:59:35]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.651075Z","level":"info","event":"📋 2025-06-06 14:59:35,648 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.651156Z","level":"info","event":"📋 [2025-06-06 14:59:35]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.651277Z","level":"info","event":"📋 2025-06-06 14:59:35,648 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.651369Z","level":"info","event":"📋 [2025-06-06 14:59:35]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.651460Z","level":"info","event":"📋 2025-06-06 14:59:35,648 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.651548Z","level":"info","event":"📋 [2025-06-06 14:59:35]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.651617Z","level":"info","event":"📋 2025-06-06 14:59:35,648 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.651676Z","level":"info","event":"📋 [2025-06-06 14:59:35] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.651734Z","level":"info","event":"📋 2025-06-06 14:59:35,649 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.651819Z","level":"info","event":"📋 [2025-06-06 14:59:35]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.651892Z","level":"info","event":"📋 2025-06-06 14:59:35,649 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.651949Z","level":"info","event":"📋 [2025-06-06 14:59:35]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.652006Z","level":"info","event":"📋 2025-06-06 14:59:35,649 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.652063Z","level":"info","event":"📋 [2025-06-06 14:59:35] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.652120Z","level":"info","event":"📋 2025-06-06 14:59:35,650 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.652177Z","level":"info","event":"📋 [2025-06-06 14:59:35] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.652284Z","level":"info","event":"📋 2025-06-06 14:59:35,651 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.652341Z","level":"info","event":"📋 [2025-06-06 14:59:35] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.652401Z","level":"info","event":"📋 2025-06-06 14:59:35,651 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.652478Z","level":"info","event":"📋 [2025-06-06 14:59:35] 📊 Starting enhanced comprehensive filtering with 7 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.652535Z","level":"info","event":"📋 2025-06-06 14:59:35,651 - INFO - 📊 Starting enhanced comprehensive filtering with 7 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.652923Z","level":"info","event":"📋 [2025-06-06 14:59:35] 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.653028Z","level":"info","event":"📋 2025-06-06 14:59:35,652 - INFO - 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.653627Z","level":"info","event":"📋 [2025-06-06 14:59:35]    After enhanced geographic filter: 7 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.653711Z","level":"info","event":"📋 2025-06-06 14:59:35,653 - INFO -    After enhanced geographic filter: 7 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.653796Z","level":"info","event":"📋 [2025-06-06 14:59:35] ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.653856Z","level":"info","event":"📋 2025-06-06 14:59:35,653 - INFO - ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.655179Z","level":"info","event":"📋 [2025-06-06 14:59:35]    After quality filter: 4 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.655281Z","level":"info","event":"📋 2025-06-06 14:59:35,655 - INFO -    After quality filter: 4 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.655368Z","level":"info","event":"📋 [2025-06-06 14:59:35] 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.655425Z","level":"info","event":"📋 2025-06-06 14:59:35,655 - INFO - 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.655593Z","level":"info","event":"📋 [2025-06-06 14:59:35]    After enhanced keyword filter: 0 articles (removed 4)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.655668Z","level":"info","event":"📋 2025-06-06 14:59:35,655 - INFO -    After enhanced keyword filter: 0 articles (removed 4)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.655729Z","level":"info","event":"📋 [2025-06-06 14:59:35] 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.655798Z","level":"info","event":"📋 2025-06-06 14:59:35,655 - INFO - 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.656372Z","level":"info","event":"📋 [2025-06-06 14:59:35]    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.656464Z","level":"info","event":"📋 2025-06-06 14:59:35,656 - INFO -    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.656555Z","level":"info","event":"📋 [2025-06-06 14:59:35] 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.656639Z","level":"info","event":"📋 2025-06-06 14:59:35,656 - INFO - 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.656848Z","level":"info","event":"📋 [2025-06-06 14:59:35]    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.656927Z","level":"info","event":"📋 2025-06-06 14:59:35,656 - INFO -    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.656997Z","level":"info","event":"📋 [2025-06-06 14:59:35] ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.657074Z","level":"info","event":"📋 2025-06-06 14:59:35,656 - INFO - ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.657656Z","level":"info","event":"📋 [2025-06-06 14:59:35]    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.657769Z","level":"info","event":"📋 2025-06-06 14:59:35,657 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.657863Z","level":"info","event":"📋 [2025-06-06 14:59:35] 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.657940Z","level":"info","event":"📋 2025-06-06 14:59:35,657 - INFO - 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.658652Z","level":"info","event":"📋 [2025-06-06 14:59:35] 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.658746Z","level":"info","event":"📋 2025-06-06 14:59:35,658 - INFO - 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.658855Z","level":"info","event":"📋 [2025-06-06 14:59:35] ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.658926Z","level":"info","event":"📋 2025-06-06 14:59:35,658 - WARNING - ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.658994Z","level":"info","event":"📋 [2025-06-06 14:59:35] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.659052Z","level":"info","event":"📋 2025-06-06 14:59:35,658 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.767584Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.767837Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.768063Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_20250606.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.768235Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_sem_vitimas_20250606.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.768371Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_log_20250606.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.768501Z","level":"info","event":"⚠️ stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_stats_20250606.json (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T13:59:35.768964","level":"info","event":"Done. Returned value was: [2025-06-06 14:59:35] Starting filtrar_artigos_vitimas_airflow\n2025-06-06 14:59:35,644 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-06 14:59:35] Parameters: dias=1, date=2025-06-06\n2025-06-06 14:59:35,644 - INFO - Parameters: dias=1, date=2025-06-06\n[2025-06-06 14:59:35] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06\n2025-06-06 14:59:35,644 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06\n[2025-06-06 14:59:35] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n2025-06-06 14:59:35,644 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n[2025-06-06 14:59:35] 🔍 Path setup:\n2025-06-06 14:59:35,645 - INFO - 🔍 Path setup:\n[2025-06-06 14:59:35]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-06 14:59:35,645 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-06 14:59:35]    Project root: /opt/airflow\n2025-06-06 14:59:35,645 - INFO -    Project root: /opt/airflow\n[2025-06-06 14:59:35] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n2025-06-06 14:59:35,645 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n[2025-06-06 14:59:35] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 14:59:35,645 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 14:59:35] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 14:59:35,645 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 14:59:35] ==================================================\n2025-06-06 14:59:35,648 - INFO - ==================================================\n[2025-06-06 14:59:35] Enhanced Filtering Started\n2025-06-06 14:59:35,648 - INFO - Enhanced Filtering Started\n[2025-06-06 14:59:35] ==================================================\n2025-06-06 14:59:35,648 - INFO - ==================================================\n[2025-06-06 14:59:35]   Total Articles Loaded: 7\n2025-06-06 14:59:35,648 - INFO -   Total Articles Loaded: 7\n[2025-06-06 14:59:35]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 14:59:35,648 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 14:59:35]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv\n2025-06-06 14:59:35,648 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv\n[2025-06-06 14:59:35]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n2025-06-06 14:59:35,648 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n[2025-06-06 14:59:35]   Days Filter: 1\n2025-06-06 14:59:35,648 - INFO -   Days Filter: 1\n[2025-06-06 14:59:35] ==================================================\n2025-06-06 14:59:35,648 - INFO - ==================================================\n[2025-06-06 14:59:35] 🔍 Applying enhanced comprehensive filtering logic...\n2025-06-06 14:59:35,648 - INFO - 🔍 Applying enhanced comprehensive filtering logic...\n[2025-06-06 14:59:35] 🔧 Loading configuration data for enhanced filtering...\n2025-06-06 14:59:35,648 - INFO - 🔧 Loading configuration data for enhanced filtering...\n[2025-06-06 14:59:35] 🔍 Looking for config files in multiple paths:\n2025-06-06 14:59:35,648 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-06 14:59:35]    Checking: /opt/airflow/config\n2025-06-06 14:59:35,648 - INFO -    Checking: /opt/airflow/config\n[2025-06-06 14:59:35]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-06 14:59:35,648 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-06 14:59:35]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-06 14:59:35,648 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-06 14:59:35]    Checking: config\n2025-06-06 14:59:35,648 - INFO -    Checking: config\n[2025-06-06 14:59:35] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-06 14:59:35,649 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-06 14:59:35]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-06 14:59:35,649 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-06 14:59:35]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-06 14:59:35,649 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-06 14:59:35] ✅ Loaded municipios config with 29 districts\n2025-06-06 14:59:35,650 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-06 14:59:35] ✅ Loaded eventos config with 14 events\n2025-06-06 14:59:35,651 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-06 14:59:35] 📊 Config summary: 29 districts, 306 parishes\n2025-06-06 14:59:35,651 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-06 14:59:35] 📊 Starting enhanced comprehensive filtering with 7 articles\n2025-06-06 14:59:35,651 - INFO - 📊 Starting enhanced comprehensive filtering with 7 articles\n[2025-06-06 14:59:35] 🇵🇹 Applying enhanced geographic filter...\n2025-06-06 14:59:35,652 - INFO - 🇵🇹 Applying enhanced geographic filter...\n[2025-06-06 14:59:35]    After enhanced geographic filter: 7 articles (removed 0)\n2025-06-06 14:59:35,653 - INFO -    After enhanced geographic filter: 7 articles (removed 0)\n[2025-06-06 14:59:35] ✨ Applying content quality filter...\n2025-06-06 14:59:35,653 - INFO - ✨ Applying content quality filter...\n[2025-06-06 14:59:35]    After quality filter: 4 articles (removed 3)\n2025-06-06 14:59:35,655 - INFO -    After quality filter: 4 articles (removed 3)\n[2025-06-06 14:59:35] 🔍 Applying enhanced keyword filtering...\n2025-06-06 14:59:35,655 - INFO - 🔍 Applying enhanced keyword filtering...\n[2025-06-06 14:59:35]    After enhanced keyword filter: 0 articles (removed 4)\n2025-06-06 14:59:35,655 - INFO -    After enhanced keyword filter: 0 articles (removed 4)\n[2025-06-06 14:59:35] 📅 Applying temporal relevance filter...\n2025-06-06 14:59:35,655 - INFO - 📅 Applying temporal relevance filter...\n[2025-06-06 14:59:35]    After temporal filter: 0 articles (removed 0)\n2025-06-06 14:59:35,656 - INFO -    After temporal filter: 0 articles (removed 0)\n[2025-06-06 14:59:35] 👥 Applying enhanced victim validation...\n2025-06-06 14:59:35,656 - INFO - 👥 Applying enhanced victim validation...\n[2025-06-06 14:59:35]    After victim validation: 0 articles (removed 0)\n2025-06-06 14:59:35,656 - INFO -    After victim validation: 0 articles (removed 0)\n[2025-06-06 14:59:35] ⭐ Calculating enhanced relevance scores...\n2025-06-06 14:59:35,656 - INFO - ⭐ Calculating enhanced relevance scores...\n[2025-06-06 14:59:35]    After relevance score filter (min 2): 0 articles (removed 0)\n2025-06-06 14:59:35,657 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)\n[2025-06-06 14:59:35] 🔄 Removing duplicates with enhanced logic...\n2025-06-06 14:59:35,657 - INFO - 🔄 Removing duplicates with enhanced logic...\n[2025-06-06 14:59:35] 🌦️ Enhanced climate event identification...\n2025-06-06 14:59:35,658 - INFO - 🌦️ Enhanced climate event identification...\n[2025-06-06 14:59:35] ⚠️ No articles remaining after enhanced filtering.\n2025-06-06 14:59:35,658 - WARNING - ⚠️ No articles remaining after enhanced filtering.\n[2025-06-06 14:59:35] ✅ Filtering completed. Found 0 articles with victims\n2025-06-06 14:59:35,658 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-06T14:16:07.636704","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-06T14:16:07.637236","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-06T14:16:07.681715Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.687870Z","level":"info","event":"📁 Using paths from processar task: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.687993Z","level":"info","event":"📅 Using provided execution date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.688436Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/06', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/06', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/06']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.688575Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.688676Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.688775Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.688874Z","level":"info","event":"  - Target date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.688967Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.693808Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.694469Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.694625Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.694997Z","level":"info","event":"  - victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.695183Z","level":"info","event":"  - no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_sem_vitimas_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.695352Z","level":"info","event":"  - filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_log_20250606.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.695491Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.695622Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/06 --date_str 2025-06-06 --date 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:07.695833Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.860296Z","level":"info","event":"📋 [2025-06-06 15:16:09] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.862269Z","level":"info","event":"📋 2025-06-06 15:16:09,860 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.862991Z","level":"info","event":"📋 [2025-06-06 15:16:09] Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.863133Z","level":"info","event":"📋 2025-06-06 15:16:09,860 - INFO - Parameters: dias=1, date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.863219Z","level":"info","event":"📋 [2025-06-06 15:16:09] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.863300Z","level":"info","event":"📋 2025-06-06 15:16:09,860 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.863382Z","level":"info","event":"📋 [2025-06-06 15:16:09] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.863472Z","level":"info","event":"📋 2025-06-06 15:16:09,860 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.863561Z","level":"info","event":"📋 [2025-06-06 15:16:09] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.863650Z","level":"info","event":"📋 2025-06-06 15:16:09,860 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.863838Z","level":"info","event":"📋 [2025-06-06 15:16:09]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.865994Z","level":"info","event":"📋 2025-06-06 15:16:09,860 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.866093Z","level":"info","event":"📋 [2025-06-06 15:16:09]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.866159Z","level":"info","event":"📋 2025-06-06 15:16:09,860 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.866222Z","level":"info","event":"📋 [2025-06-06 15:16:09] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.866287Z","level":"info","event":"📋 2025-06-06 15:16:09,860 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.866388Z","level":"info","event":"📋 [2025-06-06 15:16:09] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.866464Z","level":"info","event":"📋 2025-06-06 15:16:09,862 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.866526Z","level":"info","event":"📋 [2025-06-06 15:16:09] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.866699Z","level":"info","event":"📋 2025-06-06 15:16:09,862 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.866839Z","level":"info","event":"📋 [2025-06-06 15:16:09] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.866914Z","level":"info","event":"📋 2025-06-06 15:16:09,866 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.867047Z","level":"info","event":"📋 [2025-06-06 15:16:09] Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.867182Z","level":"info","event":"📋 2025-06-06 15:16:09,867 - INFO - Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.867254Z","level":"info","event":"📋 [2025-06-06 15:16:09] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.867373Z","level":"info","event":"📋 2025-06-06 15:16:09,867 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.867439Z","level":"info","event":"📋 [2025-06-06 15:16:09]   Total Articles Loaded: 15","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.867571Z","level":"info","event":"📋 2025-06-06 15:16:09,867 - INFO -   Total Articles Loaded: 15","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.867637Z","level":"info","event":"📋 [2025-06-06 15:16:09]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.867814Z","level":"info","event":"📋 2025-06-06 15:16:09,867 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.867885Z","level":"info","event":"📋 [2025-06-06 15:16:09]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.867950Z","level":"info","event":"📋 2025-06-06 15:16:09,867 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.868012Z","level":"info","event":"📋 [2025-06-06 15:16:09]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.868091Z","level":"info","event":"📋 2025-06-06 15:16:09,867 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.868164Z","level":"info","event":"📋 [2025-06-06 15:16:09]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.868290Z","level":"info","event":"📋 2025-06-06 15:16:09,868 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.868382Z","level":"info","event":"📋 [2025-06-06 15:16:09] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.868948Z","level":"info","event":"📋 2025-06-06 15:16:09,868 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.869142Z","level":"info","event":"📋 [2025-06-06 15:16:09] 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.869459Z","level":"info","event":"📋 2025-06-06 15:16:09,868 - INFO - 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.869570Z","level":"info","event":"📋 [2025-06-06 15:16:09] 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.870765Z","level":"info","event":"📋 2025-06-06 15:16:09,868 - INFO - 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.870851Z","level":"info","event":"📋 [2025-06-06 15:16:09] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.870921Z","level":"info","event":"📋 2025-06-06 15:16:09,868 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.870994Z","level":"info","event":"📋 [2025-06-06 15:16:09]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.871054Z","level":"info","event":"📋 2025-06-06 15:16:09,868 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.871111Z","level":"info","event":"📋 [2025-06-06 15:16:09]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.871170Z","level":"info","event":"📋 2025-06-06 15:16:09,868 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.871228Z","level":"info","event":"📋 [2025-06-06 15:16:09]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.871284Z","level":"info","event":"📋 2025-06-06 15:16:09,868 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.871341Z","level":"info","event":"📋 [2025-06-06 15:16:09]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.871400Z","level":"info","event":"📋 2025-06-06 15:16:09,868 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.871497Z","level":"info","event":"📋 [2025-06-06 15:16:09] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.871593Z","level":"info","event":"📋 2025-06-06 15:16:09,869 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.871673Z","level":"info","event":"📋 [2025-06-06 15:16:09]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.871916Z","level":"info","event":"📋 2025-06-06 15:16:09,869 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.872521Z","level":"info","event":"📋 [2025-06-06 15:16:09]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.875479Z","level":"info","event":"📋 2025-06-06 15:16:09,869 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.875578Z","level":"info","event":"📋 [2025-06-06 15:16:09] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.875644Z","level":"info","event":"📋 2025-06-06 15:16:09,871 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.875778Z","level":"info","event":"📋 [2025-06-06 15:16:09] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.875870Z","level":"info","event":"📋 2025-06-06 15:16:09,872 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.875931Z","level":"info","event":"📋 [2025-06-06 15:16:09] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.876004Z","level":"info","event":"📋 2025-06-06 15:16:09,872 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.876088Z","level":"info","event":"📋 [2025-06-06 15:16:09] 📊 Starting enhanced comprehensive filtering with 15 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.876146Z","level":"info","event":"📋 2025-06-06 15:16:09,872 - INFO - 📊 Starting enhanced comprehensive filtering with 15 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.876203Z","level":"info","event":"📋 [2025-06-06 15:16:09] 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.876260Z","level":"info","event":"📋 2025-06-06 15:16:09,873 - INFO - 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.876319Z","level":"info","event":"📋 [2025-06-06 15:16:09]    After enhanced geographic filter: 14 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.876375Z","level":"info","event":"📋 2025-06-06 15:16:09,874 - INFO -    After enhanced geographic filter: 14 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.876432Z","level":"info","event":"📋 [2025-06-06 15:16:09] ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.876513Z","level":"info","event":"📋 2025-06-06 15:16:09,874 - INFO - ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.876762Z","level":"info","event":"📋 [2025-06-06 15:16:09]    After quality filter: 11 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.876855Z","level":"info","event":"📋 2025-06-06 15:16:09,876 - INFO -    After quality filter: 11 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.876974Z","level":"info","event":"📋 [2025-06-06 15:16:09] 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.877053Z","level":"info","event":"📋 2025-06-06 15:16:09,876 - INFO - 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.877610Z","level":"info","event":"📋 [2025-06-06 15:16:09]    After enhanced keyword filter: 0 articles (removed 11)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.877692Z","level":"info","event":"📋 2025-06-06 15:16:09,877 - INFO -    After enhanced keyword filter: 0 articles (removed 11)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.878652Z","level":"info","event":"📋 [2025-06-06 15:16:09] 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.878739Z","level":"info","event":"📋 2025-06-06 15:16:09,877 - INFO - 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.879482Z","level":"info","event":"📋 [2025-06-06 15:16:09]    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.879571Z","level":"info","event":"📋 2025-06-06 15:16:09,879 - INFO -    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.879656Z","level":"info","event":"📋 [2025-06-06 15:16:09] 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.879847Z","level":"info","event":"📋 2025-06-06 15:16:09,879 - INFO - 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.880329Z","level":"info","event":"📋 [2025-06-06 15:16:09]    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.880433Z","level":"info","event":"📋 2025-06-06 15:16:09,880 - INFO -    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.880547Z","level":"info","event":"📋 [2025-06-06 15:16:09] ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.880690Z","level":"info","event":"📋 2025-06-06 15:16:09,880 - INFO - ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.881557Z","level":"info","event":"📋 [2025-06-06 15:16:09]    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.881639Z","level":"info","event":"📋 2025-06-06 15:16:09,881 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.881756Z","level":"info","event":"📋 [2025-06-06 15:16:09] 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.881874Z","level":"info","event":"📋 2025-06-06 15:16:09,881 - INFO - 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.882437Z","level":"info","event":"📋 [2025-06-06 15:16:09] 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.882546Z","level":"info","event":"📋 2025-06-06 15:16:09,882 - INFO - 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.882690Z","level":"info","event":"📋 [2025-06-06 15:16:09] ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.882819Z","level":"info","event":"📋 2025-06-06 15:16:09,882 - WARNING - ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.882942Z","level":"info","event":"📋 [2025-06-06 15:16:09] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:09.883081Z","level":"info","event":"📋 2025-06-06 15:16:09,882 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:10.002510Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:10.002823Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:10.003071Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_20250606.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:10.003216Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_sem_vitimas_20250606.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:10.003398Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_log_20250606.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:10.003536Z","level":"info","event":"⚠️ stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/filtering_stats_20250606.json (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:16:10.004245","level":"info","event":"Done. Returned value was: [2025-06-06 15:16:09] Starting filtrar_artigos_vitimas_airflow\n2025-06-06 15:16:09,860 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-06 15:16:09] Parameters: dias=1, date=2025-06-06\n2025-06-06 15:16:09,860 - INFO - Parameters: dias=1, date=2025-06-06\n[2025-06-06 15:16:09] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06\n2025-06-06 15:16:09,860 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06\n[2025-06-06 15:16:09] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n2025-06-06 15:16:09,860 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n[2025-06-06 15:16:09] 🔍 Path setup:\n2025-06-06 15:16:09,860 - INFO - 🔍 Path setup:\n[2025-06-06 15:16:09]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-06 15:16:09,860 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-06 15:16:09]    Project root: /opt/airflow\n2025-06-06 15:16:09,860 - INFO -    Project root: /opt/airflow\n[2025-06-06 15:16:09] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n2025-06-06 15:16:09,860 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n[2025-06-06 15:16:09] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 15:16:09,862 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 15:16:09] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 15:16:09,862 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 15:16:09] ==================================================\n2025-06-06 15:16:09,866 - INFO - ==================================================\n[2025-06-06 15:16:09] Enhanced Filtering Started\n2025-06-06 15:16:09,867 - INFO - Enhanced Filtering Started\n[2025-06-06 15:16:09] ==================================================\n2025-06-06 15:16:09,867 - INFO - ==================================================\n[2025-06-06 15:16:09]   Total Articles Loaded: 15\n2025-06-06 15:16:09,867 - INFO -   Total Articles Loaded: 15\n[2025-06-06 15:16:09]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 15:16:09,867 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 15:16:09]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv\n2025-06-06 15:16:09,867 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_2025-06-06.csv\n[2025-06-06 15:16:09]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n2025-06-06 15:16:09,867 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n[2025-06-06 15:16:09]   Days Filter: 1\n2025-06-06 15:16:09,868 - INFO -   Days Filter: 1\n[2025-06-06 15:16:09] ==================================================\n2025-06-06 15:16:09,868 - INFO - ==================================================\n[2025-06-06 15:16:09] 🔍 Applying enhanced comprehensive filtering logic...\n2025-06-06 15:16:09,868 - INFO - 🔍 Applying enhanced comprehensive filtering logic...\n[2025-06-06 15:16:09] 🔧 Loading configuration data for enhanced filtering...\n2025-06-06 15:16:09,868 - INFO - 🔧 Loading configuration data for enhanced filtering...\n[2025-06-06 15:16:09] 🔍 Looking for config files in multiple paths:\n2025-06-06 15:16:09,868 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-06 15:16:09]    Checking: /opt/airflow/config\n2025-06-06 15:16:09,868 - INFO -    Checking: /opt/airflow/config\n[2025-06-06 15:16:09]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-06 15:16:09,868 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-06 15:16:09]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-06 15:16:09,868 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-06 15:16:09]    Checking: config\n2025-06-06 15:16:09,868 - INFO -    Checking: config\n[2025-06-06 15:16:09] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-06 15:16:09,869 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-06 15:16:09]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-06 15:16:09,869 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-06 15:16:09]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-06 15:16:09,869 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-06 15:16:09] ✅ Loaded municipios config with 29 districts\n2025-06-06 15:16:09,871 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-06 15:16:09] ✅ Loaded eventos config with 14 events\n2025-06-06 15:16:09,872 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-06 15:16:09] 📊 Config summary: 29 districts, 306 parishes\n2025-06-06 15:16:09,872 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-06 15:16:09] 📊 Starting enhanced comprehensive filtering with 15 articles\n2025-06-06 15:16:09,872 - INFO - 📊 Starting enhanced comprehensive filtering with 15 articles\n[2025-06-06 15:16:09] 🇵🇹 Applying enhanced geographic filter...\n2025-06-06 15:16:09,873 - INFO - 🇵🇹 Applying enhanced geographic filter...\n[2025-06-06 15:16:09]    After enhanced geographic filter: 14 articles (removed 1)\n2025-06-06 15:16:09,874 - INFO -    After enhanced geographic filter: 14 articles (removed 1)\n[2025-06-06 15:16:09] ✨ Applying content quality filter...\n2025-06-06 15:16:09,874 - INFO - ✨ Applying content quality filter...\n[2025-06-06 15:16:09]    After quality filter: 11 articles (removed 3)\n2025-06-06 15:16:09,876 - INFO -    After quality filter: 11 articles (removed 3)\n[2025-06-06 15:16:09] 🔍 Applying enhanced keyword filtering...\n2025-06-06 15:16:09,876 - INFO - 🔍 Applying enhanced keyword filtering...\n[2025-06-06 15:16:09]    After enhanced keyword filter: 0 articles (removed 11)\n2025-06-06 15:16:09,877 - INFO -    After enhanced keyword filter: 0 articles (removed 11)\n[2025-06-06 15:16:09] 📅 Applying temporal relevance filter...\n2025-06-06 15:16:09,877 - INFO - 📅 Applying temporal relevance filter...\n[2025-06-06 15:16:09]    After temporal filter: 0 articles (removed 0)\n2025-06-06 15:16:09,879 - INFO -    After temporal filter: 0 articles (removed 0)\n[2025-06-06 15:16:09] 👥 Applying enhanced victim validation...\n2025-06-06 15:16:09,879 - INFO - 👥 Applying enhanced victim validation...\n[2025-06-06 15:16:09]    After victim validation: 0 articles (removed 0)\n2025-06-06 15:16:09,880 - INFO -    After victim validation: 0 articles (removed 0)\n[2025-06-06 15:16:09] ⭐ Calculating enhanced relevance scores...\n2025-06-06 15:16:09,880 - INFO - ⭐ Calculating enhanced relevance scores...\n[2025-06-06 15:16:09]    After relevance score filter (min 2): 0 articles (removed 0)\n2025-06-06 15:16:09,881 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)\n[2025-06-06 15:16:09] 🔄 Removing duplicates with enhanced logic...\n2025-06-06 15:16:09,881 - INFO - 🔄 Removing duplicates with enhanced logic...\n[2025-06-06 15:16:09] 🌦️ Enhanced climate event identification...\n2025-06-06 15:16:09,882 - INFO - 🌦️ Enhanced climate event identification...\n[2025-06-06 15:16:09] ⚠️ No articles remaining after enhanced filtering.\n2025-06-06 15:16:09,882 - WARNING - ⚠️ No articles remaining after enhanced filtering.\n[2025-06-06 15:16:09] ✅ Filtering completed. Found 0 articles with victims\n2025-06-06 15:16:09,882 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
