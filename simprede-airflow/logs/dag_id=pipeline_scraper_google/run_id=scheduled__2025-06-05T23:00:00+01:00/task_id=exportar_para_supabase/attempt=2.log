{"timestamp":"2025-06-06T14:40:05.027147","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-06T14:40:05.028946","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-06T14:40:05.323040Z","level":"info","event":"ğŸ”„ Starting export_supabase task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.324191Z","level":"info","event":"ğŸ“… Using current date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.325498Z","level":"info","event":"ğŸ“ Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/06', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/06', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/06']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.325806Z","level":"info","event":"ğŸ“… Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.325987Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.326158Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.326434Z","level":"info","event":"  - Target date: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.326692Z","level":"info","event":"  - Database table: artigos_filtrados_20250606_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.326811Z","level":"info","event":"ğŸ“ Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.361197Z","level":"info","event":"ğŸ“‹ Found 2 files from processar task via XCom","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.361648Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_vitimas_filtrados_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.362813Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/artigos_sem_vitimas_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.363726Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.364098Z","level":"info","event":"âœ… Found file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (3808 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.365451Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.366160Z","level":"info","event":"âœ… Found file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (3808 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.366656Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.367064Z","level":"info","event":"âœ… Found file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/processing_stats_20250606.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.367293Z","level":"info","event":"ğŸ“‹ Selected input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv (3808 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.367493Z","level":"info","event":"ğŸ“Š Processing all relevant disaster-related articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.367820Z","level":"info","event":"ğŸ“ Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.368100Z","level":"info","event":"  - export_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_log_20250606.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.368292Z","level":"info","event":"  - export_stats: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.368635Z","level":"info","event":"  - backup_csv: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_backup_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.368819Z","level":"info","event":"ğŸ”„ Running export command: python /opt/airflow/scripts/google_scraper/exportador_bd/export_to_supabase_airflow.py --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/06 --date_str 2025-06-06 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv --date 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:05.369102Z","level":"info","event":"â° Waiting for export completion with timeout: 600 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.962408Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] A iniciar export_to_supabase_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.979078Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,959 - INFO - A iniciar export_to_supabase_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.980012Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] ParÃ¢metros: date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.981891Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,959 - INFO - ParÃ¢metros: date=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.982106Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.982502Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,959 - INFO - Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.982806Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] ğŸš€ A iniciar exportaÃ§Ã£o para Supabase para a data: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.982978Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,959 - INFO - ğŸš€ A iniciar exportaÃ§Ã£o para Supabase para a data: 2025-06-06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.983279Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] ğŸ“‹ Tabela de destino: artigos_filtrados_20250606_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.983462Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,959 - INFO - ğŸ“‹ Tabela de destino: artigos_filtrados_20250606_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.983652Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] ğŸ“ A usar diretÃ³rio de saÃ­da controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.984731Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,960 - INFO - ğŸ“ A usar diretÃ³rio de saÃ­da controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.984987Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] âœ… A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.985989Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,960 - INFO - âœ… A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.986150Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] ğŸ“‚ A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.987251Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,960 - INFO - ğŸ“‚ A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.989598Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] ğŸ“Š Carregados 15 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.989844Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,983 - INFO - ğŸ“Š Carregados 15 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.990088Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] ğŸ“‹ A processar todos os artigos relevantes relacionados com desastres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.990309Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,983 - INFO - ğŸ“‹ A processar todos os artigos relevantes relacionados com desastres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.990567Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] ğŸ” VerificaÃ§Ã£o inicial do ambiente...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.990927Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,984 - INFO - ğŸ” VerificaÃ§Ã£o inicial do ambiente...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.991373Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   DB_HOST do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.991819Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,984 - INFO -   DB_HOST do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.992022Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   DB_USER do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.992436Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,984 - INFO -   DB_USER do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.992753Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   DB_PASSWORD do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.993086Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,984 - INFO -   DB_PASSWORD do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.993830Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] ğŸ” ConfiguraÃ§Ã£o da base de dados nÃ£o encontrada no ambiente, procurando ficheiro .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.994117Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,984 - INFO - ğŸ” ConfiguraÃ§Ã£o da base de dados nÃ£o encontrada no ambiente, procurando ficheiro .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.994397Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] ğŸ” Verificando 6 localizaÃ§Ãµes possÃ­veis do .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.994521Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,984 - INFO - ğŸ” Verificando 6 localizaÃ§Ãµes possÃ­veis do .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.994711Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   A verificar: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.994867Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,984 - INFO -   A verificar: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.995035Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   âŒ NÃ£o encontrado: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.995175Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,984 - INFO -   âŒ NÃ£o encontrado: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.995432Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   A verificar: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.995619Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,984 - INFO -   A verificar: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.995746Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] âœ… Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.995845Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,984 - INFO - âœ… Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.995967Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] ğŸ“„ Tamanho do ficheiro .env: 210 caracteres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.996120Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,985 - INFO - ğŸ“„ Tamanho do ficheiro .env: 210 caracteres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.996240Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   âœ… Definido DB_USER do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.996422Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,985 - INFO -   âœ… Definido DB_USER do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.996668Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   âœ… Definido DB_PASSWORD do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.996803Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,985 - INFO -   âœ… Definido DB_PASSWORD do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.996984Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   âœ… Definido DB_HOST do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.997090Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,985 - INFO -   âœ… Definido DB_HOST do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.997217Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   âœ… Definido DB_PORT do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.997324Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,985 - INFO -   âœ… Definido DB_PORT do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.997429Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   âœ… Definido DB_NAME do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.997548Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,985 - INFO -   âœ… Definido DB_NAME do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.997659Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   âœ… Definido DB_SCHEMA do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.997777Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,985 - INFO -   âœ… Definido DB_SCHEMA do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.997982Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] ğŸ” VerificaÃ§Ã£o final da configuraÃ§Ã£o...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.998174Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,987 - INFO - ğŸ” VerificaÃ§Ã£o final da configuraÃ§Ã£o...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.998278Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   DB_HOST: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.998361Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,987 - INFO -   DB_HOST: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.998454Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   DB_USER: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.998563Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,987 - INFO -   DB_USER: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.998645Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   DB_PASSWORD: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.998750Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,987 - INFO -   DB_PASSWORD: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.998846Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   DB_PORT: 6543","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.998924Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,987 - INFO -   DB_PORT: 6543","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.999003Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   DB_NAME: postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.999081Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,987 - INFO -   DB_NAME: postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.999175Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07]   DB_SCHEMA: google_scraper","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.999260Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,987 - INFO -   DB_SCHEMA: google_scraper","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.999339Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] âœ… ConfiguraÃ§Ã£o da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.999421Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,987 - INFO - âœ… ConfiguraÃ§Ã£o da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.999500Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:07] ğŸ”— A conectar Ã  base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:07.999575Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:07,987 - INFO - ğŸ”— A conectar Ã  base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:08.372816Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:08] âœ… Conectado Ã  base de dados com sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:08.373261Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:08,372 - INFO - âœ… Conectado Ã  base de dados com sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:08.431458Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:08] ğŸ—‘ï¸ Tabela existente google_scraper.artigos_filtrados_20250606_staging eliminada se existia","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:08.432139Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:08,431 - INFO - ğŸ—‘ï¸ Tabela existente google_scraper.artigos_filtrados_20250606_staging eliminada se existia","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:08.516684Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:08] âœ… Tabela google_scraper.artigos_filtrados_20250606_staging criada com esquema correto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:08.517378Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:08,515 - INFO - âœ… Tabela google_scraper.artigos_filtrados_20250606_staging criada com esquema correto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:08.611235Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:08] âœ… Ãndices criados para a tabela google_scraper.artigos_filtrados_20250606_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:08.620764Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:08,608 - INFO - âœ… Ãndices criados para a tabela google_scraper.artigos_filtrados_20250606_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:08.622918Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:08] ğŸ”§ A preparar dataframe para inserÃ§Ã£o na base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:08.624135Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:08,609 - INFO - ğŸ”§ A preparar dataframe para inserÃ§Ã£o na base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:08.624536Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:08] ğŸ“… A converter formatos de data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:08.625780Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:08,609 - INFO - ğŸ“… A converter formatos de data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:08.626187Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:08] âœ… Preparadas 15 linhas para inserÃ§Ã£o","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:08.626530Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:08,623 - INFO - âœ… Preparadas 15 linhas para inserÃ§Ã£o","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.343629Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:09] âœ… Inseridos/atualizados 15 artigos (falharam: 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.345721Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:09,343 - INFO - âœ… Inseridos/atualizados 15 artigos (falharam: 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.354092Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:09] ğŸ’¾ Backup de exportaÃ§Ã£o guardado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_backup_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.355109Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:09,353 - INFO - ğŸ’¾ Backup de exportaÃ§Ã£o guardado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_backup_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.356688Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:09] âœ… EstatÃ­sticas de exportaÃ§Ã£o guardadas: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.360657Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:09,355 - INFO - âœ… EstatÃ­sticas de exportaÃ§Ã£o guardadas: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_stats_20250606.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.363638Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:09] ğŸ“‹ LocalizaÃ§Ã£o de backup de exportaÃ§Ã£o preparada: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_backup_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.363999Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:09,356 - INFO - ğŸ“‹ LocalizaÃ§Ã£o de backup de exportaÃ§Ã£o preparada: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_backup_20250606.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.364448Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:09] âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Inseridos/atualizados 15 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250606_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.364982Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:09,356 - INFO - âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Inseridos/atualizados 15 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250606_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.366601Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:09] ğŸ”— LigaÃ§Ã£o Ã  base de dados fechada","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.367276Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:09,357 - INFO - ğŸ”— LigaÃ§Ã£o Ã  base de dados fechada","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.367769Z","level":"info","event":"ğŸ“‹ [2025-06-06 15:40:09] âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Processados 15 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.368405Z","level":"info","event":"ğŸ“‹ 2025-06-06 15:40:09,357 - INFO - âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Processados 15 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.546812Z","level":"info","event":"âœ… Export completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.547337Z","level":"info","event":"ğŸ” Verifying export outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.548057Z","level":"info","event":"âš ï¸ export_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_log_20250606.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.548353Z","level":"info","event":"âœ… export_stats: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_stats_20250606.json (931 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.548654Z","level":"info","event":"âœ… backup_csv: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_backup_20250606.csv (3799 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-06T14:40:09.554374","level":"info","event":"Done. Returned value was: [2025-06-06 15:40:07] A iniciar export_to_supabase_airflow\n2025-06-06 15:40:07,959 - INFO - A iniciar export_to_supabase_airflow\n[2025-06-06 15:40:07] ParÃ¢metros: date=2025-06-06\n2025-06-06 15:40:07,959 - INFO - ParÃ¢metros: date=2025-06-06\n[2025-06-06 15:40:07] Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06\n2025-06-06 15:40:07,959 - INFO - Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/06, date_str=2025-06-06\n[2025-06-06 15:40:07] ğŸš€ A iniciar exportaÃ§Ã£o para Supabase para a data: 2025-06-06\n2025-06-06 15:40:07,959 - INFO - ğŸš€ A iniciar exportaÃ§Ã£o para Supabase para a data: 2025-06-06\n[2025-06-06 15:40:07] ğŸ“‹ Tabela de destino: artigos_filtrados_20250606_staging\n2025-06-06 15:40:07,959 - INFO - ğŸ“‹ Tabela de destino: artigos_filtrados_20250606_staging\n[2025-06-06 15:40:07] ğŸ“ A usar diretÃ³rio de saÃ­da controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n2025-06-06 15:40:07,960 - INFO - ğŸ“ A usar diretÃ³rio de saÃ­da controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06\n[2025-06-06 15:40:07] âœ… A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 15:40:07,960 - INFO - âœ… A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 15:40:07] ğŸ“‚ A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n2025-06-06 15:40:07,960 - INFO - ğŸ“‚ A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/06/artigos_google_municipios_pt_2025-06-06.csv\n[2025-06-06 15:40:07] ğŸ“Š Carregados 15 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']\n2025-06-06 15:40:07,983 - INFO - ğŸ“Š Carregados 15 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']\n[2025-06-06 15:40:07] ğŸ“‹ A processar todos os artigos relevantes relacionados com desastres\n2025-06-06 15:40:07,983 - INFO - ğŸ“‹ A processar todos os artigos relevantes relacionados com desastres\n[2025-06-06 15:40:07] ğŸ” VerificaÃ§Ã£o inicial do ambiente...\n2025-06-06 15:40:07,984 - INFO - ğŸ” VerificaÃ§Ã£o inicial do ambiente...\n[2025-06-06 15:40:07]   DB_HOST do ambiente: NÃƒO_ENCONTRADO\n2025-06-06 15:40:07,984 - INFO -   DB_HOST do ambiente: NÃƒO_ENCONTRADO\n[2025-06-06 15:40:07]   DB_USER do ambiente: NÃƒO_ENCONTRADO\n2025-06-06 15:40:07,984 - INFO -   DB_USER do ambiente: NÃƒO_ENCONTRADO\n[2025-06-06 15:40:07]   DB_PASSWORD do ambiente: NÃƒO_ENCONTRADO\n2025-06-06 15:40:07,984 - INFO -   DB_PASSWORD do ambiente: NÃƒO_ENCONTRADO\n[2025-06-06 15:40:07] ğŸ” ConfiguraÃ§Ã£o da base de dados nÃ£o encontrada no ambiente, procurando ficheiro .env...\n2025-06-06 15:40:07,984 - INFO - ğŸ” ConfiguraÃ§Ã£o da base de dados nÃ£o encontrada no ambiente, procurando ficheiro .env...\n[2025-06-06 15:40:07] ğŸ” Verificando 6 localizaÃ§Ãµes possÃ­veis do .env...\n2025-06-06 15:40:07,984 - INFO - ğŸ” Verificando 6 localizaÃ§Ãµes possÃ­veis do .env...\n[2025-06-06 15:40:07]   A verificar: /opt/airflow/.env\n2025-06-06 15:40:07,984 - INFO -   A verificar: /opt/airflow/.env\n[2025-06-06 15:40:07]   âŒ NÃ£o encontrado: /opt/airflow/.env\n2025-06-06 15:40:07,984 - INFO -   âŒ NÃ£o encontrado: /opt/airflow/.env\n[2025-06-06 15:40:07]   A verificar: /opt/airflow/scripts/google_scraper/.env\n2025-06-06 15:40:07,984 - INFO -   A verificar: /opt/airflow/scripts/google_scraper/.env\n[2025-06-06 15:40:07] âœ… Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env\n2025-06-06 15:40:07,984 - INFO - âœ… Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env\n[2025-06-06 15:40:07] ğŸ“„ Tamanho do ficheiro .env: 210 caracteres\n2025-06-06 15:40:07,985 - INFO - ğŸ“„ Tamanho do ficheiro .env: 210 caracteres\n[2025-06-06 15:40:07]   âœ… Definido DB_USER do .env\n2025-06-06 15:40:07,985 - INFO -   âœ… Definido DB_USER do .env\n[2025-06-06 15:40:07]   âœ… Definido DB_PASSWORD do .env\n2025-06-06 15:40:07,985 - INFO -   âœ… Definido DB_PASSWORD do .env\n[2025-06-06 15:40:07]   âœ… Definido DB_HOST do .env\n2025-06-06 15:40:07,985 - INFO -   âœ… Definido DB_HOST do .env\n[2025-06-06 15:40:07]   âœ… Definido DB_PORT do .env\n2025-06-06 15:40:07,985 - INFO -   âœ… Definido DB_PORT do .env\n[2025-06-06 15:40:07]   âœ… Definido DB_NAME do .env\n2025-06-06 15:40:07,985 - INFO -   âœ… Definido DB_NAME do .env\n[2025-06-06 15:40:07]   âœ… Definido DB_SCHEMA do .env\n2025-06-06 15:40:07,985 - INFO -   âœ… Definido DB_SCHEMA do .env\n[2025-06-06 15:40:07] ğŸ” VerificaÃ§Ã£o final da configuraÃ§Ã£o...\n2025-06-06 15:40:07,987 - INFO - ğŸ” VerificaÃ§Ã£o final da configuraÃ§Ã£o...\n[2025-06-06 15:40:07]   DB_HOST: DEFINIDO\n2025-06-06 15:40:07,987 - INFO -   DB_HOST: DEFINIDO\n[2025-06-06 15:40:07]   DB_USER: DEFINIDO\n2025-06-06 15:40:07,987 - INFO -   DB_USER: DEFINIDO\n[2025-06-06 15:40:07]   DB_PASSWORD: DEFINIDO\n2025-06-06 15:40:07,987 - INFO -   DB_PASSWORD: DEFINIDO\n[2025-06-06 15:40:07]   DB_PORT: 6543\n2025-06-06 15:40:07,987 - INFO -   DB_PORT: 6543\n[2025-06-06 15:40:07]   DB_NAME: postgres\n2025-06-06 15:40:07,987 - INFO -   DB_NAME: postgres\n[2025-06-06 15:40:07]   DB_SCHEMA: google_scraper\n2025-06-06 15:40:07,987 - INFO -   DB_SCHEMA: google_scraper\n[2025-06-06 15:40:07] âœ… ConfiguraÃ§Ã£o da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres\n2025-06-06 15:40:07,987 - INFO - âœ… ConfiguraÃ§Ã£o da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres\n[2025-06-06 15:40:07] ğŸ”— A conectar Ã  base de dados...\n2025-06-06 15:40:07,987 - INFO - ğŸ”— A conectar Ã  base de dados...\n[2025-06-06 15:40:08] âœ… Conectado Ã  base de dados com sucesso\n2025-06-06 15:40:08,372 - INFO - âœ… Conectado Ã  base de dados com sucesso\n[2025-06-06 15:40:08] ğŸ—‘ï¸ Tabela existente google_scraper.artigos_filtrados_20250606_staging eliminada se existia\n2025-06-06 15:40:08,431 - INFO - ğŸ—‘ï¸ Tabela existente google_scraper.artigos_filtrados_20250606_staging eliminada se existia\n[2025-06-06 15:40:08] âœ… Tabela google_scraper.artigos_filtrados_20250606_staging criada com esquema correto\n2025-06-06 15:40:08,515 - INFO - âœ… Tabela google_scraper.artigos_filtrados_20250606_staging criada com esquema correto\n[2025-06-06 15:40:08] âœ… Ãndices criados para a tabela google_scraper.artigos_filtrados_20250606_staging\n2025-06-06 15:40:08,608 - INFO - âœ… Ãndices criados para a tabela google_scraper.artigos_filtrados_20250606_staging\n[2025-06-06 15:40:08] ğŸ”§ A preparar dataframe para inserÃ§Ã£o na base de dados...\n2025-06-06 15:40:08,609 - INFO - ğŸ”§ A preparar dataframe para inserÃ§Ã£o na base de dados...\n[2025-06-06 15:40:08] ğŸ“… A converter formatos de data...\n2025-06-06 15:40:08,609 - INFO - ğŸ“… A converter formatos de data...\n[2025-06-06 15:40:08] âœ… Preparadas 15 linhas para inserÃ§Ã£o\n2025-06-06 15:40:08,623 - INFO - âœ… Preparadas 15 linhas para inserÃ§Ã£o\n[2025-06-06 15:40:09] âœ… Inseridos/atualizados 15 artigos (falharam: 0)\n2025-06-06 15:40:09,343 - INFO - âœ… Inseridos/atualizados 15 artigos (falharam: 0)\n[2025-06-06 15:40:09] ğŸ’¾ Backup de exportaÃ§Ã£o guardado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_backup_20250606.csv\n2025-06-06 15:40:09,353 - INFO - ğŸ’¾ Backup de exportaÃ§Ã£o guardado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_backup_20250606.csv\n[2025-06-06 15:40:09] âœ… EstatÃ­sticas de exportaÃ§Ã£o guardadas: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_stats_20250606.json\n2025-06-06 15:40:09,355 - INFO - âœ… EstatÃ­sticas de exportaÃ§Ã£o guardadas: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_stats_20250606.json\n[2025-06-06 15:40:09] ğŸ“‹ LocalizaÃ§Ã£o de backup de exportaÃ§Ã£o preparada: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_backup_20250606.csv\n2025-06-06 15:40:09,356 - INFO - ğŸ“‹ LocalizaÃ§Ã£o de backup de exportaÃ§Ã£o preparada: /opt/airflow/scripts/google_scraper/data/processed/2025/06/06/export_backup_20250606.csv\n[2025-06-06 15:40:09] âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Inseridos/atualizados 15 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250606_staging\n2025-06-06 15:40:09,356 - INFO - âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Inseridos/atualizados 15 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250606_staging\n[2025-06-06 15:40:09] ğŸ”— LigaÃ§Ã£o Ã  base de dados fechada\n2025-06-06 15:40:09,357 - INFO - ğŸ”— LigaÃ§Ã£o Ã  base de dados fechada\n[2025-06-06 15:40:09] âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Processados 15 artigos\n2025-06-06 15:40:09,357 - INFO - âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Processados 15 artigos\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
