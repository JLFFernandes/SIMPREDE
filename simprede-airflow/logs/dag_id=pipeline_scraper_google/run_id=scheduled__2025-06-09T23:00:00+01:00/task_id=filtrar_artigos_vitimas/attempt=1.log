{"timestamp":"2025-06-09T23:09:40.958737","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-09T23:09:40.959217","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-09T23:09:40.991309Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:40.991532Z","level":"info","event":"📁 Using paths from processar task: 2025-06-10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:40.993909Z","level":"info","event":"📅 Using provided execution date: 2025-06-10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:40.994302Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/10', '/opt/airflow/data/structured/2025/06/10', '/opt/airflow/data/processed/2025/06/10']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:40.994428Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:40.994489Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:40.994543Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:40.994597Z","level":"info","event":"  - Target date: 2025-06-10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:40.994638Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:40.999053Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:40.999158Z","level":"info","event":"✅ Found input file: /opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:40.999409Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:40.999538Z","level":"info","event":"  - victims_articles: /opt/airflow/data/processed/2025/06/10/artigos_vitimas_filtrados_20250610.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:40.999613Z","level":"info","event":"  - no_victims_articles: /opt/airflow/data/processed/2025/06/10/artigos_sem_vitimas_20250610.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:40.999690Z","level":"info","event":"  - filtering_log: /opt/airflow/data/processed/2025/06/10/filtering_log_20250610.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:40.999767Z","level":"info","event":"  - stats_json: /opt/airflow/data/processed/2025/06/10/filtering_stats_20250610.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:40.999883Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv --output_dir /opt/airflow/data/processed/2025/06/10 --date_str 2025-06-10 --date 2025-06-10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:40.999995Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.340253Z","level":"info","event":"📋 [2025-06-10 00:09:42] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.340721Z","level":"info","event":"📋 2025-06-10 00:09:42,340 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.340841Z","level":"info","event":"📋 [2025-06-10 00:09:42] Parameters: dias=1, date=2025-06-10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.341237Z","level":"info","event":"📋 2025-06-10 00:09:42,340 - INFO - Parameters: dias=1, date=2025-06-10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.342673Z","level":"info","event":"📋 [2025-06-10 00:09:42] Paths: input_file=/opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv, output_dir=/opt/airflow/data/processed/2025/06/10, date_str=2025-06-10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.342758Z","level":"info","event":"📋 2025-06-10 00:09:42,340 - INFO - Paths: input_file=/opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv, output_dir=/opt/airflow/data/processed/2025/06/10, date_str=2025-06-10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.342821Z","level":"info","event":"📋 [2025-06-10 00:09:42] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.342880Z","level":"info","event":"📋 2025-06-10 00:09:42,340 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.342937Z","level":"info","event":"📋 [2025-06-10 00:09:42] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.342994Z","level":"info","event":"📋 2025-06-10 00:09:42,340 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.343061Z","level":"info","event":"📋 [2025-06-10 00:09:42]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.343127Z","level":"info","event":"📋 2025-06-10 00:09:42,340 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.343190Z","level":"info","event":"📋 [2025-06-10 00:09:42]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.343245Z","level":"info","event":"📋 2025-06-10 00:09:42,340 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.343299Z","level":"info","event":"📋 [2025-06-10 00:09:42] 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.343354Z","level":"info","event":"📋 2025-06-10 00:09:42,340 - INFO - 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.343437Z","level":"info","event":"📋 [2025-06-10 00:09:42] 📁 Using provided input file: /opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.343497Z","level":"info","event":"📋 2025-06-10 00:09:42,340 - INFO - 📁 Using provided input file: /opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.343555Z","level":"info","event":"📋 [2025-06-10 00:09:42] 📂 Loading articles from: /opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.343612Z","level":"info","event":"📋 2025-06-10 00:09:42,340 - INFO - 📂 Loading articles from: /opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.343667Z","level":"info","event":"📋 [2025-06-10 00:09:42] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.343721Z","level":"info","event":"📋 2025-06-10 00:09:42,342 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.343776Z","level":"info","event":"📋 [2025-06-10 00:09:42] Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.343869Z","level":"info","event":"📋 2025-06-10 00:09:42,343 - INFO - Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.343924Z","level":"info","event":"📋 [2025-06-10 00:09:42] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.343999Z","level":"info","event":"📋 2025-06-10 00:09:42,343 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.344065Z","level":"info","event":"📋 [2025-06-10 00:09:42]   Total Articles Loaded: 26","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.344119Z","level":"info","event":"📋 2025-06-10 00:09:42,343 - INFO -   Total Articles Loaded: 26","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.344175Z","level":"info","event":"📋 [2025-06-10 00:09:42]   Input File: /opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.344243Z","level":"info","event":"📋 2025-06-10 00:09:42,343 - INFO -   Input File: /opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.344298Z","level":"info","event":"📋 [2025-06-10 00:09:42]   Output File: /opt/airflow/data/processed/2025/06/10/artigos_vitimas_filtrados_2025-06-10.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.344354Z","level":"info","event":"📋 2025-06-10 00:09:42,343 - INFO -   Output File: /opt/airflow/data/processed/2025/06/10/artigos_vitimas_filtrados_2025-06-10.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.344468Z","level":"info","event":"📋 [2025-06-10 00:09:42]   Processed Data Directory: /opt/airflow/data/processed/2025/06/10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.344569Z","level":"info","event":"📋 2025-06-10 00:09:42,344 - INFO -   Processed Data Directory: /opt/airflow/data/processed/2025/06/10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.344846Z","level":"info","event":"📋 [2025-06-10 00:09:42]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.344927Z","level":"info","event":"📋 2025-06-10 00:09:42,344 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.345038Z","level":"info","event":"📋 [2025-06-10 00:09:42] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.345147Z","level":"info","event":"📋 2025-06-10 00:09:42,344 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.345331Z","level":"info","event":"📋 [2025-06-10 00:09:42] 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.345412Z","level":"info","event":"📋 2025-06-10 00:09:42,344 - INFO - 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.345477Z","level":"info","event":"📋 [2025-06-10 00:09:42] 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.346126Z","level":"info","event":"📋 2025-06-10 00:09:42,344 - INFO - 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.346194Z","level":"info","event":"📋 [2025-06-10 00:09:42] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.346250Z","level":"info","event":"📋 2025-06-10 00:09:42,344 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.346304Z","level":"info","event":"📋 [2025-06-10 00:09:42]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.346449Z","level":"info","event":"📋 2025-06-10 00:09:42,344 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.346530Z","level":"info","event":"📋 [2025-06-10 00:09:42]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.348681Z","level":"info","event":"📋 2025-06-10 00:09:42,344 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.349115Z","level":"info","event":"📋 [2025-06-10 00:09:42]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.351068Z","level":"info","event":"📋 2025-06-10 00:09:42,344 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.351146Z","level":"info","event":"📋 [2025-06-10 00:09:42]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.351203Z","level":"info","event":"📋 2025-06-10 00:09:42,344 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.351292Z","level":"info","event":"📋 [2025-06-10 00:09:42] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.351356Z","level":"info","event":"📋 2025-06-10 00:09:42,345 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.351410Z","level":"info","event":"📋 [2025-06-10 00:09:42]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.351466Z","level":"info","event":"📋 2025-06-10 00:09:42,345 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.351519Z","level":"info","event":"📋 [2025-06-10 00:09:42]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.351572Z","level":"info","event":"📋 2025-06-10 00:09:42,345 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.351625Z","level":"info","event":"📋 [2025-06-10 00:09:42] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.351679Z","level":"info","event":"📋 2025-06-10 00:09:42,346 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.351735Z","level":"info","event":"📋 [2025-06-10 00:09:42] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.351787Z","level":"info","event":"📋 2025-06-10 00:09:42,348 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.351841Z","level":"info","event":"📋 [2025-06-10 00:09:42] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.351894Z","level":"info","event":"📋 2025-06-10 00:09:42,348 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.351948Z","level":"info","event":"📋 [2025-06-10 00:09:42] 📊 Starting enhanced comprehensive filtering with 26 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.352002Z","level":"info","event":"📋 2025-06-10 00:09:42,348 - INFO - 📊 Starting enhanced comprehensive filtering with 26 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.352062Z","level":"info","event":"📋 [2025-06-10 00:09:42] 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.352153Z","level":"info","event":"📋 2025-06-10 00:09:42,349 - INFO - 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.352205Z","level":"info","event":"📋 [2025-06-10 00:09:42]    After enhanced geographic filter: 25 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.352257Z","level":"info","event":"📋 2025-06-10 00:09:42,350 - INFO -    After enhanced geographic filter: 25 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.352309Z","level":"info","event":"📋 [2025-06-10 00:09:42] ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.352361Z","level":"info","event":"📋 2025-06-10 00:09:42,350 - INFO - ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.352866Z","level":"info","event":"📋 [2025-06-10 00:09:42]    After quality filter: 11 articles (removed 14)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.352938Z","level":"info","event":"📋 2025-06-10 00:09:42,352 - INFO -    After quality filter: 11 articles (removed 14)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.353011Z","level":"info","event":"📋 [2025-06-10 00:09:42] 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.353186Z","level":"info","event":"📋 2025-06-10 00:09:42,353 - INFO - 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.353646Z","level":"info","event":"📋 [2025-06-10 00:09:42]    After enhanced keyword filter: 0 articles (removed 11)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.356072Z","level":"info","event":"📋 2025-06-10 00:09:42,353 - INFO -    After enhanced keyword filter: 0 articles (removed 11)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.356169Z","level":"info","event":"📋 [2025-06-10 00:09:42] 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.356229Z","level":"info","event":"📋 2025-06-10 00:09:42,353 - INFO - 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.356283Z","level":"info","event":"📋 [2025-06-10 00:09:42]    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.356336Z","level":"info","event":"📋 2025-06-10 00:09:42,354 - INFO -    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.356389Z","level":"info","event":"📋 [2025-06-10 00:09:42] 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.356441Z","level":"info","event":"📋 2025-06-10 00:09:42,354 - INFO - 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.356492Z","level":"info","event":"📋 [2025-06-10 00:09:42]    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.356543Z","level":"info","event":"📋 2025-06-10 00:09:42,354 - INFO -    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.356595Z","level":"info","event":"📋 [2025-06-10 00:09:42] ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.356645Z","level":"info","event":"📋 2025-06-10 00:09:42,354 - INFO - ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.356696Z","level":"info","event":"📋 [2025-06-10 00:09:42]    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.356786Z","level":"info","event":"📋 2025-06-10 00:09:42,354 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.356840Z","level":"info","event":"📋 [2025-06-10 00:09:42] 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.356891Z","level":"info","event":"📋 2025-06-10 00:09:42,354 - INFO - 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.356941Z","level":"info","event":"📋 [2025-06-10 00:09:42] 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.356991Z","level":"info","event":"📋 2025-06-10 00:09:42,355 - INFO - 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.357041Z","level":"info","event":"📋 [2025-06-10 00:09:42] ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.357106Z","level":"info","event":"📋 2025-06-10 00:09:42,355 - WARNING - ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.357157Z","level":"info","event":"📋 [2025-06-10 00:09:42] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.357207Z","level":"info","event":"📋 2025-06-10 00:09:42,355 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.442413Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.442603Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.442732Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/data/processed/2025/06/10/artigos_vitimas_filtrados_20250610.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.442827Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/data/processed/2025/06/10/artigos_sem_vitimas_20250610.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.442931Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/data/processed/2025/06/10/filtering_log_20250610.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.443015Z","level":"info","event":"⚠️ stats_json: /opt/airflow/data/processed/2025/06/10/filtering_stats_20250610.json (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T23:09:42.443077","level":"info","event":"Done. Returned value was: [2025-06-10 00:09:42] Starting filtrar_artigos_vitimas_airflow\n2025-06-10 00:09:42,340 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-10 00:09:42] Parameters: dias=1, date=2025-06-10\n2025-06-10 00:09:42,340 - INFO - Parameters: dias=1, date=2025-06-10\n[2025-06-10 00:09:42] Paths: input_file=/opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv, output_dir=/opt/airflow/data/processed/2025/06/10, date_str=2025-06-10\n2025-06-10 00:09:42,340 - INFO - Paths: input_file=/opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv, output_dir=/opt/airflow/data/processed/2025/06/10, date_str=2025-06-10\n[2025-06-10 00:09:42] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n2025-06-10 00:09:42,340 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n[2025-06-10 00:09:42] 🔍 Path setup:\n2025-06-10 00:09:42,340 - INFO - 🔍 Path setup:\n[2025-06-10 00:09:42]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-10 00:09:42,340 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-10 00:09:42]    Project root: /opt/airflow\n2025-06-10 00:09:42,340 - INFO -    Project root: /opt/airflow\n[2025-06-10 00:09:42] 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/10\n2025-06-10 00:09:42,340 - INFO - 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/10\n[2025-06-10 00:09:42] 📁 Using provided input file: /opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv\n2025-06-10 00:09:42,340 - INFO - 📁 Using provided input file: /opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv\n[2025-06-10 00:09:42] 📂 Loading articles from: /opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv\n2025-06-10 00:09:42,340 - INFO - 📂 Loading articles from: /opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv\n[2025-06-10 00:09:42] ==================================================\n2025-06-10 00:09:42,342 - INFO - ==================================================\n[2025-06-10 00:09:42] Enhanced Filtering Started\n2025-06-10 00:09:42,343 - INFO - Enhanced Filtering Started\n[2025-06-10 00:09:42] ==================================================\n2025-06-10 00:09:42,343 - INFO - ==================================================\n[2025-06-10 00:09:42]   Total Articles Loaded: 26\n2025-06-10 00:09:42,343 - INFO -   Total Articles Loaded: 26\n[2025-06-10 00:09:42]   Input File: /opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv\n2025-06-10 00:09:42,343 - INFO -   Input File: /opt/airflow/data/structured/2025/06/10/artigos_google_municipios_pt_2025-06-10.csv\n[2025-06-10 00:09:42]   Output File: /opt/airflow/data/processed/2025/06/10/artigos_vitimas_filtrados_2025-06-10.csv\n2025-06-10 00:09:42,343 - INFO -   Output File: /opt/airflow/data/processed/2025/06/10/artigos_vitimas_filtrados_2025-06-10.csv\n[2025-06-10 00:09:42]   Processed Data Directory: /opt/airflow/data/processed/2025/06/10\n2025-06-10 00:09:42,344 - INFO -   Processed Data Directory: /opt/airflow/data/processed/2025/06/10\n[2025-06-10 00:09:42]   Days Filter: 1\n2025-06-10 00:09:42,344 - INFO -   Days Filter: 1\n[2025-06-10 00:09:42] ==================================================\n2025-06-10 00:09:42,344 - INFO - ==================================================\n[2025-06-10 00:09:42] 🔍 Applying enhanced comprehensive filtering logic...\n2025-06-10 00:09:42,344 - INFO - 🔍 Applying enhanced comprehensive filtering logic...\n[2025-06-10 00:09:42] 🔧 Loading configuration data for enhanced filtering...\n2025-06-10 00:09:42,344 - INFO - 🔧 Loading configuration data for enhanced filtering...\n[2025-06-10 00:09:42] 🔍 Looking for config files in multiple paths:\n2025-06-10 00:09:42,344 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-10 00:09:42]    Checking: /opt/airflow/config\n2025-06-10 00:09:42,344 - INFO -    Checking: /opt/airflow/config\n[2025-06-10 00:09:42]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-10 00:09:42,344 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-10 00:09:42]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-10 00:09:42,344 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-10 00:09:42]    Checking: config\n2025-06-10 00:09:42,344 - INFO -    Checking: config\n[2025-06-10 00:09:42] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-10 00:09:42,345 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-10 00:09:42]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-10 00:09:42,345 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-10 00:09:42]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-10 00:09:42,345 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-10 00:09:42] ✅ Loaded municipios config with 29 districts\n2025-06-10 00:09:42,346 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-10 00:09:42] ✅ Loaded eventos config with 14 events\n2025-06-10 00:09:42,348 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-10 00:09:42] 📊 Config summary: 29 districts, 306 parishes\n2025-06-10 00:09:42,348 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-10 00:09:42] 📊 Starting enhanced comprehensive filtering with 26 articles\n2025-06-10 00:09:42,348 - INFO - 📊 Starting enhanced comprehensive filtering with 26 articles\n[2025-06-10 00:09:42] 🇵🇹 Applying enhanced geographic filter...\n2025-06-10 00:09:42,349 - INFO - 🇵🇹 Applying enhanced geographic filter...\n[2025-06-10 00:09:42]    After enhanced geographic filter: 25 articles (removed 1)\n2025-06-10 00:09:42,350 - INFO -    After enhanced geographic filter: 25 articles (removed 1)\n[2025-06-10 00:09:42] ✨ Applying content quality filter...\n2025-06-10 00:09:42,350 - INFO - ✨ Applying content quality filter...\n[2025-06-10 00:09:42]    After quality filter: 11 articles (removed 14)\n2025-06-10 00:09:42,352 - INFO -    After quality filter: 11 articles (removed 14)\n[2025-06-10 00:09:42] 🔍 Applying enhanced keyword filtering...\n2025-06-10 00:09:42,353 - INFO - 🔍 Applying enhanced keyword filtering...\n[2025-06-10 00:09:42]    After enhanced keyword filter: 0 articles (removed 11)\n2025-06-10 00:09:42,353 - INFO -    After enhanced keyword filter: 0 articles (removed 11)\n[2025-06-10 00:09:42] 📅 Applying temporal relevance filter...\n2025-06-10 00:09:42,353 - INFO - 📅 Applying temporal relevance filter...\n[2025-06-10 00:09:42]    After temporal filter: 0 articles (removed 0)\n2025-06-10 00:09:42,354 - INFO -    After temporal filter: 0 articles (removed 0)\n[2025-06-10 00:09:42] 👥 Applying enhanced victim validation...\n2025-06-10 00:09:42,354 - INFO - 👥 Applying enhanced victim validation...\n[2025-06-10 00:09:42]    After victim validation: 0 articles (removed 0)\n2025-06-10 00:09:42,354 - INFO -    After victim validation: 0 articles (removed 0)\n[2025-06-10 00:09:42] ⭐ Calculating enhanced relevance scores...\n2025-06-10 00:09:42,354 - INFO - ⭐ Calculating enhanced relevance scores...\n[2025-06-10 00:09:42]    After relevance score filter (min 2): 0 articles (removed 0)\n2025-06-10 00:09:42,354 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)\n[2025-06-10 00:09:42] 🔄 Removing duplicates with enhanced logic...\n2025-06-10 00:09:42,354 - INFO - 🔄 Removing duplicates with enhanced logic...\n[2025-06-10 00:09:42] 🌦️ Enhanced climate event identification...\n2025-06-10 00:09:42,355 - INFO - 🌦️ Enhanced climate event identification...\n[2025-06-10 00:09:42] ⚠️ No articles remaining after enhanced filtering.\n2025-06-10 00:09:42,355 - WARNING - ⚠️ No articles remaining after enhanced filtering.\n[2025-06-10 00:09:42] ✅ Filtering completed. Found 0 articles with victims\n2025-06-10 00:09:42,355 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
