{"timestamp":"2025-06-05T17:08:17.249898","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T17:08:17.250385","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T17:08:17.291136Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.293824Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.294706Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.295677Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.296209Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.296658Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.296938Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.297124Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.297234Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.297344Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.297430Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.297506Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.297587Z","level":"info","event":"  - relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.297673Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.297775Z","level":"info","event":"  - processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.298104Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.298181Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv --output_dir /opt/airflow/scripts/google_scraper/data/structured/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.298282Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.805942Z","level":"info","event":"📋 [2025-06-05 18:08:18] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.806546Z","level":"info","event":"📋 2025-06-05 18:08:18,805 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.806798Z","level":"info","event":"📋 [2025-06-05 18:08:18] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.806853Z","level":"info","event":"📋 2025-06-05 18:08:18,805 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.806897Z","level":"info","event":"📋 [2025-06-05 18:08:18] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807024Z","level":"info","event":"📋 2025-06-05 18:08:18,805 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807088Z","level":"info","event":"📋 [2025-06-05 18:08:18] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807158Z","level":"info","event":"📋 2025-06-05 18:08:18,805 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807657Z","level":"info","event":"📋 [2025-06-05 18:08:18] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807702Z","level":"info","event":"📋 2025-06-05 18:08:18,805 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807740Z","level":"info","event":"📋 [2025-06-05 18:08:18] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807821Z","level":"info","event":"📋 2025-06-05 18:08:18,806 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807858Z","level":"info","event":"📋 [2025-06-05 18:08:18] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807893Z","level":"info","event":"📋 2025-06-05 18:08:18,806 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807927Z","level":"info","event":"📋 [2025-06-05 18:08:18] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807961Z","level":"info","event":"📋 2025-06-05 18:08:18,806 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.808000Z","level":"info","event":"📋 [2025-06-05 18:08:18] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.808045Z","level":"info","event":"📋 2025-06-05 18:08:18,806 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.808089Z","level":"info","event":"📋 [2025-06-05 18:08:18] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.808304Z","level":"info","event":"📋 2025-06-05 18:08:18,806 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.808403Z","level":"info","event":"📋 [2025-06-05 18:08:18] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.808739Z","level":"info","event":"📋 2025-06-05 18:08:18,806 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.808831Z","level":"info","event":"📋 [2025-06-05 18:08:18] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.808889Z","level":"info","event":"📋 2025-06-05 18:08:18,806 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.810488Z","level":"info","event":"📋 [2025-06-05 18:08:18] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.811937Z","level":"info","event":"📋 2025-06-05 18:08:18,808 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.813607Z","level":"info","event":"📋 [2025-06-05 18:08:18] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815292Z","level":"info","event":"📋 2025-06-05 18:08:18,808 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815358Z","level":"info","event":"📋 [2025-06-05 18:08:18] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815397Z","level":"info","event":"📋 2025-06-05 18:08:18,808 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815469Z","level":"info","event":"📋 [2025-06-05 18:08:18] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815519Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815555Z","level":"info","event":"📋 [2025-06-05 18:08:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815591Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815626Z","level":"info","event":"📋 [2025-06-05 18:08:18] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815661Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815696Z","level":"info","event":"📋 [2025-06-05 18:08:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815732Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815771Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815825Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815867Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815903Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815939Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815975Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.816039Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.816075Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.816110Z","level":"info","event":"📋 [2025-06-05 18:08:18]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.816144Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.816179Z","level":"info","event":"📋 [2025-06-05 18:08:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.816213Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.817349Z","level":"info","event":"📋 [2025-06-05 18:08:18] ✅ Ficheiro CSV válido com 6 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.817893Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO - ✅ Ficheiro CSV válido com 6 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818303Z","level":"info","event":"📋 [2025-06-05 18:08:18] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818350Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818387Z","level":"info","event":"📋 [2025-06-05 18:08:18] 📅 Filtrado para artigos dos últimos 1 dias: 6 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818424Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 6 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818474Z","level":"info","event":"📋 [2025-06-05 18:08:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818522Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818576Z","level":"info","event":"📋 [2025-06-05 18:08:18] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818624Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818676Z","level":"info","event":"📋 [2025-06-05 18:08:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818726Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818777Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Total de Artigos para Processar: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.819803Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO -   Total de Artigos para Processar: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.821763Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.821865Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822015Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822075Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822152Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822226Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822289Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822348Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822421Z","level":"info","event":"📋 [2025-06-05 18:08:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822548Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822653Z","level":"info","event":"📋 [2025-06-05 18:08:18] 📦 A processar lote 1/1 (6 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822718Z","level":"info","event":"📋 2025-06-05 18:08:18,818 - INFO - 📦 A processar lote 1/1 (6 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:22.099999Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:22.484991Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:22.603586Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:22.653095Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:22.708824Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:27.864455Z","level":"info","event":"📋 [2025-06-05 18:08:27] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga Nações: UEFA está a monitorizar mau tempo em Munique - Diário de Viseu","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:27.866522Z","level":"info","event":"📋 2025-06-05 18:08:27,751 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga Nações: UEFA está a monitorizar mau tempo em Munique - Diário de Viseu","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:27.866631Z","level":"info","event":"📋 [2025-06-05 18:08:27] 🔄 Processado: Liga Nações: UEFA está a monitorizar mau tempo em ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:27.866686Z","level":"info","event":"📋 2025-06-05 18:08:27,776 - INFO - 🔄 Processado: Liga Nações: UEFA está a monitorizar mau tempo em ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:28.965710Z","level":"info","event":"📋 [2025-06-05 18:08:28] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva de granizo envia guarda-redes do Alemanha-Portugal para os balneários - Abola.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:28.969599Z","level":"info","event":"📋 2025-06-05 18:08:28,965 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva de granizo envia guarda-redes do Alemanha-Portugal para os balneários - Abola.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:28.969806Z","level":"info","event":"📋 [2025-06-05 18:08:28] 🔄 Processado: Chuva de granizo envia guarda-redes do Alemanha-Po...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:28.969905Z","level":"info","event":"📋 2025-06-05 18:08:28,966 - INFO - 🔄 Processado: Chuva de granizo envia guarda-redes do Alemanha-Po...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:31.736932Z","level":"info","event":"📋 [2025-06-05 18:08:31] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (05) para Resende (RJ) - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:31.738318Z","level":"info","event":"📋 2025-06-05 18:08:31,735 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (05) para Resende (RJ) - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:31.740375Z","level":"info","event":"📋 [2025-06-05 18:08:31] 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (05) ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:31.740586Z","level":"info","event":"📋 2025-06-05 18:08:31,740 - INFO - 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (05) ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:32.935411Z","level":"info","event":"⚠️ ❌ Erro ao resolver URL do Google News: Message:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:32.938790Z","level":"info","event":"⚠️","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:32.998278Z","level":"info","event":"📋 [2025-06-05 18:08:32] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiX0FVX3lxTE1lN1M4dmh6bjQ3MjNHTVN2Qk9VOHVaVy0tS2duRjJ4MVp0ZEp3Z0ZIQzN0RnFxSHk3SUI2MTNBbFJaOTR1b29BWmkzMVp1cFJSWmJQVWdfWExoM1hKRWow?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:32.998477Z","level":"info","event":"📋 2025-06-05 18:08:32,998 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiX0FVX3lxTE1lN1M4dmh6bjQ3MjNHTVN2Qk9VOHVaVy0tS2duRjJ4MVp0ZEp3Z0ZIQzN0RnFxSHk3SUI2MTNBbFJaOTR1b29BWmkzMVp1cFJSWmJQVWdfWExoM1hKRWow?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:40.195735Z","level":"info","event":"⚠️ ❌ Erro ao resolver URL do Google News: Message:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:40.196769Z","level":"info","event":"⚠️","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:40.261413Z","level":"info","event":"📋 [2025-06-05 18:08:40] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiygFBVV95cUxPdW4wZEtZaVZXby0ybTdXdUZwR0EwOFYtTUN0d055WkZNRmg4S0JEaFdkSk1fWWEyWXVNcnk4Z0hsTHhQSVltcnNXX1ZjNFJzS1g5Rnp0clNsNHhrY2QtWldHYVUycHZLcnNLVGtJWnBQQ2ZCcGstZUlFNnRsYUlidm9NR05ZWi1yWThtaHVLaTNiN2Z6cHFsczhUdi1wUEJoUElWa21sZi1sZmU5ZDgta3hyM3BxdEVSazduSDRxQm5DckZYTWFGYUZn0gG7AUFVX3lxTE9ZdXRXcTB4SzJ1RVhQeUc1R2JxMlJBMExOTUFjbEJFY2E1Y3RIYTJQa2x2WXFSSFczWHdxeVNka3dGbFEzWG8xNjdQbGk2SDE3Ymo0UjlvX19VY3JzYUhlVHN6d29QejloTmZpTDhKQ2pJanNuY08xbUVNWENteVlSUHU1MGZVU2J4RnZOc2hzN0J0eHRSU2NYNndydlg1ODBUUFJsSHZ3Vzh5RFFzWFUzYktEOThVTlhfS0E?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:40.261679Z","level":"info","event":"📋 2025-06-05 18:08:40,261 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiygFBVV95cUxPdW4wZEtZaVZXby0ybTdXdUZwR0EwOFYtTUN0d055WkZNRmg4S0JEaFdkSk1fWWEyWXVNcnk4Z0hsTHhQSVltcnNXX1ZjNFJzS1g5Rnp0clNsNHhrY2QtWldHYVUycHZLcnNLVGtJWnBQQ2ZCcGstZUlFNnRsYUlidm9NR05ZWi1yWThtaHVLaTNiN2Z6cHFsczhUdi1wUEJoUElWa21sZi1sZmU5ZDgta3hyM3BxdEVSazduSDRxQm5DckZYTWFGYUZn0gG7AUFVX3lxTE9ZdXRXcTB4SzJ1RVhQeUc1R2JxMlJBMExOTUFjbEJFY2E1Y3RIYTJQa2x2WXFSSFczWHdxeVNka3dGbFEzWG8xNjdQbGk2SDE3Ymo0UjlvX19VY3JzYUhlVHN6d29QejloTmZpTDhKQ2pJanNuY08xbUVNWENteVlSUHU1MGZVU2J4RnZOc2hzN0J0eHRSU2NYNndydlg1ODBUUFJsSHZ3Vzh5RFFzWFUzYktEOThVTlhfS0E?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.766591Z","level":"info","event":"⚠️ ❌ Erro ao resolver URL do Google News: Message:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.767640Z","level":"info","event":"⚠️","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.832367Z","level":"info","event":"📋 [2025-06-05 18:08:41] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMi_gFBVV95cUxORHNQaDZTVzN2VGJfZXpTVUtidEIzOGFvS1VtVUFqMGpCUHVsVl9BRkNfRXRORUJFTC1jTWtNVnkwekRSMzU2c2lqZEtEU2RrbVlMbXd4WFdHQ2VLZS1qbFFXZ0dEYWN4WVJteldCcEFHZXRocVp1M3hZWHcyMTFLYjlEN3V3VVl4TGswYUVqcW1ZM0JHN3ZpTkt2Vy1saXoyU2tPN1AxUXpjanpoSkd0ZmcwcWtPTmFUZDZqSVlWSjl0SXUwSUR6OVlHMnNxbUMyTVB1NWVFOTZKclE3V3VaVVpCalpsaEhYRU8yNVJaUWo1N1BrUjh2OFJLU2hiUQ?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.832734Z","level":"info","event":"📋 2025-06-05 18:08:41,832 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMi_gFBVV95cUxORHNQaDZTVzN2VGJfZXpTVUtidEIzOGFvS1VtVUFqMGpCUHVsVl9BRkNfRXRORUJFTC1jTWtNVnkwekRSMzU2c2lqZEtEU2RrbVlMbXd4WFdHQ2VLZS1qbFFXZ0dEYWN4WVJteldCcEFHZXRocVp1M3hZWHcyMTFLYjlEN3V3VVl4TGswYUVqcW1ZM0JHN3ZpTkt2Vy1saXoyU2tPN1AxUXpjanpoSkd0ZmcwcWtPTmFUZDZqSVlWSjl0SXUwSUR6OVlHMnNxbUMyTVB1NWVFOTZKclE3V3VaVVpCalpsaEhYRU8yNVJaUWo1N1BrUjh2OFJLU2hiUQ?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.833770Z","level":"info","event":"📋 📥 Novos artigos recebidos: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.835618Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.835787Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.835973Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.836545Z","level":"info","event":"📋 💾 Guardados 3 artigos no arquivo /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.836924Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.837024Z","level":"info","event":"📋 📥 Novos artigos recebidos: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.837123Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.837255Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.837401Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.837614Z","level":"info","event":"📋 💾 Guardados 3 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.837970Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.838131Z","level":"info","event":"📋 [2025-06-05 18:08:41] ✅ Relevant articles saved: 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.838291Z","level":"info","event":"📋 2025-06-05 18:08:41,837 - INFO - ✅ Relevant articles saved: 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.838576Z","level":"info","event":"📋 [2025-06-05 18:08:41] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.838637Z","level":"info","event":"📋 2025-06-05 18:08:41,838 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.838704Z","level":"info","event":"📋 [2025-06-05 18:08:41] ✅ Lote 1 concluído: 3 artigos (total: 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.838773Z","level":"info","event":"📋 2025-06-05 18:08:41,838 - INFO - ✅ Lote 1 concluído: 3 artigos (total: 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.805186Z","level":"info","event":"📋 📥 Novos artigos recebidos: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.910085Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.911091Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.912828Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.912942Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913011Z","level":"info","event":"📋 📥 Novos artigos recebidos: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913068Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913115Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913180Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913231Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913278Z","level":"info","event":"📋 [2025-06-05 18:08:46] ✅ Relevant articles saved: 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913329Z","level":"info","event":"📋 2025-06-05 18:08:46,824 - INFO - ✅ Relevant articles saved: 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913372Z","level":"info","event":"📋 [2025-06-05 18:08:46] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913432Z","level":"info","event":"📋 2025-06-05 18:08:46,827 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913481Z","level":"info","event":"📋 [2025-06-05 18:08:46] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913531Z","level":"info","event":"📋 2025-06-05 18:08:46,827 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913577Z","level":"info","event":"📋 [2025-06-05 18:08:46] Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913716Z","level":"info","event":"📋 2025-06-05 18:08:46,828 - INFO - Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913773Z","level":"info","event":"📋 [2025-06-05 18:08:46] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913852Z","level":"info","event":"📋 2025-06-05 18:08:46,828 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913891Z","level":"info","event":"📋 [2025-06-05 18:08:46]   Total de Artigos Processados: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913933Z","level":"info","event":"📋 2025-06-05 18:08:46,828 - INFO -   Total de Artigos Processados: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914063Z","level":"info","event":"📋 [2025-06-05 18:08:46]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914113Z","level":"info","event":"📋 2025-06-05 18:08:46,828 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914176Z","level":"info","event":"📋 [2025-06-05 18:08:46]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914311Z","level":"info","event":"📋 2025-06-05 18:08:46,828 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914438Z","level":"info","event":"📋 [2025-06-05 18:08:46]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914509Z","level":"info","event":"📋 2025-06-05 18:08:46,828 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914553Z","level":"info","event":"📋 [2025-06-05 18:08:46]   Taxa de Sucesso: 50.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914591Z","level":"info","event":"📋 2025-06-05 18:08:46,828 - INFO -   Taxa de Sucesso: 50.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914638Z","level":"info","event":"📋 [2025-06-05 18:08:46] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914683Z","level":"info","event":"📋 2025-06-05 18:08:46,828 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914734Z","level":"info","event":"📋 [2025-06-05 18:08:46] ✅ Processing completed. Processed 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914783Z","level":"info","event":"📋 2025-06-05 18:08:46,838 - INFO - ✅ Processing completed. Processed 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.079827Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.080056Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.080229Z","level":"info","event":"✅ relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (916 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.875284Z","level":"info","event":"📊 Number of processed articles: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.875538Z","level":"info","event":"📊 Columns: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.875721Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.876558Z","level":"info","event":"⚠️ processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.876723Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.876120","level":"info","event":"Done. Returned value was: [2025-06-05 18:08:18] Starting processar_relevantes_airflow\n2025-06-05 18:08:18,805 - INFO - Starting processar_relevantes_airflow\n[2025-06-05 18:08:18] Parameters: dias=1, date=2025-06-05\n2025-06-05 18:08:18,805 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 18:08:18] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n2025-06-05 18:08:18,805 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n[2025-06-05 18:08:18] 🚀 A iniciar processar_relevantes_airflow\n2025-06-05 18:08:18,805 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-05 18:08:18] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 18:08:18,805 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 18:08:18] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 18:08:18,806 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 18:08:18] 🔧 A carregar ficheiros de configuração...\n2025-06-05 18:08:18,806 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-05 18:08:18] 🔍 Checking config path: /opt/airflow/config\n2025-06-05 18:08:18,806 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-05 18:08:18] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-05 18:08:18,806 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-05 18:08:18] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-05 18:08:18,806 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-05 18:08:18] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-05 18:08:18,806 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-05 18:08:18] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-05 18:08:18,806 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-05 18:08:18] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-05 18:08:18,808 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-05 18:08:18] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-05 18:08:18,808 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-05 18:08:18] ✅ Loaded 6 keywords\n2025-06-05 18:08:18,808 - INFO - ✅ Loaded 6 keywords\n[2025-06-05 18:08:18] ✅ Loaded 3614 DICOFREG codes\n2025-06-05 18:08:18,815 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-05 18:08:18] ==================================================\n2025-06-05 18:08:18,815 - INFO - ==================================================\n[2025-06-05 18:08:18] Configuration Loaded\n2025-06-05 18:08:18,815 - INFO - Configuration Loaded\n[2025-06-05 18:08:18] ==================================================\n2025-06-05 18:08:18,815 - INFO - ==================================================\n[2025-06-05 18:08:18]   Parishes: 306\n2025-06-05 18:08:18,815 - INFO -   Parishes: 306\n[2025-06-05 18:08:18]   Municipalities: 306\n2025-06-05 18:08:18,815 - INFO -   Municipalities: 306\n[2025-06-05 18:08:18]   Districts: 29\n2025-06-05 18:08:18,815 - INFO -   Districts: 29\n[2025-06-05 18:08:18]   Keywords: 6\n2025-06-05 18:08:18,815 - INFO -   Keywords: 6\n[2025-06-05 18:08:18]   DICOFREG Codes: 3614\n2025-06-05 18:08:18,815 - INFO -   DICOFREG Codes: 3614\n[2025-06-05 18:08:18] ==================================================\n2025-06-05 18:08:18,815 - INFO - ==================================================\n[2025-06-05 18:08:18] ✅ Ficheiro CSV válido com 6 artigos\n2025-06-05 18:08:18,817 - INFO - ✅ Ficheiro CSV válido com 6 artigos\n[2025-06-05 18:08:18] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-05 18:08:18,817 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-05 18:08:18] 📅 Filtrado para artigos dos últimos 1 dias: 6 artigos\n2025-06-05 18:08:18,817 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 6 artigos\n[2025-06-05 18:08:18] ==================================================\n2025-06-05 18:08:18,817 - INFO - ==================================================\n[2025-06-05 18:08:18] Processamento Iniciado\n2025-06-05 18:08:18,817 - INFO - Processamento Iniciado\n[2025-06-05 18:08:18] ==================================================\n2025-06-05 18:08:18,817 - INFO - ==================================================\n[2025-06-05 18:08:18]   Total de Artigos para Processar: 6\n2025-06-05 18:08:18,817 - INFO -   Total de Artigos para Processar: 6\n[2025-06-05 18:08:18]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 18:08:18,817 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 18:08:18]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:08:18,817 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:08:18]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 18:08:18,817 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 18:08:18]   Filtro de Dias: 1\n2025-06-05 18:08:18,817 - INFO -   Filtro de Dias: 1\n[2025-06-05 18:08:18] ==================================================\n2025-06-05 18:08:18,817 - INFO - ==================================================\n[2025-06-05 18:08:18] 📦 A processar lote 1/1 (6 artigos)\n2025-06-05 18:08:18,818 - INFO - 📦 A processar lote 1/1 (6 artigos)\n[2025-06-05 18:08:27] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga Nações: UEFA está a monitorizar mau tempo em Munique - Diário de Viseu\n2025-06-05 18:08:27,751 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga Nações: UEFA está a monitorizar mau tempo em Munique - Diário de Viseu\n[2025-06-05 18:08:27] 🔄 Processado: Liga Nações: UEFA está a monitorizar mau tempo em ...\n2025-06-05 18:08:27,776 - INFO - 🔄 Processado: Liga Nações: UEFA está a monitorizar mau tempo em ...\n[2025-06-05 18:08:28] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva de granizo envia guarda-redes do Alemanha-Portugal para os balneários - Abola.pt\n2025-06-05 18:08:28,965 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva de granizo envia guarda-redes do Alemanha-Portugal para os balneários - Abola.pt\n[2025-06-05 18:08:28] 🔄 Processado: Chuva de granizo envia guarda-redes do Alemanha-Po...\n2025-06-05 18:08:28,966 - INFO - 🔄 Processado: Chuva de granizo envia guarda-redes do Alemanha-Po...\n[2025-06-05 18:08:31] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (05) para Resende (RJ) - UOL Notícias\n2025-06-05 18:08:31,735 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (05) para Resende (RJ) - UOL Notícias\n[2025-06-05 18:08:31] 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (05) ...\n2025-06-05 18:08:31,740 - INFO - 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (05) ...\n[2025-06-05 18:08:32] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiX0FVX3lxTE1lN1M4dmh6bjQ3MjNHTVN2Qk9VOHVaVy0tS2duRjJ4MVp0ZEp3Z0ZIQzN0RnFxSHk3SUI2MTNBbFJaOTR1b29BWmkzMVp1cFJSWmJQVWdfWExoM1hKRWow?oc=5\n2025-06-05 18:08:32,998 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiX0FVX3lxTE1lN1M4dmh6bjQ3MjNHTVN2Qk9VOHVaVy0tS2duRjJ4MVp0ZEp3Z0ZIQzN0RnFxSHk3SUI2MTNBbFJaOTR1b29BWmkzMVp1cFJSWmJQVWdfWExoM1hKRWow?oc=5\n[2025-06-05 18:08:40] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiygFBVV95cUxPdW4wZEtZaVZXby0ybTdXdUZwR0EwOFYtTUN0d055WkZNRmg4S0JEaFdkSk1fWWEyWXVNcnk4Z0hsTHhQSVltcnNXX1ZjNFJzS1g5Rnp0clNsNHhrY2QtWldHYVUycHZLcnNLVGtJWnBQQ2ZCcGstZUlFNnRsYUlidm9NR05ZWi1yWThtaHVLaTNiN2Z6cHFsczhUdi1wUEJoUElWa21sZi1sZmU5ZDgta3hyM3BxdEVSazduSDRxQm5DckZYTWFGYUZn0gG7AUFVX3lxTE9ZdXRXcTB4SzJ1RVhQeUc1R2JxMlJBMExOTUFjbEJFY2E1Y3RIYTJQa2x2WXFSSFczWHdxeVNka3dGbFEzWG8xNjdQbGk2SDE3Ymo0UjlvX19VY3JzYUhlVHN6d29QejloTmZpTDhKQ2pJanNuY08xbUVNWENteVlSUHU1MGZVU2J4RnZOc2hzN0J0eHRSU2NYNndydlg1ODBUUFJsSHZ3Vzh5RFFzWFUzYktEOThVTlhfS0E?oc=5\n2025-06-05 18:08:40,261 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiygFBVV95cUxPdW4wZEtZaVZXby0ybTdXdUZwR0EwOFYtTUN0d055WkZNRmg4S0JEaFdkSk1fWWEyWXVNcnk4Z0hsTHhQSVltcnNXX1ZjNFJzS1g5Rnp0clNsNHhrY2QtWldHYVUycHZLcnNLVGtJWnBQQ2ZCcGstZUlFNnRsYUlidm9NR05ZWi1yWThtaHVLaTNiN2Z6cHFsczhUdi1wUEJoUElWa21sZi1sZmU5ZDgta3hyM3BxdEVSazduSDRxQm5DckZYTWFGYUZn0gG7AUFVX3lxTE9ZdXRXcTB4SzJ1RVhQeUc1R2JxMlJBMExOTUFjbEJFY2E1Y3RIYTJQa2x2WXFSSFczWHdxeVNka3dGbFEzWG8xNjdQbGk2SDE3Ymo0UjlvX19VY3JzYUhlVHN6d29QejloTmZpTDhKQ2pJanNuY08xbUVNWENteVlSUHU1MGZVU2J4RnZOc2hzN0J0eHRSU2NYNndydlg1ODBUUFJsSHZ3Vzh5RFFzWFUzYktEOThVTlhfS0E?oc=5\n[2025-06-05 18:08:41] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMi_gFBVV95cUxORHNQaDZTVzN2VGJfZXpTVUtidEIzOGFvS1VtVUFqMGpCUHVsVl9BRkNfRXRORUJFTC1jTWtNVnkwekRSMzU2c2lqZEtEU2RrbVlMbXd4WFdHQ2VLZS1qbFFXZ0dEYWN4WVJteldCcEFHZXRocVp1M3hZWHcyMTFLYjlEN3V3VVl4TGswYUVqcW1ZM0JHN3ZpTkt2Vy1saXoyU2tPN1AxUXpjanpoSkd0ZmcwcWtPTmFUZDZqSVlWSjl0SXUwSUR6OVlHMnNxbUMyTVB1NWVFOTZKclE3V3VaVVpCalpsaEhYRU8yNVJaUWo1N1BrUjh2OFJLU2hiUQ?oc=5\n2025-06-05 18:08:41,832 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMi_gFBVV95cUxORHNQaDZTVzN2VGJfZXpTVUtidEIzOGFvS1VtVUFqMGpCUHVsVl9BRkNfRXRORUJFTC1jTWtNVnkwekRSMzU2c2lqZEtEU2RrbVlMbXd4WFdHQ2VLZS1qbFFXZ0dEYWN4WVJteldCcEFHZXRocVp1M3hZWHcyMTFLYjlEN3V3VVl4TGswYUVqcW1ZM0JHN3ZpTkt2Vy1saXoyU2tPN1AxUXpjanpoSkd0ZmcwcWtPTmFUZDZqSVlWSjl0SXUwSUR6OVlHMnNxbUMyTVB1NWVFOTZKclE3V3VaVVpCalpsaEhYRU8yNVJaUWo1N1BrUjh2OFJLU2hiUQ?oc=5\n📥 Novos artigos recebidos: 3\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 3\n💾 Guardados 3 artigos no arquivo /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📥 Novos artigos recebidos: 3\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 3\n💾 Guardados 3 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:08:41] ✅ Relevant articles saved: 3 articles\n2025-06-05 18:08:41,837 - INFO - ✅ Relevant articles saved: 3 articles\n[2025-06-05 18:08:41] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n2025-06-05 18:08:41,838 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n[2025-06-05 18:08:41] ✅ Lote 1 concluído: 3 artigos (total: 3)\n2025-06-05 18:08:41,838 - INFO - ✅ Lote 1 concluído: 3 artigos (total: 3)\n📥 Novos artigos recebidos: 3\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 3\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 3\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 3\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-05 18:08:46] ✅ Relevant articles saved: 3 articles\n2025-06-05 18:08:46,824 - INFO - ✅ Relevant articles saved: 3 articles\n[2025-06-05 18:08:46] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n2025-06-05 18:08:46,827 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n[2025-06-05 18:08:46] ==================================================\n2025-06-05 18:08:46,827 - INFO - ==================================================\n[2025-06-05 18:08:46] Processamento Concluído com Sucesso\n2025-06-05 18:08:46,828 - INFO - Processamento Concluído com Sucesso\n[2025-06-05 18:08:46] ==================================================\n2025-06-05 18:08:46,828 - INFO - ==================================================\n[2025-06-05 18:08:46]   Total de Artigos Processados: 3\n2025-06-05 18:08:46,828 - INFO -   Total de Artigos Processados: 3\n[2025-06-05 18:08:46]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:08:46,828 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:08:46]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:08:46,828 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:08:46]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n2025-06-05 18:08:46,828 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n[2025-06-05 18:08:46]   Taxa de Sucesso: 50.0%\n2025-06-05 18:08:46,828 - INFO -   Taxa de Sucesso: 50.0%\n[2025-06-05 18:08:46] ==================================================\n2025-06-05 18:08:46,828 - INFO - ==================================================\n[2025-06-05 18:08:46] ✅ Processing completed. Processed 3 articles\n2025-06-05 18:08:46,838 - INFO - ✅ Processing completed. Processed 3 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-05T20:00:01.952773","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T20:00:01.953262","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T20:00:02.003459Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:02.005710Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:02.009732Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:02.010069Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:02.010657Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:02.010737Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:02.010821Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:02.010884Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:02.011174Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:02.011336Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:02.011477Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:02.011528Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:02.011574Z","level":"info","event":"  - relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:02.011626Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:02.011679Z","level":"info","event":"  - processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:02.011734Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:02.011794Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv --output_dir /opt/airflow/scripts/google_scraper/data/structured/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:02.011918Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.369469Z","level":"info","event":"📋 [2025-06-05 21:00:03] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.369771Z","level":"info","event":"📋 2025-06-05 21:00:03,369 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.369869Z","level":"info","event":"📋 [2025-06-05 21:00:03] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.370231Z","level":"info","event":"📋 2025-06-05 21:00:03,369 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.370340Z","level":"info","event":"📋 [2025-06-05 21:00:03] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.370486Z","level":"info","event":"📋 2025-06-05 21:00:03,369 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.370578Z","level":"info","event":"📋 [2025-06-05 21:00:03] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.370700Z","level":"info","event":"📋 2025-06-05 21:00:03,369 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.370807Z","level":"info","event":"📋 [2025-06-05 21:00:03] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.370879Z","level":"info","event":"📋 2025-06-05 21:00:03,369 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.371351Z","level":"info","event":"📋 [2025-06-05 21:00:03] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.371415Z","level":"info","event":"📋 2025-06-05 21:00:03,369 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.371467Z","level":"info","event":"📋 [2025-06-05 21:00:03] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.371514Z","level":"info","event":"📋 2025-06-05 21:00:03,369 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.371564Z","level":"info","event":"📋 [2025-06-05 21:00:03] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.371611Z","level":"info","event":"📋 2025-06-05 21:00:03,370 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.371679Z","level":"info","event":"📋 [2025-06-05 21:00:03] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.371725Z","level":"info","event":"📋 2025-06-05 21:00:03,370 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.371774Z","level":"info","event":"📋 [2025-06-05 21:00:03] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.371869Z","level":"info","event":"📋 2025-06-05 21:00:03,370 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.371914Z","level":"info","event":"📋 [2025-06-05 21:00:03] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.371961Z","level":"info","event":"📋 2025-06-05 21:00:03,370 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.372007Z","level":"info","event":"📋 [2025-06-05 21:00:03] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.372060Z","level":"info","event":"📋 2025-06-05 21:00:03,370 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.372206Z","level":"info","event":"📋 [2025-06-05 21:00:03] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.372289Z","level":"info","event":"📋 2025-06-05 21:00:03,372 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.372419Z","level":"info","event":"📋 [2025-06-05 21:00:03] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.372563Z","level":"info","event":"📋 2025-06-05 21:00:03,372 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.372643Z","level":"info","event":"📋 [2025-06-05 21:00:03] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.372734Z","level":"info","event":"📋 2025-06-05 21:00:03,372 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.379855Z","level":"info","event":"📋 [2025-06-05 21:00:03] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.380239Z","level":"info","event":"📋 2025-06-05 21:00:03,379 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.380324Z","level":"info","event":"📋 [2025-06-05 21:00:03] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.380400Z","level":"info","event":"📋 2025-06-05 21:00:03,379 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.380489Z","level":"info","event":"📋 [2025-06-05 21:00:03] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.380562Z","level":"info","event":"📋 2025-06-05 21:00:03,379 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.380664Z","level":"info","event":"📋 [2025-06-05 21:00:03] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.380770Z","level":"info","event":"📋 2025-06-05 21:00:03,379 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.380840Z","level":"info","event":"📋 [2025-06-05 21:00:03]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.382910Z","level":"info","event":"📋 2025-06-05 21:00:03,379 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.383202Z","level":"info","event":"📋 [2025-06-05 21:00:03]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.383355Z","level":"info","event":"📋 2025-06-05 21:00:03,379 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.383411Z","level":"info","event":"📋 [2025-06-05 21:00:03]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.383494Z","level":"info","event":"📋 2025-06-05 21:00:03,379 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.383552Z","level":"info","event":"📋 [2025-06-05 21:00:03]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.383604Z","level":"info","event":"📋 2025-06-05 21:00:03,379 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.383655Z","level":"info","event":"📋 [2025-06-05 21:00:03]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.383704Z","level":"info","event":"📋 2025-06-05 21:00:03,379 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.383755Z","level":"info","event":"📋 [2025-06-05 21:00:03] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.383804Z","level":"info","event":"📋 2025-06-05 21:00:03,379 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.385044Z","level":"info","event":"📋 [2025-06-05 21:00:03] ✅ Ficheiro CSV válido com 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.385149Z","level":"info","event":"📋 2025-06-05 21:00:03,384 - INFO - ✅ Ficheiro CSV válido com 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.385213Z","level":"info","event":"📋 [2025-06-05 21:00:03] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.385276Z","level":"info","event":"📋 2025-06-05 21:00:03,385 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.385368Z","level":"info","event":"📋 [2025-06-05 21:00:03] 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.385420Z","level":"info","event":"📋 2025-06-05 21:00:03,385 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.385493Z","level":"info","event":"📋 [2025-06-05 21:00:03] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.385588Z","level":"info","event":"📋 2025-06-05 21:00:03,385 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.385698Z","level":"info","event":"📋 [2025-06-05 21:00:03] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.386273Z","level":"info","event":"📋 2025-06-05 21:00:03,385 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.386568Z","level":"info","event":"📋 [2025-06-05 21:00:03] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.386643Z","level":"info","event":"📋 2025-06-05 21:00:03,385 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.386703Z","level":"info","event":"📋 [2025-06-05 21:00:03]   Total de Artigos para Processar: 12","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.387419Z","level":"info","event":"📋 2025-06-05 21:00:03,385 - INFO -   Total de Artigos para Processar: 12","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.388193Z","level":"info","event":"📋 [2025-06-05 21:00:03]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.388339Z","level":"info","event":"📋 2025-06-05 21:00:03,385 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.388449Z","level":"info","event":"📋 [2025-06-05 21:00:03]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.388569Z","level":"info","event":"📋 2025-06-05 21:00:03,385 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.388635Z","level":"info","event":"📋 [2025-06-05 21:00:03]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.388684Z","level":"info","event":"📋 2025-06-05 21:00:03,385 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.388728Z","level":"info","event":"📋 [2025-06-05 21:00:03]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.388778Z","level":"info","event":"📋 2025-06-05 21:00:03,385 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.388829Z","level":"info","event":"📋 [2025-06-05 21:00:03] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.388903Z","level":"info","event":"📋 2025-06-05 21:00:03,385 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.388952Z","level":"info","event":"📋 [2025-06-05 21:00:03] ⏩ A retomar do índice 12 após o ID: 1e795af93eb00e95e13b9722432e619a","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.388998Z","level":"info","event":"📋 2025-06-05 21:00:03,387 - INFO - ⏩ A retomar do índice 12 após o ID: 1e795af93eb00e95e13b9722432e619a","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.389044Z","level":"info","event":"📋 [2025-06-05 21:00:03] ⚠️ Nenhum artigo foi processado com sucesso.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.389092Z","level":"info","event":"📋 2025-06-05 21:00:03,388 - WARNING - ⚠️ Nenhum artigo foi processado com sucesso.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.389223Z","level":"info","event":"📋 [2025-06-05 21:00:03] ✅ Processing completed. Processed 0 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.389276Z","level":"info","event":"📋 2025-06-05 21:00:03,389 - INFO - ✅ Processing completed. Processed 0 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.471679Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.472027Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:03.472264Z","level":"info","event":"✅ relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (1907 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.124174Z","level":"info","event":"📊 Number of processed articles: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.124389Z","level":"info","event":"📊 Columns: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.126228Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.126386Z","level":"info","event":"⚠️ processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.127185Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.124832","level":"info","event":"Done. Returned value was: [2025-06-05 21:00:03] Starting processar_relevantes_airflow\n2025-06-05 21:00:03,369 - INFO - Starting processar_relevantes_airflow\n[2025-06-05 21:00:03] Parameters: dias=1, date=2025-06-05\n2025-06-05 21:00:03,369 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 21:00:03] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n2025-06-05 21:00:03,369 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n[2025-06-05 21:00:03] 🚀 A iniciar processar_relevantes_airflow\n2025-06-05 21:00:03,369 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-05 21:00:03] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 21:00:03,369 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 21:00:03] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 21:00:03,369 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 21:00:03] 🔧 A carregar ficheiros de configuração...\n2025-06-05 21:00:03,369 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-05 21:00:03] 🔍 Checking config path: /opt/airflow/config\n2025-06-05 21:00:03,370 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-05 21:00:03] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-05 21:00:03,370 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-05 21:00:03] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-05 21:00:03,370 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-05 21:00:03] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-05 21:00:03,370 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-05 21:00:03] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-05 21:00:03,370 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-05 21:00:03] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-05 21:00:03,372 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-05 21:00:03] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-05 21:00:03,372 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-05 21:00:03] ✅ Loaded 6 keywords\n2025-06-05 21:00:03,372 - INFO - ✅ Loaded 6 keywords\n[2025-06-05 21:00:03] ✅ Loaded 3614 DICOFREG codes\n2025-06-05 21:00:03,379 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-05 21:00:03] ==================================================\n2025-06-05 21:00:03,379 - INFO - ==================================================\n[2025-06-05 21:00:03] Configuration Loaded\n2025-06-05 21:00:03,379 - INFO - Configuration Loaded\n[2025-06-05 21:00:03] ==================================================\n2025-06-05 21:00:03,379 - INFO - ==================================================\n[2025-06-05 21:00:03]   Parishes: 306\n2025-06-05 21:00:03,379 - INFO -   Parishes: 306\n[2025-06-05 21:00:03]   Municipalities: 306\n2025-06-05 21:00:03,379 - INFO -   Municipalities: 306\n[2025-06-05 21:00:03]   Districts: 29\n2025-06-05 21:00:03,379 - INFO -   Districts: 29\n[2025-06-05 21:00:03]   Keywords: 6\n2025-06-05 21:00:03,379 - INFO -   Keywords: 6\n[2025-06-05 21:00:03]   DICOFREG Codes: 3614\n2025-06-05 21:00:03,379 - INFO -   DICOFREG Codes: 3614\n[2025-06-05 21:00:03] ==================================================\n2025-06-05 21:00:03,379 - INFO - ==================================================\n[2025-06-05 21:00:03] ✅ Ficheiro CSV válido com 12 artigos\n2025-06-05 21:00:03,384 - INFO - ✅ Ficheiro CSV válido com 12 artigos\n[2025-06-05 21:00:03] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-05 21:00:03,385 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-05 21:00:03] 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos\n2025-06-05 21:00:03,385 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos\n[2025-06-05 21:00:03] ==================================================\n2025-06-05 21:00:03,385 - INFO - ==================================================\n[2025-06-05 21:00:03] Processamento Iniciado\n2025-06-05 21:00:03,385 - INFO - Processamento Iniciado\n[2025-06-05 21:00:03] ==================================================\n2025-06-05 21:00:03,385 - INFO - ==================================================\n[2025-06-05 21:00:03]   Total de Artigos para Processar: 12\n2025-06-05 21:00:03,385 - INFO -   Total de Artigos para Processar: 12\n[2025-06-05 21:00:03]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 21:00:03,385 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 21:00:03]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 21:00:03,385 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 21:00:03]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 21:00:03,385 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 21:00:03]   Filtro de Dias: 1\n2025-06-05 21:00:03,385 - INFO -   Filtro de Dias: 1\n[2025-06-05 21:00:03] ==================================================\n2025-06-05 21:00:03,385 - INFO - ==================================================\n[2025-06-05 21:00:03] ⏩ A retomar do índice 12 após o ID: 1e795af93eb00e95e13b9722432e619a\n2025-06-05 21:00:03,387 - INFO - ⏩ A retomar do índice 12 após o ID: 1e795af93eb00e95e13b9722432e619a\n[2025-06-05 21:00:03] ⚠️ Nenhum artigo foi processado com sucesso.\n2025-06-05 21:00:03,388 - WARNING - ⚠️ Nenhum artigo foi processado com sucesso.\n[2025-06-05 21:00:03] ✅ Processing completed. Processed 0 articles\n2025-06-05 21:00:03,389 - INFO - ✅ Processing completed. Processed 0 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-05T20:06:05.667931","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T20:06:05.668608","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T20:06:05.712741Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:05.713423Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:05.715955Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:05.716561Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:05.716669Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:05.717032Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:05.717190Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:05.717302Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:05.717387Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:05.717653Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:05.717818Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:05.717910Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:05.718167Z","level":"info","event":"  - relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:05.718262Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:05.718392Z","level":"info","event":"  - processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:05.718470Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:05.718548Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv --output_dir /opt/airflow/scripts/google_scraper/data/structured/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:05.718653Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.164524Z","level":"info","event":"📋 [2025-06-05 21:06:07] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.164873Z","level":"info","event":"📋 2025-06-05 21:06:07,164 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.165154Z","level":"info","event":"📋 [2025-06-05 21:06:07] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.165220Z","level":"info","event":"📋 2025-06-05 21:06:07,164 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.165350Z","level":"info","event":"📋 [2025-06-05 21:06:07] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.165527Z","level":"info","event":"📋 2025-06-05 21:06:07,164 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.165635Z","level":"info","event":"📋 [2025-06-05 21:06:07] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.165710Z","level":"info","event":"📋 2025-06-05 21:06:07,164 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.165782Z","level":"info","event":"📋 [2025-06-05 21:06:07] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.166292Z","level":"info","event":"📋 2025-06-05 21:06:07,164 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.166348Z","level":"info","event":"📋 [2025-06-05 21:06:07] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.166393Z","level":"info","event":"📋 2025-06-05 21:06:07,165 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.166429Z","level":"info","event":"📋 [2025-06-05 21:06:07] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.166465Z","level":"info","event":"📋 2025-06-05 21:06:07,165 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.166506Z","level":"info","event":"📋 [2025-06-05 21:06:07] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.166547Z","level":"info","event":"📋 2025-06-05 21:06:07,165 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.166604Z","level":"info","event":"📋 [2025-06-05 21:06:07] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.166642Z","level":"info","event":"📋 2025-06-05 21:06:07,165 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.166693Z","level":"info","event":"📋 [2025-06-05 21:06:07] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.166740Z","level":"info","event":"📋 2025-06-05 21:06:07,165 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.166781Z","level":"info","event":"📋 [2025-06-05 21:06:07] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.166842Z","level":"info","event":"📋 2025-06-05 21:06:07,165 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.166877Z","level":"info","event":"📋 [2025-06-05 21:06:07] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.166911Z","level":"info","event":"📋 2025-06-05 21:06:07,165 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.167153Z","level":"info","event":"📋 [2025-06-05 21:06:07] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.167240Z","level":"info","event":"📋 2025-06-05 21:06:07,167 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.167317Z","level":"info","event":"📋 [2025-06-05 21:06:07] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.167394Z","level":"info","event":"📋 2025-06-05 21:06:07,167 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.167482Z","level":"info","event":"📋 [2025-06-05 21:06:07] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.167535Z","level":"info","event":"📋 2025-06-05 21:06:07,167 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.171154Z","level":"info","event":"📋 [2025-06-05 21:06:07] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.171438Z","level":"info","event":"📋 2025-06-05 21:06:07,171 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.171728Z","level":"info","event":"📋 [2025-06-05 21:06:07] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.171786Z","level":"info","event":"📋 2025-06-05 21:06:07,171 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.171836Z","level":"info","event":"📋 [2025-06-05 21:06:07] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.171885Z","level":"info","event":"📋 2025-06-05 21:06:07,171 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.171935Z","level":"info","event":"📋 [2025-06-05 21:06:07] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.171983Z","level":"info","event":"📋 2025-06-05 21:06:07,171 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.172031Z","level":"info","event":"📋 [2025-06-05 21:06:07]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.172142Z","level":"info","event":"📋 2025-06-05 21:06:07,171 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.172309Z","level":"info","event":"📋 [2025-06-05 21:06:07]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.173165Z","level":"info","event":"📋 2025-06-05 21:06:07,171 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.173223Z","level":"info","event":"📋 [2025-06-05 21:06:07]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.173300Z","level":"info","event":"📋 2025-06-05 21:06:07,171 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.173351Z","level":"info","event":"📋 [2025-06-05 21:06:07]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.173398Z","level":"info","event":"📋 2025-06-05 21:06:07,171 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.173458Z","level":"info","event":"📋 [2025-06-05 21:06:07]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.173506Z","level":"info","event":"📋 2025-06-05 21:06:07,171 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.173554Z","level":"info","event":"📋 [2025-06-05 21:06:07] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.173600Z","level":"info","event":"📋 2025-06-05 21:06:07,171 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.174657Z","level":"info","event":"📋 [2025-06-05 21:06:07] ✅ Ficheiro CSV válido com 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.175194Z","level":"info","event":"📋 2025-06-05 21:06:07,174 - INFO - ✅ Ficheiro CSV válido com 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.175366Z","level":"info","event":"📋 [2025-06-05 21:06:07] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.175965Z","level":"info","event":"📋 2025-06-05 21:06:07,174 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.176028Z","level":"info","event":"📋 [2025-06-05 21:06:07] 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.176081Z","level":"info","event":"📋 2025-06-05 21:06:07,174 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.176126Z","level":"info","event":"📋 [2025-06-05 21:06:07] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.176174Z","level":"info","event":"📋 2025-06-05 21:06:07,174 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.176224Z","level":"info","event":"📋 [2025-06-05 21:06:07] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.176271Z","level":"info","event":"📋 2025-06-05 21:06:07,175 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.176319Z","level":"info","event":"📋 [2025-06-05 21:06:07] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.176370Z","level":"info","event":"📋 2025-06-05 21:06:07,175 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.176418Z","level":"info","event":"📋 [2025-06-05 21:06:07]   Total de Artigos para Processar: 12","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.176465Z","level":"info","event":"📋 2025-06-05 21:06:07,175 - INFO -   Total de Artigos para Processar: 12","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.176513Z","level":"info","event":"📋 [2025-06-05 21:06:07]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.176572Z","level":"info","event":"📋 2025-06-05 21:06:07,175 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.176656Z","level":"info","event":"📋 [2025-06-05 21:06:07]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.176706Z","level":"info","event":"📋 2025-06-05 21:06:07,175 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.176756Z","level":"info","event":"📋 [2025-06-05 21:06:07]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.176804Z","level":"info","event":"📋 2025-06-05 21:06:07,175 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.177259Z","level":"info","event":"📋 [2025-06-05 21:06:07]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.177337Z","level":"info","event":"📋 2025-06-05 21:06:07,175 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.177387Z","level":"info","event":"📋 [2025-06-05 21:06:07] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.177436Z","level":"info","event":"📋 2025-06-05 21:06:07,175 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.177503Z","level":"info","event":"📋 [2025-06-05 21:06:07] ⏩ A retomar do índice 12 após o ID: 1e795af93eb00e95e13b9722432e619a","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.177549Z","level":"info","event":"📋 2025-06-05 21:06:07,177 - INFO - ⏩ A retomar do índice 12 após o ID: 1e795af93eb00e95e13b9722432e619a","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.178308Z","level":"info","event":"📋 [2025-06-05 21:06:07] ⚠️ Nenhum artigo foi processado com sucesso.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.181298Z","level":"info","event":"📋 2025-06-05 21:06:07,178 - WARNING - ⚠️ Nenhum artigo foi processado com sucesso.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.182334Z","level":"info","event":"📋 [2025-06-05 21:06:07] ✅ Processing completed. Processed 0 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.184272Z","level":"info","event":"📋 2025-06-05 21:06:07,178 - INFO - ✅ Processing completed. Processed 0 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.279947Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.280157Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.280345Z","level":"info","event":"✅ relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (1907 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.899325Z","level":"info","event":"📊 Number of processed articles: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.899493Z","level":"info","event":"📊 Columns: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.899608Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.901518Z","level":"info","event":"⚠️ processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.902289Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:07.899886","level":"info","event":"Done. Returned value was: [2025-06-05 21:06:07] Starting processar_relevantes_airflow\n2025-06-05 21:06:07,164 - INFO - Starting processar_relevantes_airflow\n[2025-06-05 21:06:07] Parameters: dias=1, date=2025-06-05\n2025-06-05 21:06:07,164 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 21:06:07] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n2025-06-05 21:06:07,164 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n[2025-06-05 21:06:07] 🚀 A iniciar processar_relevantes_airflow\n2025-06-05 21:06:07,164 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-05 21:06:07] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 21:06:07,164 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 21:06:07] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 21:06:07,165 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 21:06:07] 🔧 A carregar ficheiros de configuração...\n2025-06-05 21:06:07,165 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-05 21:06:07] 🔍 Checking config path: /opt/airflow/config\n2025-06-05 21:06:07,165 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-05 21:06:07] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-05 21:06:07,165 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-05 21:06:07] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-05 21:06:07,165 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-05 21:06:07] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-05 21:06:07,165 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-05 21:06:07] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-05 21:06:07,165 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-05 21:06:07] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-05 21:06:07,167 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-05 21:06:07] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-05 21:06:07,167 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-05 21:06:07] ✅ Loaded 6 keywords\n2025-06-05 21:06:07,167 - INFO - ✅ Loaded 6 keywords\n[2025-06-05 21:06:07] ✅ Loaded 3614 DICOFREG codes\n2025-06-05 21:06:07,171 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-05 21:06:07] ==================================================\n2025-06-05 21:06:07,171 - INFO - ==================================================\n[2025-06-05 21:06:07] Configuration Loaded\n2025-06-05 21:06:07,171 - INFO - Configuration Loaded\n[2025-06-05 21:06:07] ==================================================\n2025-06-05 21:06:07,171 - INFO - ==================================================\n[2025-06-05 21:06:07]   Parishes: 306\n2025-06-05 21:06:07,171 - INFO -   Parishes: 306\n[2025-06-05 21:06:07]   Municipalities: 306\n2025-06-05 21:06:07,171 - INFO -   Municipalities: 306\n[2025-06-05 21:06:07]   Districts: 29\n2025-06-05 21:06:07,171 - INFO -   Districts: 29\n[2025-06-05 21:06:07]   Keywords: 6\n2025-06-05 21:06:07,171 - INFO -   Keywords: 6\n[2025-06-05 21:06:07]   DICOFREG Codes: 3614\n2025-06-05 21:06:07,171 - INFO -   DICOFREG Codes: 3614\n[2025-06-05 21:06:07] ==================================================\n2025-06-05 21:06:07,171 - INFO - ==================================================\n[2025-06-05 21:06:07] ✅ Ficheiro CSV válido com 12 artigos\n2025-06-05 21:06:07,174 - INFO - ✅ Ficheiro CSV válido com 12 artigos\n[2025-06-05 21:06:07] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-05 21:06:07,174 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-05 21:06:07] 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos\n2025-06-05 21:06:07,174 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos\n[2025-06-05 21:06:07] ==================================================\n2025-06-05 21:06:07,174 - INFO - ==================================================\n[2025-06-05 21:06:07] Processamento Iniciado\n2025-06-05 21:06:07,175 - INFO - Processamento Iniciado\n[2025-06-05 21:06:07] ==================================================\n2025-06-05 21:06:07,175 - INFO - ==================================================\n[2025-06-05 21:06:07]   Total de Artigos para Processar: 12\n2025-06-05 21:06:07,175 - INFO -   Total de Artigos para Processar: 12\n[2025-06-05 21:06:07]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 21:06:07,175 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 21:06:07]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 21:06:07,175 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 21:06:07]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 21:06:07,175 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 21:06:07]   Filtro de Dias: 1\n2025-06-05 21:06:07,175 - INFO -   Filtro de Dias: 1\n[2025-06-05 21:06:07] ==================================================\n2025-06-05 21:06:07,175 - INFO - ==================================================\n[2025-06-05 21:06:07] ⏩ A retomar do índice 12 após o ID: 1e795af93eb00e95e13b9722432e619a\n2025-06-05 21:06:07,177 - INFO - ⏩ A retomar do índice 12 após o ID: 1e795af93eb00e95e13b9722432e619a\n[2025-06-05 21:06:07] ⚠️ Nenhum artigo foi processado com sucesso.\n2025-06-05 21:06:07,178 - WARNING - ⚠️ Nenhum artigo foi processado com sucesso.\n[2025-06-05 21:06:07] ✅ Processing completed. Processed 0 articles\n2025-06-05 21:06:07,178 - INFO - ✅ Processing completed. Processed 0 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
