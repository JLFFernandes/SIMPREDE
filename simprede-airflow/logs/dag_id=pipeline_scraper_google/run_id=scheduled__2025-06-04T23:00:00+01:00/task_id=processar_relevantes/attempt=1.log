{"timestamp":"2025-06-05T17:08:17.249898","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T17:08:17.250385","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T17:08:17.291136Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.293824Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.294706Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.295677Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.296209Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.296658Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.296938Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.297124Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.297234Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.297344Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.297430Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.297506Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.297587Z","level":"info","event":"  - relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.297673Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.297775Z","level":"info","event":"  - processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.298104Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.298181Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv --output_dir /opt/airflow/scripts/google_scraper/data/structured/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:17.298282Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.805942Z","level":"info","event":"📋 [2025-06-05 18:08:18] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.806546Z","level":"info","event":"📋 2025-06-05 18:08:18,805 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.806798Z","level":"info","event":"📋 [2025-06-05 18:08:18] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.806853Z","level":"info","event":"📋 2025-06-05 18:08:18,805 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.806897Z","level":"info","event":"📋 [2025-06-05 18:08:18] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807024Z","level":"info","event":"📋 2025-06-05 18:08:18,805 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807088Z","level":"info","event":"📋 [2025-06-05 18:08:18] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807158Z","level":"info","event":"📋 2025-06-05 18:08:18,805 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807657Z","level":"info","event":"📋 [2025-06-05 18:08:18] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807702Z","level":"info","event":"📋 2025-06-05 18:08:18,805 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807740Z","level":"info","event":"📋 [2025-06-05 18:08:18] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807821Z","level":"info","event":"📋 2025-06-05 18:08:18,806 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807858Z","level":"info","event":"📋 [2025-06-05 18:08:18] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807893Z","level":"info","event":"📋 2025-06-05 18:08:18,806 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807927Z","level":"info","event":"📋 [2025-06-05 18:08:18] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.807961Z","level":"info","event":"📋 2025-06-05 18:08:18,806 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.808000Z","level":"info","event":"📋 [2025-06-05 18:08:18] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.808045Z","level":"info","event":"📋 2025-06-05 18:08:18,806 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.808089Z","level":"info","event":"📋 [2025-06-05 18:08:18] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.808304Z","level":"info","event":"📋 2025-06-05 18:08:18,806 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.808403Z","level":"info","event":"📋 [2025-06-05 18:08:18] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.808739Z","level":"info","event":"📋 2025-06-05 18:08:18,806 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.808831Z","level":"info","event":"📋 [2025-06-05 18:08:18] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.808889Z","level":"info","event":"📋 2025-06-05 18:08:18,806 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.810488Z","level":"info","event":"📋 [2025-06-05 18:08:18] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.811937Z","level":"info","event":"📋 2025-06-05 18:08:18,808 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.813607Z","level":"info","event":"📋 [2025-06-05 18:08:18] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815292Z","level":"info","event":"📋 2025-06-05 18:08:18,808 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815358Z","level":"info","event":"📋 [2025-06-05 18:08:18] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815397Z","level":"info","event":"📋 2025-06-05 18:08:18,808 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815469Z","level":"info","event":"📋 [2025-06-05 18:08:18] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815519Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815555Z","level":"info","event":"📋 [2025-06-05 18:08:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815591Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815626Z","level":"info","event":"📋 [2025-06-05 18:08:18] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815661Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815696Z","level":"info","event":"📋 [2025-06-05 18:08:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815732Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815771Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815825Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815867Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815903Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815939Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.815975Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.816039Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.816075Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.816110Z","level":"info","event":"📋 [2025-06-05 18:08:18]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.816144Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.816179Z","level":"info","event":"📋 [2025-06-05 18:08:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.816213Z","level":"info","event":"📋 2025-06-05 18:08:18,815 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.817349Z","level":"info","event":"📋 [2025-06-05 18:08:18] ✅ Ficheiro CSV válido com 6 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.817893Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO - ✅ Ficheiro CSV válido com 6 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818303Z","level":"info","event":"📋 [2025-06-05 18:08:18] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818350Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818387Z","level":"info","event":"📋 [2025-06-05 18:08:18] 📅 Filtrado para artigos dos últimos 1 dias: 6 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818424Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 6 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818474Z","level":"info","event":"📋 [2025-06-05 18:08:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818522Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818576Z","level":"info","event":"📋 [2025-06-05 18:08:18] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818624Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818676Z","level":"info","event":"📋 [2025-06-05 18:08:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818726Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.818777Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Total de Artigos para Processar: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.819803Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO -   Total de Artigos para Processar: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.821763Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.821865Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822015Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822075Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822152Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822226Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822289Z","level":"info","event":"📋 [2025-06-05 18:08:18]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822348Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822421Z","level":"info","event":"📋 [2025-06-05 18:08:18] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822548Z","level":"info","event":"📋 2025-06-05 18:08:18,817 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822653Z","level":"info","event":"📋 [2025-06-05 18:08:18] 📦 A processar lote 1/1 (6 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:18.822718Z","level":"info","event":"📋 2025-06-05 18:08:18,818 - INFO - 📦 A processar lote 1/1 (6 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:22.099999Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:22.484991Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:22.603586Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:22.653095Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:22.708824Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:27.864455Z","level":"info","event":"📋 [2025-06-05 18:08:27] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga Nações: UEFA está a monitorizar mau tempo em Munique - Diário de Viseu","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:27.866522Z","level":"info","event":"📋 2025-06-05 18:08:27,751 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga Nações: UEFA está a monitorizar mau tempo em Munique - Diário de Viseu","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:27.866631Z","level":"info","event":"📋 [2025-06-05 18:08:27] 🔄 Processado: Liga Nações: UEFA está a monitorizar mau tempo em ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:27.866686Z","level":"info","event":"📋 2025-06-05 18:08:27,776 - INFO - 🔄 Processado: Liga Nações: UEFA está a monitorizar mau tempo em ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:28.965710Z","level":"info","event":"📋 [2025-06-05 18:08:28] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva de granizo envia guarda-redes do Alemanha-Portugal para os balneários - Abola.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:28.969599Z","level":"info","event":"📋 2025-06-05 18:08:28,965 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva de granizo envia guarda-redes do Alemanha-Portugal para os balneários - Abola.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:28.969806Z","level":"info","event":"📋 [2025-06-05 18:08:28] 🔄 Processado: Chuva de granizo envia guarda-redes do Alemanha-Po...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:28.969905Z","level":"info","event":"📋 2025-06-05 18:08:28,966 - INFO - 🔄 Processado: Chuva de granizo envia guarda-redes do Alemanha-Po...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:31.736932Z","level":"info","event":"📋 [2025-06-05 18:08:31] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (05) para Resende (RJ) - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:31.738318Z","level":"info","event":"📋 2025-06-05 18:08:31,735 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (05) para Resende (RJ) - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:31.740375Z","level":"info","event":"📋 [2025-06-05 18:08:31] 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (05) ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:31.740586Z","level":"info","event":"📋 2025-06-05 18:08:31,740 - INFO - 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (05) ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:32.935411Z","level":"info","event":"⚠️ ❌ Erro ao resolver URL do Google News: Message:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:32.938790Z","level":"info","event":"⚠️","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:32.998278Z","level":"info","event":"📋 [2025-06-05 18:08:32] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiX0FVX3lxTE1lN1M4dmh6bjQ3MjNHTVN2Qk9VOHVaVy0tS2duRjJ4MVp0ZEp3Z0ZIQzN0RnFxSHk3SUI2MTNBbFJaOTR1b29BWmkzMVp1cFJSWmJQVWdfWExoM1hKRWow?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:32.998477Z","level":"info","event":"📋 2025-06-05 18:08:32,998 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiX0FVX3lxTE1lN1M4dmh6bjQ3MjNHTVN2Qk9VOHVaVy0tS2duRjJ4MVp0ZEp3Z0ZIQzN0RnFxSHk3SUI2MTNBbFJaOTR1b29BWmkzMVp1cFJSWmJQVWdfWExoM1hKRWow?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:40.195735Z","level":"info","event":"⚠️ ❌ Erro ao resolver URL do Google News: Message:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:40.196769Z","level":"info","event":"⚠️","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:40.261413Z","level":"info","event":"📋 [2025-06-05 18:08:40] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiygFBVV95cUxPdW4wZEtZaVZXby0ybTdXdUZwR0EwOFYtTUN0d055WkZNRmg4S0JEaFdkSk1fWWEyWXVNcnk4Z0hsTHhQSVltcnNXX1ZjNFJzS1g5Rnp0clNsNHhrY2QtWldHYVUycHZLcnNLVGtJWnBQQ2ZCcGstZUlFNnRsYUlidm9NR05ZWi1yWThtaHVLaTNiN2Z6cHFsczhUdi1wUEJoUElWa21sZi1sZmU5ZDgta3hyM3BxdEVSazduSDRxQm5DckZYTWFGYUZn0gG7AUFVX3lxTE9ZdXRXcTB4SzJ1RVhQeUc1R2JxMlJBMExOTUFjbEJFY2E1Y3RIYTJQa2x2WXFSSFczWHdxeVNka3dGbFEzWG8xNjdQbGk2SDE3Ymo0UjlvX19VY3JzYUhlVHN6d29QejloTmZpTDhKQ2pJanNuY08xbUVNWENteVlSUHU1MGZVU2J4RnZOc2hzN0J0eHRSU2NYNndydlg1ODBUUFJsSHZ3Vzh5RFFzWFUzYktEOThVTlhfS0E?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:40.261679Z","level":"info","event":"📋 2025-06-05 18:08:40,261 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiygFBVV95cUxPdW4wZEtZaVZXby0ybTdXdUZwR0EwOFYtTUN0d055WkZNRmg4S0JEaFdkSk1fWWEyWXVNcnk4Z0hsTHhQSVltcnNXX1ZjNFJzS1g5Rnp0clNsNHhrY2QtWldHYVUycHZLcnNLVGtJWnBQQ2ZCcGstZUlFNnRsYUlidm9NR05ZWi1yWThtaHVLaTNiN2Z6cHFsczhUdi1wUEJoUElWa21sZi1sZmU5ZDgta3hyM3BxdEVSazduSDRxQm5DckZYTWFGYUZn0gG7AUFVX3lxTE9ZdXRXcTB4SzJ1RVhQeUc1R2JxMlJBMExOTUFjbEJFY2E1Y3RIYTJQa2x2WXFSSFczWHdxeVNka3dGbFEzWG8xNjdQbGk2SDE3Ymo0UjlvX19VY3JzYUhlVHN6d29QejloTmZpTDhKQ2pJanNuY08xbUVNWENteVlSUHU1MGZVU2J4RnZOc2hzN0J0eHRSU2NYNndydlg1ODBUUFJsSHZ3Vzh5RFFzWFUzYktEOThVTlhfS0E?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.766591Z","level":"info","event":"⚠️ ❌ Erro ao resolver URL do Google News: Message:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.767640Z","level":"info","event":"⚠️","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.832367Z","level":"info","event":"📋 [2025-06-05 18:08:41] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMi_gFBVV95cUxORHNQaDZTVzN2VGJfZXpTVUtidEIzOGFvS1VtVUFqMGpCUHVsVl9BRkNfRXRORUJFTC1jTWtNVnkwekRSMzU2c2lqZEtEU2RrbVlMbXd4WFdHQ2VLZS1qbFFXZ0dEYWN4WVJteldCcEFHZXRocVp1M3hZWHcyMTFLYjlEN3V3VVl4TGswYUVqcW1ZM0JHN3ZpTkt2Vy1saXoyU2tPN1AxUXpjanpoSkd0ZmcwcWtPTmFUZDZqSVlWSjl0SXUwSUR6OVlHMnNxbUMyTVB1NWVFOTZKclE3V3VaVVpCalpsaEhYRU8yNVJaUWo1N1BrUjh2OFJLU2hiUQ?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.832734Z","level":"info","event":"📋 2025-06-05 18:08:41,832 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMi_gFBVV95cUxORHNQaDZTVzN2VGJfZXpTVUtidEIzOGFvS1VtVUFqMGpCUHVsVl9BRkNfRXRORUJFTC1jTWtNVnkwekRSMzU2c2lqZEtEU2RrbVlMbXd4WFdHQ2VLZS1qbFFXZ0dEYWN4WVJteldCcEFHZXRocVp1M3hZWHcyMTFLYjlEN3V3VVl4TGswYUVqcW1ZM0JHN3ZpTkt2Vy1saXoyU2tPN1AxUXpjanpoSkd0ZmcwcWtPTmFUZDZqSVlWSjl0SXUwSUR6OVlHMnNxbUMyTVB1NWVFOTZKclE3V3VaVVpCalpsaEhYRU8yNVJaUWo1N1BrUjh2OFJLU2hiUQ?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.833770Z","level":"info","event":"📋 📥 Novos artigos recebidos: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.835618Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.835787Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.835973Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.836545Z","level":"info","event":"📋 💾 Guardados 3 artigos no arquivo /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.836924Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.837024Z","level":"info","event":"📋 📥 Novos artigos recebidos: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.837123Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.837255Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.837401Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.837614Z","level":"info","event":"📋 💾 Guardados 3 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.837970Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.838131Z","level":"info","event":"📋 [2025-06-05 18:08:41] ✅ Relevant articles saved: 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.838291Z","level":"info","event":"📋 2025-06-05 18:08:41,837 - INFO - ✅ Relevant articles saved: 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.838576Z","level":"info","event":"📋 [2025-06-05 18:08:41] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.838637Z","level":"info","event":"📋 2025-06-05 18:08:41,838 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.838704Z","level":"info","event":"📋 [2025-06-05 18:08:41] ✅ Lote 1 concluído: 3 artigos (total: 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:41.838773Z","level":"info","event":"📋 2025-06-05 18:08:41,838 - INFO - ✅ Lote 1 concluído: 3 artigos (total: 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.805186Z","level":"info","event":"📋 📥 Novos artigos recebidos: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.910085Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.911091Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.912828Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.912942Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913011Z","level":"info","event":"📋 📥 Novos artigos recebidos: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913068Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913115Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913180Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913231Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913278Z","level":"info","event":"📋 [2025-06-05 18:08:46] ✅ Relevant articles saved: 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913329Z","level":"info","event":"📋 2025-06-05 18:08:46,824 - INFO - ✅ Relevant articles saved: 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913372Z","level":"info","event":"📋 [2025-06-05 18:08:46] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913432Z","level":"info","event":"📋 2025-06-05 18:08:46,827 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913481Z","level":"info","event":"📋 [2025-06-05 18:08:46] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913531Z","level":"info","event":"📋 2025-06-05 18:08:46,827 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913577Z","level":"info","event":"📋 [2025-06-05 18:08:46] Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913716Z","level":"info","event":"📋 2025-06-05 18:08:46,828 - INFO - Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913773Z","level":"info","event":"📋 [2025-06-05 18:08:46] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913852Z","level":"info","event":"📋 2025-06-05 18:08:46,828 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913891Z","level":"info","event":"📋 [2025-06-05 18:08:46]   Total de Artigos Processados: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.913933Z","level":"info","event":"📋 2025-06-05 18:08:46,828 - INFO -   Total de Artigos Processados: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914063Z","level":"info","event":"📋 [2025-06-05 18:08:46]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914113Z","level":"info","event":"📋 2025-06-05 18:08:46,828 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914176Z","level":"info","event":"📋 [2025-06-05 18:08:46]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914311Z","level":"info","event":"📋 2025-06-05 18:08:46,828 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914438Z","level":"info","event":"📋 [2025-06-05 18:08:46]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914509Z","level":"info","event":"📋 2025-06-05 18:08:46,828 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914553Z","level":"info","event":"📋 [2025-06-05 18:08:46]   Taxa de Sucesso: 50.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914591Z","level":"info","event":"📋 2025-06-05 18:08:46,828 - INFO -   Taxa de Sucesso: 50.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914638Z","level":"info","event":"📋 [2025-06-05 18:08:46] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914683Z","level":"info","event":"📋 2025-06-05 18:08:46,828 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914734Z","level":"info","event":"📋 [2025-06-05 18:08:46] ✅ Processing completed. Processed 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:46.914783Z","level":"info","event":"📋 2025-06-05 18:08:46,838 - INFO - ✅ Processing completed. Processed 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.079827Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.080056Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.080229Z","level":"info","event":"✅ relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (916 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.875284Z","level":"info","event":"📊 Number of processed articles: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.875538Z","level":"info","event":"📊 Columns: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.875721Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.876558Z","level":"info","event":"⚠️ processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.876723Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:47.876120","level":"info","event":"Done. Returned value was: [2025-06-05 18:08:18] Starting processar_relevantes_airflow\n2025-06-05 18:08:18,805 - INFO - Starting processar_relevantes_airflow\n[2025-06-05 18:08:18] Parameters: dias=1, date=2025-06-05\n2025-06-05 18:08:18,805 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 18:08:18] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n2025-06-05 18:08:18,805 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n[2025-06-05 18:08:18] 🚀 A iniciar processar_relevantes_airflow\n2025-06-05 18:08:18,805 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-05 18:08:18] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 18:08:18,805 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 18:08:18] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 18:08:18,806 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 18:08:18] 🔧 A carregar ficheiros de configuração...\n2025-06-05 18:08:18,806 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-05 18:08:18] 🔍 Checking config path: /opt/airflow/config\n2025-06-05 18:08:18,806 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-05 18:08:18] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-05 18:08:18,806 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-05 18:08:18] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-05 18:08:18,806 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-05 18:08:18] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-05 18:08:18,806 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-05 18:08:18] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-05 18:08:18,806 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-05 18:08:18] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-05 18:08:18,808 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-05 18:08:18] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-05 18:08:18,808 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-05 18:08:18] ✅ Loaded 6 keywords\n2025-06-05 18:08:18,808 - INFO - ✅ Loaded 6 keywords\n[2025-06-05 18:08:18] ✅ Loaded 3614 DICOFREG codes\n2025-06-05 18:08:18,815 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-05 18:08:18] ==================================================\n2025-06-05 18:08:18,815 - INFO - ==================================================\n[2025-06-05 18:08:18] Configuration Loaded\n2025-06-05 18:08:18,815 - INFO - Configuration Loaded\n[2025-06-05 18:08:18] ==================================================\n2025-06-05 18:08:18,815 - INFO - ==================================================\n[2025-06-05 18:08:18]   Parishes: 306\n2025-06-05 18:08:18,815 - INFO -   Parishes: 306\n[2025-06-05 18:08:18]   Municipalities: 306\n2025-06-05 18:08:18,815 - INFO -   Municipalities: 306\n[2025-06-05 18:08:18]   Districts: 29\n2025-06-05 18:08:18,815 - INFO -   Districts: 29\n[2025-06-05 18:08:18]   Keywords: 6\n2025-06-05 18:08:18,815 - INFO -   Keywords: 6\n[2025-06-05 18:08:18]   DICOFREG Codes: 3614\n2025-06-05 18:08:18,815 - INFO -   DICOFREG Codes: 3614\n[2025-06-05 18:08:18] ==================================================\n2025-06-05 18:08:18,815 - INFO - ==================================================\n[2025-06-05 18:08:18] ✅ Ficheiro CSV válido com 6 artigos\n2025-06-05 18:08:18,817 - INFO - ✅ Ficheiro CSV válido com 6 artigos\n[2025-06-05 18:08:18] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-05 18:08:18,817 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-05 18:08:18] 📅 Filtrado para artigos dos últimos 1 dias: 6 artigos\n2025-06-05 18:08:18,817 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 6 artigos\n[2025-06-05 18:08:18] ==================================================\n2025-06-05 18:08:18,817 - INFO - ==================================================\n[2025-06-05 18:08:18] Processamento Iniciado\n2025-06-05 18:08:18,817 - INFO - Processamento Iniciado\n[2025-06-05 18:08:18] ==================================================\n2025-06-05 18:08:18,817 - INFO - ==================================================\n[2025-06-05 18:08:18]   Total de Artigos para Processar: 6\n2025-06-05 18:08:18,817 - INFO -   Total de Artigos para Processar: 6\n[2025-06-05 18:08:18]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 18:08:18,817 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 18:08:18]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:08:18,817 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:08:18]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 18:08:18,817 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 18:08:18]   Filtro de Dias: 1\n2025-06-05 18:08:18,817 - INFO -   Filtro de Dias: 1\n[2025-06-05 18:08:18] ==================================================\n2025-06-05 18:08:18,817 - INFO - ==================================================\n[2025-06-05 18:08:18] 📦 A processar lote 1/1 (6 artigos)\n2025-06-05 18:08:18,818 - INFO - 📦 A processar lote 1/1 (6 artigos)\n[2025-06-05 18:08:27] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga Nações: UEFA está a monitorizar mau tempo em Munique - Diário de Viseu\n2025-06-05 18:08:27,751 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga Nações: UEFA está a monitorizar mau tempo em Munique - Diário de Viseu\n[2025-06-05 18:08:27] 🔄 Processado: Liga Nações: UEFA está a monitorizar mau tempo em ...\n2025-06-05 18:08:27,776 - INFO - 🔄 Processado: Liga Nações: UEFA está a monitorizar mau tempo em ...\n[2025-06-05 18:08:28] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva de granizo envia guarda-redes do Alemanha-Portugal para os balneários - Abola.pt\n2025-06-05 18:08:28,965 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva de granizo envia guarda-redes do Alemanha-Portugal para os balneários - Abola.pt\n[2025-06-05 18:08:28] 🔄 Processado: Chuva de granizo envia guarda-redes do Alemanha-Po...\n2025-06-05 18:08:28,966 - INFO - 🔄 Processado: Chuva de granizo envia guarda-redes do Alemanha-Po...\n[2025-06-05 18:08:31] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (05) para Resende (RJ) - UOL Notícias\n2025-06-05 18:08:31,735 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (05) para Resende (RJ) - UOL Notícias\n[2025-06-05 18:08:31] 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (05) ...\n2025-06-05 18:08:31,740 - INFO - 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (05) ...\n[2025-06-05 18:08:32] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiX0FVX3lxTE1lN1M4dmh6bjQ3MjNHTVN2Qk9VOHVaVy0tS2duRjJ4MVp0ZEp3Z0ZIQzN0RnFxSHk3SUI2MTNBbFJaOTR1b29BWmkzMVp1cFJSWmJQVWdfWExoM1hKRWow?oc=5\n2025-06-05 18:08:32,998 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiX0FVX3lxTE1lN1M4dmh6bjQ3MjNHTVN2Qk9VOHVaVy0tS2duRjJ4MVp0ZEp3Z0ZIQzN0RnFxSHk3SUI2MTNBbFJaOTR1b29BWmkzMVp1cFJSWmJQVWdfWExoM1hKRWow?oc=5\n[2025-06-05 18:08:40] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiygFBVV95cUxPdW4wZEtZaVZXby0ybTdXdUZwR0EwOFYtTUN0d055WkZNRmg4S0JEaFdkSk1fWWEyWXVNcnk4Z0hsTHhQSVltcnNXX1ZjNFJzS1g5Rnp0clNsNHhrY2QtWldHYVUycHZLcnNLVGtJWnBQQ2ZCcGstZUlFNnRsYUlidm9NR05ZWi1yWThtaHVLaTNiN2Z6cHFsczhUdi1wUEJoUElWa21sZi1sZmU5ZDgta3hyM3BxdEVSazduSDRxQm5DckZYTWFGYUZn0gG7AUFVX3lxTE9ZdXRXcTB4SzJ1RVhQeUc1R2JxMlJBMExOTUFjbEJFY2E1Y3RIYTJQa2x2WXFSSFczWHdxeVNka3dGbFEzWG8xNjdQbGk2SDE3Ymo0UjlvX19VY3JzYUhlVHN6d29QejloTmZpTDhKQ2pJanNuY08xbUVNWENteVlSUHU1MGZVU2J4RnZOc2hzN0J0eHRSU2NYNndydlg1ODBUUFJsSHZ3Vzh5RFFzWFUzYktEOThVTlhfS0E?oc=5\n2025-06-05 18:08:40,261 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiygFBVV95cUxPdW4wZEtZaVZXby0ybTdXdUZwR0EwOFYtTUN0d055WkZNRmg4S0JEaFdkSk1fWWEyWXVNcnk4Z0hsTHhQSVltcnNXX1ZjNFJzS1g5Rnp0clNsNHhrY2QtWldHYVUycHZLcnNLVGtJWnBQQ2ZCcGstZUlFNnRsYUlidm9NR05ZWi1yWThtaHVLaTNiN2Z6cHFsczhUdi1wUEJoUElWa21sZi1sZmU5ZDgta3hyM3BxdEVSazduSDRxQm5DckZYTWFGYUZn0gG7AUFVX3lxTE9ZdXRXcTB4SzJ1RVhQeUc1R2JxMlJBMExOTUFjbEJFY2E1Y3RIYTJQa2x2WXFSSFczWHdxeVNka3dGbFEzWG8xNjdQbGk2SDE3Ymo0UjlvX19VY3JzYUhlVHN6d29QejloTmZpTDhKQ2pJanNuY08xbUVNWENteVlSUHU1MGZVU2J4RnZOc2hzN0J0eHRSU2NYNndydlg1ODBUUFJsSHZ3Vzh5RFFzWFUzYktEOThVTlhfS0E?oc=5\n[2025-06-05 18:08:41] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMi_gFBVV95cUxORHNQaDZTVzN2VGJfZXpTVUtidEIzOGFvS1VtVUFqMGpCUHVsVl9BRkNfRXRORUJFTC1jTWtNVnkwekRSMzU2c2lqZEtEU2RrbVlMbXd4WFdHQ2VLZS1qbFFXZ0dEYWN4WVJteldCcEFHZXRocVp1M3hZWHcyMTFLYjlEN3V3VVl4TGswYUVqcW1ZM0JHN3ZpTkt2Vy1saXoyU2tPN1AxUXpjanpoSkd0ZmcwcWtPTmFUZDZqSVlWSjl0SXUwSUR6OVlHMnNxbUMyTVB1NWVFOTZKclE3V3VaVVpCalpsaEhYRU8yNVJaUWo1N1BrUjh2OFJLU2hiUQ?oc=5\n2025-06-05 18:08:41,832 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMi_gFBVV95cUxORHNQaDZTVzN2VGJfZXpTVUtidEIzOGFvS1VtVUFqMGpCUHVsVl9BRkNfRXRORUJFTC1jTWtNVnkwekRSMzU2c2lqZEtEU2RrbVlMbXd4WFdHQ2VLZS1qbFFXZ0dEYWN4WVJteldCcEFHZXRocVp1M3hZWHcyMTFLYjlEN3V3VVl4TGswYUVqcW1ZM0JHN3ZpTkt2Vy1saXoyU2tPN1AxUXpjanpoSkd0ZmcwcWtPTmFUZDZqSVlWSjl0SXUwSUR6OVlHMnNxbUMyTVB1NWVFOTZKclE3V3VaVVpCalpsaEhYRU8yNVJaUWo1N1BrUjh2OFJLU2hiUQ?oc=5\n📥 Novos artigos recebidos: 3\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 3\n💾 Guardados 3 artigos no arquivo /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📥 Novos artigos recebidos: 3\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 3\n💾 Guardados 3 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:08:41] ✅ Relevant articles saved: 3 articles\n2025-06-05 18:08:41,837 - INFO - ✅ Relevant articles saved: 3 articles\n[2025-06-05 18:08:41] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n2025-06-05 18:08:41,838 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n[2025-06-05 18:08:41] ✅ Lote 1 concluído: 3 artigos (total: 3)\n2025-06-05 18:08:41,838 - INFO - ✅ Lote 1 concluído: 3 artigos (total: 3)\n📥 Novos artigos recebidos: 3\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 3\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 3\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 3\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-05 18:08:46] ✅ Relevant articles saved: 3 articles\n2025-06-05 18:08:46,824 - INFO - ✅ Relevant articles saved: 3 articles\n[2025-06-05 18:08:46] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n2025-06-05 18:08:46,827 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n[2025-06-05 18:08:46] ==================================================\n2025-06-05 18:08:46,827 - INFO - ==================================================\n[2025-06-05 18:08:46] Processamento Concluído com Sucesso\n2025-06-05 18:08:46,828 - INFO - Processamento Concluído com Sucesso\n[2025-06-05 18:08:46] ==================================================\n2025-06-05 18:08:46,828 - INFO - ==================================================\n[2025-06-05 18:08:46]   Total de Artigos Processados: 3\n2025-06-05 18:08:46,828 - INFO -   Total de Artigos Processados: 3\n[2025-06-05 18:08:46]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:08:46,828 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:08:46]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:08:46,828 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:08:46]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n2025-06-05 18:08:46,828 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n[2025-06-05 18:08:46]   Taxa de Sucesso: 50.0%\n2025-06-05 18:08:46,828 - INFO -   Taxa de Sucesso: 50.0%\n[2025-06-05 18:08:46] ==================================================\n2025-06-05 18:08:46,828 - INFO - ==================================================\n[2025-06-05 18:08:46] ✅ Processing completed. Processed 3 articles\n2025-06-05 18:08:46,838 - INFO - ✅ Processing completed. Processed 3 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
