{"timestamp":"2025-06-05T14:34:05.490018","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T14:34:05.490780","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T14:34:05.549005Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:05.549165Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:05.549647Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.948079Z","level":"info","event":"📋 [2025-06-05 15:34:06] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.948738Z","level":"info","event":"📋 2025-06-05 15:34:06,946 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.948979Z","level":"info","event":"📋 [2025-06-05 15:34:06] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.949475Z","level":"info","event":"📋 2025-06-05 15:34:06,946 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.949792Z","level":"info","event":"📋 [2025-06-05 15:34:06] 🚀 Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.950389Z","level":"info","event":"📋 2025-06-05 15:34:06,946 - INFO - 🚀 Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.952749Z","level":"info","event":"📋 [2025-06-05 15:34:06] ❌ No input file found. Searched in:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.958276Z","level":"info","event":"📋 2025-06-05 15:34:06,952 - ERROR - ❌ No input file found. Searched in:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.958485Z","level":"info","event":"📋 [2025-06-05 15:34:06]    - /opt/airflow/data/raw/2025/06/05/intermediate_google_news_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.958616Z","level":"info","event":"📋 2025-06-05 15:34:06,952 - ERROR -    - /opt/airflow/data/raw/2025/06/05/intermediate_google_news_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.958939Z","level":"info","event":"📋 [2025-06-05 15:34:06]    - /opt/airflow/data/raw/intermediate_google_news_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.959203Z","level":"info","event":"📋 2025-06-05 15:34:06,952 - ERROR -    - /opt/airflow/data/raw/intermediate_google_news_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.959282Z","level":"info","event":"📋 [2025-06-05 15:34:06]    - /opt/airflow/data/raw/intermediate_google_news.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.959356Z","level":"info","event":"📋 2025-06-05 15:34:06,952 - ERROR -    - /opt/airflow/data/raw/intermediate_google_news.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.959421Z","level":"info","event":"📋 [2025-06-05 15:34:06] ❌ No input file found. Cannot proceed.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.959475Z","level":"info","event":"📋 2025-06-05 15:34:06,952 - ERROR - ❌ No input file found. Cannot proceed.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.959584Z","level":"info","event":"📋 [2025-06-05 15:34:06] ✅ Processing completed. Processed 0 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:06.959637Z","level":"info","event":"📋 2025-06-05 15:34:06,952 - INFO - ✅ Processing completed. Processed 0 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:07.107007Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:07.107286Z","level":"info","event":"🔍 Looking for processed articles file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/artigos_google_municipios_pt_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:07.107533Z","level":"info","event":"❌ Expected processed articles file not found!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:07.109403Z","level":"info","event":"📁 Files in /opt/airflow/scripts/google_scraper/data/raw/2025/06/05: []","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:34:07.110465","level":"info","event":"Done. Returned value was: [2025-06-05 15:34:06] Starting processar_relevantes_airflow\n2025-06-05 15:34:06,946 - INFO - Starting processar_relevantes_airflow\n[2025-06-05 15:34:06] Parameters: dias=1, date=2025-06-05\n2025-06-05 15:34:06,946 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 15:34:06] 🚀 Starting processar_relevantes_airflow\n2025-06-05 15:34:06,946 - INFO - 🚀 Starting processar_relevantes_airflow\n[2025-06-05 15:34:06] ❌ No input file found. Searched in:\n2025-06-05 15:34:06,952 - ERROR - ❌ No input file found. Searched in:\n[2025-06-05 15:34:06]    - /opt/airflow/data/raw/2025/06/05/intermediate_google_news_20250605.csv\n2025-06-05 15:34:06,952 - ERROR -    - /opt/airflow/data/raw/2025/06/05/intermediate_google_news_20250605.csv\n[2025-06-05 15:34:06]    - /opt/airflow/data/raw/intermediate_google_news_20250605.csv\n2025-06-05 15:34:06,952 - ERROR -    - /opt/airflow/data/raw/intermediate_google_news_20250605.csv\n[2025-06-05 15:34:06]    - /opt/airflow/data/raw/intermediate_google_news.csv\n2025-06-05 15:34:06,952 - ERROR -    - /opt/airflow/data/raw/intermediate_google_news.csv\n[2025-06-05 15:34:06] ❌ No input file found. Cannot proceed.\n2025-06-05 15:34:06,952 - ERROR - ❌ No input file found. Cannot proceed.\n[2025-06-05 15:34:06] ✅ Processing completed. Processed 0 articles\n2025-06-05 15:34:06,952 - INFO - ✅ Processing completed. Processed 0 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-05T15:45:48.980105","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T15:45:48.980706","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T15:45:49.110385Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:45:49.123337Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:45:49.128113Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:45:49.129422Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:45:49.129652Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:45:49.129883Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:45:49.130045Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:45:49.130192Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:45:49.130317Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:45:49.130509Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:45:49.130831Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/intermediate_google_news_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:45:49.131058Z","level":"info","event":"❌ No input file found from scraper task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:45:49.131176Z","level":"info","event":"🔍 Checking legacy path: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/intermediate_google_news_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:45:49.131273Z","level":"info","event":"🔍 Checking legacy path: /opt/airflow/scripts/google_scraper/data/raw/intermediate_google_news.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:45:49.130034","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"Exception","exc_value":"No input file found. Checked: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv', '/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/intermediate_google_news_20250605.csv', '/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/intermediate_google_news_20250605.csv', '/opt/airflow/scripts/google_scraper/data/raw/intermediate_google_news.csv']","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":838,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1130,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":212,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":235,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/google_scraper_dag.py","lineno":377,"name":"processar_relevantes_task"}]}]}
{"timestamp":"2025-06-05T15:53:47.495882","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T15:53:47.496508","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T15:53:49.810889Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:49.817613Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:49.863755Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:49.867745Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:49.868329Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:49.870832Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:49.871272Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:49.873728Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:49.875328Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:49.876982Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:49.880871Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:49.884442Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:49.887648Z","level":"info","event":"  - relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:49.888228Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:49.889167Z","level":"info","event":"  - processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:49.889617Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:49.890319Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv --output_dir /opt/airflow/scripts/google_scraper/data/structured/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:49.891300Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.735579Z","level":"info","event":"📋 [2025-06-05 16:53:56] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.736935Z","level":"info","event":"📋 2025-06-05 16:53:56,734 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.737517Z","level":"info","event":"📋 [2025-06-05 16:53:56] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.738340Z","level":"info","event":"📋 2025-06-05 16:53:56,734 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.738823Z","level":"info","event":"📋 [2025-06-05 16:53:56] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.740067Z","level":"info","event":"📋 2025-06-05 16:53:56,734 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.740303Z","level":"info","event":"📋 [2025-06-05 16:53:56] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.740454Z","level":"info","event":"📋 2025-06-05 16:53:56,734 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.740671Z","level":"info","event":"📋 [2025-06-05 16:53:56] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.740908Z","level":"info","event":"📋 2025-06-05 16:53:56,734 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.741284Z","level":"info","event":"📋 [2025-06-05 16:53:56] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.742360Z","level":"info","event":"📋 2025-06-05 16:53:56,735 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.742578Z","level":"info","event":"📋 [2025-06-05 16:53:56] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.746609Z","level":"info","event":"📋 2025-06-05 16:53:56,736 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.746933Z","level":"info","event":"📋 [2025-06-05 16:53:56] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.747385Z","level":"info","event":"📋 2025-06-05 16:53:56,736 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.747639Z","level":"info","event":"📋 [2025-06-05 16:53:56] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.747940Z","level":"info","event":"📋 2025-06-05 16:53:56,736 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.750290Z","level":"info","event":"📋 [2025-06-05 16:53:56] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.751536Z","level":"info","event":"📋 2025-06-05 16:53:56,736 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.755865Z","level":"info","event":"📋 [2025-06-05 16:53:56] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.756601Z","level":"info","event":"📋 2025-06-05 16:53:56,738 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.757487Z","level":"info","event":"📋 [2025-06-05 16:53:56] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.757803Z","level":"info","event":"📋 2025-06-05 16:53:56,738 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.758925Z","level":"info","event":"📋 [2025-06-05 16:53:56] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.759354Z","level":"info","event":"📋 2025-06-05 16:53:56,741 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.759812Z","level":"info","event":"📋 [2025-06-05 16:53:56] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.760677Z","level":"info","event":"📋 2025-06-05 16:53:56,742 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.763462Z","level":"info","event":"📋 [2025-06-05 16:53:56] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.763660Z","level":"info","event":"📋 2025-06-05 16:53:56,747 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.767288Z","level":"info","event":"📋 [2025-06-05 16:53:56] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.767536Z","level":"info","event":"📋 2025-06-05 16:53:56,767 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.767872Z","level":"info","event":"📋 [2025-06-05 16:53:56] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.768230Z","level":"info","event":"📋 2025-06-05 16:53:56,767 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.770351Z","level":"info","event":"📋 [2025-06-05 16:53:56] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.770870Z","level":"info","event":"📋 2025-06-05 16:53:56,769 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.772010Z","level":"info","event":"📋 [2025-06-05 16:53:56] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.772767Z","level":"info","event":"📋 2025-06-05 16:53:56,769 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.773578Z","level":"info","event":"📋 [2025-06-05 16:53:56]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.773825Z","level":"info","event":"📋 2025-06-05 16:53:56,769 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.774113Z","level":"info","event":"📋 [2025-06-05 16:53:56]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.774543Z","level":"info","event":"📋 2025-06-05 16:53:56,769 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.774705Z","level":"info","event":"📋 [2025-06-05 16:53:56]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.775107Z","level":"info","event":"📋 2025-06-05 16:53:56,769 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.776089Z","level":"info","event":"📋 [2025-06-05 16:53:56]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.776745Z","level":"info","event":"📋 2025-06-05 16:53:56,769 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.777482Z","level":"info","event":"📋 [2025-06-05 16:53:56]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.777811Z","level":"info","event":"📋 2025-06-05 16:53:56,770 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.778008Z","level":"info","event":"📋 [2025-06-05 16:53:56] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.778198Z","level":"info","event":"📋 2025-06-05 16:53:56,770 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.780575Z","level":"info","event":"📋 [2025-06-05 16:53:56] ✅ Ficheiro CSV válido com 6 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.780768Z","level":"info","event":"📋 2025-06-05 16:53:56,780 - INFO - ✅ Ficheiro CSV válido com 6 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.780985Z","level":"info","event":"📋 [2025-06-05 16:53:56] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.781219Z","level":"info","event":"📋 2025-06-05 16:53:56,780 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.783143Z","level":"info","event":"📋 [2025-06-05 16:53:56] 📅 Filtrado para artigos dos últimos 1 dias: 6 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.783334Z","level":"info","event":"📋 2025-06-05 16:53:56,783 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 6 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.783499Z","level":"info","event":"📋 [2025-06-05 16:53:56] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.783762Z","level":"info","event":"📋 2025-06-05 16:53:56,783 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.783914Z","level":"info","event":"📋 [2025-06-05 16:53:56] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.784039Z","level":"info","event":"📋 2025-06-05 16:53:56,783 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.784205Z","level":"info","event":"📋 [2025-06-05 16:53:56] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.784605Z","level":"info","event":"📋 2025-06-05 16:53:56,783 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.786457Z","level":"info","event":"📋 [2025-06-05 16:53:56]   Total de Artigos para Processar: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.786656Z","level":"info","event":"📋 2025-06-05 16:53:56,784 - INFO -   Total de Artigos para Processar: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.786841Z","level":"info","event":"📋 [2025-06-05 16:53:56]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.787486Z","level":"info","event":"📋 2025-06-05 16:53:56,784 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.788226Z","level":"info","event":"📋 [2025-06-05 16:53:56]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.788394Z","level":"info","event":"📋 2025-06-05 16:53:56,784 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.788611Z","level":"info","event":"📋 [2025-06-05 16:53:56]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.788742Z","level":"info","event":"📋 2025-06-05 16:53:56,784 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.788858Z","level":"info","event":"📋 [2025-06-05 16:53:56]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.788964Z","level":"info","event":"📋 2025-06-05 16:53:56,784 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.791516Z","level":"info","event":"📋 [2025-06-05 16:53:56] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.791795Z","level":"info","event":"📋 2025-06-05 16:53:56,784 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.791955Z","level":"info","event":"📋 [2025-06-05 16:53:56] 📦 A processar lote 1/1 (6 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:53:56.792069Z","level":"info","event":"📋 2025-06-05 16:53:56,788 - INFO - 📦 A processar lote 1/1 (6 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:08.355306Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:08.365262Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:08.714669Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:08.890387Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:08.925206Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:09.130122Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:25.081876Z","level":"info","event":"📋 [2025-06-05 16:54:25] ⚠️ Artigo ignorado após extração: PJ vai à Câmara de Bragança por suspeitas em obras do tempo de Hernâni Dias - Jornal de Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:25.113445Z","level":"info","event":"📋 2025-06-05 16:54:25,050 - WARNING - ⚠️ Artigo ignorado após extração: PJ vai à Câmara de Bragança por suspeitas em obras do tempo de Hernâni Dias - Jornal de Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:31.414438Z","level":"info","event":"📋 [2025-06-05 16:54:31] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: \"Pôs-se a jeito\": Cristina Ferreira criticada por comentário sobre mulher assassinada em Oliveira do Bairro. ERC já recebeu queixas - Executive Digest","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:32.019897Z","level":"info","event":"📋 2025-06-05 16:54:31,399 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: \"Pôs-se a jeito\": Cristina Ferreira criticada por comentário sobre mulher assassinada em Oliveira do Bairro. ERC já recebeu queixas - Executive Digest","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:32.023344Z","level":"info","event":"📋 [2025-06-05 16:54:31] 🔄 Processado: \"Pôs-se a jeito\": Cristina Ferreira criticada por ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:32.023688Z","level":"info","event":"📋 2025-06-05 16:54:31,682 - INFO - 🔄 Processado: \"Pôs-se a jeito\": Cristina Ferreira criticada por ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:36.788197Z","level":"info","event":"📋 [2025-06-05 16:54:36] ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:36.800080Z","level":"info","event":"📋 2025-06-05 16:54:36,772 - WARNING - ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:38.815040Z","level":"info","event":"📋 [2025-06-05 16:54:38] ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:38.816433Z","level":"info","event":"📋 2025-06-05 16:54:38,814 - WARNING - ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:38.817748Z","level":"info","event":"📋 [2025-06-05 16:54:38] ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:38.818120Z","level":"info","event":"📋 2025-06-05 16:54:38,817 - WARNING - ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.020874Z","level":"info","event":"📋 [2025-06-05 16:54:41] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva de granizo envia guarda-redes do Alemanha-Portugal para os balneários - Abola.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.021240Z","level":"info","event":"📋 2025-06-05 16:54:41,020 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva de granizo envia guarda-redes do Alemanha-Portugal para os balneários - Abola.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.027443Z","level":"info","event":"📋 [2025-06-05 16:54:41] 🔄 Processado: Chuva de granizo envia guarda-redes do Alemanha-Po...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.028073Z","level":"info","event":"📋 2025-06-05 16:54:41,027 - INFO - 🔄 Processado: Chuva de granizo envia guarda-redes do Alemanha-Po...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.028584Z","level":"info","event":"📋 📥 Novos artigos recebidos: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.030277Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.030503Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.030857Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.032255Z","level":"info","event":"📋 💾 Guardados 2 artigos no arquivo /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.032768Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.032910Z","level":"info","event":"📋 📥 Novos artigos recebidos: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.033091Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.033262Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.033521Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.033902Z","level":"info","event":"📋 💾 Guardados 2 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.034412Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.034702Z","level":"info","event":"📋 [2025-06-05 16:54:41] ✅ Relevant articles saved: 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.034968Z","level":"info","event":"📋 2025-06-05 16:54:41,034 - INFO - ✅ Relevant articles saved: 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.035508Z","level":"info","event":"📋 [2025-06-05 16:54:41] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.035674Z","level":"info","event":"📋 2025-06-05 16:54:41,035 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.035760Z","level":"info","event":"📋 [2025-06-05 16:54:41] ✅ Lote 1 concluído: 2 artigos (total: 2)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:41.035837Z","level":"info","event":"📋 2025-06-05 16:54:41,035 - INFO - ✅ Lote 1 concluído: 2 artigos (total: 2)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.746679Z","level":"info","event":"📋 📥 Novos artigos recebidos: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.792166Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.794386Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.794541Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.794639Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.794733Z","level":"info","event":"📋 📥 Novos artigos recebidos: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.794822Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.794910Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.795000Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.795082Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.795168Z","level":"info","event":"📋 [2025-06-05 16:54:44] ✅ Relevant articles saved: 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.795252Z","level":"info","event":"📋 2025-06-05 16:54:44,754 - INFO - ✅ Relevant articles saved: 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.795355Z","level":"info","event":"📋 [2025-06-05 16:54:44] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.795474Z","level":"info","event":"📋 2025-06-05 16:54:44,759 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.795569Z","level":"info","event":"📋 [2025-06-05 16:54:44] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.795651Z","level":"info","event":"📋 2025-06-05 16:54:44,759 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.795743Z","level":"info","event":"📋 [2025-06-05 16:54:44] Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.795828Z","level":"info","event":"📋 2025-06-05 16:54:44,759 - INFO - Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.795943Z","level":"info","event":"📋 [2025-06-05 16:54:44] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.796023Z","level":"info","event":"📋 2025-06-05 16:54:44,759 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.796105Z","level":"info","event":"📋 [2025-06-05 16:54:44]   Total de Artigos Processados: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.796206Z","level":"info","event":"📋 2025-06-05 16:54:44,759 - INFO -   Total de Artigos Processados: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.796313Z","level":"info","event":"📋 [2025-06-05 16:54:44]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.796407Z","level":"info","event":"📋 2025-06-05 16:54:44,759 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.796512Z","level":"info","event":"📋 [2025-06-05 16:54:44]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.796588Z","level":"info","event":"📋 2025-06-05 16:54:44,759 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.796666Z","level":"info","event":"📋 [2025-06-05 16:54:44]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.796740Z","level":"info","event":"📋 2025-06-05 16:54:44,759 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.796823Z","level":"info","event":"📋 [2025-06-05 16:54:44]   Taxa de Sucesso: 33.3%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.796900Z","level":"info","event":"📋 2025-06-05 16:54:44,759 - INFO -   Taxa de Sucesso: 33.3%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.796974Z","level":"info","event":"📋 [2025-06-05 16:54:44] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.797098Z","level":"info","event":"📋 2025-06-05 16:54:44,759 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.797174Z","level":"info","event":"📋 [2025-06-05 16:54:44] ✅ Processing completed. Processed 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.797246Z","level":"info","event":"📋 2025-06-05 16:54:44,763 - INFO - ✅ Processing completed. Processed 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.982450Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.982687Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:44.983267Z","level":"info","event":"✅ relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (744 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:45.873378Z","level":"info","event":"📊 Number of processed articles: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:45.873540Z","level":"info","event":"📊 Columns: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:45.874300Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:45.875164Z","level":"info","event":"⚠️ processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:45.877431Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:45.874703","level":"info","event":"Done. Returned value was: [2025-06-05 16:53:56] Starting processar_relevantes_airflow\n2025-06-05 16:53:56,734 - INFO - Starting processar_relevantes_airflow\n[2025-06-05 16:53:56] Parameters: dias=1, date=2025-06-05\n2025-06-05 16:53:56,734 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 16:53:56] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n2025-06-05 16:53:56,734 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n[2025-06-05 16:53:56] 🚀 A iniciar processar_relevantes_airflow\n2025-06-05 16:53:56,734 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-05 16:53:56] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 16:53:56,734 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 16:53:56] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 16:53:56,735 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 16:53:56] 🔧 A carregar ficheiros de configuração...\n2025-06-05 16:53:56,736 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-05 16:53:56] 🔍 Checking config path: /opt/airflow/config\n2025-06-05 16:53:56,736 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-05 16:53:56] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-05 16:53:56,736 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-05 16:53:56] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-05 16:53:56,736 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-05 16:53:56] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-05 16:53:56,738 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-05 16:53:56] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-05 16:53:56,738 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-05 16:53:56] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-05 16:53:56,741 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-05 16:53:56] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-05 16:53:56,742 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-05 16:53:56] ✅ Loaded 6 keywords\n2025-06-05 16:53:56,747 - INFO - ✅ Loaded 6 keywords\n[2025-06-05 16:53:56] ✅ Loaded 3614 DICOFREG codes\n2025-06-05 16:53:56,767 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-05 16:53:56] ==================================================\n2025-06-05 16:53:56,767 - INFO - ==================================================\n[2025-06-05 16:53:56] Configuration Loaded\n2025-06-05 16:53:56,769 - INFO - Configuration Loaded\n[2025-06-05 16:53:56] ==================================================\n2025-06-05 16:53:56,769 - INFO - ==================================================\n[2025-06-05 16:53:56]   Parishes: 306\n2025-06-05 16:53:56,769 - INFO -   Parishes: 306\n[2025-06-05 16:53:56]   Municipalities: 306\n2025-06-05 16:53:56,769 - INFO -   Municipalities: 306\n[2025-06-05 16:53:56]   Districts: 29\n2025-06-05 16:53:56,769 - INFO -   Districts: 29\n[2025-06-05 16:53:56]   Keywords: 6\n2025-06-05 16:53:56,769 - INFO -   Keywords: 6\n[2025-06-05 16:53:56]   DICOFREG Codes: 3614\n2025-06-05 16:53:56,770 - INFO -   DICOFREG Codes: 3614\n[2025-06-05 16:53:56] ==================================================\n2025-06-05 16:53:56,770 - INFO - ==================================================\n[2025-06-05 16:53:56] ✅ Ficheiro CSV válido com 6 artigos\n2025-06-05 16:53:56,780 - INFO - ✅ Ficheiro CSV válido com 6 artigos\n[2025-06-05 16:53:56] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-05 16:53:56,780 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-05 16:53:56] 📅 Filtrado para artigos dos últimos 1 dias: 6 artigos\n2025-06-05 16:53:56,783 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 6 artigos\n[2025-06-05 16:53:56] ==================================================\n2025-06-05 16:53:56,783 - INFO - ==================================================\n[2025-06-05 16:53:56] Processamento Iniciado\n2025-06-05 16:53:56,783 - INFO - Processamento Iniciado\n[2025-06-05 16:53:56] ==================================================\n2025-06-05 16:53:56,783 - INFO - ==================================================\n[2025-06-05 16:53:56]   Total de Artigos para Processar: 6\n2025-06-05 16:53:56,784 - INFO -   Total de Artigos para Processar: 6\n[2025-06-05 16:53:56]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 16:53:56,784 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 16:53:56]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 16:53:56,784 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 16:53:56]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 16:53:56,784 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 16:53:56]   Filtro de Dias: 1\n2025-06-05 16:53:56,784 - INFO -   Filtro de Dias: 1\n[2025-06-05 16:53:56] ==================================================\n2025-06-05 16:53:56,784 - INFO - ==================================================\n[2025-06-05 16:53:56] 📦 A processar lote 1/1 (6 artigos)\n2025-06-05 16:53:56,788 - INFO - 📦 A processar lote 1/1 (6 artigos)\n[2025-06-05 16:54:25] ⚠️ Artigo ignorado após extração: PJ vai à Câmara de Bragança por suspeitas em obras do tempo de Hernâni Dias - Jornal de Notícias\n2025-06-05 16:54:25,050 - WARNING - ⚠️ Artigo ignorado após extração: PJ vai à Câmara de Bragança por suspeitas em obras do tempo de Hernâni Dias - Jornal de Notícias\n[2025-06-05 16:54:31] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: \"Pôs-se a jeito\": Cristina Ferreira criticada por comentário sobre mulher assassinada em Oliveira do Bairro. ERC já recebeu queixas - Executive Digest\n2025-06-05 16:54:31,399 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: \"Pôs-se a jeito\": Cristina Ferreira criticada por comentário sobre mulher assassinada em Oliveira do Bairro. ERC já recebeu queixas - Executive Digest\n[2025-06-05 16:54:31] 🔄 Processado: \"Pôs-se a jeito\": Cristina Ferreira criticada por ...\n2025-06-05 16:54:31,682 - INFO - 🔄 Processado: \"Pôs-se a jeito\": Cristina Ferreira criticada por ...\n[2025-06-05 16:54:36] ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho\n2025-06-05 16:54:36,772 - WARNING - ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho\n[2025-06-05 16:54:38] ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho\n2025-06-05 16:54:38,814 - WARNING - ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho\n[2025-06-05 16:54:38] ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho\n2025-06-05 16:54:38,817 - WARNING - ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho\n[2025-06-05 16:54:41] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva de granizo envia guarda-redes do Alemanha-Portugal para os balneários - Abola.pt\n2025-06-05 16:54:41,020 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva de granizo envia guarda-redes do Alemanha-Portugal para os balneários - Abola.pt\n[2025-06-05 16:54:41] 🔄 Processado: Chuva de granizo envia guarda-redes do Alemanha-Po...\n2025-06-05 16:54:41,027 - INFO - 🔄 Processado: Chuva de granizo envia guarda-redes do Alemanha-Po...\n📥 Novos artigos recebidos: 2\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 2\n💾 Guardados 2 artigos no arquivo /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📥 Novos artigos recebidos: 2\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 2\n💾 Guardados 2 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 16:54:41] ✅ Relevant articles saved: 2 articles\n2025-06-05 16:54:41,034 - INFO - ✅ Relevant articles saved: 2 articles\n[2025-06-05 16:54:41] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n2025-06-05 16:54:41,035 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n[2025-06-05 16:54:41] ✅ Lote 1 concluído: 2 artigos (total: 2)\n2025-06-05 16:54:41,035 - INFO - ✅ Lote 1 concluído: 2 artigos (total: 2)\n📥 Novos artigos recebidos: 2\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 2\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 2\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 2\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-05 16:54:44] ✅ Relevant articles saved: 2 articles\n2025-06-05 16:54:44,754 - INFO - ✅ Relevant articles saved: 2 articles\n[2025-06-05 16:54:44] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n2025-06-05 16:54:44,759 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n[2025-06-05 16:54:44] ==================================================\n2025-06-05 16:54:44,759 - INFO - ==================================================\n[2025-06-05 16:54:44] Processamento Concluído com Sucesso\n2025-06-05 16:54:44,759 - INFO - Processamento Concluído com Sucesso\n[2025-06-05 16:54:44] ==================================================\n2025-06-05 16:54:44,759 - INFO - ==================================================\n[2025-06-05 16:54:44]   Total de Artigos Processados: 2\n2025-06-05 16:54:44,759 - INFO -   Total de Artigos Processados: 2\n[2025-06-05 16:54:44]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 16:54:44,759 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 16:54:44]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 16:54:44,759 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 16:54:44]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n2025-06-05 16:54:44,759 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n[2025-06-05 16:54:44]   Taxa de Sucesso: 33.3%\n2025-06-05 16:54:44,759 - INFO -   Taxa de Sucesso: 33.3%\n[2025-06-05 16:54:44] ==================================================\n2025-06-05 16:54:44,759 - INFO - ==================================================\n[2025-06-05 16:54:44] ✅ Processing completed. Processed 2 articles\n2025-06-05 16:54:44,763 - INFO - ✅ Processing completed. Processed 2 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
