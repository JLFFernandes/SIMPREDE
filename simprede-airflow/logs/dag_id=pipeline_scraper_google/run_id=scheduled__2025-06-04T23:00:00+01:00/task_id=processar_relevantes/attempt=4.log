{"timestamp":"2025-06-05T15:38:40.019670","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T15:38:40.019985","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T15:38:40.056287Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:40.058636Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:40.059534Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/04', '/opt/airflow/data/structured/2025/06/04', '/opt/airflow/data/processed/2025/06/04']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:40.059640Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:40.059906Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:40.060048Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:40.060130Z","level":"info","event":"  - Target date: 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:40.060204Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:40.060277Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:40.060358Z","level":"info","event":"✅ Found input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:40.060431Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:40.060493Z","level":"info","event":"  - relevant_articles: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:40.060558Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/data/structured/2025/06/04/artigos_irrelevantes_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:40.060632Z","level":"info","event":"  - processing_log: /opt/airflow/data/structured/2025/06/04/processing_log_20250604.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:40.060699Z","level":"info","event":"  - stats_json: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:40.060770Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv --output_dir /opt/airflow/data/structured/2025/06/04 --date_str 2025-06-04 --date 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:40.060843Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.328428Z","level":"info","event":"📋 [2025-06-05 16:38:41] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.328781Z","level":"info","event":"📋 2025-06-05 16:38:41,328 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.328878Z","level":"info","event":"📋 [2025-06-05 16:38:41] Parameters: dias=1, date=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.329079Z","level":"info","event":"📋 2025-06-05 16:38:41,328 - INFO - Parameters: dias=1, date=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.329138Z","level":"info","event":"📋 [2025-06-05 16:38:41] Paths: input_file=/opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv, output_dir=/opt/airflow/data/structured/2025/06/04, date_str=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.329294Z","level":"info","event":"📋 2025-06-05 16:38:41,328 - INFO - Paths: input_file=/opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv, output_dir=/opt/airflow/data/structured/2025/06/04, date_str=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.329431Z","level":"info","event":"📋 [2025-06-05 16:38:41] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.329480Z","level":"info","event":"📋 2025-06-05 16:38:41,328 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.329585Z","level":"info","event":"📋 [2025-06-05 16:38:41] 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.329666Z","level":"info","event":"📋 2025-06-05 16:38:41,328 - INFO - 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.330217Z","level":"info","event":"📋 [2025-06-05 16:38:41] 📁 Using provided input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.330262Z","level":"info","event":"📋 2025-06-05 16:38:41,328 - INFO - 📁 Using provided input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.330299Z","level":"info","event":"📋 [2025-06-05 16:38:41] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.330339Z","level":"info","event":"📋 2025-06-05 16:38:41,328 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.330378Z","level":"info","event":"📋 [2025-06-05 16:38:41] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.330413Z","level":"info","event":"📋 2025-06-05 16:38:41,329 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.330447Z","level":"info","event":"📋 [2025-06-05 16:38:41] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.330482Z","level":"info","event":"📋 2025-06-05 16:38:41,329 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.330523Z","level":"info","event":"📋 [2025-06-05 16:38:41] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.330562Z","level":"info","event":"📋 2025-06-05 16:38:41,329 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.330623Z","level":"info","event":"📋 [2025-06-05 16:38:41] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.330661Z","level":"info","event":"📋 2025-06-05 16:38:41,329 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.330697Z","level":"info","event":"📋 [2025-06-05 16:38:41] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.330738Z","level":"info","event":"📋 2025-06-05 16:38:41,329 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.330984Z","level":"info","event":"📋 [2025-06-05 16:38:41] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.331044Z","level":"info","event":"📋 2025-06-05 16:38:41,330 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.331123Z","level":"info","event":"📋 [2025-06-05 16:38:41] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.331185Z","level":"info","event":"📋 2025-06-05 16:38:41,331 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.331545Z","level":"info","event":"📋 [2025-06-05 16:38:41] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.331608Z","level":"info","event":"📋 2025-06-05 16:38:41,331 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.338731Z","level":"info","event":"📋 [2025-06-05 16:38:41] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.338997Z","level":"info","event":"📋 2025-06-05 16:38:41,338 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.339055Z","level":"info","event":"📋 [2025-06-05 16:38:41] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.339094Z","level":"info","event":"📋 2025-06-05 16:38:41,338 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.339129Z","level":"info","event":"📋 [2025-06-05 16:38:41] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.339163Z","level":"info","event":"📋 2025-06-05 16:38:41,338 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.339205Z","level":"info","event":"📋 [2025-06-05 16:38:41] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.339241Z","level":"info","event":"📋 2025-06-05 16:38:41,338 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.339276Z","level":"info","event":"📋 [2025-06-05 16:38:41]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.339314Z","level":"info","event":"📋 2025-06-05 16:38:41,338 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.339350Z","level":"info","event":"📋 [2025-06-05 16:38:41]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.339454Z","level":"info","event":"📋 2025-06-05 16:38:41,338 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.339498Z","level":"info","event":"📋 [2025-06-05 16:38:41]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.339748Z","level":"info","event":"📋 2025-06-05 16:38:41,338 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.340247Z","level":"info","event":"📋 [2025-06-05 16:38:41]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.340292Z","level":"info","event":"📋 2025-06-05 16:38:41,338 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.340328Z","level":"info","event":"📋 [2025-06-05 16:38:41]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.340390Z","level":"info","event":"📋 2025-06-05 16:38:41,338 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.340428Z","level":"info","event":"📋 [2025-06-05 16:38:41] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.340461Z","level":"info","event":"📋 2025-06-05 16:38:41,338 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.341145Z","level":"info","event":"📋 [2025-06-05 16:38:41] ✅ Ficheiro CSV válido com 11 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.341230Z","level":"info","event":"📋 2025-06-05 16:38:41,341 - INFO - ✅ Ficheiro CSV válido com 11 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.341317Z","level":"info","event":"📋 [2025-06-05 16:38:41] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.341372Z","level":"info","event":"📋 2025-06-05 16:38:41,341 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.341928Z","level":"info","event":"📋 [2025-06-05 16:38:41] 📅 Filtrado para artigos dos últimos 1 dias: 11 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.341994Z","level":"info","event":"📋 2025-06-05 16:38:41,341 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 11 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.342237Z","level":"info","event":"📋 [2025-06-05 16:38:41] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.342286Z","level":"info","event":"📋 2025-06-05 16:38:41,342 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.342325Z","level":"info","event":"📋 [2025-06-05 16:38:41] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.342362Z","level":"info","event":"📋 2025-06-05 16:38:41,342 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.342397Z","level":"info","event":"📋 [2025-06-05 16:38:41] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.342861Z","level":"info","event":"📋 2025-06-05 16:38:41,342 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.342907Z","level":"info","event":"📋 [2025-06-05 16:38:41]   Total de Artigos para Processar: 11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.342943Z","level":"info","event":"📋 2025-06-05 16:38:41,342 - INFO -   Total de Artigos para Processar: 11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.342980Z","level":"info","event":"📋 [2025-06-05 16:38:41]   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.343017Z","level":"info","event":"📋 2025-06-05 16:38:41,342 - INFO -   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.343056Z","level":"info","event":"📋 [2025-06-05 16:38:41]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.343094Z","level":"info","event":"📋 2025-06-05 16:38:41,342 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.343129Z","level":"info","event":"📋 [2025-06-05 16:38:41]   Diretoria de Saída: /opt/airflow/data/structured/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.343190Z","level":"info","event":"📋 2025-06-05 16:38:41,342 - INFO -   Diretoria de Saída: /opt/airflow/data/structured/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.343226Z","level":"info","event":"📋 [2025-06-05 16:38:41]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.343261Z","level":"info","event":"📋 2025-06-05 16:38:41,342 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.343295Z","level":"info","event":"📋 [2025-06-05 16:38:41] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.343329Z","level":"info","event":"📋 2025-06-05 16:38:41,342 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.343376Z","level":"info","event":"📋 [2025-06-05 16:38:41] 📦 A processar lote 1/1 (11 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:41.343411Z","level":"info","event":"📋 2025-06-05 16:38:41,343 - INFO - 📦 A processar lote 1/1 (11 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:44.631467Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:44.756286Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:44.966351Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:45.064811Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:45.122906Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:45.127792Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:45.139351Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:45.569557Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:48.532263Z","level":"info","event":"📋 [2025-06-05 16:38:48] 🔄 Processado: Água potável responsável por 18% dos óbitos por di...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:48.536183Z","level":"info","event":"📋 2025-06-05 16:38:48,529 - INFO - 🔄 Processado: Água potável responsável por 18% dos óbitos por di...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:50.629431Z","level":"info","event":"📋 [2025-06-05 16:38:50] 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:50.635976Z","level":"info","event":"📋 2025-06-05 16:38:50,618 - INFO - 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:52.963433Z","level":"info","event":"📋 [2025-06-05 16:38:52] 🔄 Processado: Escocês desaparecido em Albufeira foi encontrado m...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:52.980937Z","level":"info","event":"📋 2025-06-05 16:38:52,955 - INFO - 🔄 Processado: Escocês desaparecido em Albufeira foi encontrado m...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:53.268405Z","level":"info","event":"📋 [2025-06-05 16:38:53] ⚠️ Artigo ignorado após extração: PJ vai à Câmara de Bragança por suspeitas em obras do tempo de Hernâni Dias - Jornal de Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:53.272313Z","level":"info","event":"📋 2025-06-05 16:38:53,267 - WARNING - ⚠️ Artigo ignorado após extração: PJ vai à Câmara de Bragança por suspeitas em obras do tempo de Hernâni Dias - Jornal de Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:53.778233Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:54.477051Z","level":"info","event":"📋 [2025-06-05 16:38:54] ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:54.479877Z","level":"info","event":"📋 2025-06-05 16:38:54,476 - WARNING - ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:54.553793Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:56.884660Z","level":"info","event":"📋 [2025-06-05 16:38:56] 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...[2025-06-05 16:38:56] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Morador de Magé constrói cachoeira sustentável de 25 m de queda e captação de água da chuva - G1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:56.887541Z","level":"info","event":"📋 2025-06-05 16:38:56,883 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Morador de Magé constrói cachoeira sustentável de 25 m de queda e captação de água da chuva - G1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:56.941766Z","level":"info","event":"📋 [2025-06-05 16:38:56] 🔄 Processado: Morador de Magé constrói cachoeira sustentável de ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:56.942014Z","level":"info","event":"📋 2025-06-05 16:38:56,885 - INFO - 🔄 Processado: Morador de Magé constrói cachoeira sustentável de ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:56.942123Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:56.942190Z","level":"info","event":"📋 2025-06-05 16:38:56,885 - INFO - 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:57.843354Z","level":"info","event":"📋 [2025-06-05 16:38:57] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Sertãozinho (SP) terá dia ensolarado hoje (05); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:57.843751Z","level":"info","event":"📋 2025-06-05 16:38:57,842 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Sertãozinho (SP) terá dia ensolarado hoje (05); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:57.844253Z","level":"info","event":"📋 [2025-06-05 16:38:57] 🔄 Processado: Sertãozinho (SP) terá dia ensolarado hoje (05); ve...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:38:57.844428Z","level":"info","event":"📋 2025-06-05 16:38:57,844 - INFO - 🔄 Processado: Sertãozinho (SP) terá dia ensolarado hoje (05); ve...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:13.608852Z","level":"info","event":"⚠️ ❌ Erro ao resolver URL do Google News: Message:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:13.611921Z","level":"info","event":"⚠️","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:13.738864Z","level":"info","event":"📋 [2025-06-05 16:39:13] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMisgFBVV95cUxOUXgxZW96cGJKRm1kUmhpQy12YWxScndrZDJtVE1OZUVQdEhZZ1JTV3R0X3MweVJ1Xzg5V1ZmdTN0VmRURHkwVmJUeE1FLXVsUGt6ZlFvNG1CTnlBSndydkd0Qnd4QmpZMjJYbDVvRGF2RjZtM2dYVDJGT2lQek1yd2liLXV3U2U4N3c4VUpEVFl0NUJrZjUxMlZsRjBEX3ZmTDU5eURZakJWemwwa1hnckFn?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:13.739571Z","level":"info","event":"📋 2025-06-05 16:39:13,737 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMisgFBVV95cUxOUXgxZW96cGJKRm1kUmhpQy12YWxScndrZDJtVE1OZUVQdEhZZ1JTV3R0X3MweVJ1Xzg5V1ZmdTN0VmRURHkwVmJUeE1FLXVsUGt6ZlFvNG1CTnlBSndydkd0Qnd4QmpZMjJYbDVvRGF2RjZtM2dYVDJGT2lQek1yd2liLXV3U2U4N3c4VUpEVFl0NUJrZjUxMlZsRjBEX3ZmTDU5eURZakJWemwwa1hnckFn?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:14.423399Z","level":"info","event":"⚠️ ❌ Erro ao resolver URL do Google News: Message:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:14.424863Z","level":"info","event":"⚠️","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:14.516221Z","level":"info","event":"📋 [2025-06-05 16:39:14] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiswFBVV95cUxNWHBqX0FkeXhZU2dnd28yZHlyZ1RaTm5EUzdVcWRNV3ZMOElCUlhZaThmbFRsTC1nM0RPLWVlV1JsaXdCMno5ZmMycEZGR2hiLWswQTNoQTFJUFNPTjJJUU5ZNmxDVjMyTEh6WmgyTHBpT1d0NmhneDZUTzhJZWNGUFhaVWFBblVlUHVRZmg4M2pGUHQxLTN3c1gzMXpHVkxxM1dJdHlKSkJZcEpRVTFXNzFZcw?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:14.516965Z","level":"info","event":"📋 2025-06-05 16:39:14,515 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiswFBVV95cUxNWHBqX0FkeXhZU2dnd28yZHlyZ1RaTm5EUzdVcWRNV3ZMOElCUlhZaThmbFRsTC1nM0RPLWVlV1JsaXdCMno5ZmMycEZGR2hiLWswQTNoQTFJUFNPTjJJUU5ZNmxDVjMyTEh6WmgyTHBpT1d0NmhneDZUTzhJZWNGUFhaVWFBblVlUHVRZmg4M2pGUHQxLTN3c1gzMXpHVkxxM1dJdHlKSkJZcEpRVTFXNzFZcw?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.467627Z","level":"info","event":"⚠️ ⚠️ Error fetching URL https://rr.pt/noticia/amp/pais/2025/06/04/chuva-fraca-no-norte-e-centro-e-subida-da-temperatura-no-sul/428013/: HTTPSConnectionPool(host='rr.pt', port=443): Read timed out. (read timeout=10)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.470781Z","level":"info","event":"📋 [2025-06-05 16:39:17] ⚠️ Artigo ignorado após extração: Chuva fraca no Norte e Centro e subida da temperatura no Sul - Renascença","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.471750Z","level":"info","event":"📋 2025-06-05 16:39:17,466 - WARNING - ⚠️ Artigo ignorado após extração: Chuva fraca no Norte e Centro e subida da temperatura no Sul - Renascença","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.473177Z","level":"info","event":"📋 📥 Novos artigos recebidos: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.489344Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.490193Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.490468Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.491442Z","level":"info","event":"📋 💾 Guardados 5 artigos no arquivo /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.492262Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.492673Z","level":"info","event":"📋 📥 Novos artigos recebidos: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.493237Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.493768Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.494087Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.494411Z","level":"info","event":"📋 💾 Guardados 5 artigos no arquivo /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.495147Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.495706Z","level":"info","event":"📋 [2025-06-05 16:39:17] ✅ Relevant articles saved: 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.496143Z","level":"info","event":"📋 2025-06-05 16:39:17,494 - INFO - ✅ Relevant articles saved: 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.496884Z","level":"info","event":"📋 [2025-06-05 16:39:17] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.497136Z","level":"info","event":"📋 2025-06-05 16:39:17,496 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.497405Z","level":"info","event":"📋 [2025-06-05 16:39:17] ✅ Lote 1 concluído: 5 artigos (total: 5)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:17.497630Z","level":"info","event":"📋 2025-06-05 16:39:17,496 - INFO - ✅ Lote 1 concluído: 5 artigos (total: 5)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.890264Z","level":"info","event":"📋 📥 Novos artigos recebidos: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.987696Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.989336Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.991616Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.991957Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.992100Z","level":"info","event":"📋 📥 Novos artigos recebidos: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.992449Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.992721Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.992983Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.993163Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.993272Z","level":"info","event":"📋 [2025-06-05 16:39:20] ✅ Relevant articles saved: 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.993373Z","level":"info","event":"📋 2025-06-05 16:39:20,898 - INFO - ✅ Relevant articles saved: 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.993467Z","level":"info","event":"📋 [2025-06-05 16:39:20] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.993698Z","level":"info","event":"📋 2025-06-05 16:39:20,905 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.993786Z","level":"info","event":"📋 [2025-06-05 16:39:20] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.993872Z","level":"info","event":"📋 2025-06-05 16:39:20,906 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.993954Z","level":"info","event":"📋 [2025-06-05 16:39:20] Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.994037Z","level":"info","event":"📋 2025-06-05 16:39:20,906 - INFO - Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.994164Z","level":"info","event":"📋 [2025-06-05 16:39:20] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.994247Z","level":"info","event":"📋 2025-06-05 16:39:20,906 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.994364Z","level":"info","event":"📋 [2025-06-05 16:39:20]   Total de Artigos Processados: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.995121Z","level":"info","event":"📋 2025-06-05 16:39:20,906 - INFO -   Total de Artigos Processados: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.995631Z","level":"info","event":"📋 [2025-06-05 16:39:20]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.998262Z","level":"info","event":"📋 2025-06-05 16:39:20,906 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.998659Z","level":"info","event":"📋 [2025-06-05 16:39:20]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:20.999597Z","level":"info","event":"📋 2025-06-05 16:39:20,906 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:21.001552Z","level":"info","event":"📋 [2025-06-05 16:39:20]   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:21.001657Z","level":"info","event":"📋 2025-06-05 16:39:20,906 - INFO -   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:21.001743Z","level":"info","event":"📋 [2025-06-05 16:39:20]   Taxa de Sucesso: 45.5%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:21.001824Z","level":"info","event":"📋 2025-06-05 16:39:20,906 - INFO -   Taxa de Sucesso: 45.5%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:21.001900Z","level":"info","event":"📋 [2025-06-05 16:39:20] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:21.002034Z","level":"info","event":"📋 2025-06-05 16:39:20,906 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:21.002119Z","level":"info","event":"📋 [2025-06-05 16:39:20] ✅ Processing completed. Processed 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:21.002447Z","level":"info","event":"📋 2025-06-05 16:39:20,909 - INFO - ✅ Processing completed. Processed 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:21.470314Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:21.470645Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:21.471084Z","level":"info","event":"⚠️ relevant_articles: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:21.471452Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/data/structured/2025/06/04/artigos_irrelevantes_2025-06-04.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:21.471698Z","level":"info","event":"⚠️ processing_log: /opt/airflow/data/structured/2025/06/04/processing_log_20250604.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:21.472115Z","level":"info","event":"✅ stats_json: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json (393 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:21.477855","level":"info","event":"Done. Returned value was: [2025-06-05 16:38:41] Starting processar_relevantes_airflow\n2025-06-05 16:38:41,328 - INFO - Starting processar_relevantes_airflow\n[2025-06-05 16:38:41] Parameters: dias=1, date=2025-06-04\n2025-06-05 16:38:41,328 - INFO - Parameters: dias=1, date=2025-06-04\n[2025-06-05 16:38:41] Paths: input_file=/opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv, output_dir=/opt/airflow/data/structured/2025/06/04, date_str=2025-06-04\n2025-06-05 16:38:41,328 - INFO - Paths: input_file=/opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv, output_dir=/opt/airflow/data/structured/2025/06/04, date_str=2025-06-04\n[2025-06-05 16:38:41] 🚀 A iniciar processar_relevantes_airflow\n2025-06-05 16:38:41,328 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-05 16:38:41] 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/04\n2025-06-05 16:38:41,328 - INFO - 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/04\n[2025-06-05 16:38:41] 📁 Using provided input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv\n2025-06-05 16:38:41,328 - INFO - 📁 Using provided input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv\n[2025-06-05 16:38:41] 🔧 A carregar ficheiros de configuração...\n2025-06-05 16:38:41,328 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-05 16:38:41] 🔍 Checking config path: /opt/airflow/config\n2025-06-05 16:38:41,329 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-05 16:38:41] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-05 16:38:41,329 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-05 16:38:41] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-05 16:38:41,329 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-05 16:38:41] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-05 16:38:41,329 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-05 16:38:41] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-05 16:38:41,329 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-05 16:38:41] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-05 16:38:41,330 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-05 16:38:41] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-05 16:38:41,331 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-05 16:38:41] ✅ Loaded 6 keywords\n2025-06-05 16:38:41,331 - INFO - ✅ Loaded 6 keywords\n[2025-06-05 16:38:41] ✅ Loaded 3614 DICOFREG codes\n2025-06-05 16:38:41,338 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-05 16:38:41] ==================================================\n2025-06-05 16:38:41,338 - INFO - ==================================================\n[2025-06-05 16:38:41] Configuration Loaded\n2025-06-05 16:38:41,338 - INFO - Configuration Loaded\n[2025-06-05 16:38:41] ==================================================\n2025-06-05 16:38:41,338 - INFO - ==================================================\n[2025-06-05 16:38:41]   Parishes: 306\n2025-06-05 16:38:41,338 - INFO -   Parishes: 306\n[2025-06-05 16:38:41]   Municipalities: 306\n2025-06-05 16:38:41,338 - INFO -   Municipalities: 306\n[2025-06-05 16:38:41]   Districts: 29\n2025-06-05 16:38:41,338 - INFO -   Districts: 29\n[2025-06-05 16:38:41]   Keywords: 6\n2025-06-05 16:38:41,338 - INFO -   Keywords: 6\n[2025-06-05 16:38:41]   DICOFREG Codes: 3614\n2025-06-05 16:38:41,338 - INFO -   DICOFREG Codes: 3614\n[2025-06-05 16:38:41] ==================================================\n2025-06-05 16:38:41,338 - INFO - ==================================================\n[2025-06-05 16:38:41] ✅ Ficheiro CSV válido com 11 artigos\n2025-06-05 16:38:41,341 - INFO - ✅ Ficheiro CSV válido com 11 artigos\n[2025-06-05 16:38:41] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-05 16:38:41,341 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-05 16:38:41] 📅 Filtrado para artigos dos últimos 1 dias: 11 artigos\n2025-06-05 16:38:41,341 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 11 artigos\n[2025-06-05 16:38:41] ==================================================\n2025-06-05 16:38:41,342 - INFO - ==================================================\n[2025-06-05 16:38:41] Processamento Iniciado\n2025-06-05 16:38:41,342 - INFO - Processamento Iniciado\n[2025-06-05 16:38:41] ==================================================\n2025-06-05 16:38:41,342 - INFO - ==================================================\n[2025-06-05 16:38:41]   Total de Artigos para Processar: 11\n2025-06-05 16:38:41,342 - INFO -   Total de Artigos para Processar: 11\n[2025-06-05 16:38:41]   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv\n2025-06-05 16:38:41,342 - INFO -   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv\n[2025-06-05 16:38:41]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n2025-06-05 16:38:41,342 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n[2025-06-05 16:38:41]   Diretoria de Saída: /opt/airflow/data/structured/2025/06/04\n2025-06-05 16:38:41,342 - INFO -   Diretoria de Saída: /opt/airflow/data/structured/2025/06/04\n[2025-06-05 16:38:41]   Filtro de Dias: 1\n2025-06-05 16:38:41,342 - INFO -   Filtro de Dias: 1\n[2025-06-05 16:38:41] ==================================================\n2025-06-05 16:38:41,342 - INFO - ==================================================\n[2025-06-05 16:38:41] 📦 A processar lote 1/1 (11 artigos)\n2025-06-05 16:38:41,343 - INFO - 📦 A processar lote 1/1 (11 artigos)\n[2025-06-05 16:38:48] 🔄 Processado: Água potável responsável por 18% dos óbitos por di...\n2025-06-05 16:38:48,529 - INFO - 🔄 Processado: Água potável responsável por 18% dos óbitos por di...\n[2025-06-05 16:38:50] 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...\n2025-06-05 16:38:50,618 - INFO - 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...\n[2025-06-05 16:38:52] 🔄 Processado: Escocês desaparecido em Albufeira foi encontrado m...\n2025-06-05 16:38:52,955 - INFO - 🔄 Processado: Escocês desaparecido em Albufeira foi encontrado m...\n[2025-06-05 16:38:53] ⚠️ Artigo ignorado após extração: PJ vai à Câmara de Bragança por suspeitas em obras do tempo de Hernâni Dias - Jornal de Notícias\n2025-06-05 16:38:53,267 - WARNING - ⚠️ Artigo ignorado após extração: PJ vai à Câmara de Bragança por suspeitas em obras do tempo de Hernâni Dias - Jornal de Notícias\n[2025-06-05 16:38:54] ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho\n2025-06-05 16:38:54,476 - WARNING - ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho\n[2025-06-05 16:38:56] 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...[2025-06-05 16:38:56] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Morador de Magé constrói cachoeira sustentável de 25 m de queda e captação de água da chuva - G1\n2025-06-05 16:38:56,883 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Morador de Magé constrói cachoeira sustentável de 25 m de queda e captação de água da chuva - G1\n[2025-06-05 16:38:56] 🔄 Processado: Morador de Magé constrói cachoeira sustentável de ...\n2025-06-05 16:38:56,885 - INFO - 🔄 Processado: Morador de Magé constrói cachoeira sustentável de ...\n\n2025-06-05 16:38:56,885 - INFO - 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...\n[2025-06-05 16:38:57] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Sertãozinho (SP) terá dia ensolarado hoje (05); veja previsão do tempo - UOL Notícias\n2025-06-05 16:38:57,842 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Sertãozinho (SP) terá dia ensolarado hoje (05); veja previsão do tempo - UOL Notícias\n[2025-06-05 16:38:57] 🔄 Processado: Sertãozinho (SP) terá dia ensolarado hoje (05); ve...\n2025-06-05 16:38:57,844 - INFO - 🔄 Processado: Sertãozinho (SP) terá dia ensolarado hoje (05); ve...\n[2025-06-05 16:39:13] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMisgFBVV95cUxOUXgxZW96cGJKRm1kUmhpQy12YWxScndrZDJtVE1OZUVQdEhZZ1JTV3R0X3MweVJ1Xzg5V1ZmdTN0VmRURHkwVmJUeE1FLXVsUGt6ZlFvNG1CTnlBSndydkd0Qnd4QmpZMjJYbDVvRGF2RjZtM2dYVDJGT2lQek1yd2liLXV3U2U4N3c4VUpEVFl0NUJrZjUxMlZsRjBEX3ZmTDU5eURZakJWemwwa1hnckFn?oc=5\n2025-06-05 16:39:13,737 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMisgFBVV95cUxOUXgxZW96cGJKRm1kUmhpQy12YWxScndrZDJtVE1OZUVQdEhZZ1JTV3R0X3MweVJ1Xzg5V1ZmdTN0VmRURHkwVmJUeE1FLXVsUGt6ZlFvNG1CTnlBSndydkd0Qnd4QmpZMjJYbDVvRGF2RjZtM2dYVDJGT2lQek1yd2liLXV3U2U4N3c4VUpEVFl0NUJrZjUxMlZsRjBEX3ZmTDU5eURZakJWemwwa1hnckFn?oc=5\n[2025-06-05 16:39:14] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiswFBVV95cUxNWHBqX0FkeXhZU2dnd28yZHlyZ1RaTm5EUzdVcWRNV3ZMOElCUlhZaThmbFRsTC1nM0RPLWVlV1JsaXdCMno5ZmMycEZGR2hiLWswQTNoQTFJUFNPTjJJUU5ZNmxDVjMyTEh6WmgyTHBpT1d0NmhneDZUTzhJZWNGUFhaVWFBblVlUHVRZmg4M2pGUHQxLTN3c1gzMXpHVkxxM1dJdHlKSkJZcEpRVTFXNzFZcw?oc=5\n2025-06-05 16:39:14,515 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMiswFBVV95cUxNWHBqX0FkeXhZU2dnd28yZHlyZ1RaTm5EUzdVcWRNV3ZMOElCUlhZaThmbFRsTC1nM0RPLWVlV1JsaXdCMno5ZmMycEZGR2hiLWswQTNoQTFJUFNPTjJJUU5ZNmxDVjMyTEh6WmgyTHBpT1d0NmhneDZUTzhJZWNGUFhaVWFBblVlUHVRZmg4M2pGUHQxLTN3c1gzMXpHVkxxM1dJdHlKSkJZcEpRVTFXNzFZcw?oc=5\n[2025-06-05 16:39:17] ⚠️ Artigo ignorado após extração: Chuva fraca no Norte e Centro e subida da temperatura no Sul - Renascença\n2025-06-05 16:39:17,466 - WARNING - ⚠️ Artigo ignorado após extração: Chuva fraca no Norte e Centro e subida da temperatura no Sul - Renascença\n📥 Novos artigos recebidos: 5\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 5\n💾 Guardados 5 artigos no arquivo /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n📥 Novos artigos recebidos: 5\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 5\n💾 Guardados 5 artigos no arquivo /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n[2025-06-05 16:39:17] ✅ Relevant articles saved: 5 articles\n2025-06-05 16:39:17,494 - INFO - ✅ Relevant articles saved: 5 articles\n[2025-06-05 16:39:17] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:39:17,496 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:39:17] ✅ Lote 1 concluído: 5 artigos (total: 5)\n2025-06-05 16:39:17,496 - INFO - ✅ Lote 1 concluído: 5 artigos (total: 5)\n📥 Novos artigos recebidos: 5\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n📂 IDs existentes no arquivo: 5\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 5\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n📂 IDs existentes no arquivo: 5\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-05 16:39:20] ✅ Relevant articles saved: 5 articles\n2025-06-05 16:39:20,898 - INFO - ✅ Relevant articles saved: 5 articles\n[2025-06-05 16:39:20] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:39:20,905 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:39:20] ==================================================\n2025-06-05 16:39:20,906 - INFO - ==================================================\n[2025-06-05 16:39:20] Processamento Concluído com Sucesso\n2025-06-05 16:39:20,906 - INFO - Processamento Concluído com Sucesso\n[2025-06-05 16:39:20] ==================================================\n2025-06-05 16:39:20,906 - INFO - ==================================================\n[2025-06-05 16:39:20]   Total de Artigos Processados: 5\n2025-06-05 16:39:20,906 - INFO -   Total de Artigos Processados: 5\n[2025-06-05 16:39:20]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n2025-06-05 16:39:20,906 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n[2025-06-05 16:39:20]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n2025-06-05 16:39:20,906 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n[2025-06-05 16:39:20]   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:39:20,906 - INFO -   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:39:20]   Taxa de Sucesso: 45.5%\n2025-06-05 16:39:20,906 - INFO -   Taxa de Sucesso: 45.5%\n[2025-06-05 16:39:20] ==================================================\n2025-06-05 16:39:20,906 - INFO - ==================================================\n[2025-06-05 16:39:20] ✅ Processing completed. Processed 5 articles\n2025-06-05 16:39:20,909 - INFO - ✅ Processing completed. Processed 5 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
