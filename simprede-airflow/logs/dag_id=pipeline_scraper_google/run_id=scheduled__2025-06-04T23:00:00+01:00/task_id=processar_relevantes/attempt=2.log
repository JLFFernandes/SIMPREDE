{"timestamp":"2025-06-05T15:23:06.991578","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T15:23:06.991950","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T15:23:07.027249Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:07.029684Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:07.030695Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/04', '/opt/airflow/data/structured/2025/06/04', '/opt/airflow/data/processed/2025/06/04']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:07.031149Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:07.031227Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:07.031509Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:07.031683Z","level":"info","event":"  - Target date: 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:07.031747Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:07.031803Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:07.031874Z","level":"info","event":"✅ Found input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:07.031941Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:07.032012Z","level":"info","event":"  - relevant_articles: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:07.032077Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/data/structured/2025/06/04/artigos_irrelevantes_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:07.032142Z","level":"info","event":"  - processing_log: /opt/airflow/data/structured/2025/06/04/processing_log_20250604.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:07.032201Z","level":"info","event":"  - stats_json: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:07.032265Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv --output_dir /opt/airflow/data/structured/2025/06/04 --date_str 2025-06-04 --date 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:07.032355Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.591758Z","level":"info","event":"📋 [2025-06-05 16:23:08] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.592017Z","level":"info","event":"📋 2025-06-05 16:23:08,591 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.592127Z","level":"info","event":"📋 [2025-06-05 16:23:08] Parameters: dias=1, date=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.592409Z","level":"info","event":"📋 2025-06-05 16:23:08,591 - INFO - Parameters: dias=1, date=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.592477Z","level":"info","event":"📋 [2025-06-05 16:23:08] Paths: input_file=/opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv, output_dir=/opt/airflow/data/structured/2025/06/04, date_str=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.592719Z","level":"info","event":"📋 2025-06-05 16:23:08,591 - INFO - Paths: input_file=/opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv, output_dir=/opt/airflow/data/structured/2025/06/04, date_str=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.592786Z","level":"info","event":"📋 [2025-06-05 16:23:08] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.592864Z","level":"info","event":"📋 2025-06-05 16:23:08,591 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.593078Z","level":"info","event":"📋 [2025-06-05 16:23:08] 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.593182Z","level":"info","event":"📋 2025-06-05 16:23:08,591 - INFO - 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.593776Z","level":"info","event":"📋 [2025-06-05 16:23:08] 📁 Using provided input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.593842Z","level":"info","event":"📋 2025-06-05 16:23:08,592 - INFO - 📁 Using provided input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.593890Z","level":"info","event":"📋 [2025-06-05 16:23:08] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.593941Z","level":"info","event":"📋 2025-06-05 16:23:08,592 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.593988Z","level":"info","event":"📋 [2025-06-05 16:23:08] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.594036Z","level":"info","event":"📋 2025-06-05 16:23:08,592 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.594087Z","level":"info","event":"📋 [2025-06-05 16:23:08] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.594135Z","level":"info","event":"📋 2025-06-05 16:23:08,592 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.594183Z","level":"info","event":"📋 [2025-06-05 16:23:08] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.594229Z","level":"info","event":"📋 2025-06-05 16:23:08,592 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.594274Z","level":"info","event":"📋 [2025-06-05 16:23:08] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.594321Z","level":"info","event":"📋 2025-06-05 16:23:08,592 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.594370Z","level":"info","event":"📋 [2025-06-05 16:23:08] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.594421Z","level":"info","event":"📋 2025-06-05 16:23:08,592 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.594783Z","level":"info","event":"📋 [2025-06-05 16:23:08] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.594857Z","level":"info","event":"📋 2025-06-05 16:23:08,594 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.594919Z","level":"info","event":"📋 [2025-06-05 16:23:08] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.595199Z","level":"info","event":"📋 2025-06-05 16:23:08,594 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.595351Z","level":"info","event":"📋 [2025-06-05 16:23:08] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.595863Z","level":"info","event":"📋 2025-06-05 16:23:08,595 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.604702Z","level":"info","event":"📋 [2025-06-05 16:23:08] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.605073Z","level":"info","event":"📋 2025-06-05 16:23:08,604 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.605281Z","level":"info","event":"📋 [2025-06-05 16:23:08] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.605343Z","level":"info","event":"📋 2025-06-05 16:23:08,604 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.605394Z","level":"info","event":"📋 [2025-06-05 16:23:08] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.606286Z","level":"info","event":"📋 2025-06-05 16:23:08,604 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.606355Z","level":"info","event":"📋 [2025-06-05 16:23:08] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.606409Z","level":"info","event":"📋 2025-06-05 16:23:08,604 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.606457Z","level":"info","event":"📋 [2025-06-05 16:23:08]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.606505Z","level":"info","event":"📋 2025-06-05 16:23:08,604 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.606551Z","level":"info","event":"📋 [2025-06-05 16:23:08]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.606598Z","level":"info","event":"📋 2025-06-05 16:23:08,604 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.606656Z","level":"info","event":"📋 [2025-06-05 16:23:08]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.606705Z","level":"info","event":"📋 2025-06-05 16:23:08,604 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.606750Z","level":"info","event":"📋 [2025-06-05 16:23:08]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.606800Z","level":"info","event":"📋 2025-06-05 16:23:08,604 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.607089Z","level":"info","event":"📋 [2025-06-05 16:23:08]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.607500Z","level":"info","event":"📋 2025-06-05 16:23:08,604 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.607755Z","level":"info","event":"📋 [2025-06-05 16:23:08] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.607803Z","level":"info","event":"📋 2025-06-05 16:23:08,604 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.608289Z","level":"info","event":"📋 [2025-06-05 16:23:08] ✅ Ficheiro CSV válido com 13 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.608360Z","level":"info","event":"📋 2025-06-05 16:23:08,608 - INFO - ✅ Ficheiro CSV válido com 13 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.608464Z","level":"info","event":"📋 [2025-06-05 16:23:08] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.608529Z","level":"info","event":"📋 2025-06-05 16:23:08,608 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.609924Z","level":"info","event":"📋 [2025-06-05 16:23:08] 📅 Filtrado para artigos dos últimos 1 dias: 13 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.610003Z","level":"info","event":"📋 2025-06-05 16:23:08,609 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 13 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.610306Z","level":"info","event":"📋 [2025-06-05 16:23:08] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.610367Z","level":"info","event":"📋 2025-06-05 16:23:08,610 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.610415Z","level":"info","event":"📋 [2025-06-05 16:23:08] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.610462Z","level":"info","event":"📋 2025-06-05 16:23:08,610 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.610508Z","level":"info","event":"📋 [2025-06-05 16:23:08] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.611494Z","level":"info","event":"📋 2025-06-05 16:23:08,610 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.611555Z","level":"info","event":"📋 [2025-06-05 16:23:08]   Total de Artigos para Processar: 13","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.611605Z","level":"info","event":"📋 2025-06-05 16:23:08,610 - INFO -   Total de Artigos para Processar: 13","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.611659Z","level":"info","event":"📋 [2025-06-05 16:23:08]   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.611710Z","level":"info","event":"📋 2025-06-05 16:23:08,610 - INFO -   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.611759Z","level":"info","event":"📋 [2025-06-05 16:23:08]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.611809Z","level":"info","event":"📋 2025-06-05 16:23:08,610 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.611859Z","level":"info","event":"📋 [2025-06-05 16:23:08]   Diretoria de Saída: /opt/airflow/data/structured/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.611937Z","level":"info","event":"📋 2025-06-05 16:23:08,610 - INFO -   Diretoria de Saída: /opt/airflow/data/structured/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.611987Z","level":"info","event":"📋 [2025-06-05 16:23:08]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.612033Z","level":"info","event":"📋 2025-06-05 16:23:08,610 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.612078Z","level":"info","event":"📋 [2025-06-05 16:23:08] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.612123Z","level":"info","event":"📋 2025-06-05 16:23:08,610 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.612183Z","level":"info","event":"📋 [2025-06-05 16:23:08] 📦 A processar lote 1/1 (13 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:08.612229Z","level":"info","event":"📋 2025-06-05 16:23:08,611 - INFO - 📦 A processar lote 1/1 (13 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:16.605456Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:17.509261Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:17.625097Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:18.000267Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:18.097475Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:18.290532Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:32.853340Z","level":"info","event":"⚠️ ❌ Erro ao resolver URL do Google News: Message:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:32.913001Z","level":"info","event":"⚠️","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:33.178470Z","level":"info","event":"📋 [2025-06-05 16:23:33] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva fraca no Norte e Centro e subida da temperatura no Sul - Renascença","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:33.188578Z","level":"info","event":"📋 2025-06-05 16:23:33,172 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva fraca no Norte e Centro e subida da temperatura no Sul - Renascença","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:33.376259Z","level":"info","event":"📋 [2025-06-05 16:23:33] 🔄 Processado: Chuva fraca no Norte e Centro e subida da temperat...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:33.382740Z","level":"info","event":"📋 2025-06-05 16:23:33,375 - INFO - 🔄 Processado: Chuva fraca no Norte e Centro e subida da temperat...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:33.447227Z","level":"info","event":"📋 [2025-06-05 16:23:33] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMirwFBVV95cUxPaUpkbWxMTzloTWxndHFGYm53N1VjMXlJN3R6V1dickRkWWR2NGJMT1BVbmZDZGNpTVZJOEh5cllMejRCV0ZYSWE0YmdEVE1QN3RFU0pMd2UyU3ZHRnk4TnBOdjVCSUhvcm1mMHNrRlNIYUE4NmVOcVpYNXlDS3hoOXlKRTVnT3NUU3dBbXk5RGdBM2RnSTBWWDBDeEpMM0hNZXA1bEd3V1dwT3pEVXJ3?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:33.447924Z","level":"info","event":"📋 2025-06-05 16:23:33,444 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMirwFBVV95cUxPaUpkbWxMTzloTWxndHFGYm53N1VjMXlJN3R6V1dickRkWWR2NGJMT1BVbmZDZGNpTVZJOEh5cllMejRCV0ZYSWE0YmdEVE1QN3RFU0pMd2UyU3ZHRnk4TnBOdjVCSUhvcm1mMHNrRlNIYUE4NmVOcVpYNXlDS3hoOXlKRTVnT3NUU3dBbXk5RGdBM2RnSTBWWDBDeEpMM0hNZXA1bEd3V1dwT3pEVXJ3?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:36.151811Z","level":"info","event":"⚠️ ❌ Erro ao resolver URL do Google News: Message:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:36.238652Z","level":"info","event":"⚠️","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:37.460617Z","level":"info","event":"📋 [2025-06-05 16:23:36] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMi8wFBVV95cUxOTXJkMDE3djJzVjBRck56cHRnMkFDeE5XNzhrRHVadU1Yby1wMC1WN3J5UjNhUzdUMkZEamN6cFUwWTY1MlNYRzNPbnJYcmp4YmtYcTFnQ051OWNlS0JjS21OanlXc0NOTE5QaE5LNnFybkZHcXZLaC1nbnRjZmxHaWhtbTBOVVRBUnV3UnlSUVA5bkhkQV9BbnpTRHh2ejZ0TnUyY0VYTld0eGw3M0xOYXhkSG9reE9tdDhWNkhWTmRPSGJoaU1LUF9TT2ppaDJXdzA4YmNyNWY2VDhucWpQTzRIc2R2alRiQWFxeWxVV0tTdGfSAfcBQVVfeXFMTzZsbC1WRXdBbUpMcGlZX09heUM3emVtUVV1UkRqYVhRTWR1RDFuN3g2NHNlYW5CdmNOdnREcTNnLTZKek9LSlVqQ2xmMGlPMEVmUVU4ZlhicHJaSVZOTE80V21RelJVblhCV1FtWWVJeE9ZN3RJZ0d5Z2UtUjloVTJ3TjlJbExSQjRCU2hRQ1RVNXJKb0N1bk15V1F4YnlPbXczdkQ2TWpPZ0Jub3BjeGRMVVFDUTRyWXgxWjBjbjVTcHE5LWhRdlJLMHlLa3JSQllGeXBXUkJNd0x0SnEyRUh2YkZ3bWI2VXE4VEFWVHo1cWJ1bjJ2TQ?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:37.463797Z","level":"info","event":"📋 2025-06-05 16:23:36,858 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMi8wFBVV95cUxOTXJkMDE3djJzVjBRck56cHRnMkFDeE5XNzhrRHVadU1Yby1wMC1WN3J5UjNhUzdUMkZEamN6cFUwWTY1MlNYRzNPbnJYcmp4YmtYcTFnQ051OWNlS0JjS21OanlXc0NOTE5QaE5LNnFybkZHcXZLaC1nbnRjZmxHaWhtbTBOVVRBUnV3UnlSUVA5bkhkQV9BbnpTRHh2ejZ0TnUyY0VYTld0eGw3M0xOYXhkSG9reE9tdDhWNkhWTmRPSGJoaU1LUF9TT2ppaDJXdzA4YmNyNWY2VDhucWpQTzRIc2R2alRiQWFxeWxVV0tTdGfSAfcBQVVfeXFMTzZsbC1WRXdBbUpMcGlZX09heUM3emVtUVV1UkRqYVhRTWR1RDFuN3g2NHNlYW5CdmNOdnREcTNnLTZKek9LSlVqQ2xmMGlPMEVmUVU4ZlhicHJaSVZOTE80V21RelJVblhCV1FtWWVJeE9ZN3RJZ0d5Z2UtUjloVTJ3TjlJbExSQjRCU2hRQ1RVNXJKb0N1bk15V1F4YnlPbXczdkQ2TWpPZ0Jub3BjeGRMVVFDUTRyWXgxWjBjbjVTcHE5LWhRdlJLMHlLa3JSQllGeXBXUkJNd0x0SnEyRUh2YkZ3bWI2VXE4VEFWVHo1cWJ1bjJ2TQ?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:37.464165Z","level":"info","event":"📋 [2025-06-05 16:23:37] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Anticiclone dos Açores \"jogará\" papel crucial no tempo das Regiões Autónomas portuguesas até 8 de junho: saiba como! - Tempo.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:37.464425Z","level":"info","event":"📋 2025-06-05 16:23:37,302 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Anticiclone dos Açores \"jogará\" papel crucial no tempo das Regiões Autónomas portuguesas até 8 de junho: saiba como! - Tempo.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:37.464690Z","level":"info","event":"📋 [2025-06-05 16:23:37] 🔄 Processado: Anticiclone dos Açores \"jogará\" papel crucial no t...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:37.465699Z","level":"info","event":"📋 2025-06-05 16:23:37,375 - INFO - 🔄 Processado: Anticiclone dos Açores \"jogará\" papel crucial no t...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:37.760593Z","level":"info","event":"⚠️ ❌ Erro ao resolver URL do Google News: Message:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:37.761354Z","level":"info","event":"⚠️","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:38.359834Z","level":"info","event":"⚠️ ❌ Erro ao resolver URL do Google News: Message:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:38.364612Z","level":"info","event":"⚠️","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:38.835769Z","level":"info","event":"📋 [2025-06-05 16:23:38] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMikAFBVV95cUxPZll6djBBMklKbWVvUmQ1ZWlmN2Rycy0tUHQtN1IyeVNhMDdnLTlwWk1Cd0VQUm5rcXU2OEJRZmJKZjVOdW1OdUZ2ZFNrS01zUU1uZjU5RzhfZ0JNTUF6cWhJN1QxWi01Y3pzRE5QN3pqdGRVakw3SWJpVlFOMmx6cTVPX2hrOXo3T3ZUX1luMXI?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:38.882332Z","level":"info","event":"📋 2025-06-05 16:23:38,849 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMikAFBVV95cUxPZll6djBBMklKbWVvUmQ1ZWlmN2Rycy0tUHQtN1IyeVNhMDdnLTlwWk1Cd0VQUm5rcXU2OEJRZmJKZjVOdW1OdUZ2ZFNrS01zUU1uZjU5RzhfZ0JNTUF6cWhJN1QxWi01Y3pzRE5QN3pqdGRVakw3SWJpVlFOMmx6cTVPX2hrOXo3T3ZUX1luMXI?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:39.394529Z","level":"info","event":"📋 [2025-06-05 16:23:39] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMi5AFBVV95cUxQSFZWNDZldGZ6RE42SEZhbmV6WTJMekZWQloweUIxTHlta0xhcVRyQ1E5R1pyNjQzRXhvRm1uVnNuVzM3bmFlT0o5dWwzUC1pa1QxTWtVUWpHbS1xS3ByTE9wenhoLWlFUXJ6X0RueTg3WVd5UUx0Mmt5cmh1ekF0VWJVNllLcS1pSnlOUjc5RzBWOWdrcUZmaTZtODJ2ZnI0d3BleGkyNG0ydWZYODNjcDJvSm9NRWF3OXp4RG1jZWpGakpVaVF3QnhCQWNPT0paamFxT1ZPQzJ4aEdBdlRmZ25RTmbSAeoBQVVfeXFMTjgyTXBmczdRRUtxSHFYeENaWGk0TTlqZkNpUHBoVk5uWjRNVVFQVE11Q0xBdG85UmxLUnJ0MGRrc3JMRENSZm4tbmlMWlU5YWE0TFBwR2hURlRZb2ZLMlhhMzRFTVdsbDhza00yMll3b3VndUpjQ1RlY3FhdjhqZHlaSlh2bnZsdUlCZW5CREdBSklON296c1QxUzl6VGM2UFV6M1k5SHdyWHItd3IyN1BvNTBlalVySllLeS0tVWVSc2dvcUFiTllzbkRmVHNCU25IVld1bHQ5V04yZGdPTW5OYVVVZlRJRGVR?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:39.403962Z","level":"info","event":"📋 2025-06-05 16:23:39,386 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMi5AFBVV95cUxQSFZWNDZldGZ6RE42SEZhbmV6WTJMekZWQloweUIxTHlta0xhcVRyQ1E5R1pyNjQzRXhvRm1uVnNuVzM3bmFlT0o5dWwzUC1pa1QxTWtVUWpHbS1xS3ByTE9wenhoLWlFUXJ6X0RueTg3WVd5UUx0Mmt5cmh1ekF0VWJVNllLcS1pSnlOUjc5RzBWOWdrcUZmaTZtODJ2ZnI0d3BleGkyNG0ydWZYODNjcDJvSm9NRWF3OXp4RG1jZWpGakpVaVF3QnhCQWNPT0paamFxT1ZPQzJ4aEdBdlRmZ25RTmbSAeoBQVVfeXFMTjgyTXBmczdRRUtxSHFYeENaWGk0TTlqZkNpUHBoVk5uWjRNVVFQVE11Q0xBdG85UmxLUnJ0MGRrc3JMRENSZm4tbmlMWlU5YWE0TFBwR2hURlRZb2ZLMlhhMzRFTVdsbDhza00yMll3b3VndUpjQ1RlY3FhdjhqZHlaSlh2bnZsdUlCZW5CREdBSklON296c1QxUzl6VGM2UFV6M1k5SHdyWHItd3IyN1BvNTBlalVySllLeS0tVWVSc2dvcUFiTllzbkRmVHNCU25IVld1bHQ5V04yZGdPTW5OYVVVZlRJRGVR?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:47.142191Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:47.974253Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:48.602135Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:49.033790Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:49.338173Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:51.469654Z","level":"info","event":"📋 [2025-06-05 16:23:51] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Alemanha 1-2 Portugal - CNN Portugal","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:51.484525Z","level":"info","event":"📋 2025-06-05 16:23:51,466 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Alemanha 1-2 Portugal - CNN Portugal","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:51.791379Z","level":"info","event":"📋 [2025-06-05 16:23:51] 🔄 Processado: Liga das Nações: Alemanha 1-2 Portugal - CNN Portu...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:51.792192Z","level":"info","event":"📋 2025-06-05 16:23:51,508 - INFO - 🔄 Processado: Liga das Nações: Alemanha 1-2 Portugal - CNN Portu...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:58.243035Z","level":"info","event":"📋 [2025-06-05 16:23:58] 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:58.252656Z","level":"info","event":"📋 2025-06-05 16:23:58,240 - INFO - 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:59.760172Z","level":"info","event":"📋 [2025-06-05 16:23:59] 🔄 Processado: Escocês desaparecido em Albufeira foi encontrado m...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:23:59.760521Z","level":"info","event":"📋 2025-06-05 16:23:59,757 - INFO - 🔄 Processado: Escocês desaparecido em Albufeira foi encontrado m...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:00.518866Z","level":"info","event":"📋 [2025-06-05 16:24:00] ⚠️ Artigo ignorado após extração: Barreiro tem chuva extremamente forte nesta terça-feira (3) - MSN","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:00.523722Z","level":"info","event":"📋 2025-06-05 16:24:00,518 - WARNING - ⚠️ Artigo ignorado após extração: Barreiro tem chuva extremamente forte nesta terça-feira (3) - MSN","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:00.544865Z","level":"info","event":"📋 [2025-06-05 16:24:00] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Chuva fraca está de regresso com descida da temperatura - O Amarense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:00.545465Z","level":"info","event":"📋 2025-06-05 16:24:00,543 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Chuva fraca está de regresso com descida da temperatura - O Amarense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:00.548727Z","level":"info","event":"📋 [2025-06-05 16:24:00] 🔄 Processado: Tempo. Chuva fraca está de regresso com descida da...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:00.550493Z","level":"info","event":"📋 2025-06-05 16:24:00,549 - INFO - 🔄 Processado: Tempo. Chuva fraca está de regresso com descida da...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:01.780384Z","level":"info","event":"📋 [2025-06-05 16:24:01] 🔄 Processado: Água potável responsável por 18% dos óbitos por di...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:01.781706Z","level":"info","event":"📋 2025-06-05 16:24:01,781 - INFO - 🔄 Processado: Água potável responsável por 18% dos óbitos por di...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.622943Z","level":"info","event":"📋 [2025-06-05 16:24:06] ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.630647Z","level":"info","event":"📋 2025-06-05 16:24:06,620 - WARNING - ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.686627Z","level":"info","event":"📋 📥 Novos artigos recebidos: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.686949Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.687148Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.687358Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.687526Z","level":"info","event":"📋 💾 Guardados 7 artigos no arquivo /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.687764Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.687919Z","level":"info","event":"📋 📥 Novos artigos recebidos: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.688074Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.688254Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.688427Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.688611Z","level":"info","event":"📋 💾 Guardados 7 artigos no arquivo /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.688783Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.688940Z","level":"info","event":"📋 [2025-06-05 16:24:06] ✅ Relevant articles saved: 7 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.689149Z","level":"info","event":"📋 2025-06-05 16:24:06,645 - INFO - ✅ Relevant articles saved: 7 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.689316Z","level":"info","event":"📋 [2025-06-05 16:24:06] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.689463Z","level":"info","event":"📋 2025-06-05 16:24:06,646 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.689610Z","level":"info","event":"📋 [2025-06-05 16:24:06] ✅ Lote 1 concluído: 7 artigos (total: 7)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:06.689756Z","level":"info","event":"📋 2025-06-05 16:24:06,646 - INFO - ✅ Lote 1 concluído: 7 artigos (total: 7)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.504545Z","level":"info","event":"📋 📥 Novos artigos recebidos: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.530360Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.538063Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.547732Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.554642Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.556879Z","level":"info","event":"📋 📥 Novos artigos recebidos: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.563295Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.565126Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.570177Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.570770Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.578122Z","level":"info","event":"📋 [2025-06-05 16:24:10] ✅ Relevant articles saved: 7 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.583556Z","level":"info","event":"📋 2025-06-05 16:24:10,569 - INFO - ✅ Relevant articles saved: 7 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.601548Z","level":"info","event":"📋 [2025-06-05 16:24:10] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.603946Z","level":"info","event":"📋 2025-06-05 16:24:10,587 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.605562Z","level":"info","event":"📋 [2025-06-05 16:24:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.606335Z","level":"info","event":"📋 2025-06-05 16:24:10,590 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.607711Z","level":"info","event":"📋 [2025-06-05 16:24:10] Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.609705Z","level":"info","event":"📋 2025-06-05 16:24:10,590 - INFO - Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.610486Z","level":"info","event":"📋 [2025-06-05 16:24:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.610793Z","level":"info","event":"📋 2025-06-05 16:24:10,590 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.612535Z","level":"info","event":"📋 [2025-06-05 16:24:10]   Total de Artigos Processados: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.613453Z","level":"info","event":"📋 2025-06-05 16:24:10,591 - INFO -   Total de Artigos Processados: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.613763Z","level":"info","event":"📋 [2025-06-05 16:24:10]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.613992Z","level":"info","event":"📋 2025-06-05 16:24:10,591 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.614284Z","level":"info","event":"📋 [2025-06-05 16:24:10]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.615073Z","level":"info","event":"📋 2025-06-05 16:24:10,591 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.615664Z","level":"info","event":"📋 [2025-06-05 16:24:10]   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.616338Z","level":"info","event":"📋 2025-06-05 16:24:10,591 - INFO -   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.617970Z","level":"info","event":"📋 [2025-06-05 16:24:10]   Taxa de Sucesso: 53.8%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.618773Z","level":"info","event":"📋 2025-06-05 16:24:10,591 - INFO -   Taxa de Sucesso: 53.8%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.620456Z","level":"info","event":"📋 [2025-06-05 16:24:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.620977Z","level":"info","event":"📋 2025-06-05 16:24:10,591 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.621189Z","level":"info","event":"📋 [2025-06-05 16:24:10] ✅ Processing completed. Processed 7 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:10.621725Z","level":"info","event":"📋 2025-06-05 16:24:10,613 - INFO - ✅ Processing completed. Processed 7 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:11.130238Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:11.131875Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:11.132530Z","level":"info","event":"⚠️ relevant_articles: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:11.134702Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/data/structured/2025/06/04/artigos_irrelevantes_2025-06-04.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:11.135102Z","level":"info","event":"⚠️ processing_log: /opt/airflow/data/structured/2025/06/04/processing_log_20250604.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:11.135445Z","level":"info","event":"✅ stats_json: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json (393 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:11.144411","level":"info","event":"Done. Returned value was: [2025-06-05 16:23:08] Starting processar_relevantes_airflow\n2025-06-05 16:23:08,591 - INFO - Starting processar_relevantes_airflow\n[2025-06-05 16:23:08] Parameters: dias=1, date=2025-06-04\n2025-06-05 16:23:08,591 - INFO - Parameters: dias=1, date=2025-06-04\n[2025-06-05 16:23:08] Paths: input_file=/opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv, output_dir=/opt/airflow/data/structured/2025/06/04, date_str=2025-06-04\n2025-06-05 16:23:08,591 - INFO - Paths: input_file=/opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv, output_dir=/opt/airflow/data/structured/2025/06/04, date_str=2025-06-04\n[2025-06-05 16:23:08] 🚀 A iniciar processar_relevantes_airflow\n2025-06-05 16:23:08,591 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-05 16:23:08] 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/04\n2025-06-05 16:23:08,591 - INFO - 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/04\n[2025-06-05 16:23:08] 📁 Using provided input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv\n2025-06-05 16:23:08,592 - INFO - 📁 Using provided input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv\n[2025-06-05 16:23:08] 🔧 A carregar ficheiros de configuração...\n2025-06-05 16:23:08,592 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-05 16:23:08] 🔍 Checking config path: /opt/airflow/config\n2025-06-05 16:23:08,592 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-05 16:23:08] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-05 16:23:08,592 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-05 16:23:08] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-05 16:23:08,592 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-05 16:23:08] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-05 16:23:08,592 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-05 16:23:08] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-05 16:23:08,592 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-05 16:23:08] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-05 16:23:08,594 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-05 16:23:08] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-05 16:23:08,594 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-05 16:23:08] ✅ Loaded 6 keywords\n2025-06-05 16:23:08,595 - INFO - ✅ Loaded 6 keywords\n[2025-06-05 16:23:08] ✅ Loaded 3614 DICOFREG codes\n2025-06-05 16:23:08,604 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-05 16:23:08] ==================================================\n2025-06-05 16:23:08,604 - INFO - ==================================================\n[2025-06-05 16:23:08] Configuration Loaded\n2025-06-05 16:23:08,604 - INFO - Configuration Loaded\n[2025-06-05 16:23:08] ==================================================\n2025-06-05 16:23:08,604 - INFO - ==================================================\n[2025-06-05 16:23:08]   Parishes: 306\n2025-06-05 16:23:08,604 - INFO -   Parishes: 306\n[2025-06-05 16:23:08]   Municipalities: 306\n2025-06-05 16:23:08,604 - INFO -   Municipalities: 306\n[2025-06-05 16:23:08]   Districts: 29\n2025-06-05 16:23:08,604 - INFO -   Districts: 29\n[2025-06-05 16:23:08]   Keywords: 6\n2025-06-05 16:23:08,604 - INFO -   Keywords: 6\n[2025-06-05 16:23:08]   DICOFREG Codes: 3614\n2025-06-05 16:23:08,604 - INFO -   DICOFREG Codes: 3614\n[2025-06-05 16:23:08] ==================================================\n2025-06-05 16:23:08,604 - INFO - ==================================================\n[2025-06-05 16:23:08] ✅ Ficheiro CSV válido com 13 artigos\n2025-06-05 16:23:08,608 - INFO - ✅ Ficheiro CSV válido com 13 artigos\n[2025-06-05 16:23:08] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-05 16:23:08,608 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-05 16:23:08] 📅 Filtrado para artigos dos últimos 1 dias: 13 artigos\n2025-06-05 16:23:08,609 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 13 artigos\n[2025-06-05 16:23:08] ==================================================\n2025-06-05 16:23:08,610 - INFO - ==================================================\n[2025-06-05 16:23:08] Processamento Iniciado\n2025-06-05 16:23:08,610 - INFO - Processamento Iniciado\n[2025-06-05 16:23:08] ==================================================\n2025-06-05 16:23:08,610 - INFO - ==================================================\n[2025-06-05 16:23:08]   Total de Artigos para Processar: 13\n2025-06-05 16:23:08,610 - INFO -   Total de Artigos para Processar: 13\n[2025-06-05 16:23:08]   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv\n2025-06-05 16:23:08,610 - INFO -   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv\n[2025-06-05 16:23:08]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n2025-06-05 16:23:08,610 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n[2025-06-05 16:23:08]   Diretoria de Saída: /opt/airflow/data/structured/2025/06/04\n2025-06-05 16:23:08,610 - INFO -   Diretoria de Saída: /opt/airflow/data/structured/2025/06/04\n[2025-06-05 16:23:08]   Filtro de Dias: 1\n2025-06-05 16:23:08,610 - INFO -   Filtro de Dias: 1\n[2025-06-05 16:23:08] ==================================================\n2025-06-05 16:23:08,610 - INFO - ==================================================\n[2025-06-05 16:23:08] 📦 A processar lote 1/1 (13 artigos)\n2025-06-05 16:23:08,611 - INFO - 📦 A processar lote 1/1 (13 artigos)\n[2025-06-05 16:23:33] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva fraca no Norte e Centro e subida da temperatura no Sul - Renascença\n2025-06-05 16:23:33,172 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva fraca no Norte e Centro e subida da temperatura no Sul - Renascença\n[2025-06-05 16:23:33] 🔄 Processado: Chuva fraca no Norte e Centro e subida da temperat...\n2025-06-05 16:23:33,375 - INFO - 🔄 Processado: Chuva fraca no Norte e Centro e subida da temperat...\n[2025-06-05 16:23:33] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMirwFBVV95cUxPaUpkbWxMTzloTWxndHFGYm53N1VjMXlJN3R6V1dickRkWWR2NGJMT1BVbmZDZGNpTVZJOEh5cllMejRCV0ZYSWE0YmdEVE1QN3RFU0pMd2UyU3ZHRnk4TnBOdjVCSUhvcm1mMHNrRlNIYUE4NmVOcVpYNXlDS3hoOXlKRTVnT3NUU3dBbXk5RGdBM2RnSTBWWDBDeEpMM0hNZXA1bEd3V1dwT3pEVXJ3?oc=5\n2025-06-05 16:23:33,444 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMirwFBVV95cUxPaUpkbWxMTzloTWxndHFGYm53N1VjMXlJN3R6V1dickRkWWR2NGJMT1BVbmZDZGNpTVZJOEh5cllMejRCV0ZYSWE0YmdEVE1QN3RFU0pMd2UyU3ZHRnk4TnBOdjVCSUhvcm1mMHNrRlNIYUE4NmVOcVpYNXlDS3hoOXlKRTVnT3NUU3dBbXk5RGdBM2RnSTBWWDBDeEpMM0hNZXA1bEd3V1dwT3pEVXJ3?oc=5\n[2025-06-05 16:23:36] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMi8wFBVV95cUxOTXJkMDE3djJzVjBRck56cHRnMkFDeE5XNzhrRHVadU1Yby1wMC1WN3J5UjNhUzdUMkZEamN6cFUwWTY1MlNYRzNPbnJYcmp4YmtYcTFnQ051OWNlS0JjS21OanlXc0NOTE5QaE5LNnFybkZHcXZLaC1nbnRjZmxHaWhtbTBOVVRBUnV3UnlSUVA5bkhkQV9BbnpTRHh2ejZ0TnUyY0VYTld0eGw3M0xOYXhkSG9reE9tdDhWNkhWTmRPSGJoaU1LUF9TT2ppaDJXdzA4YmNyNWY2VDhucWpQTzRIc2R2alRiQWFxeWxVV0tTdGfSAfcBQVVfeXFMTzZsbC1WRXdBbUpMcGlZX09heUM3emVtUVV1UkRqYVhRTWR1RDFuN3g2NHNlYW5CdmNOdnREcTNnLTZKek9LSlVqQ2xmMGlPMEVmUVU4ZlhicHJaSVZOTE80V21RelJVblhCV1FtWWVJeE9ZN3RJZ0d5Z2UtUjloVTJ3TjlJbExSQjRCU2hRQ1RVNXJKb0N1bk15V1F4YnlPbXczdkQ2TWpPZ0Jub3BjeGRMVVFDUTRyWXgxWjBjbjVTcHE5LWhRdlJLMHlLa3JSQllGeXBXUkJNd0x0SnEyRUh2YkZ3bWI2VXE4VEFWVHo1cWJ1bjJ2TQ?oc=5\n2025-06-05 16:23:36,858 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMi8wFBVV95cUxOTXJkMDE3djJzVjBRck56cHRnMkFDeE5XNzhrRHVadU1Yby1wMC1WN3J5UjNhUzdUMkZEamN6cFUwWTY1MlNYRzNPbnJYcmp4YmtYcTFnQ051OWNlS0JjS21OanlXc0NOTE5QaE5LNnFybkZHcXZLaC1nbnRjZmxHaWhtbTBOVVRBUnV3UnlSUVA5bkhkQV9BbnpTRHh2ejZ0TnUyY0VYTld0eGw3M0xOYXhkSG9reE9tdDhWNkhWTmRPSGJoaU1LUF9TT2ppaDJXdzA4YmNyNWY2VDhucWpQTzRIc2R2alRiQWFxeWxVV0tTdGfSAfcBQVVfeXFMTzZsbC1WRXdBbUpMcGlZX09heUM3emVtUVV1UkRqYVhRTWR1RDFuN3g2NHNlYW5CdmNOdnREcTNnLTZKek9LSlVqQ2xmMGlPMEVmUVU4ZlhicHJaSVZOTE80V21RelJVblhCV1FtWWVJeE9ZN3RJZ0d5Z2UtUjloVTJ3TjlJbExSQjRCU2hRQ1RVNXJKb0N1bk15V1F4YnlPbXczdkQ2TWpPZ0Jub3BjeGRMVVFDUTRyWXgxWjBjbjVTcHE5LWhRdlJLMHlLa3JSQllGeXBXUkJNd0x0SnEyRUh2YkZ3bWI2VXE4VEFWVHo1cWJ1bjJ2TQ?oc=5\n[2025-06-05 16:23:37] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Anticiclone dos Açores \"jogará\" papel crucial no tempo das Regiões Autónomas portuguesas até 8 de junho: saiba como! - Tempo.pt\n2025-06-05 16:23:37,302 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Anticiclone dos Açores \"jogará\" papel crucial no tempo das Regiões Autónomas portuguesas até 8 de junho: saiba como! - Tempo.pt\n[2025-06-05 16:23:37] 🔄 Processado: Anticiclone dos Açores \"jogará\" papel crucial no t...\n2025-06-05 16:23:37,375 - INFO - 🔄 Processado: Anticiclone dos Açores \"jogará\" papel crucial no t...\n[2025-06-05 16:23:38] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMikAFBVV95cUxPZll6djBBMklKbWVvUmQ1ZWlmN2Rycy0tUHQtN1IyeVNhMDdnLTlwWk1Cd0VQUm5rcXU2OEJRZmJKZjVOdW1OdUZ2ZFNrS01zUU1uZjU5RzhfZ0JNTUF6cWhJN1QxWi01Y3pzRE5QN3pqdGRVakw3SWJpVlFOMmx6cTVPX2hrOXo3T3ZUX1luMXI?oc=5\n2025-06-05 16:23:38,849 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMikAFBVV95cUxPZll6djBBMklKbWVvUmQ1ZWlmN2Rycy0tUHQtN1IyeVNhMDdnLTlwWk1Cd0VQUm5rcXU2OEJRZmJKZjVOdW1OdUZ2ZFNrS01zUU1uZjU5RzhfZ0JNTUF6cWhJN1QxWi01Y3pzRE5QN3pqdGRVakw3SWJpVlFOMmx6cTVPX2hrOXo3T3ZUX1luMXI?oc=5\n[2025-06-05 16:23:39] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMi5AFBVV95cUxQSFZWNDZldGZ6RE42SEZhbmV6WTJMekZWQloweUIxTHlta0xhcVRyQ1E5R1pyNjQzRXhvRm1uVnNuVzM3bmFlT0o5dWwzUC1pa1QxTWtVUWpHbS1xS3ByTE9wenhoLWlFUXJ6X0RueTg3WVd5UUx0Mmt5cmh1ekF0VWJVNllLcS1pSnlOUjc5RzBWOWdrcUZmaTZtODJ2ZnI0d3BleGkyNG0ydWZYODNjcDJvSm9NRWF3OXp4RG1jZWpGakpVaVF3QnhCQWNPT0paamFxT1ZPQzJ4aEdBdlRmZ25RTmbSAeoBQVVfeXFMTjgyTXBmczdRRUtxSHFYeENaWGk0TTlqZkNpUHBoVk5uWjRNVVFQVE11Q0xBdG85UmxLUnJ0MGRrc3JMRENSZm4tbmlMWlU5YWE0TFBwR2hURlRZb2ZLMlhhMzRFTVdsbDhza00yMll3b3VndUpjQ1RlY3FhdjhqZHlaSlh2bnZsdUlCZW5CREdBSklON296c1QxUzl6VGM2UFV6M1k5SHdyWHItd3IyN1BvNTBlalVySllLeS0tVWVSc2dvcUFiTllzbkRmVHNCU25IVld1bHQ5V04yZGdPTW5OYVVVZlRJRGVR?oc=5\n2025-06-05 16:23:39,386 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMi5AFBVV95cUxQSFZWNDZldGZ6RE42SEZhbmV6WTJMekZWQloweUIxTHlta0xhcVRyQ1E5R1pyNjQzRXhvRm1uVnNuVzM3bmFlT0o5dWwzUC1pa1QxTWtVUWpHbS1xS3ByTE9wenhoLWlFUXJ6X0RueTg3WVd5UUx0Mmt5cmh1ekF0VWJVNllLcS1pSnlOUjc5RzBWOWdrcUZmaTZtODJ2ZnI0d3BleGkyNG0ydWZYODNjcDJvSm9NRWF3OXp4RG1jZWpGakpVaVF3QnhCQWNPT0paamFxT1ZPQzJ4aEdBdlRmZ25RTmbSAeoBQVVfeXFMTjgyTXBmczdRRUtxSHFYeENaWGk0TTlqZkNpUHBoVk5uWjRNVVFQVE11Q0xBdG85UmxLUnJ0MGRrc3JMRENSZm4tbmlMWlU5YWE0TFBwR2hURlRZb2ZLMlhhMzRFTVdsbDhza00yMll3b3VndUpjQ1RlY3FhdjhqZHlaSlh2bnZsdUlCZW5CREdBSklON296c1QxUzl6VGM2UFV6M1k5SHdyWHItd3IyN1BvNTBlalVySllLeS0tVWVSc2dvcUFiTllzbkRmVHNCU25IVld1bHQ5V04yZGdPTW5OYVVVZlRJRGVR?oc=5\n[2025-06-05 16:23:51] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Alemanha 1-2 Portugal - CNN Portugal\n2025-06-05 16:23:51,466 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Alemanha 1-2 Portugal - CNN Portugal\n[2025-06-05 16:23:51] 🔄 Processado: Liga das Nações: Alemanha 1-2 Portugal - CNN Portu...\n2025-06-05 16:23:51,508 - INFO - 🔄 Processado: Liga das Nações: Alemanha 1-2 Portugal - CNN Portu...\n[2025-06-05 16:23:58] 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...\n2025-06-05 16:23:58,240 - INFO - 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...\n[2025-06-05 16:23:59] 🔄 Processado: Escocês desaparecido em Albufeira foi encontrado m...\n2025-06-05 16:23:59,757 - INFO - 🔄 Processado: Escocês desaparecido em Albufeira foi encontrado m...\n[2025-06-05 16:24:00] ⚠️ Artigo ignorado após extração: Barreiro tem chuva extremamente forte nesta terça-feira (3) - MSN\n2025-06-05 16:24:00,518 - WARNING - ⚠️ Artigo ignorado após extração: Barreiro tem chuva extremamente forte nesta terça-feira (3) - MSN\n[2025-06-05 16:24:00] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Chuva fraca está de regresso com descida da temperatura - O Amarense\n2025-06-05 16:24:00,543 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Chuva fraca está de regresso com descida da temperatura - O Amarense\n[2025-06-05 16:24:00] 🔄 Processado: Tempo. Chuva fraca está de regresso com descida da...\n2025-06-05 16:24:00,549 - INFO - 🔄 Processado: Tempo. Chuva fraca está de regresso com descida da...\n[2025-06-05 16:24:01] 🔄 Processado: Água potável responsável por 18% dos óbitos por di...\n2025-06-05 16:24:01,781 - INFO - 🔄 Processado: Água potável responsável por 18% dos óbitos por di...\n[2025-06-05 16:24:06] ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho\n2025-06-05 16:24:06,620 - WARNING - ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho\n📥 Novos artigos recebidos: 7\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 7\n💾 Guardados 7 artigos no arquivo /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n📥 Novos artigos recebidos: 7\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 7\n💾 Guardados 7 artigos no arquivo /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n[2025-06-05 16:24:06] ✅ Relevant articles saved: 7 articles\n2025-06-05 16:24:06,645 - INFO - ✅ Relevant articles saved: 7 articles\n[2025-06-05 16:24:06] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:24:06,646 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:24:06] ✅ Lote 1 concluído: 7 artigos (total: 7)\n2025-06-05 16:24:06,646 - INFO - ✅ Lote 1 concluído: 7 artigos (total: 7)\n📥 Novos artigos recebidos: 7\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n📂 IDs existentes no arquivo: 7\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 7\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n📂 IDs existentes no arquivo: 7\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-05 16:24:10] ✅ Relevant articles saved: 7 articles\n2025-06-05 16:24:10,569 - INFO - ✅ Relevant articles saved: 7 articles\n[2025-06-05 16:24:10] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:24:10,587 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:24:10] ==================================================\n2025-06-05 16:24:10,590 - INFO - ==================================================\n[2025-06-05 16:24:10] Processamento Concluído com Sucesso\n2025-06-05 16:24:10,590 - INFO - Processamento Concluído com Sucesso\n[2025-06-05 16:24:10] ==================================================\n2025-06-05 16:24:10,590 - INFO - ==================================================\n[2025-06-05 16:24:10]   Total de Artigos Processados: 7\n2025-06-05 16:24:10,591 - INFO -   Total de Artigos Processados: 7\n[2025-06-05 16:24:10]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n2025-06-05 16:24:10,591 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n[2025-06-05 16:24:10]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n2025-06-05 16:24:10,591 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n[2025-06-05 16:24:10]   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:24:10,591 - INFO -   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:24:10]   Taxa de Sucesso: 53.8%\n2025-06-05 16:24:10,591 - INFO -   Taxa de Sucesso: 53.8%\n[2025-06-05 16:24:10] ==================================================\n2025-06-05 16:24:10,591 - INFO - ==================================================\n[2025-06-05 16:24:10] ✅ Processing completed. Processed 7 articles\n2025-06-05 16:24:10,613 - INFO - ✅ Processing completed. Processed 7 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-05T16:10:55.764687","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T16:10:55.765242","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T16:10:55.846671Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:55.849304Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:55.850123Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:55.850524Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:55.851148Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:55.851263Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:55.851358Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:55.851443Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:55.851872Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:55.852290Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:55.852449Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:55.852539Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:55.852621Z","level":"info","event":"  - relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:55.852810Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:55.853311Z","level":"info","event":"  - processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:55.853569Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:55.853693Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv --output_dir /opt/airflow/scripts/google_scraper/data/structured/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:55.853897Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.389543Z","level":"info","event":"📋 [2025-06-05 17:10:57] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.390237Z","level":"info","event":"📋 2025-06-05 17:10:57,389 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.390335Z","level":"info","event":"📋 [2025-06-05 17:10:57] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.390564Z","level":"info","event":"📋 2025-06-05 17:10:57,389 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.390635Z","level":"info","event":"📋 [2025-06-05 17:10:57] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.390707Z","level":"info","event":"📋 2025-06-05 17:10:57,389 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.390875Z","level":"info","event":"📋 [2025-06-05 17:10:57] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.391542Z","level":"info","event":"📋 2025-06-05 17:10:57,389 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.391692Z","level":"info","event":"📋 [2025-06-05 17:10:57] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.391744Z","level":"info","event":"📋 2025-06-05 17:10:57,389 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.391798Z","level":"info","event":"📋 [2025-06-05 17:10:57] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.391839Z","level":"info","event":"📋 2025-06-05 17:10:57,390 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.391878Z","level":"info","event":"📋 [2025-06-05 17:10:57] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.391917Z","level":"info","event":"📋 2025-06-05 17:10:57,390 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.391952Z","level":"info","event":"📋 [2025-06-05 17:10:57] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.391987Z","level":"info","event":"📋 2025-06-05 17:10:57,390 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.392033Z","level":"info","event":"📋 [2025-06-05 17:10:57] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.392077Z","level":"info","event":"📋 2025-06-05 17:10:57,390 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.392114Z","level":"info","event":"📋 [2025-06-05 17:10:57] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.392217Z","level":"info","event":"📋 2025-06-05 17:10:57,390 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.392270Z","level":"info","event":"📋 [2025-06-05 17:10:57] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.392347Z","level":"info","event":"📋 2025-06-05 17:10:57,390 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.392686Z","level":"info","event":"📋 [2025-06-05 17:10:57] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.393022Z","level":"info","event":"📋 2025-06-05 17:10:57,390 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.393167Z","level":"info","event":"📋 [2025-06-05 17:10:57] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.393731Z","level":"info","event":"📋 2025-06-05 17:10:57,392 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.395431Z","level":"info","event":"📋 [2025-06-05 17:10:57] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.396500Z","level":"info","event":"📋 2025-06-05 17:10:57,392 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.397375Z","level":"info","event":"📋 [2025-06-05 17:10:57] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.399925Z","level":"info","event":"📋 2025-06-05 17:10:57,393 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.402193Z","level":"info","event":"📋 [2025-06-05 17:10:57] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.402708Z","level":"info","event":"📋 2025-06-05 17:10:57,401 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.402902Z","level":"info","event":"📋 [2025-06-05 17:10:57] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.404140Z","level":"info","event":"📋 2025-06-05 17:10:57,401 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.404191Z","level":"info","event":"📋 [2025-06-05 17:10:57] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.404228Z","level":"info","event":"📋 2025-06-05 17:10:57,401 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.404270Z","level":"info","event":"📋 [2025-06-05 17:10:57] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.404316Z","level":"info","event":"📋 2025-06-05 17:10:57,401 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.404372Z","level":"info","event":"📋 [2025-06-05 17:10:57]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.404415Z","level":"info","event":"📋 2025-06-05 17:10:57,401 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.404450Z","level":"info","event":"📋 [2025-06-05 17:10:57]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.404485Z","level":"info","event":"📋 2025-06-05 17:10:57,401 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.404519Z","level":"info","event":"📋 [2025-06-05 17:10:57]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.404553Z","level":"info","event":"📋 2025-06-05 17:10:57,401 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.404587Z","level":"info","event":"📋 [2025-06-05 17:10:57]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.404650Z","level":"info","event":"📋 2025-06-05 17:10:57,401 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.404691Z","level":"info","event":"📋 [2025-06-05 17:10:57]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.404726Z","level":"info","event":"📋 2025-06-05 17:10:57,402 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.404765Z","level":"info","event":"📋 [2025-06-05 17:10:57] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.404799Z","level":"info","event":"📋 2025-06-05 17:10:57,402 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.406132Z","level":"info","event":"📋 [2025-06-05 17:10:57] ✅ Ficheiro CSV válido com 9 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.406616Z","level":"info","event":"📋 2025-06-05 17:10:57,406 - INFO - ✅ Ficheiro CSV válido com 9 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.406818Z","level":"info","event":"📋 [2025-06-05 17:10:57] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.407467Z","level":"info","event":"📋 2025-06-05 17:10:57,406 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.407524Z","level":"info","event":"📋 [2025-06-05 17:10:57] 📅 Filtrado para artigos dos últimos 1 dias: 9 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.407573Z","level":"info","event":"📋 2025-06-05 17:10:57,406 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 9 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.407613Z","level":"info","event":"📋 [2025-06-05 17:10:57] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.407649Z","level":"info","event":"📋 2025-06-05 17:10:57,406 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.407688Z","level":"info","event":"📋 [2025-06-05 17:10:57] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.407723Z","level":"info","event":"📋 2025-06-05 17:10:57,406 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.407758Z","level":"info","event":"📋 [2025-06-05 17:10:57] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.407796Z","level":"info","event":"📋 2025-06-05 17:10:57,406 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.407833Z","level":"info","event":"📋 [2025-06-05 17:10:57]   Total de Artigos para Processar: 9","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.407869Z","level":"info","event":"📋 2025-06-05 17:10:57,406 - INFO -   Total de Artigos para Processar: 9","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.407903Z","level":"info","event":"📋 [2025-06-05 17:10:57]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.407949Z","level":"info","event":"📋 2025-06-05 17:10:57,406 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.407991Z","level":"info","event":"📋 [2025-06-05 17:10:57]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.408051Z","level":"info","event":"📋 2025-06-05 17:10:57,406 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.408099Z","level":"info","event":"📋 [2025-06-05 17:10:57]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.408141Z","level":"info","event":"📋 2025-06-05 17:10:57,406 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.408175Z","level":"info","event":"📋 [2025-06-05 17:10:57]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.408209Z","level":"info","event":"📋 2025-06-05 17:10:57,406 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.409165Z","level":"info","event":"📋 [2025-06-05 17:10:57] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.409222Z","level":"info","event":"📋 2025-06-05 17:10:57,406 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.409286Z","level":"info","event":"📋 [2025-06-05 17:10:57] ⏩ A retomar do índice 6 após o ID: b59bd9d0ea2b18028c3c5a5ac6609947","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.409324Z","level":"info","event":"📋 2025-06-05 17:10:57,408 - INFO - ⏩ A retomar do índice 6 após o ID: b59bd9d0ea2b18028c3c5a5ac6609947","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.410065Z","level":"info","event":"📋 [2025-06-05 17:10:57] 📦 A processar lote 1/1 (3 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:10:57.412270Z","level":"info","event":"📋 2025-06-05 17:10:57,410 - INFO - 📦 A processar lote 1/1 (3 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:00.185341Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:00.196726Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:00.205928Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:06.338903Z","level":"info","event":"📋 [2025-06-05 17:11:06] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Portugal começa com um dos melhores jogadores da Champions no banco - TVI","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:06.340619Z","level":"info","event":"📋 2025-06-05 17:11:06,337 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Portugal começa com um dos melhores jogadores da Champions no banco - TVI","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:06.347437Z","level":"info","event":"📋 [2025-06-05 17:11:06] 🔄 Processado: Liga das Nações: Portugal começa com um dos melhor...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:06.347666Z","level":"info","event":"📋 2025-06-05 17:11:06,347 - INFO - 🔄 Processado: Liga das Nações: Portugal começa com um dos melhor...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:06.558503Z","level":"info","event":"📋 [2025-06-05 17:11:06] ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:06.558767Z","level":"info","event":"📋 2025-06-05 17:11:06,558 - WARNING - ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.346596Z","level":"info","event":"📋 [2025-06-05 17:11:07] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Alemanha 1-2 Portugal - CNN Portugal","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.346862Z","level":"info","event":"📋 2025-06-05 17:11:07,346 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Alemanha 1-2 Portugal - CNN Portugal","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.347659Z","level":"info","event":"📋 [2025-06-05 17:11:07] 🔄 Processado: Liga das Nações: Alemanha 1-2 Portugal - CNN Portu...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.347823Z","level":"info","event":"📋 2025-06-05 17:11:07,347 - INFO - 🔄 Processado: Liga das Nações: Alemanha 1-2 Portugal - CNN Portu...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.348181Z","level":"info","event":"📋 📥 Novos artigos recebidos: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.349283Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.349715Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.349928Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.350858Z","level":"info","event":"📋 💾 Guardados 2 artigos no arquivo /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.351142Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.351209Z","level":"info","event":"📋 📥 Novos artigos recebidos: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.351380Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.351862Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.351982Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.352213Z","level":"info","event":"📋 💾 Guardados 2 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.352670Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.353053Z","level":"info","event":"📋 [2025-06-05 17:11:07] ✅ Relevant articles saved: 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.353155Z","level":"info","event":"📋 2025-06-05 17:11:07,352 - INFO - ✅ Relevant articles saved: 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.353513Z","level":"info","event":"📋 [2025-06-05 17:11:07] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.353616Z","level":"info","event":"📋 2025-06-05 17:11:07,353 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.353706Z","level":"info","event":"📋 [2025-06-05 17:11:07] ✅ Lote 1 concluído: 2 artigos (total: 2)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:07.353762Z","level":"info","event":"📋 2025-06-05 17:11:07,353 - INFO - ✅ Lote 1 concluído: 2 artigos (total: 2)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.865423Z","level":"info","event":"📋 📥 Novos artigos recebidos: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.944086Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.945144Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.945240Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.945318Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.945400Z","level":"info","event":"📋 📥 Novos artigos recebidos: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.945481Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.945549Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.945644Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.945706Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.945768Z","level":"info","event":"📋 [2025-06-05 17:11:11] ✅ Relevant articles saved: 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.945845Z","level":"info","event":"📋 2025-06-05 17:11:11,875 - INFO - ✅ Relevant articles saved: 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.945907Z","level":"info","event":"📋 [2025-06-05 17:11:11] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.946004Z","level":"info","event":"📋 2025-06-05 17:11:11,882 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.946067Z","level":"info","event":"📋 [2025-06-05 17:11:11] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.946150Z","level":"info","event":"📋 2025-06-05 17:11:11,882 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.946222Z","level":"info","event":"📋 [2025-06-05 17:11:11] Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.946285Z","level":"info","event":"📋 2025-06-05 17:11:11,882 - INFO - Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.946341Z","level":"info","event":"📋 [2025-06-05 17:11:11] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.946412Z","level":"info","event":"📋 2025-06-05 17:11:11,882 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.949138Z","level":"info","event":"📋 [2025-06-05 17:11:11]   Total de Artigos Processados: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.949204Z","level":"info","event":"📋 2025-06-05 17:11:11,882 - INFO -   Total de Artigos Processados: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.949320Z","level":"info","event":"📋 [2025-06-05 17:11:11]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.949593Z","level":"info","event":"📋 2025-06-05 17:11:11,883 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.950516Z","level":"info","event":"📋 [2025-06-05 17:11:11]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.950570Z","level":"info","event":"📋 2025-06-05 17:11:11,883 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.950660Z","level":"info","event":"📋 [2025-06-05 17:11:11]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.950750Z","level":"info","event":"📋 2025-06-05 17:11:11,883 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.950848Z","level":"info","event":"📋 [2025-06-05 17:11:11]   Taxa de Sucesso: 22.2%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.950923Z","level":"info","event":"📋 2025-06-05 17:11:11,883 - INFO -   Taxa de Sucesso: 22.2%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.951071Z","level":"info","event":"📋 [2025-06-05 17:11:11] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.951158Z","level":"info","event":"📋 2025-06-05 17:11:11,883 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.951230Z","level":"info","event":"📋 [2025-06-05 17:11:11] ✅ Processing completed. Processed 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:11.951304Z","level":"info","event":"📋 2025-06-05 17:11:11,896 - INFO - ✅ Processing completed. Processed 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:12.100951Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:12.101140Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:12.101285Z","level":"info","event":"✅ relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (1335 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:12.952110Z","level":"info","event":"📊 Number of processed articles: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:12.952303Z","level":"info","event":"📊 Columns: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:12.953354Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:12.955136Z","level":"info","event":"⚠️ processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:12.955205Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:12.952784","level":"info","event":"Done. Returned value was: [2025-06-05 17:10:57] Starting processar_relevantes_airflow\n2025-06-05 17:10:57,389 - INFO - Starting processar_relevantes_airflow\n[2025-06-05 17:10:57] Parameters: dias=1, date=2025-06-05\n2025-06-05 17:10:57,389 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 17:10:57] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n2025-06-05 17:10:57,389 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n[2025-06-05 17:10:57] 🚀 A iniciar processar_relevantes_airflow\n2025-06-05 17:10:57,389 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-05 17:10:57] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 17:10:57,389 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 17:10:57] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 17:10:57,390 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 17:10:57] 🔧 A carregar ficheiros de configuração...\n2025-06-05 17:10:57,390 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-05 17:10:57] 🔍 Checking config path: /opt/airflow/config\n2025-06-05 17:10:57,390 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-05 17:10:57] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-05 17:10:57,390 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-05 17:10:57] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-05 17:10:57,390 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-05 17:10:57] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-05 17:10:57,390 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-05 17:10:57] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-05 17:10:57,390 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-05 17:10:57] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-05 17:10:57,392 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-05 17:10:57] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-05 17:10:57,392 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-05 17:10:57] ✅ Loaded 6 keywords\n2025-06-05 17:10:57,393 - INFO - ✅ Loaded 6 keywords\n[2025-06-05 17:10:57] ✅ Loaded 3614 DICOFREG codes\n2025-06-05 17:10:57,401 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-05 17:10:57] ==================================================\n2025-06-05 17:10:57,401 - INFO - ==================================================\n[2025-06-05 17:10:57] Configuration Loaded\n2025-06-05 17:10:57,401 - INFO - Configuration Loaded\n[2025-06-05 17:10:57] ==================================================\n2025-06-05 17:10:57,401 - INFO - ==================================================\n[2025-06-05 17:10:57]   Parishes: 306\n2025-06-05 17:10:57,401 - INFO -   Parishes: 306\n[2025-06-05 17:10:57]   Municipalities: 306\n2025-06-05 17:10:57,401 - INFO -   Municipalities: 306\n[2025-06-05 17:10:57]   Districts: 29\n2025-06-05 17:10:57,401 - INFO -   Districts: 29\n[2025-06-05 17:10:57]   Keywords: 6\n2025-06-05 17:10:57,401 - INFO -   Keywords: 6\n[2025-06-05 17:10:57]   DICOFREG Codes: 3614\n2025-06-05 17:10:57,402 - INFO -   DICOFREG Codes: 3614\n[2025-06-05 17:10:57] ==================================================\n2025-06-05 17:10:57,402 - INFO - ==================================================\n[2025-06-05 17:10:57] ✅ Ficheiro CSV válido com 9 artigos\n2025-06-05 17:10:57,406 - INFO - ✅ Ficheiro CSV válido com 9 artigos\n[2025-06-05 17:10:57] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-05 17:10:57,406 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-05 17:10:57] 📅 Filtrado para artigos dos últimos 1 dias: 9 artigos\n2025-06-05 17:10:57,406 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 9 artigos\n[2025-06-05 17:10:57] ==================================================\n2025-06-05 17:10:57,406 - INFO - ==================================================\n[2025-06-05 17:10:57] Processamento Iniciado\n2025-06-05 17:10:57,406 - INFO - Processamento Iniciado\n[2025-06-05 17:10:57] ==================================================\n2025-06-05 17:10:57,406 - INFO - ==================================================\n[2025-06-05 17:10:57]   Total de Artigos para Processar: 9\n2025-06-05 17:10:57,406 - INFO -   Total de Artigos para Processar: 9\n[2025-06-05 17:10:57]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 17:10:57,406 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 17:10:57]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 17:10:57,406 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 17:10:57]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 17:10:57,406 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 17:10:57]   Filtro de Dias: 1\n2025-06-05 17:10:57,406 - INFO -   Filtro de Dias: 1\n[2025-06-05 17:10:57] ==================================================\n2025-06-05 17:10:57,406 - INFO - ==================================================\n[2025-06-05 17:10:57] ⏩ A retomar do índice 6 após o ID: b59bd9d0ea2b18028c3c5a5ac6609947\n2025-06-05 17:10:57,408 - INFO - ⏩ A retomar do índice 6 após o ID: b59bd9d0ea2b18028c3c5a5ac6609947\n[2025-06-05 17:10:57] 📦 A processar lote 1/1 (3 artigos)\n2025-06-05 17:10:57,410 - INFO - 📦 A processar lote 1/1 (3 artigos)\n[2025-06-05 17:11:06] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Portugal começa com um dos melhores jogadores da Champions no banco - TVI\n2025-06-05 17:11:06,337 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Portugal começa com um dos melhores jogadores da Champions no banco - TVI\n[2025-06-05 17:11:06] 🔄 Processado: Liga das Nações: Portugal começa com um dos melhor...\n2025-06-05 17:11:06,347 - INFO - 🔄 Processado: Liga das Nações: Portugal começa com um dos melhor...\n[2025-06-05 17:11:06] ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho\n2025-06-05 17:11:06,558 - WARNING - ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho\n[2025-06-05 17:11:07] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Alemanha 1-2 Portugal - CNN Portugal\n2025-06-05 17:11:07,346 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Alemanha 1-2 Portugal - CNN Portugal\n[2025-06-05 17:11:07] 🔄 Processado: Liga das Nações: Alemanha 1-2 Portugal - CNN Portu...\n2025-06-05 17:11:07,347 - INFO - 🔄 Processado: Liga das Nações: Alemanha 1-2 Portugal - CNN Portu...\n📥 Novos artigos recebidos: 2\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 2\n🆕 Artigos únicos para salvar: 2\n💾 Guardados 2 artigos no arquivo /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📥 Novos artigos recebidos: 2\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 2\n🆕 Artigos únicos para salvar: 2\n💾 Guardados 2 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 17:11:07] ✅ Relevant articles saved: 2 articles\n2025-06-05 17:11:07,352 - INFO - ✅ Relevant articles saved: 2 articles\n[2025-06-05 17:11:07] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n2025-06-05 17:11:07,353 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n[2025-06-05 17:11:07] ✅ Lote 1 concluído: 2 artigos (total: 2)\n2025-06-05 17:11:07,353 - INFO - ✅ Lote 1 concluído: 2 artigos (total: 2)\n📥 Novos artigos recebidos: 2\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 4\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 2\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 4\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-05 17:11:11] ✅ Relevant articles saved: 2 articles\n2025-06-05 17:11:11,875 - INFO - ✅ Relevant articles saved: 2 articles\n[2025-06-05 17:11:11] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n2025-06-05 17:11:11,882 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n[2025-06-05 17:11:11] ==================================================\n2025-06-05 17:11:11,882 - INFO - ==================================================\n[2025-06-05 17:11:11] Processamento Concluído com Sucesso\n2025-06-05 17:11:11,882 - INFO - Processamento Concluído com Sucesso\n[2025-06-05 17:11:11] ==================================================\n2025-06-05 17:11:11,882 - INFO - ==================================================\n[2025-06-05 17:11:11]   Total de Artigos Processados: 2\n2025-06-05 17:11:11,882 - INFO -   Total de Artigos Processados: 2\n[2025-06-05 17:11:11]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 17:11:11,883 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 17:11:11]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 17:11:11,883 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 17:11:11]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n2025-06-05 17:11:11,883 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n[2025-06-05 17:11:11]   Taxa de Sucesso: 22.2%\n2025-06-05 17:11:11,883 - INFO -   Taxa de Sucesso: 22.2%\n[2025-06-05 17:11:11] ==================================================\n2025-06-05 17:11:11,883 - INFO - ==================================================\n[2025-06-05 17:11:11] ✅ Processing completed. Processed 2 articles\n2025-06-05 17:11:11,896 - INFO - ✅ Processing completed. Processed 2 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
