{"timestamp":"2025-06-05T17:15:08.922592","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T17:15:08.922922","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T17:15:08.962122Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:08.962321Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:08.964662Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:08.965187Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:08.965597Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:08.965692Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:08.965768Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:08.965990Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:08.966114Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:08.966177Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:08.966236Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:08.966299Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:08.966360Z","level":"info","event":"  - relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:08.966440Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:08.966508Z","level":"info","event":"  - processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:08.966575Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:08.966639Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv --output_dir /opt/airflow/scripts/google_scraper/data/structured/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:08.966727Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.195346Z","level":"info","event":"📋 [2025-06-05 18:15:10] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.195647Z","level":"info","event":"📋 2025-06-05 18:15:10,195 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.195957Z","level":"info","event":"📋 [2025-06-05 18:15:10] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.197172Z","level":"info","event":"📋 2025-06-05 18:15:10,195 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.197348Z","level":"info","event":"📋 [2025-06-05 18:15:10] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.197400Z","level":"info","event":"📋 2025-06-05 18:15:10,195 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.197509Z","level":"info","event":"📋 [2025-06-05 18:15:10] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.197582Z","level":"info","event":"📋 2025-06-05 18:15:10,195 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.198100Z","level":"info","event":"📋 [2025-06-05 18:15:10] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.198146Z","level":"info","event":"📋 2025-06-05 18:15:10,195 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.198449Z","level":"info","event":"📋 [2025-06-05 18:15:10] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.198520Z","level":"info","event":"📋 2025-06-05 18:15:10,195 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.198628Z","level":"info","event":"📋 [2025-06-05 18:15:10] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.198732Z","level":"info","event":"📋 2025-06-05 18:15:10,195 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.199095Z","level":"info","event":"📋 [2025-06-05 18:15:10] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.199150Z","level":"info","event":"📋 2025-06-05 18:15:10,195 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.200619Z","level":"info","event":"📋 [2025-06-05 18:15:10] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.201477Z","level":"info","event":"📋 2025-06-05 18:15:10,197 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.203392Z","level":"info","event":"📋 [2025-06-05 18:15:10] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.204476Z","level":"info","event":"📋 2025-06-05 18:15:10,197 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.204888Z","level":"info","event":"📋 [2025-06-05 18:15:10] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.205002Z","level":"info","event":"📋 2025-06-05 18:15:10,197 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.205111Z","level":"info","event":"📋 [2025-06-05 18:15:10] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.205170Z","level":"info","event":"📋 2025-06-05 18:15:10,197 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.205207Z","level":"info","event":"📋 [2025-06-05 18:15:10] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.205453Z","level":"info","event":"📋 2025-06-05 18:15:10,198 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.205583Z","level":"info","event":"📋 [2025-06-05 18:15:10] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.205633Z","level":"info","event":"📋 2025-06-05 18:15:10,198 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.205669Z","level":"info","event":"📋 [2025-06-05 18:15:10] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.205705Z","level":"info","event":"📋 2025-06-05 18:15:10,198 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.206486Z","level":"info","event":"📋 [2025-06-05 18:15:10] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.206637Z","level":"info","event":"📋 2025-06-05 18:15:10,204 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.206689Z","level":"info","event":"📋 [2025-06-05 18:15:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.206728Z","level":"info","event":"📋 2025-06-05 18:15:10,204 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.207110Z","level":"info","event":"📋 [2025-06-05 18:15:10] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.207202Z","level":"info","event":"📋 2025-06-05 18:15:10,204 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.207238Z","level":"info","event":"📋 [2025-06-05 18:15:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.207271Z","level":"info","event":"📋 2025-06-05 18:15:10,204 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.207654Z","level":"info","event":"📋 [2025-06-05 18:15:10]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.207713Z","level":"info","event":"📋 2025-06-05 18:15:10,204 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.207762Z","level":"info","event":"📋 [2025-06-05 18:15:10]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.207810Z","level":"info","event":"📋 2025-06-05 18:15:10,204 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.207860Z","level":"info","event":"📋 [2025-06-05 18:15:10]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.207905Z","level":"info","event":"📋 2025-06-05 18:15:10,204 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.207991Z","level":"info","event":"📋 [2025-06-05 18:15:10]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.208038Z","level":"info","event":"📋 2025-06-05 18:15:10,204 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.208091Z","level":"info","event":"📋 [2025-06-05 18:15:10]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.208139Z","level":"info","event":"📋 2025-06-05 18:15:10,204 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.208185Z","level":"info","event":"📋 [2025-06-05 18:15:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.208631Z","level":"info","event":"📋 2025-06-05 18:15:10,205 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.208718Z","level":"info","event":"📋 [2025-06-05 18:15:10] ✅ Ficheiro CSV válido com 6 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.208766Z","level":"info","event":"📋 2025-06-05 18:15:10,207 - INFO - ✅ Ficheiro CSV válido com 6 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.208817Z","level":"info","event":"📋 [2025-06-05 18:15:10] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.208865Z","level":"info","event":"📋 2025-06-05 18:15:10,208 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.208918Z","level":"info","event":"📋 [2025-06-05 18:15:10] 📅 Filtrado para artigos dos últimos 1 dias: 6 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.209469Z","level":"info","event":"📋 2025-06-05 18:15:10,208 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 6 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.209530Z","level":"info","event":"📋 [2025-06-05 18:15:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.209577Z","level":"info","event":"📋 2025-06-05 18:15:10,208 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.209623Z","level":"info","event":"📋 [2025-06-05 18:15:10] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.209670Z","level":"info","event":"📋 2025-06-05 18:15:10,208 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.209716Z","level":"info","event":"📋 [2025-06-05 18:15:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.209763Z","level":"info","event":"📋 2025-06-05 18:15:10,208 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.209809Z","level":"info","event":"📋 [2025-06-05 18:15:10]   Total de Artigos para Processar: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.209854Z","level":"info","event":"📋 2025-06-05 18:15:10,208 - INFO -   Total de Artigos para Processar: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.209901Z","level":"info","event":"📋 [2025-06-05 18:15:10]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.209952Z","level":"info","event":"📋 2025-06-05 18:15:10,208 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.210035Z","level":"info","event":"📋 [2025-06-05 18:15:10]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.210082Z","level":"info","event":"📋 2025-06-05 18:15:10,208 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.210129Z","level":"info","event":"📋 [2025-06-05 18:15:10]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.210175Z","level":"info","event":"📋 2025-06-05 18:15:10,208 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.210221Z","level":"info","event":"📋 [2025-06-05 18:15:10]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.210267Z","level":"info","event":"📋 2025-06-05 18:15:10,208 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.210313Z","level":"info","event":"📋 [2025-06-05 18:15:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.210744Z","level":"info","event":"📋 2025-06-05 18:15:10,208 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.210826Z","level":"info","event":"📋 [2025-06-05 18:15:10] ⏩ A retomar do índice 4 após o ID: 6df4e1edab7c3f38b5c3d13d41396b0b","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.210873Z","level":"info","event":"📋 2025-06-05 18:15:10,210 - INFO - ⏩ A retomar do índice 4 após o ID: 6df4e1edab7c3f38b5c3d13d41396b0b","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.211642Z","level":"info","event":"📋 [2025-06-05 18:15:10] 📦 A processar lote 1/1 (2 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:10.214363Z","level":"info","event":"📋 2025-06-05 18:15:10,211 - INFO - 📦 A processar lote 1/1 (2 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:12.121182Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:12.197020Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:15.882244Z","level":"info","event":"📋 [2025-06-05 18:15:15] ⚠️ Artigo ignorado após extração: Beja Inaugura Agência do Banco de Tempo - Rádio Pax","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:15.884468Z","level":"info","event":"📋 2025-06-05 18:15:15,878 - WARNING - ⚠️ Artigo ignorado após extração: Beja Inaugura Agência do Banco de Tempo - Rádio Pax","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:16.414823Z","level":"info","event":"📋 [2025-06-05 18:15:16] ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:16.415454Z","level":"info","event":"📋 2025-06-05 18:15:16,414 - WARNING - ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:16.415935Z","level":"info","event":"📋 [2025-06-05 18:15:16] ⚠️ Nenhum artigo foi processado com sucesso.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:16.416113Z","level":"info","event":"📋 2025-06-05 18:15:16,415 - WARNING - ⚠️ Nenhum artigo foi processado com sucesso.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:16.417814Z","level":"info","event":"📋 [2025-06-05 18:15:16] ✅ Processing completed. Processed 0 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:16.418176Z","level":"info","event":"📋 2025-06-05 18:15:16,417 - INFO - ✅ Processing completed. Processed 0 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:16.595546Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:16.596761Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:16.597551Z","level":"info","event":"✅ relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (916 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:17.370058Z","level":"info","event":"📊 Number of processed articles: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:17.370210Z","level":"info","event":"📊 Columns: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:17.370350Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:17.371150Z","level":"info","event":"⚠️ processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:17.371269Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:17.370677","level":"info","event":"Done. Returned value was: [2025-06-05 18:15:10] Starting processar_relevantes_airflow\n2025-06-05 18:15:10,195 - INFO - Starting processar_relevantes_airflow\n[2025-06-05 18:15:10] Parameters: dias=1, date=2025-06-05\n2025-06-05 18:15:10,195 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 18:15:10] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n2025-06-05 18:15:10,195 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n[2025-06-05 18:15:10] 🚀 A iniciar processar_relevantes_airflow\n2025-06-05 18:15:10,195 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-05 18:15:10] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 18:15:10,195 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 18:15:10] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 18:15:10,195 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 18:15:10] 🔧 A carregar ficheiros de configuração...\n2025-06-05 18:15:10,195 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-05 18:15:10] 🔍 Checking config path: /opt/airflow/config\n2025-06-05 18:15:10,195 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-05 18:15:10] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-05 18:15:10,197 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-05 18:15:10] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-05 18:15:10,197 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-05 18:15:10] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-05 18:15:10,197 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-05 18:15:10] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-05 18:15:10,197 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-05 18:15:10] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-05 18:15:10,198 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-05 18:15:10] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-05 18:15:10,198 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-05 18:15:10] ✅ Loaded 6 keywords\n2025-06-05 18:15:10,198 - INFO - ✅ Loaded 6 keywords\n[2025-06-05 18:15:10] ✅ Loaded 3614 DICOFREG codes\n2025-06-05 18:15:10,204 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-05 18:15:10] ==================================================\n2025-06-05 18:15:10,204 - INFO - ==================================================\n[2025-06-05 18:15:10] Configuration Loaded\n2025-06-05 18:15:10,204 - INFO - Configuration Loaded\n[2025-06-05 18:15:10] ==================================================\n2025-06-05 18:15:10,204 - INFO - ==================================================\n[2025-06-05 18:15:10]   Parishes: 306\n2025-06-05 18:15:10,204 - INFO -   Parishes: 306\n[2025-06-05 18:15:10]   Municipalities: 306\n2025-06-05 18:15:10,204 - INFO -   Municipalities: 306\n[2025-06-05 18:15:10]   Districts: 29\n2025-06-05 18:15:10,204 - INFO -   Districts: 29\n[2025-06-05 18:15:10]   Keywords: 6\n2025-06-05 18:15:10,204 - INFO -   Keywords: 6\n[2025-06-05 18:15:10]   DICOFREG Codes: 3614\n2025-06-05 18:15:10,204 - INFO -   DICOFREG Codes: 3614\n[2025-06-05 18:15:10] ==================================================\n2025-06-05 18:15:10,205 - INFO - ==================================================\n[2025-06-05 18:15:10] ✅ Ficheiro CSV válido com 6 artigos\n2025-06-05 18:15:10,207 - INFO - ✅ Ficheiro CSV válido com 6 artigos\n[2025-06-05 18:15:10] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-05 18:15:10,208 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-05 18:15:10] 📅 Filtrado para artigos dos últimos 1 dias: 6 artigos\n2025-06-05 18:15:10,208 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 6 artigos\n[2025-06-05 18:15:10] ==================================================\n2025-06-05 18:15:10,208 - INFO - ==================================================\n[2025-06-05 18:15:10] Processamento Iniciado\n2025-06-05 18:15:10,208 - INFO - Processamento Iniciado\n[2025-06-05 18:15:10] ==================================================\n2025-06-05 18:15:10,208 - INFO - ==================================================\n[2025-06-05 18:15:10]   Total de Artigos para Processar: 6\n2025-06-05 18:15:10,208 - INFO -   Total de Artigos para Processar: 6\n[2025-06-05 18:15:10]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 18:15:10,208 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 18:15:10]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:15:10,208 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:15:10]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 18:15:10,208 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 18:15:10]   Filtro de Dias: 1\n2025-06-05 18:15:10,208 - INFO -   Filtro de Dias: 1\n[2025-06-05 18:15:10] ==================================================\n2025-06-05 18:15:10,208 - INFO - ==================================================\n[2025-06-05 18:15:10] ⏩ A retomar do índice 4 após o ID: 6df4e1edab7c3f38b5c3d13d41396b0b\n2025-06-05 18:15:10,210 - INFO - ⏩ A retomar do índice 4 após o ID: 6df4e1edab7c3f38b5c3d13d41396b0b\n[2025-06-05 18:15:10] 📦 A processar lote 1/1 (2 artigos)\n2025-06-05 18:15:10,211 - INFO - 📦 A processar lote 1/1 (2 artigos)\n[2025-06-05 18:15:15] ⚠️ Artigo ignorado após extração: Beja Inaugura Agência do Banco de Tempo - Rádio Pax\n2025-06-05 18:15:15,878 - WARNING - ⚠️ Artigo ignorado após extração: Beja Inaugura Agência do Banco de Tempo - Rádio Pax\n[2025-06-05 18:15:16] ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho\n2025-06-05 18:15:16,414 - WARNING - ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho\n[2025-06-05 18:15:16] ⚠️ Nenhum artigo foi processado com sucesso.\n2025-06-05 18:15:16,415 - WARNING - ⚠️ Nenhum artigo foi processado com sucesso.\n[2025-06-05 18:15:16] ✅ Processing completed. Processed 0 articles\n2025-06-05 18:15:16,417 - INFO - ✅ Processing completed. Processed 0 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
