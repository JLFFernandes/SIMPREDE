{"timestamp":"2025-06-05T20:07:37.378407","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T20:07:37.378738","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T20:07:37.460070Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:37.462681Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:37.463628Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:37.468272Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:37.468883Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:37.469236Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:37.470033Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:37.471647Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:37.472067Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:37.473128Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:37.473457Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:37.473790Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:37.474010Z","level":"info","event":"  - relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:37.474228Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:37.474351Z","level":"info","event":"  - processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:37.474577Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:37.474668Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv --output_dir /opt/airflow/scripts/google_scraper/data/structured/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:37.474794Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.959260Z","level":"info","event":"📋 [2025-06-05 21:07:38] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.959571Z","level":"info","event":"📋 2025-06-05 21:07:38,958 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.959933Z","level":"info","event":"📋 [2025-06-05 21:07:38] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.960151Z","level":"info","event":"📋 2025-06-05 21:07:38,958 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.960229Z","level":"info","event":"📋 [2025-06-05 21:07:38] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.960371Z","level":"info","event":"📋 2025-06-05 21:07:38,958 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.960472Z","level":"info","event":"📋 [2025-06-05 21:07:38] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.961063Z","level":"info","event":"📋 2025-06-05 21:07:38,958 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.961120Z","level":"info","event":"📋 [2025-06-05 21:07:38] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.961168Z","level":"info","event":"📋 2025-06-05 21:07:38,959 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.961299Z","level":"info","event":"📋 [2025-06-05 21:07:38] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.961350Z","level":"info","event":"📋 2025-06-05 21:07:38,959 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.961388Z","level":"info","event":"📋 [2025-06-05 21:07:38] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.961429Z","level":"info","event":"📋 2025-06-05 21:07:38,959 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.961474Z","level":"info","event":"📋 [2025-06-05 21:07:38] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.961522Z","level":"info","event":"📋 2025-06-05 21:07:38,959 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.961560Z","level":"info","event":"📋 [2025-06-05 21:07:38] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.961865Z","level":"info","event":"📋 2025-06-05 21:07:38,960 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.961928Z","level":"info","event":"📋 [2025-06-05 21:07:38] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.961976Z","level":"info","event":"📋 2025-06-05 21:07:38,960 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.962022Z","level":"info","event":"📋 [2025-06-05 21:07:38] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.962133Z","level":"info","event":"📋 2025-06-05 21:07:38,960 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.962212Z","level":"info","event":"📋 [2025-06-05 21:07:38] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.962313Z","level":"info","event":"📋 2025-06-05 21:07:38,960 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.962518Z","level":"info","event":"📋 [2025-06-05 21:07:38] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.963565Z","level":"info","event":"📋 2025-06-05 21:07:38,961 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.965541Z","level":"info","event":"📋 [2025-06-05 21:07:38] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.967664Z","level":"info","event":"📋 2025-06-05 21:07:38,961 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.968086Z","level":"info","event":"📋 [2025-06-05 21:07:38] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.968152Z","level":"info","event":"📋 2025-06-05 21:07:38,962 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.971692Z","level":"info","event":"📋 [2025-06-05 21:07:38] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.971899Z","level":"info","event":"📋 2025-06-05 21:07:38,971 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.972637Z","level":"info","event":"📋 [2025-06-05 21:07:38] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.972863Z","level":"info","event":"📋 2025-06-05 21:07:38,971 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.973165Z","level":"info","event":"📋 [2025-06-05 21:07:38] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.973228Z","level":"info","event":"📋 2025-06-05 21:07:38,972 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.973277Z","level":"info","event":"📋 [2025-06-05 21:07:38] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.973329Z","level":"info","event":"📋 2025-06-05 21:07:38,972 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.973384Z","level":"info","event":"📋 [2025-06-05 21:07:38]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.973437Z","level":"info","event":"📋 2025-06-05 21:07:38,972 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.973488Z","level":"info","event":"📋 [2025-06-05 21:07:38]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.974851Z","level":"info","event":"📋 2025-06-05 21:07:38,972 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.974941Z","level":"info","event":"📋 [2025-06-05 21:07:38]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.974991Z","level":"info","event":"📋 2025-06-05 21:07:38,972 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.975084Z","level":"info","event":"📋 [2025-06-05 21:07:38]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.975137Z","level":"info","event":"📋 2025-06-05 21:07:38,972 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.975196Z","level":"info","event":"📋 [2025-06-05 21:07:38]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.975247Z","level":"info","event":"📋 2025-06-05 21:07:38,972 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.975306Z","level":"info","event":"📋 [2025-06-05 21:07:38] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.975361Z","level":"info","event":"📋 2025-06-05 21:07:38,972 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.976763Z","level":"info","event":"📋 [2025-06-05 21:07:38] ✅ Ficheiro CSV válido com 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.977339Z","level":"info","event":"📋 2025-06-05 21:07:38,976 - INFO - ✅ Ficheiro CSV válido com 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.977518Z","level":"info","event":"📋 [2025-06-05 21:07:38] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.978305Z","level":"info","event":"📋 2025-06-05 21:07:38,976 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.978396Z","level":"info","event":"📋 [2025-06-05 21:07:38] 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.978445Z","level":"info","event":"📋 2025-06-05 21:07:38,977 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.978489Z","level":"info","event":"📋 [2025-06-05 21:07:38] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.978537Z","level":"info","event":"📋 2025-06-05 21:07:38,977 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.978589Z","level":"info","event":"📋 [2025-06-05 21:07:38] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.978637Z","level":"info","event":"📋 2025-06-05 21:07:38,977 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.978681Z","level":"info","event":"📋 [2025-06-05 21:07:38] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.978724Z","level":"info","event":"📋 2025-06-05 21:07:38,977 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.978767Z","level":"info","event":"📋 [2025-06-05 21:07:38]   Total de Artigos para Processar: 12","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.978807Z","level":"info","event":"📋 2025-06-05 21:07:38,977 - INFO -   Total de Artigos para Processar: 12","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.978856Z","level":"info","event":"📋 [2025-06-05 21:07:38]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.978911Z","level":"info","event":"📋 2025-06-05 21:07:38,977 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.979000Z","level":"info","event":"📋 [2025-06-05 21:07:38]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.979050Z","level":"info","event":"📋 2025-06-05 21:07:38,977 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.979108Z","level":"info","event":"📋 [2025-06-05 21:07:38]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.979164Z","level":"info","event":"📋 2025-06-05 21:07:38,977 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.979214Z","level":"info","event":"📋 [2025-06-05 21:07:38]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.979265Z","level":"info","event":"📋 2025-06-05 21:07:38,977 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.979314Z","level":"info","event":"📋 [2025-06-05 21:07:38] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.979365Z","level":"info","event":"📋 2025-06-05 21:07:38,977 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.979875Z","level":"info","event":"📋 [2025-06-05 21:07:38] ⏩ A retomar do índice 12 após o ID: 1e795af93eb00e95e13b9722432e619a","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.979946Z","level":"info","event":"📋 2025-06-05 21:07:38,979 - INFO - ⏩ A retomar do índice 12 após o ID: 1e795af93eb00e95e13b9722432e619a","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.980812Z","level":"info","event":"📋 [2025-06-05 21:07:38] ⚠️ Nenhum artigo foi processado com sucesso.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.983556Z","level":"info","event":"📋 2025-06-05 21:07:38,980 - WARNING - ⚠️ Nenhum artigo foi processado com sucesso.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.984590Z","level":"info","event":"📋 [2025-06-05 21:07:38] ✅ Processing completed. Processed 0 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:38.985537Z","level":"info","event":"📋 2025-06-05 21:07:38,980 - INFO - ✅ Processing completed. Processed 0 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:39.079337Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:39.079557Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:39.079703Z","level":"info","event":"✅ relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (1907 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:39.907565Z","level":"info","event":"📊 Number of processed articles: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:39.907761Z","level":"info","event":"📊 Columns: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:39.908523Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:39.908715Z","level":"info","event":"⚠️ processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:39.908807Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:39.908083","level":"info","event":"Done. Returned value was: [2025-06-05 21:07:38] Starting processar_relevantes_airflow\n2025-06-05 21:07:38,958 - INFO - Starting processar_relevantes_airflow\n[2025-06-05 21:07:38] Parameters: dias=1, date=2025-06-05\n2025-06-05 21:07:38,958 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 21:07:38] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n2025-06-05 21:07:38,958 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n[2025-06-05 21:07:38] 🚀 A iniciar processar_relevantes_airflow\n2025-06-05 21:07:38,958 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-05 21:07:38] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 21:07:38,959 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 21:07:38] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 21:07:38,959 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 21:07:38] 🔧 A carregar ficheiros de configuração...\n2025-06-05 21:07:38,959 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-05 21:07:38] 🔍 Checking config path: /opt/airflow/config\n2025-06-05 21:07:38,959 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-05 21:07:38] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-05 21:07:38,960 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-05 21:07:38] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-05 21:07:38,960 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-05 21:07:38] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-05 21:07:38,960 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-05 21:07:38] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-05 21:07:38,960 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-05 21:07:38] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-05 21:07:38,961 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-05 21:07:38] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-05 21:07:38,961 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-05 21:07:38] ✅ Loaded 6 keywords\n2025-06-05 21:07:38,962 - INFO - ✅ Loaded 6 keywords\n[2025-06-05 21:07:38] ✅ Loaded 3614 DICOFREG codes\n2025-06-05 21:07:38,971 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-05 21:07:38] ==================================================\n2025-06-05 21:07:38,971 - INFO - ==================================================\n[2025-06-05 21:07:38] Configuration Loaded\n2025-06-05 21:07:38,972 - INFO - Configuration Loaded\n[2025-06-05 21:07:38] ==================================================\n2025-06-05 21:07:38,972 - INFO - ==================================================\n[2025-06-05 21:07:38]   Parishes: 306\n2025-06-05 21:07:38,972 - INFO -   Parishes: 306\n[2025-06-05 21:07:38]   Municipalities: 306\n2025-06-05 21:07:38,972 - INFO -   Municipalities: 306\n[2025-06-05 21:07:38]   Districts: 29\n2025-06-05 21:07:38,972 - INFO -   Districts: 29\n[2025-06-05 21:07:38]   Keywords: 6\n2025-06-05 21:07:38,972 - INFO -   Keywords: 6\n[2025-06-05 21:07:38]   DICOFREG Codes: 3614\n2025-06-05 21:07:38,972 - INFO -   DICOFREG Codes: 3614\n[2025-06-05 21:07:38] ==================================================\n2025-06-05 21:07:38,972 - INFO - ==================================================\n[2025-06-05 21:07:38] ✅ Ficheiro CSV válido com 12 artigos\n2025-06-05 21:07:38,976 - INFO - ✅ Ficheiro CSV válido com 12 artigos\n[2025-06-05 21:07:38] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-05 21:07:38,976 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-05 21:07:38] 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos\n2025-06-05 21:07:38,977 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos\n[2025-06-05 21:07:38] ==================================================\n2025-06-05 21:07:38,977 - INFO - ==================================================\n[2025-06-05 21:07:38] Processamento Iniciado\n2025-06-05 21:07:38,977 - INFO - Processamento Iniciado\n[2025-06-05 21:07:38] ==================================================\n2025-06-05 21:07:38,977 - INFO - ==================================================\n[2025-06-05 21:07:38]   Total de Artigos para Processar: 12\n2025-06-05 21:07:38,977 - INFO -   Total de Artigos para Processar: 12\n[2025-06-05 21:07:38]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 21:07:38,977 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 21:07:38]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 21:07:38,977 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 21:07:38]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 21:07:38,977 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 21:07:38]   Filtro de Dias: 1\n2025-06-05 21:07:38,977 - INFO -   Filtro de Dias: 1\n[2025-06-05 21:07:38] ==================================================\n2025-06-05 21:07:38,977 - INFO - ==================================================\n[2025-06-05 21:07:38] ⏩ A retomar do índice 12 após o ID: 1e795af93eb00e95e13b9722432e619a\n2025-06-05 21:07:38,979 - INFO - ⏩ A retomar do índice 12 após o ID: 1e795af93eb00e95e13b9722432e619a\n[2025-06-05 21:07:38] ⚠️ Nenhum artigo foi processado com sucesso.\n2025-06-05 21:07:38,980 - WARNING - ⚠️ Nenhum artigo foi processado com sucesso.\n[2025-06-05 21:07:38] ✅ Processing completed. Processed 0 articles\n2025-06-05 21:07:38,980 - INFO - ✅ Processing completed. Processed 0 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
