{"timestamp":"2025-06-05T15:32:32.124624","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T15:32:32.125448","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T15:32:32.191489Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:32.194319Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:32.195865Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/04', '/opt/airflow/data/structured/2025/06/04', '/opt/airflow/data/processed/2025/06/04']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:32.195992Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:32.197001Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:32.197367Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:32.197486Z","level":"info","event":"  - Target date: 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:32.197572Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:32.198089Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:32.198210Z","level":"info","event":"✅ Found input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:32.198321Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:32.198429Z","level":"info","event":"  - relevant_articles: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:32.198504Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/data/structured/2025/06/04/artigos_irrelevantes_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:32.198579Z","level":"info","event":"  - processing_log: /opt/airflow/data/structured/2025/06/04/processing_log_20250604.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:32.198647Z","level":"info","event":"  - stats_json: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:32.198742Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv --output_dir /opt/airflow/data/structured/2025/06/04 --date_str 2025-06-04 --date 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:32.198842Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.731886Z","level":"info","event":"📋 [2025-06-05 16:32:33] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.732226Z","level":"info","event":"📋 2025-06-05 16:32:33,731 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.732348Z","level":"info","event":"📋 [2025-06-05 16:32:33] Parameters: dias=1, date=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.732495Z","level":"info","event":"📋 2025-06-05 16:32:33,731 - INFO - Parameters: dias=1, date=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.732580Z","level":"info","event":"📋 [2025-06-05 16:32:33] Paths: input_file=/opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv, output_dir=/opt/airflow/data/structured/2025/06/04, date_str=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.732870Z","level":"info","event":"📋 2025-06-05 16:32:33,731 - INFO - Paths: input_file=/opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv, output_dir=/opt/airflow/data/structured/2025/06/04, date_str=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.733622Z","level":"info","event":"📋 [2025-06-05 16:32:33] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.734569Z","level":"info","event":"📋 2025-06-05 16:32:33,731 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.735235Z","level":"info","event":"📋 [2025-06-05 16:32:33] 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.735410Z","level":"info","event":"📋 2025-06-05 16:32:33,731 - INFO - 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.735791Z","level":"info","event":"📋 [2025-06-05 16:32:33] 📁 Using provided input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.735906Z","level":"info","event":"📋 2025-06-05 16:32:33,731 - INFO - 📁 Using provided input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.736047Z","level":"info","event":"📋 [2025-06-05 16:32:33] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.736203Z","level":"info","event":"📋 2025-06-05 16:32:33,731 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.736316Z","level":"info","event":"📋 [2025-06-05 16:32:33] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.737842Z","level":"info","event":"📋 2025-06-05 16:32:33,732 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.740389Z","level":"info","event":"📋 [2025-06-05 16:32:33] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.742330Z","level":"info","event":"📋 2025-06-05 16:32:33,732 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.742680Z","level":"info","event":"📋 [2025-06-05 16:32:33] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.742916Z","level":"info","event":"📋 2025-06-05 16:32:33,732 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.743019Z","level":"info","event":"📋 [2025-06-05 16:32:33] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.743457Z","level":"info","event":"📋 2025-06-05 16:32:33,732 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.743717Z","level":"info","event":"📋 [2025-06-05 16:32:33] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.746047Z","level":"info","event":"📋 2025-06-05 16:32:33,732 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.747320Z","level":"info","event":"📋 [2025-06-05 16:32:33] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.748343Z","level":"info","event":"📋 2025-06-05 16:32:33,735 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.748667Z","level":"info","event":"📋 [2025-06-05 16:32:33] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.748928Z","level":"info","event":"📋 2025-06-05 16:32:33,735 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.749366Z","level":"info","event":"📋 [2025-06-05 16:32:33] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.750110Z","level":"info","event":"📋 2025-06-05 16:32:33,735 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.750190Z","level":"info","event":"📋 [2025-06-05 16:32:33] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.750264Z","level":"info","event":"📋 2025-06-05 16:32:33,745 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.750345Z","level":"info","event":"📋 [2025-06-05 16:32:33] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.750395Z","level":"info","event":"📋 2025-06-05 16:32:33,745 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.750450Z","level":"info","event":"📋 [2025-06-05 16:32:33] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.750510Z","level":"info","event":"📋 2025-06-05 16:32:33,745 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.750578Z","level":"info","event":"📋 [2025-06-05 16:32:33] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.750640Z","level":"info","event":"📋 2025-06-05 16:32:33,745 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.750700Z","level":"info","event":"📋 [2025-06-05 16:32:33]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.750760Z","level":"info","event":"📋 2025-06-05 16:32:33,745 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.750818Z","level":"info","event":"📋 [2025-06-05 16:32:33]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.750877Z","level":"info","event":"📋 2025-06-05 16:32:33,745 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.750935Z","level":"info","event":"📋 [2025-06-05 16:32:33]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.750993Z","level":"info","event":"📋 2025-06-05 16:32:33,745 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.751051Z","level":"info","event":"📋 [2025-06-05 16:32:33]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.751110Z","level":"info","event":"📋 2025-06-05 16:32:33,745 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.751176Z","level":"info","event":"📋 [2025-06-05 16:32:33]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.751295Z","level":"info","event":"📋 2025-06-05 16:32:33,745 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.751416Z","level":"info","event":"📋 [2025-06-05 16:32:33] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.751485Z","level":"info","event":"📋 2025-06-05 16:32:33,745 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.751581Z","level":"info","event":"📋 [2025-06-05 16:32:33] ✅ Ficheiro CSV válido com 13 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.751640Z","level":"info","event":"📋 2025-06-05 16:32:33,748 - INFO - ✅ Ficheiro CSV válido com 13 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.751699Z","level":"info","event":"📋 [2025-06-05 16:32:33] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.751758Z","level":"info","event":"📋 2025-06-05 16:32:33,748 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.751816Z","level":"info","event":"📋 [2025-06-05 16:32:33] 📅 Filtrado para artigos dos últimos 1 dias: 13 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.752123Z","level":"info","event":"📋 2025-06-05 16:32:33,749 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 13 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.752539Z","level":"info","event":"📋 [2025-06-05 16:32:33] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.752687Z","level":"info","event":"📋 2025-06-05 16:32:33,749 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.752784Z","level":"info","event":"📋 [2025-06-05 16:32:33] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.752876Z","level":"info","event":"📋 2025-06-05 16:32:33,749 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.752963Z","level":"info","event":"📋 [2025-06-05 16:32:33] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.753087Z","level":"info","event":"📋 2025-06-05 16:32:33,749 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.753357Z","level":"info","event":"📋 [2025-06-05 16:32:33]   Total de Artigos para Processar: 13","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.753458Z","level":"info","event":"📋 2025-06-05 16:32:33,749 - INFO -   Total de Artigos para Processar: 13","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.753533Z","level":"info","event":"📋 [2025-06-05 16:32:33]   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.753602Z","level":"info","event":"📋 2025-06-05 16:32:33,749 - INFO -   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.753664Z","level":"info","event":"📋 [2025-06-05 16:32:33]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.753726Z","level":"info","event":"📋 2025-06-05 16:32:33,749 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.753786Z","level":"info","event":"📋 [2025-06-05 16:32:33]   Diretoria de Saída: /opt/airflow/data/structured/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.753911Z","level":"info","event":"📋 2025-06-05 16:32:33,749 - INFO -   Diretoria de Saída: /opt/airflow/data/structured/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.753984Z","level":"info","event":"📋 [2025-06-05 16:32:33]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.754055Z","level":"info","event":"📋 2025-06-05 16:32:33,749 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.754126Z","level":"info","event":"📋 [2025-06-05 16:32:33] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.754193Z","level":"info","event":"📋 2025-06-05 16:32:33,749 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.754273Z","level":"info","event":"📋 [2025-06-05 16:32:33] 📦 A processar lote 1/1 (13 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:33.754350Z","level":"info","event":"📋 2025-06-05 16:32:33,750 - INFO - 📦 A processar lote 1/1 (13 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:37.354063Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:37.577800Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:37.619587Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:37.692346Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:37.747153Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:37.802407Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:37.827584Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:37.866644Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:45.038349Z","level":"info","event":"📋 [2025-06-05 16:32:45] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva fraca no Norte e Centro e subida da temperatura no Sul - Renascença","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:45.044377Z","level":"info","event":"📋 2025-06-05 16:32:45,027 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva fraca no Norte e Centro e subida da temperatura no Sul - Renascença","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:45.074897Z","level":"info","event":"📋 [2025-06-05 16:32:45] 🔄 Processado: Chuva fraca no Norte e Centro e subida da temperat...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:45.077741Z","level":"info","event":"📋 2025-06-05 16:32:45,068 - INFO - 🔄 Processado: Chuva fraca no Norte e Centro e subida da temperat...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:46.303528Z","level":"info","event":"📋 [2025-06-05 16:32:46] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Anticiclone dos Açores \"jogará\" papel crucial no tempo das Regiões Autónomas portuguesas até 8 de junho: saiba como! - Tempo.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:46.313035Z","level":"info","event":"📋 2025-06-05 16:32:46,289 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Anticiclone dos Açores \"jogará\" papel crucial no tempo das Regiões Autónomas portuguesas até 8 de junho: saiba como! - Tempo.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:46.313340Z","level":"info","event":"📋 [2025-06-05 16:32:46] 🔄 Processado: Anticiclone dos Açores \"jogará\" papel crucial no t...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:46.313436Z","level":"info","event":"📋 2025-06-05 16:32:46,296 - INFO - 🔄 Processado: Anticiclone dos Açores \"jogará\" papel crucial no t...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:47.541782Z","level":"info","event":"📋 [2025-06-05 16:32:47] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Portugal começa com um dos melhores jogadores da Champions no banco - TVI","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:47.547452Z","level":"info","event":"📋 2025-06-05 16:32:47,543 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Portugal começa com um dos melhores jogadores da Champions no banco - TVI","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:47.558838Z","level":"info","event":"📋 [2025-06-05 16:32:47] 🔄 Processado: Liga das Nações: Portugal começa com um dos melhor...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:47.563347Z","level":"info","event":"📋 2025-06-05 16:32:47,557 - INFO - 🔄 Processado: Liga das Nações: Portugal começa com um dos melhor...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:49.046921Z","level":"info","event":"📋 [2025-06-05 16:32:49] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Alemanha 1-2 Portugal - CNN Portugal","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:49.047389Z","level":"info","event":"📋 2025-06-05 16:32:49,043 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Alemanha 1-2 Portugal - CNN Portugal","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:49.458209Z","level":"info","event":"📋 [2025-06-05 16:32:49] 🔄 Processado: Liga das Nações: Alemanha 1-2 Portugal - CNN Portu...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:49.463580Z","level":"info","event":"📋 2025-06-05 16:32:49,056 - INFO - 🔄 Processado: Liga das Nações: Alemanha 1-2 Portugal - CNN Portu...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:49.463945Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:49.577592Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:51.112103Z","level":"info","event":"📋 [2025-06-05 16:32:51] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Esta é a cidade portuguesa onde mais chove. Em cada três dias, um é de chuva - CNN Portugal","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:51.122825Z","level":"info","event":"📋 2025-06-05 16:32:51,106 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Esta é a cidade portuguesa onde mais chove. Em cada três dias, um é de chuva - CNN Portugal","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:51.152455Z","level":"info","event":"📋 [2025-06-05 16:32:51] 🔄 Processado: Esta é a cidade portuguesa onde mais chove. Em cad...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:51.153311Z","level":"info","event":"📋 2025-06-05 16:32:51,150 - INFO - 🔄 Processado: Esta é a cidade portuguesa onde mais chove. Em cad...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:51.495355Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:51.727041Z","level":"info","event":"📋 [2025-06-05 16:32:51] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Um em cada três dias são de chuva em Bragança - Correio da Manhã","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:51.728579Z","level":"info","event":"📋 2025-06-05 16:32:51,723 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Um em cada três dias são de chuva em Bragança - Correio da Manhã","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:51.728801Z","level":"info","event":"📋 [2025-06-05 16:32:51] 🔄 Processado: Um em cada três dias são de chuva em Bragança - Co...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:51.728945Z","level":"info","event":"📋 2025-06-05 16:32:51,724 - INFO - 🔄 Processado: Um em cada três dias são de chuva em Bragança - Co...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:53.489764Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:54.190922Z","level":"info","event":"📋 [2025-06-05 16:32:54] ⚠️ Artigo ignorado após extração: Barreiro tem chuva extremamente forte nesta terça-feira (3) - MSN","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:54.274321Z","level":"info","event":"📋 2025-06-05 16:32:54,191 - WARNING - ⚠️ Artigo ignorado após extração: Barreiro tem chuva extremamente forte nesta terça-feira (3) - MSN","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:54.328147Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:54.523380Z","level":"info","event":"📋 [2025-06-05 16:32:54] 🔄 Processado: Água potável responsável por 18% dos óbitos por di...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:54.523615Z","level":"info","event":"📋 2025-06-05 16:32:54,519 - INFO - 🔄 Processado: Água potável responsável por 18% dos óbitos por di...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:55.484697Z","level":"info","event":"📋 [2025-06-05 16:32:55] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Sertãozinho (SP) terá dia ensolarado hoje (05); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:55.485103Z","level":"info","event":"📋 2025-06-05 16:32:55,484 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Sertãozinho (SP) terá dia ensolarado hoje (05); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:55.486225Z","level":"info","event":"📋 [2025-06-05 16:32:55] 🔄 Processado: Sertãozinho (SP) terá dia ensolarado hoje (05); ve...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:55.486464Z","level":"info","event":"📋 2025-06-05 16:32:55,486 - INFO - 🔄 Processado: Sertãozinho (SP) terá dia ensolarado hoje (05); ve...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:56.468886Z","level":"info","event":"📋 [2025-06-05 16:32:56] 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:56.470640Z","level":"info","event":"📋 2025-06-05 16:32:56,467 - INFO - 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:56.494460Z","level":"info","event":"📋 [2025-06-05 16:32:56] 🔄 Processado: Escocês desaparecido em Albufeira foi encontrado m...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:56.495804Z","level":"info","event":"📋 2025-06-05 16:32:56,494 - INFO - 🔄 Processado: Escocês desaparecido em Albufeira foi encontrado m...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:57.671324Z","level":"info","event":"📋 [2025-06-05 16:32:57] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Chuva fraca está de regresso com descida da temperatura - O Amarense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:57.672145Z","level":"info","event":"📋 2025-06-05 16:32:57,664 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Chuva fraca está de regresso com descida da temperatura - O Amarense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:57.674183Z","level":"info","event":"📋 [2025-06-05 16:32:57] 🔄 Processado: Tempo. Chuva fraca está de regresso com descida da...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:57.675163Z","level":"info","event":"📋 2025-06-05 16:32:57,673 - INFO - 🔄 Processado: Tempo. Chuva fraca está de regresso com descida da...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.327601Z","level":"info","event":"📋 [2025-06-05 16:32:59] ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.328107Z","level":"info","event":"📋 2025-06-05 16:32:59,327 - WARNING - ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.378292Z","level":"info","event":"📋 📥 Novos artigos recebidos: 11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.378473Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.378574Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.378649Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.378734Z","level":"info","event":"📋 💾 Guardados 4 artigos no arquivo /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.378801Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.378866Z","level":"info","event":"📋 📥 Novos artigos recebidos: 11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.378937Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.379028Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.379097Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.379172Z","level":"info","event":"📋 💾 Guardados 4 artigos no arquivo /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.379262Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.379819Z","level":"info","event":"📋 [2025-06-05 16:32:59] ✅ Relevant articles saved: 11 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.379959Z","level":"info","event":"📋 2025-06-05 16:32:59,337 - INFO - ✅ Relevant articles saved: 11 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.380066Z","level":"info","event":"📋 [2025-06-05 16:32:59] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.380176Z","level":"info","event":"📋 2025-06-05 16:32:59,338 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.380280Z","level":"info","event":"📋 [2025-06-05 16:32:59] ✅ Lote 1 concluído: 11 artigos (total: 11)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:32:59.380345Z","level":"info","event":"📋 2025-06-05 16:32:59,338 - INFO - ✅ Lote 1 concluído: 11 artigos (total: 11)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.765208Z","level":"info","event":"📋 📥 Novos artigos recebidos: 11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.769492Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.769708Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.769846Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.770006Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.770099Z","level":"info","event":"📋 📥 Novos artigos recebidos: 11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.770296Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.771288Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.771473Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.771601Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.771755Z","level":"info","event":"📋 [2025-06-05 16:33:03] ✅ Relevant articles saved: 11 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.773212Z","level":"info","event":"📋 2025-06-05 16:33:03,770 - INFO - ✅ Relevant articles saved: 11 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.774234Z","level":"info","event":"📋 [2025-06-05 16:33:03] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.774309Z","level":"info","event":"📋 2025-06-05 16:33:03,771 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.774369Z","level":"info","event":"📋 [2025-06-05 16:33:03] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.774417Z","level":"info","event":"📋 2025-06-05 16:33:03,771 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.774463Z","level":"info","event":"📋 [2025-06-05 16:33:03] Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.774513Z","level":"info","event":"📋 2025-06-05 16:33:03,771 - INFO - Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.774557Z","level":"info","event":"📋 [2025-06-05 16:33:03] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.774593Z","level":"info","event":"📋 2025-06-05 16:33:03,771 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.774671Z","level":"info","event":"📋 [2025-06-05 16:33:03]   Total de Artigos Processados: 11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.774717Z","level":"info","event":"📋 2025-06-05 16:33:03,771 - INFO -   Total de Artigos Processados: 11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.774758Z","level":"info","event":"📋 [2025-06-05 16:33:03]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.774807Z","level":"info","event":"📋 2025-06-05 16:33:03,772 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.774859Z","level":"info","event":"📋 [2025-06-05 16:33:03]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.774905Z","level":"info","event":"📋 2025-06-05 16:33:03,772 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.774956Z","level":"info","event":"📋 [2025-06-05 16:33:03]   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.775001Z","level":"info","event":"📋 2025-06-05 16:33:03,772 - INFO -   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.775040Z","level":"info","event":"📋 [2025-06-05 16:33:03]   Taxa de Sucesso: 84.6%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.775085Z","level":"info","event":"📋 2025-06-05 16:33:03,772 - INFO -   Taxa de Sucesso: 84.6%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.775129Z","level":"info","event":"📋 [2025-06-05 16:33:03] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.775174Z","level":"info","event":"📋 2025-06-05 16:33:03,772 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.775334Z","level":"info","event":"📋 [2025-06-05 16:33:03] ✅ Processing completed. Processed 11 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.775423Z","level":"info","event":"📋 2025-06-05 16:33:03,775 - INFO - ✅ Processing completed. Processed 11 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.964874Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.965084Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.965266Z","level":"info","event":"⚠️ relevant_articles: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.965371Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/data/structured/2025/06/04/artigos_irrelevantes_2025-06-04.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.965463Z","level":"info","event":"⚠️ processing_log: /opt/airflow/data/structured/2025/06/04/processing_log_20250604.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.965582Z","level":"info","event":"✅ stats_json: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json (395 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:03.968829","level":"info","event":"Done. Returned value was: [2025-06-05 16:32:33] Starting processar_relevantes_airflow\n2025-06-05 16:32:33,731 - INFO - Starting processar_relevantes_airflow\n[2025-06-05 16:32:33] Parameters: dias=1, date=2025-06-04\n2025-06-05 16:32:33,731 - INFO - Parameters: dias=1, date=2025-06-04\n[2025-06-05 16:32:33] Paths: input_file=/opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv, output_dir=/opt/airflow/data/structured/2025/06/04, date_str=2025-06-04\n2025-06-05 16:32:33,731 - INFO - Paths: input_file=/opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv, output_dir=/opt/airflow/data/structured/2025/06/04, date_str=2025-06-04\n[2025-06-05 16:32:33] 🚀 A iniciar processar_relevantes_airflow\n2025-06-05 16:32:33,731 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-05 16:32:33] 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/04\n2025-06-05 16:32:33,731 - INFO - 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/04\n[2025-06-05 16:32:33] 📁 Using provided input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv\n2025-06-05 16:32:33,731 - INFO - 📁 Using provided input file: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv\n[2025-06-05 16:32:33] 🔧 A carregar ficheiros de configuração...\n2025-06-05 16:32:33,731 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-05 16:32:33] 🔍 Checking config path: /opt/airflow/config\n2025-06-05 16:32:33,732 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-05 16:32:33] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-05 16:32:33,732 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-05 16:32:33] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-05 16:32:33,732 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-05 16:32:33] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-05 16:32:33,732 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-05 16:32:33] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-05 16:32:33,732 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-05 16:32:33] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-05 16:32:33,735 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-05 16:32:33] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-05 16:32:33,735 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-05 16:32:33] ✅ Loaded 6 keywords\n2025-06-05 16:32:33,735 - INFO - ✅ Loaded 6 keywords\n[2025-06-05 16:32:33] ✅ Loaded 3614 DICOFREG codes\n2025-06-05 16:32:33,745 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-05 16:32:33] ==================================================\n2025-06-05 16:32:33,745 - INFO - ==================================================\n[2025-06-05 16:32:33] Configuration Loaded\n2025-06-05 16:32:33,745 - INFO - Configuration Loaded\n[2025-06-05 16:32:33] ==================================================\n2025-06-05 16:32:33,745 - INFO - ==================================================\n[2025-06-05 16:32:33]   Parishes: 306\n2025-06-05 16:32:33,745 - INFO -   Parishes: 306\n[2025-06-05 16:32:33]   Municipalities: 306\n2025-06-05 16:32:33,745 - INFO -   Municipalities: 306\n[2025-06-05 16:32:33]   Districts: 29\n2025-06-05 16:32:33,745 - INFO -   Districts: 29\n[2025-06-05 16:32:33]   Keywords: 6\n2025-06-05 16:32:33,745 - INFO -   Keywords: 6\n[2025-06-05 16:32:33]   DICOFREG Codes: 3614\n2025-06-05 16:32:33,745 - INFO -   DICOFREG Codes: 3614\n[2025-06-05 16:32:33] ==================================================\n2025-06-05 16:32:33,745 - INFO - ==================================================\n[2025-06-05 16:32:33] ✅ Ficheiro CSV válido com 13 artigos\n2025-06-05 16:32:33,748 - INFO - ✅ Ficheiro CSV válido com 13 artigos\n[2025-06-05 16:32:33] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-05 16:32:33,748 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-05 16:32:33] 📅 Filtrado para artigos dos últimos 1 dias: 13 artigos\n2025-06-05 16:32:33,749 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 13 artigos\n[2025-06-05 16:32:33] ==================================================\n2025-06-05 16:32:33,749 - INFO - ==================================================\n[2025-06-05 16:32:33] Processamento Iniciado\n2025-06-05 16:32:33,749 - INFO - Processamento Iniciado\n[2025-06-05 16:32:33] ==================================================\n2025-06-05 16:32:33,749 - INFO - ==================================================\n[2025-06-05 16:32:33]   Total de Artigos para Processar: 13\n2025-06-05 16:32:33,749 - INFO -   Total de Artigos para Processar: 13\n[2025-06-05 16:32:33]   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv\n2025-06-05 16:32:33,749 - INFO -   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/04/google_news_articles_20250604.csv\n[2025-06-05 16:32:33]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n2025-06-05 16:32:33,749 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n[2025-06-05 16:32:33]   Diretoria de Saída: /opt/airflow/data/structured/2025/06/04\n2025-06-05 16:32:33,749 - INFO -   Diretoria de Saída: /opt/airflow/data/structured/2025/06/04\n[2025-06-05 16:32:33]   Filtro de Dias: 1\n2025-06-05 16:32:33,749 - INFO -   Filtro de Dias: 1\n[2025-06-05 16:32:33] ==================================================\n2025-06-05 16:32:33,749 - INFO - ==================================================\n[2025-06-05 16:32:33] 📦 A processar lote 1/1 (13 artigos)\n2025-06-05 16:32:33,750 - INFO - 📦 A processar lote 1/1 (13 artigos)\n[2025-06-05 16:32:45] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva fraca no Norte e Centro e subida da temperatura no Sul - Renascença\n2025-06-05 16:32:45,027 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva fraca no Norte e Centro e subida da temperatura no Sul - Renascença\n[2025-06-05 16:32:45] 🔄 Processado: Chuva fraca no Norte e Centro e subida da temperat...\n2025-06-05 16:32:45,068 - INFO - 🔄 Processado: Chuva fraca no Norte e Centro e subida da temperat...\n[2025-06-05 16:32:46] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Anticiclone dos Açores \"jogará\" papel crucial no tempo das Regiões Autónomas portuguesas até 8 de junho: saiba como! - Tempo.pt\n2025-06-05 16:32:46,289 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Anticiclone dos Açores \"jogará\" papel crucial no tempo das Regiões Autónomas portuguesas até 8 de junho: saiba como! - Tempo.pt\n[2025-06-05 16:32:46] 🔄 Processado: Anticiclone dos Açores \"jogará\" papel crucial no t...\n2025-06-05 16:32:46,296 - INFO - 🔄 Processado: Anticiclone dos Açores \"jogará\" papel crucial no t...\n[2025-06-05 16:32:47] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Portugal começa com um dos melhores jogadores da Champions no banco - TVI\n2025-06-05 16:32:47,543 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Portugal começa com um dos melhores jogadores da Champions no banco - TVI\n[2025-06-05 16:32:47] 🔄 Processado: Liga das Nações: Portugal começa com um dos melhor...\n2025-06-05 16:32:47,557 - INFO - 🔄 Processado: Liga das Nações: Portugal começa com um dos melhor...\n[2025-06-05 16:32:49] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Alemanha 1-2 Portugal - CNN Portugal\n2025-06-05 16:32:49,043 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Liga das Nações: Alemanha 1-2 Portugal - CNN Portugal\n[2025-06-05 16:32:49] 🔄 Processado: Liga das Nações: Alemanha 1-2 Portugal - CNN Portu...\n2025-06-05 16:32:49,056 - INFO - 🔄 Processado: Liga das Nações: Alemanha 1-2 Portugal - CNN Portu...\n[2025-06-05 16:32:51] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Esta é a cidade portuguesa onde mais chove. Em cada três dias, um é de chuva - CNN Portugal\n2025-06-05 16:32:51,106 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Esta é a cidade portuguesa onde mais chove. Em cada três dias, um é de chuva - CNN Portugal\n[2025-06-05 16:32:51] 🔄 Processado: Esta é a cidade portuguesa onde mais chove. Em cad...\n2025-06-05 16:32:51,150 - INFO - 🔄 Processado: Esta é a cidade portuguesa onde mais chove. Em cad...\n[2025-06-05 16:32:51] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Um em cada três dias são de chuva em Bragança - Correio da Manhã\n2025-06-05 16:32:51,723 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Um em cada três dias são de chuva em Bragança - Correio da Manhã\n[2025-06-05 16:32:51] 🔄 Processado: Um em cada três dias são de chuva em Bragança - Co...\n2025-06-05 16:32:51,724 - INFO - 🔄 Processado: Um em cada três dias são de chuva em Bragança - Co...\n[2025-06-05 16:32:54] ⚠️ Artigo ignorado após extração: Barreiro tem chuva extremamente forte nesta terça-feira (3) - MSN\n2025-06-05 16:32:54,191 - WARNING - ⚠️ Artigo ignorado após extração: Barreiro tem chuva extremamente forte nesta terça-feira (3) - MSN\n[2025-06-05 16:32:54] 🔄 Processado: Água potável responsável por 18% dos óbitos por di...\n2025-06-05 16:32:54,519 - INFO - 🔄 Processado: Água potável responsável por 18% dos óbitos por di...\n[2025-06-05 16:32:55] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Sertãozinho (SP) terá dia ensolarado hoje (05); veja previsão do tempo - UOL Notícias\n2025-06-05 16:32:55,484 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Sertãozinho (SP) terá dia ensolarado hoje (05); veja previsão do tempo - UOL Notícias\n[2025-06-05 16:32:55] 🔄 Processado: Sertãozinho (SP) terá dia ensolarado hoje (05); ve...\n2025-06-05 16:32:55,486 - INFO - 🔄 Processado: Sertãozinho (SP) terá dia ensolarado hoje (05); ve...\n[2025-06-05 16:32:56] 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...\n2025-06-05 16:32:56,467 - INFO - 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...\n[2025-06-05 16:32:56] 🔄 Processado: Escocês desaparecido em Albufeira foi encontrado m...\n2025-06-05 16:32:56,494 - INFO - 🔄 Processado: Escocês desaparecido em Albufeira foi encontrado m...\n[2025-06-05 16:32:57] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Chuva fraca está de regresso com descida da temperatura - O Amarense\n2025-06-05 16:32:57,664 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Chuva fraca está de regresso com descida da temperatura - O Amarense\n[2025-06-05 16:32:57] 🔄 Processado: Tempo. Chuva fraca está de regresso com descida da...\n2025-06-05 16:32:57,673 - INFO - 🔄 Processado: Tempo. Chuva fraca está de regresso com descida da...\n[2025-06-05 16:32:59] ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho\n2025-06-05 16:32:59,327 - WARNING - ⚠️ Artigo ignorado após extração: Inundação no Guimarães Shopping - O Minho\n📥 Novos artigos recebidos: 11\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n📂 IDs existentes no arquivo: 7\n🆕 Artigos únicos para salvar: 4\n💾 Guardados 4 artigos no arquivo /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n📥 Novos artigos recebidos: 11\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n📂 IDs existentes no arquivo: 7\n🆕 Artigos únicos para salvar: 4\n💾 Guardados 4 artigos no arquivo /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n[2025-06-05 16:32:59] ✅ Relevant articles saved: 11 articles\n2025-06-05 16:32:59,337 - INFO - ✅ Relevant articles saved: 11 articles\n[2025-06-05 16:32:59] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:32:59,338 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:32:59] ✅ Lote 1 concluído: 11 artigos (total: 11)\n2025-06-05 16:32:59,338 - INFO - ✅ Lote 1 concluído: 11 artigos (total: 11)\n📥 Novos artigos recebidos: 11\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n📂 IDs existentes no arquivo: 11\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 11\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-04.csv\n📂 IDs existentes no arquivo: 11\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-05 16:33:03] ✅ Relevant articles saved: 11 articles\n2025-06-05 16:33:03,770 - INFO - ✅ Relevant articles saved: 11 articles\n[2025-06-05 16:33:03] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:33:03,771 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:33:03] ==================================================\n2025-06-05 16:33:03,771 - INFO - ==================================================\n[2025-06-05 16:33:03] Processamento Concluído com Sucesso\n2025-06-05 16:33:03,771 - INFO - Processamento Concluído com Sucesso\n[2025-06-05 16:33:03] ==================================================\n2025-06-05 16:33:03,771 - INFO - ==================================================\n[2025-06-05 16:33:03]   Total de Artigos Processados: 11\n2025-06-05 16:33:03,771 - INFO -   Total de Artigos Processados: 11\n[2025-06-05 16:33:03]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n2025-06-05 16:33:03,772 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n[2025-06-05 16:33:03]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n2025-06-05 16:33:03,772 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv\n[2025-06-05 16:33:03]   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:33:03,772 - INFO -   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:33:03]   Taxa de Sucesso: 84.6%\n2025-06-05 16:33:03,772 - INFO -   Taxa de Sucesso: 84.6%\n[2025-06-05 16:33:03] ==================================================\n2025-06-05 16:33:03,772 - INFO - ==================================================\n[2025-06-05 16:33:03] ✅ Processing completed. Processed 11 articles\n2025-06-05 16:33:03,775 - INFO - ✅ Processing completed. Processed 11 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
