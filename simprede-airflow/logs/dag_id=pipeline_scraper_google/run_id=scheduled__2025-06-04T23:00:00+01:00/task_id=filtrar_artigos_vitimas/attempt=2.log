{"timestamp":"2025-06-05T17:15:17.957025","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T17:15:17.957419","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T17:15:18.012853Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:18.013510Z","level":"info","event":"📁 Using paths from processar task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:18.015544Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:18.016058Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:18.016193Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:18.016264Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:18.016331Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:18.016393Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:18.016447Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:18.019849Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:18.019963Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:18.020234Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:18.020351Z","level":"info","event":"  - victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:18.020421Z","level":"info","event":"  - no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:18.020536Z","level":"info","event":"  - filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:18.020605Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:18.020680Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:18.020761Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.441210Z","level":"info","event":"📋 [2025-06-05 18:15:19] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.441582Z","level":"info","event":"📋 2025-06-05 18:15:19,441 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.442191Z","level":"info","event":"📋 [2025-06-05 18:15:19] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.442300Z","level":"info","event":"📋 2025-06-05 18:15:19,441 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.443261Z","level":"info","event":"📋 [2025-06-05 18:15:19] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.443338Z","level":"info","event":"📋 2025-06-05 18:15:19,441 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.443401Z","level":"info","event":"📋 [2025-06-05 18:15:19] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.443457Z","level":"info","event":"📋 2025-06-05 18:15:19,441 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.443507Z","level":"info","event":"📋 [2025-06-05 18:15:19] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.443556Z","level":"info","event":"📋 2025-06-05 18:15:19,441 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.443604Z","level":"info","event":"📋 [2025-06-05 18:15:19]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.443650Z","level":"info","event":"📋 2025-06-05 18:15:19,441 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.443701Z","level":"info","event":"📋 [2025-06-05 18:15:19]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.443747Z","level":"info","event":"📋 2025-06-05 18:15:19,441 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.443797Z","level":"info","event":"📋 [2025-06-05 18:15:19] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.443849Z","level":"info","event":"📋 2025-06-05 18:15:19,441 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.443904Z","level":"info","event":"📋 [2025-06-05 18:15:19] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.443959Z","level":"info","event":"📋 2025-06-05 18:15:19,441 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.444014Z","level":"info","event":"📋 [2025-06-05 18:15:19] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.444072Z","level":"info","event":"📋 2025-06-05 18:15:19,441 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.444147Z","level":"info","event":"📋 [2025-06-05 18:15:19] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.444257Z","level":"info","event":"📋 2025-06-05 18:15:19,443 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.444310Z","level":"info","event":"📋 [2025-06-05 18:15:19] Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.444357Z","level":"info","event":"📋 2025-06-05 18:15:19,443 - INFO - Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.444402Z","level":"info","event":"📋 [2025-06-05 18:15:19] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.444448Z","level":"info","event":"📋 2025-06-05 18:15:19,443 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.444494Z","level":"info","event":"📋 [2025-06-05 18:15:19]   Total Articles Loaded: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.444542Z","level":"info","event":"📋 2025-06-05 18:15:19,444 - INFO -   Total Articles Loaded: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.444649Z","level":"info","event":"📋 [2025-06-05 18:15:19]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.444727Z","level":"info","event":"📋 2025-06-05 18:15:19,444 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.444787Z","level":"info","event":"📋 [2025-06-05 18:15:19]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.445046Z","level":"info","event":"📋 2025-06-05 18:15:19,444 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.445130Z","level":"info","event":"📋 [2025-06-05 18:15:19]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.445207Z","level":"info","event":"📋 2025-06-05 18:15:19,444 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.445306Z","level":"info","event":"📋 [2025-06-05 18:15:19]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.445446Z","level":"info","event":"📋 2025-06-05 18:15:19,444 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.445582Z","level":"info","event":"📋 [2025-06-05 18:15:19] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.446041Z","level":"info","event":"📋 2025-06-05 18:15:19,444 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.446101Z","level":"info","event":"📋 [2025-06-05 18:15:19] 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.446150Z","level":"info","event":"📋 2025-06-05 18:15:19,444 - INFO - 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.446199Z","level":"info","event":"📋 [2025-06-05 18:15:19] 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.446670Z","level":"info","event":"📋 2025-06-05 18:15:19,444 - INFO - 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.446964Z","level":"info","event":"📋 [2025-06-05 18:15:19] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.447542Z","level":"info","event":"📋 2025-06-05 18:15:19,444 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.448707Z","level":"info","event":"📋 [2025-06-05 18:15:19]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.449449Z","level":"info","event":"📋 2025-06-05 18:15:19,444 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.449524Z","level":"info","event":"📋 [2025-06-05 18:15:19]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.450012Z","level":"info","event":"📋 2025-06-05 18:15:19,444 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.452463Z","level":"info","event":"📋 [2025-06-05 18:15:19]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.452547Z","level":"info","event":"📋 2025-06-05 18:15:19,444 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.452631Z","level":"info","event":"📋 [2025-06-05 18:15:19]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.452698Z","level":"info","event":"📋 2025-06-05 18:15:19,444 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.452744Z","level":"info","event":"📋 [2025-06-05 18:15:19] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.452790Z","level":"info","event":"📋 2025-06-05 18:15:19,445 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.452851Z","level":"info","event":"📋 [2025-06-05 18:15:19]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.452905Z","level":"info","event":"📋 2025-06-05 18:15:19,445 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.452946Z","level":"info","event":"📋 [2025-06-05 18:15:19]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.452990Z","level":"info","event":"📋 2025-06-05 18:15:19,445 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.453073Z","level":"info","event":"📋 [2025-06-05 18:15:19] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.453112Z","level":"info","event":"📋 2025-06-05 18:15:19,446 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.453151Z","level":"info","event":"📋 [2025-06-05 18:15:19] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.453187Z","level":"info","event":"📋 2025-06-05 18:15:19,447 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.453223Z","level":"info","event":"📋 [2025-06-05 18:15:19] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.453288Z","level":"info","event":"📋 2025-06-05 18:15:19,447 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.453323Z","level":"info","event":"📋 [2025-06-05 18:15:19] 📊 Starting enhanced comprehensive filtering with 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.453537Z","level":"info","event":"📋 2025-06-05 18:15:19,447 - INFO - 📊 Starting enhanced comprehensive filtering with 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.453578Z","level":"info","event":"📋 [2025-06-05 18:15:19] 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.453611Z","level":"info","event":"📋 2025-06-05 18:15:19,447 - INFO - 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.453645Z","level":"info","event":"📋 [2025-06-05 18:15:19]    After enhanced geographic filter: 3 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.453681Z","level":"info","event":"📋 2025-06-05 18:15:19,448 - INFO -    After enhanced geographic filter: 3 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.453715Z","level":"info","event":"📋 [2025-06-05 18:15:19] ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.453749Z","level":"info","event":"📋 2025-06-05 18:15:19,448 - INFO - ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.454441Z","level":"info","event":"📋 [2025-06-05 18:15:19]    After quality filter: 2 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.454488Z","level":"info","event":"📋 2025-06-05 18:15:19,448 - INFO -    After quality filter: 2 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.454522Z","level":"info","event":"📋 [2025-06-05 18:15:19] 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.454556Z","level":"info","event":"📋 2025-06-05 18:15:19,448 - INFO - 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.454602Z","level":"info","event":"📋 [2025-06-05 18:15:19]    After enhanced keyword filter: 0 articles (removed 2)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.454650Z","level":"info","event":"📋 2025-06-05 18:15:19,449 - INFO -    After enhanced keyword filter: 0 articles (removed 2)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.454700Z","level":"info","event":"📋 [2025-06-05 18:15:19] 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.454747Z","level":"info","event":"📋 2025-06-05 18:15:19,449 - INFO - 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.454795Z","level":"info","event":"📋 [2025-06-05 18:15:19]    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.454844Z","level":"info","event":"📋 2025-06-05 18:15:19,449 - INFO -    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.454891Z","level":"info","event":"📋 [2025-06-05 18:15:19] 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.454940Z","level":"info","event":"📋 2025-06-05 18:15:19,449 - INFO - 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.454988Z","level":"info","event":"📋 [2025-06-05 18:15:19]    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.455035Z","level":"info","event":"📋 2025-06-05 18:15:19,449 - INFO -    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.455127Z","level":"info","event":"📋 [2025-06-05 18:15:19] ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.455179Z","level":"info","event":"📋 2025-06-05 18:15:19,449 - INFO - ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.455228Z","level":"info","event":"📋 [2025-06-05 18:15:19]    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.455276Z","level":"info","event":"📋 2025-06-05 18:15:19,450 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.455325Z","level":"info","event":"📋 [2025-06-05 18:15:19] 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.455374Z","level":"info","event":"📋 2025-06-05 18:15:19,450 - INFO - 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.455421Z","level":"info","event":"📋 [2025-06-05 18:15:19] 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.455481Z","level":"info","event":"📋 2025-06-05 18:15:19,450 - INFO - 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.455524Z","level":"info","event":"📋 [2025-06-05 18:15:19] ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.455571Z","level":"info","event":"📋 2025-06-05 18:15:19,450 - WARNING - ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.455606Z","level":"info","event":"📋 [2025-06-05 18:15:19] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.455648Z","level":"info","event":"📋 2025-06-05 18:15:19,450 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.548786Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.548953Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.549120Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.549207Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.549286Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.549376Z","level":"info","event":"⚠️ stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:15:19.549715","level":"info","event":"Done. Returned value was: [2025-06-05 18:15:19] Starting filtrar_artigos_vitimas_airflow\n2025-06-05 18:15:19,441 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 18:15:19] Parameters: dias=1, date=2025-06-05\n2025-06-05 18:15:19,441 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 18:15:19] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n2025-06-05 18:15:19,441 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n[2025-06-05 18:15:19] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n2025-06-05 18:15:19,441 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n[2025-06-05 18:15:19] 🔍 Path setup:\n2025-06-05 18:15:19,441 - INFO - 🔍 Path setup:\n[2025-06-05 18:15:19]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-05 18:15:19,441 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-05 18:15:19]    Project root: /opt/airflow\n2025-06-05 18:15:19,441 - INFO -    Project root: /opt/airflow\n[2025-06-05 18:15:19] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 18:15:19,441 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 18:15:19] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:15:19,441 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:15:19] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:15:19,441 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:15:19] ==================================================\n2025-06-05 18:15:19,443 - INFO - ==================================================\n[2025-06-05 18:15:19] Enhanced Filtering Started\n2025-06-05 18:15:19,443 - INFO - Enhanced Filtering Started\n[2025-06-05 18:15:19] ==================================================\n2025-06-05 18:15:19,443 - INFO - ==================================================\n[2025-06-05 18:15:19]   Total Articles Loaded: 3\n2025-06-05 18:15:19,444 - INFO -   Total Articles Loaded: 3\n[2025-06-05 18:15:19]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:15:19,444 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:15:19]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 18:15:19,444 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 18:15:19]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 18:15:19,444 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 18:15:19]   Days Filter: 1\n2025-06-05 18:15:19,444 - INFO -   Days Filter: 1\n[2025-06-05 18:15:19] ==================================================\n2025-06-05 18:15:19,444 - INFO - ==================================================\n[2025-06-05 18:15:19] 🔍 Applying enhanced comprehensive filtering logic...\n2025-06-05 18:15:19,444 - INFO - 🔍 Applying enhanced comprehensive filtering logic...\n[2025-06-05 18:15:19] 🔧 Loading configuration data for enhanced filtering...\n2025-06-05 18:15:19,444 - INFO - 🔧 Loading configuration data for enhanced filtering...\n[2025-06-05 18:15:19] 🔍 Looking for config files in multiple paths:\n2025-06-05 18:15:19,444 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-05 18:15:19]    Checking: /opt/airflow/config\n2025-06-05 18:15:19,444 - INFO -    Checking: /opt/airflow/config\n[2025-06-05 18:15:19]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-05 18:15:19,444 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-05 18:15:19]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-05 18:15:19,444 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 18:15:19]    Checking: config\n2025-06-05 18:15:19,444 - INFO -    Checking: config\n[2025-06-05 18:15:19] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-05 18:15:19,445 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 18:15:19]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-05 18:15:19,445 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-05 18:15:19]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-05 18:15:19,445 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-05 18:15:19] ✅ Loaded municipios config with 29 districts\n2025-06-05 18:15:19,446 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-05 18:15:19] ✅ Loaded eventos config with 14 events\n2025-06-05 18:15:19,447 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-05 18:15:19] 📊 Config summary: 29 districts, 306 parishes\n2025-06-05 18:15:19,447 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-05 18:15:19] 📊 Starting enhanced comprehensive filtering with 3 articles\n2025-06-05 18:15:19,447 - INFO - 📊 Starting enhanced comprehensive filtering with 3 articles\n[2025-06-05 18:15:19] 🇵🇹 Applying enhanced geographic filter...\n2025-06-05 18:15:19,447 - INFO - 🇵🇹 Applying enhanced geographic filter...\n[2025-06-05 18:15:19]    After enhanced geographic filter: 3 articles (removed 0)\n2025-06-05 18:15:19,448 - INFO -    After enhanced geographic filter: 3 articles (removed 0)\n[2025-06-05 18:15:19] ✨ Applying content quality filter...\n2025-06-05 18:15:19,448 - INFO - ✨ Applying content quality filter...\n[2025-06-05 18:15:19]    After quality filter: 2 articles (removed 1)\n2025-06-05 18:15:19,448 - INFO -    After quality filter: 2 articles (removed 1)\n[2025-06-05 18:15:19] 🔍 Applying enhanced keyword filtering...\n2025-06-05 18:15:19,448 - INFO - 🔍 Applying enhanced keyword filtering...\n[2025-06-05 18:15:19]    After enhanced keyword filter: 0 articles (removed 2)\n2025-06-05 18:15:19,449 - INFO -    After enhanced keyword filter: 0 articles (removed 2)\n[2025-06-05 18:15:19] 📅 Applying temporal relevance filter...\n2025-06-05 18:15:19,449 - INFO - 📅 Applying temporal relevance filter...\n[2025-06-05 18:15:19]    After temporal filter: 0 articles (removed 0)\n2025-06-05 18:15:19,449 - INFO -    After temporal filter: 0 articles (removed 0)\n[2025-06-05 18:15:19] 👥 Applying enhanced victim validation...\n2025-06-05 18:15:19,449 - INFO - 👥 Applying enhanced victim validation...\n[2025-06-05 18:15:19]    After victim validation: 0 articles (removed 0)\n2025-06-05 18:15:19,449 - INFO -    After victim validation: 0 articles (removed 0)\n[2025-06-05 18:15:19] ⭐ Calculating enhanced relevance scores...\n2025-06-05 18:15:19,449 - INFO - ⭐ Calculating enhanced relevance scores...\n[2025-06-05 18:15:19]    After relevance score filter (min 2): 0 articles (removed 0)\n2025-06-05 18:15:19,450 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)\n[2025-06-05 18:15:19] 🔄 Removing duplicates with enhanced logic...\n2025-06-05 18:15:19,450 - INFO - 🔄 Removing duplicates with enhanced logic...\n[2025-06-05 18:15:19] 🌦️ Enhanced climate event identification...\n2025-06-05 18:15:19,450 - INFO - 🌦️ Enhanced climate event identification...\n[2025-06-05 18:15:19] ⚠️ No articles remaining after enhanced filtering.\n2025-06-05 18:15:19,450 - WARNING - ⚠️ No articles remaining after enhanced filtering.\n[2025-06-05 18:15:19] ✅ Filtering completed. Found 0 articles with victims\n2025-06-05 18:15:19,450 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
