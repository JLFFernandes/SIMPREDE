{"timestamp":"2025-06-05T15:24:12.125678","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T15:24:12.127266","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T15:24:12.225770Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:12.226763Z","level":"info","event":"📁 Using paths from processar task: 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:12.233664Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/04', '/opt/airflow/data/structured/2025/06/04', '/opt/airflow/data/processed/2025/06/04']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:12.233978Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:12.234217Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:12.234437Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:12.234564Z","level":"info","event":"  - Target date: 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:12.234787Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:12.247592Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:12.249504Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:12.252641Z","level":"info","event":"✅ Found input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:12.252868Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:12.253036Z","level":"info","event":"  - victims_articles: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:12.253205Z","level":"info","event":"  - no_victims_articles: /opt/airflow/data/processed/2025/06/04/artigos_sem_vitimas_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:12.253348Z","level":"info","event":"  - filtering_log: /opt/airflow/data/processed/2025/06/04/filtering_log_20250604.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:12.253480Z","level":"info","event":"  - stats_json: /opt/airflow/data/processed/2025/06/04/filtering_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:12.253648Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json --output_dir /opt/airflow/data/processed/2025/06/04 --date_str 2025-06-04 --date 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:12.255175Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.508678Z","level":"info","event":"📋 [2025-06-05 16:24:15] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.509786Z","level":"info","event":"📋 2025-06-05 16:24:15,508 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.510428Z","level":"info","event":"📋 [2025-06-05 16:24:15] Parameters: dias=1, date=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.512315Z","level":"info","event":"📋 2025-06-05 16:24:15,508 - INFO - Parameters: dias=1, date=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.514513Z","level":"info","event":"📋 [2025-06-05 16:24:15] Paths: input_file=/opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json, output_dir=/opt/airflow/data/processed/2025/06/04, date_str=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.514643Z","level":"info","event":"📋 2025-06-05 16:24:15,509 - INFO - Paths: input_file=/opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json, output_dir=/opt/airflow/data/processed/2025/06/04, date_str=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.514735Z","level":"info","event":"📋 [2025-06-05 16:24:15] 🚀 Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.514817Z","level":"info","event":"📋 2025-06-05 16:24:15,509 - INFO - 🚀 Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.514912Z","level":"info","event":"📋 [2025-06-05 16:24:15] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.515005Z","level":"info","event":"📋 2025-06-05 16:24:15,509 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.515095Z","level":"info","event":"📋 [2025-06-05 16:24:15]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.515183Z","level":"info","event":"📋 2025-06-05 16:24:15,509 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.515278Z","level":"info","event":"📋 [2025-06-05 16:24:15]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.515368Z","level":"info","event":"📋 2025-06-05 16:24:15,509 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.515466Z","level":"info","event":"📋 [2025-06-05 16:24:15] 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.515564Z","level":"info","event":"📋 2025-06-05 16:24:15,509 - INFO - 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.515653Z","level":"info","event":"📋 [2025-06-05 16:24:15] 📁 Using provided input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.515742Z","level":"info","event":"📋 2025-06-05 16:24:15,509 - INFO - 📁 Using provided input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.515830Z","level":"info","event":"📋 [2025-06-05 16:24:15] 📂 Loading articles from: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.516426Z","level":"info","event":"📋 2025-06-05 16:24:15,509 - INFO - 📂 Loading articles from: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.516677Z","level":"info","event":"📋 [2025-06-05 16:24:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.516844Z","level":"info","event":"📋 2025-06-05 16:24:15,514 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.517212Z","level":"info","event":"📋 [2025-06-05 16:24:15] Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.517331Z","level":"info","event":"📋 2025-06-05 16:24:15,515 - INFO - Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.518661Z","level":"info","event":"📋 [2025-06-05 16:24:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.518786Z","level":"info","event":"📋 2025-06-05 16:24:15,515 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.519073Z","level":"info","event":"📋 [2025-06-05 16:24:15]   Total Articles Loaded: 10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.519182Z","level":"info","event":"📋 2025-06-05 16:24:15,515 - INFO -   Total Articles Loaded: 10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.521696Z","level":"info","event":"📋 [2025-06-05 16:24:15]   Input File: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.521771Z","level":"info","event":"📋 2025-06-05 16:24:15,515 - INFO -   Input File: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.521852Z","level":"info","event":"📋 [2025-06-05 16:24:15]   Output File: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.521932Z","level":"info","event":"📋 2025-06-05 16:24:15,516 - INFO -   Output File: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.522000Z","level":"info","event":"📋 [2025-06-05 16:24:15]   Processed Data Directory: /opt/airflow/data/processed/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.522068Z","level":"info","event":"📋 2025-06-05 16:24:15,516 - INFO -   Processed Data Directory: /opt/airflow/data/processed/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.522136Z","level":"info","event":"📋 [2025-06-05 16:24:15]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.522200Z","level":"info","event":"📋 2025-06-05 16:24:15,516 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.522269Z","level":"info","event":"📋 [2025-06-05 16:24:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.522335Z","level":"info","event":"📋 2025-06-05 16:24:15,516 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.522400Z","level":"info","event":"📋 [2025-06-05 16:24:15] 🔍 Applying comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.522467Z","level":"info","event":"📋 2025-06-05 16:24:15,516 - INFO - 🔍 Applying comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.522532Z","level":"info","event":"📋 [2025-06-05 16:24:15] 🔧 Loading configuration data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.522620Z","level":"info","event":"📋 2025-06-05 16:24:15,516 - INFO - 🔧 Loading configuration data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.522700Z","level":"info","event":"📋 [2025-06-05 16:24:15] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.522773Z","level":"info","event":"📋 2025-06-05 16:24:15,516 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.522851Z","level":"info","event":"📋 [2025-06-05 16:24:15]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.522917Z","level":"info","event":"📋 2025-06-05 16:24:15,516 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.523051Z","level":"info","event":"📋 [2025-06-05 16:24:15]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.523133Z","level":"info","event":"📋 2025-06-05 16:24:15,516 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.523196Z","level":"info","event":"📋 [2025-06-05 16:24:15]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.523261Z","level":"info","event":"📋 2025-06-05 16:24:15,516 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.523325Z","level":"info","event":"📋 [2025-06-05 16:24:15]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.523388Z","level":"info","event":"📋 2025-06-05 16:24:15,516 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.523510Z","level":"info","event":"📋 [2025-06-05 16:24:15] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.523608Z","level":"info","event":"📋 2025-06-05 16:24:15,516 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.523690Z","level":"info","event":"📋 [2025-06-05 16:24:15]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.523762Z","level":"info","event":"📋 2025-06-05 16:24:15,517 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.523826Z","level":"info","event":"📋 [2025-06-05 16:24:15]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.523890Z","level":"info","event":"📋 2025-06-05 16:24:15,517 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.523953Z","level":"info","event":"📋 [2025-06-05 16:24:15] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.524017Z","level":"info","event":"📋 2025-06-05 16:24:15,518 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.524093Z","level":"info","event":"📋 [2025-06-05 16:24:15] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.524159Z","level":"info","event":"📋 2025-06-05 16:24:15,519 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.524225Z","level":"info","event":"📋 [2025-06-05 16:24:15] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.524292Z","level":"info","event":"📋 2025-06-05 16:24:15,519 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.524365Z","level":"info","event":"📋 [2025-06-05 16:24:15] 📊 Starting comprehensive filtering with 10 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.524441Z","level":"info","event":"📋 2025-06-05 16:24:15,519 - INFO - 📊 Starting comprehensive filtering with 10 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.524507Z","level":"info","event":"📋 [2025-06-05 16:24:15] 🇵🇹 Applying national article filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.524581Z","level":"info","event":"📋 2025-06-05 16:24:15,520 - INFO - 🇵🇹 Applying national article filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.524691Z","level":"info","event":"📋 [2025-06-05 16:24:15]    After national filter: 0 articles (removed 10)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.524754Z","level":"info","event":"📋 2025-06-05 16:24:15,521 - INFO -    After national filter: 0 articles (removed 10)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.524818Z","level":"info","event":"📋 [2025-06-05 16:24:15] 🚫 Applying unwanted keywords filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.524882Z","level":"info","event":"📋 2025-06-05 16:24:15,521 - INFO - 🚫 Applying unwanted keywords filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.524945Z","level":"info","event":"📋 [2025-06-05 16:24:15]    After unwanted keywords filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.525014Z","level":"info","event":"📋 2025-06-05 16:24:15,521 - INFO -    After unwanted keywords filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.525082Z","level":"info","event":"📋 [2025-06-05 16:24:15] 📅 Applying year range filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.526603Z","level":"info","event":"📋 2025-06-05 16:24:15,522 - INFO - 📅 Applying year range filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.526766Z","level":"info","event":"📋 [2025-06-05 16:24:15]    After year filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.526846Z","level":"info","event":"📋 2025-06-05 16:24:15,525 - INFO -    After year filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.526920Z","level":"info","event":"📋 [2025-06-05 16:24:15] ⭐ Calculating relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.527001Z","level":"info","event":"📋 2025-06-05 16:24:15,525 - INFO - ⭐ Calculating relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.527083Z","level":"info","event":"📋 [2025-06-05 16:24:15] 🎯 Applying relevance and victim filters...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.527155Z","level":"info","event":"📋 2025-06-05 16:24:15,525 - INFO - 🎯 Applying relevance and victim filters...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.527227Z","level":"info","event":"📋 [2025-06-05 16:24:15]    After relevance/victim filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.527301Z","level":"info","event":"📋 2025-06-05 16:24:15,526 - INFO -    After relevance/victim filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.527679Z","level":"info","event":"📋 [2025-06-05 16:24:15] 🌦️ Identifying climate events...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.527765Z","level":"info","event":"📋 2025-06-05 16:24:15,527 - INFO - 🌦️ Identifying climate events...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.528068Z","level":"info","event":"📋 [2025-06-05 16:24:15] 🔄 Removing event-based duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.528156Z","level":"info","event":"📋 2025-06-05 16:24:15,528 - INFO - 🔄 Removing event-based duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.528367Z","level":"info","event":"📋 [2025-06-05 16:24:15]    After event deduplication: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.528446Z","level":"info","event":"📋 2025-06-05 16:24:15,528 - INFO -    After event deduplication: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.528608Z","level":"info","event":"📋 [2025-06-05 16:24:15] ⚠️ No articles remaining after comprehensive filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.528907Z","level":"info","event":"📋 2025-06-05 16:24:15,528 - WARNING - ⚠️ No articles remaining after comprehensive filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.529068Z","level":"info","event":"📋 [2025-06-05 16:24:15] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.529176Z","level":"info","event":"📋 2025-06-05 16:24:15,528 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.669000Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.669819Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.670082Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_20250604.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.670257Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/data/processed/2025/06/04/artigos_sem_vitimas_20250604.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.670401Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/data/processed/2025/06/04/filtering_log_20250604.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.670594Z","level":"info","event":"⚠️ stats_json: /opt/airflow/data/processed/2025/06/04/filtering_stats_20250604.json (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:24:15.671698","level":"info","event":"Done. Returned value was: [2025-06-05 16:24:15] Starting filtrar_artigos_vitimas_airflow\n2025-06-05 16:24:15,508 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 16:24:15] Parameters: dias=1, date=2025-06-04\n2025-06-05 16:24:15,508 - INFO - Parameters: dias=1, date=2025-06-04\n[2025-06-05 16:24:15] Paths: input_file=/opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json, output_dir=/opt/airflow/data/processed/2025/06/04, date_str=2025-06-04\n2025-06-05 16:24:15,509 - INFO - Paths: input_file=/opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json, output_dir=/opt/airflow/data/processed/2025/06/04, date_str=2025-06-04\n[2025-06-05 16:24:15] 🚀 Starting filtrar_artigos_vitimas_airflow\n2025-06-05 16:24:15,509 - INFO - 🚀 Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 16:24:15] 🔍 Path setup:\n2025-06-05 16:24:15,509 - INFO - 🔍 Path setup:\n[2025-06-05 16:24:15]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-05 16:24:15,509 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-05 16:24:15]    Project root: /opt/airflow\n2025-06-05 16:24:15,509 - INFO -    Project root: /opt/airflow\n[2025-06-05 16:24:15] 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/04\n2025-06-05 16:24:15,509 - INFO - 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/04\n[2025-06-05 16:24:15] 📁 Using provided input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:24:15,509 - INFO - 📁 Using provided input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:24:15] 📂 Loading articles from: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:24:15,509 - INFO - 📂 Loading articles from: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:24:15] ==================================================\n2025-06-05 16:24:15,514 - INFO - ==================================================\n[2025-06-05 16:24:15] Filtering Started\n2025-06-05 16:24:15,515 - INFO - Filtering Started\n[2025-06-05 16:24:15] ==================================================\n2025-06-05 16:24:15,515 - INFO - ==================================================\n[2025-06-05 16:24:15]   Total Articles Loaded: 10\n2025-06-05 16:24:15,515 - INFO -   Total Articles Loaded: 10\n[2025-06-05 16:24:15]   Input File: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:24:15,515 - INFO -   Input File: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:24:15]   Output File: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_2025-06-04.csv\n2025-06-05 16:24:15,516 - INFO -   Output File: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_2025-06-04.csv\n[2025-06-05 16:24:15]   Processed Data Directory: /opt/airflow/data/processed/2025/06/04\n2025-06-05 16:24:15,516 - INFO -   Processed Data Directory: /opt/airflow/data/processed/2025/06/04\n[2025-06-05 16:24:15]   Days Filter: 1\n2025-06-05 16:24:15,516 - INFO -   Days Filter: 1\n[2025-06-05 16:24:15] ==================================================\n2025-06-05 16:24:15,516 - INFO - ==================================================\n[2025-06-05 16:24:15] 🔍 Applying comprehensive filtering logic...\n2025-06-05 16:24:15,516 - INFO - 🔍 Applying comprehensive filtering logic...\n[2025-06-05 16:24:15] 🔧 Loading configuration data...\n2025-06-05 16:24:15,516 - INFO - 🔧 Loading configuration data...\n[2025-06-05 16:24:15] 🔍 Looking for config files in multiple paths:\n2025-06-05 16:24:15,516 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-05 16:24:15]    Checking: /opt/airflow/config\n2025-06-05 16:24:15,516 - INFO -    Checking: /opt/airflow/config\n[2025-06-05 16:24:15]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-05 16:24:15,516 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-05 16:24:15]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-05 16:24:15,516 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 16:24:15]    Checking: config\n2025-06-05 16:24:15,516 - INFO -    Checking: config\n[2025-06-05 16:24:15] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-05 16:24:15,516 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 16:24:15]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-05 16:24:15,517 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-05 16:24:15]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-05 16:24:15,517 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-05 16:24:15] ✅ Loaded municipios config with 29 districts\n2025-06-05 16:24:15,518 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-05 16:24:15] ✅ Loaded eventos config with 14 events\n2025-06-05 16:24:15,519 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-05 16:24:15] 📊 Config summary: 29 districts, 306 parishes\n2025-06-05 16:24:15,519 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-05 16:24:15] 📊 Starting comprehensive filtering with 10 articles\n2025-06-05 16:24:15,519 - INFO - 📊 Starting comprehensive filtering with 10 articles\n[2025-06-05 16:24:15] 🇵🇹 Applying national article filter...\n2025-06-05 16:24:15,520 - INFO - 🇵🇹 Applying national article filter...\n[2025-06-05 16:24:15]    After national filter: 0 articles (removed 10)\n2025-06-05 16:24:15,521 - INFO -    After national filter: 0 articles (removed 10)\n[2025-06-05 16:24:15] 🚫 Applying unwanted keywords filter...\n2025-06-05 16:24:15,521 - INFO - 🚫 Applying unwanted keywords filter...\n[2025-06-05 16:24:15]    After unwanted keywords filter: 0 articles (removed 0)\n2025-06-05 16:24:15,521 - INFO -    After unwanted keywords filter: 0 articles (removed 0)\n[2025-06-05 16:24:15] 📅 Applying year range filter...\n2025-06-05 16:24:15,522 - INFO - 📅 Applying year range filter...\n[2025-06-05 16:24:15]    After year filter: 0 articles (removed 0)\n2025-06-05 16:24:15,525 - INFO -    After year filter: 0 articles (removed 0)\n[2025-06-05 16:24:15] ⭐ Calculating relevance scores...\n2025-06-05 16:24:15,525 - INFO - ⭐ Calculating relevance scores...\n[2025-06-05 16:24:15] 🎯 Applying relevance and victim filters...\n2025-06-05 16:24:15,525 - INFO - 🎯 Applying relevance and victim filters...\n[2025-06-05 16:24:15]    After relevance/victim filter: 0 articles (removed 0)\n2025-06-05 16:24:15,526 - INFO -    After relevance/victim filter: 0 articles (removed 0)\n[2025-06-05 16:24:15] 🌦️ Identifying climate events...\n2025-06-05 16:24:15,527 - INFO - 🌦️ Identifying climate events...\n[2025-06-05 16:24:15] 🔄 Removing event-based duplicates...\n2025-06-05 16:24:15,528 - INFO - 🔄 Removing event-based duplicates...\n[2025-06-05 16:24:15]    After event deduplication: 0 articles (removed 0)\n2025-06-05 16:24:15,528 - INFO -    After event deduplication: 0 articles (removed 0)\n[2025-06-05 16:24:15] ⚠️ No articles remaining after comprehensive filtering.\n2025-06-05 16:24:15,528 - WARNING - ⚠️ No articles remaining after comprehensive filtering.\n[2025-06-05 16:24:15] ✅ Filtering completed. Found 0 articles with victims\n2025-06-05 16:24:15,528 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-05T16:11:13.723466","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T16:11:13.724159","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T16:11:13.799423Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:13.802175Z","level":"info","event":"📁 Using paths from processar task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:13.803480Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:13.803912Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:13.804062Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:13.804131Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:13.804197Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:13.804257Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:13.804317Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:13.808147Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:13.808280Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:13.808373Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:13.808938Z","level":"info","event":"  - victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:13.809156Z","level":"info","event":"  - no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:13.809243Z","level":"info","event":"  - filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:13.809356Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:13.809448Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:13.809576Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.007216Z","level":"info","event":"📋 [2025-06-05 17:11:15] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.007571Z","level":"info","event":"📋 2025-06-05 17:11:15,006 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.007793Z","level":"info","event":"📋 [2025-06-05 17:11:15] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.007875Z","level":"info","event":"📋 2025-06-05 17:11:15,006 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.007932Z","level":"info","event":"📋 [2025-06-05 17:11:15] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.009018Z","level":"info","event":"📋 2025-06-05 17:11:15,006 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.009095Z","level":"info","event":"📋 [2025-06-05 17:11:15] 🚀 Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.009176Z","level":"info","event":"📋 2025-06-05 17:11:15,006 - INFO - 🚀 Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.009230Z","level":"info","event":"📋 [2025-06-05 17:11:15] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.009278Z","level":"info","event":"📋 2025-06-05 17:11:15,006 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.009342Z","level":"info","event":"📋 [2025-06-05 17:11:15]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.009407Z","level":"info","event":"📋 2025-06-05 17:11:15,006 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.009463Z","level":"info","event":"📋 [2025-06-05 17:11:15]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.009512Z","level":"info","event":"📋 2025-06-05 17:11:15,006 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.009562Z","level":"info","event":"📋 [2025-06-05 17:11:15] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.009649Z","level":"info","event":"📋 2025-06-05 17:11:15,006 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.009751Z","level":"info","event":"📋 [2025-06-05 17:11:15] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.009808Z","level":"info","event":"📋 2025-06-05 17:11:15,007 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.009856Z","level":"info","event":"📋 [2025-06-05 17:11:15] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.009906Z","level":"info","event":"📋 2025-06-05 17:11:15,007 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.009963Z","level":"info","event":"📋 [2025-06-05 17:11:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.010010Z","level":"info","event":"📋 2025-06-05 17:11:15,009 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.010060Z","level":"info","event":"📋 [2025-06-05 17:11:15] Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.010128Z","level":"info","event":"📋 2025-06-05 17:11:15,009 - INFO - Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.010201Z","level":"info","event":"📋 [2025-06-05 17:11:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.010258Z","level":"info","event":"📋 2025-06-05 17:11:15,009 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.010336Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Total Articles Loaded: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.010412Z","level":"info","event":"📋 2025-06-05 17:11:15,009 - INFO -   Total Articles Loaded: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.010492Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.010564Z","level":"info","event":"📋 2025-06-05 17:11:15,009 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.010622Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.010679Z","level":"info","event":"📋 2025-06-05 17:11:15,010 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.011014Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.011158Z","level":"info","event":"📋 2025-06-05 17:11:15,010 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.011283Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.011423Z","level":"info","event":"📋 2025-06-05 17:11:15,010 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.011518Z","level":"info","event":"📋 [2025-06-05 17:11:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.011597Z","level":"info","event":"📋 2025-06-05 17:11:15,010 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.012078Z","level":"info","event":"📋 [2025-06-05 17:11:15] 🔍 Applying comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.012145Z","level":"info","event":"📋 2025-06-05 17:11:15,010 - INFO - 🔍 Applying comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.012199Z","level":"info","event":"📋 [2025-06-05 17:11:15] 🔧 Loading configuration data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.012247Z","level":"info","event":"📋 2025-06-05 17:11:15,010 - INFO - 🔧 Loading configuration data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.012285Z","level":"info","event":"📋 [2025-06-05 17:11:15] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.012333Z","level":"info","event":"📋 2025-06-05 17:11:15,010 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.012392Z","level":"info","event":"📋 [2025-06-05 17:11:15]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.012440Z","level":"info","event":"📋 2025-06-05 17:11:15,010 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.012493Z","level":"info","event":"📋 [2025-06-05 17:11:15]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.012567Z","level":"info","event":"📋 2025-06-05 17:11:15,010 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.012779Z","level":"info","event":"📋 [2025-06-05 17:11:15]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.015152Z","level":"info","event":"📋 2025-06-05 17:11:15,010 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018134Z","level":"info","event":"📋 [2025-06-05 17:11:15]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018204Z","level":"info","event":"📋 2025-06-05 17:11:15,010 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018316Z","level":"info","event":"📋 [2025-06-05 17:11:15] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018366Z","level":"info","event":"📋 2025-06-05 17:11:15,011 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018420Z","level":"info","event":"📋 [2025-06-05 17:11:15]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018460Z","level":"info","event":"📋 2025-06-05 17:11:15,011 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018527Z","level":"info","event":"📋 [2025-06-05 17:11:15]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018572Z","level":"info","event":"📋 2025-06-05 17:11:15,011 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018618Z","level":"info","event":"📋 [2025-06-05 17:11:15] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018667Z","level":"info","event":"📋 2025-06-05 17:11:15,012 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018707Z","level":"info","event":"📋 [2025-06-05 17:11:15] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018745Z","level":"info","event":"📋 2025-06-05 17:11:15,012 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018785Z","level":"info","event":"📋 [2025-06-05 17:11:15] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018824Z","level":"info","event":"📋 2025-06-05 17:11:15,012 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018870Z","level":"info","event":"📋 [2025-06-05 17:11:15] 📊 Starting comprehensive filtering with 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018912Z","level":"info","event":"📋 2025-06-05 17:11:15,012 - INFO - 📊 Starting comprehensive filtering with 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018951Z","level":"info","event":"📋 [2025-06-05 17:11:15] 🇵🇹 Applying national article filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.018990Z","level":"info","event":"📋 2025-06-05 17:11:15,013 - INFO - 🇵🇹 Applying national article filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019031Z","level":"info","event":"📋 [2025-06-05 17:11:15]    After national filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019064Z","level":"info","event":"📋 2025-06-05 17:11:15,014 - INFO -    After national filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019098Z","level":"info","event":"📋 [2025-06-05 17:11:15] 🚫 Applying unwanted keywords filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019154Z","level":"info","event":"📋 2025-06-05 17:11:15,014 - INFO - 🚫 Applying unwanted keywords filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019198Z","level":"info","event":"📋 [2025-06-05 17:11:15]    After unwanted keywords filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019233Z","level":"info","event":"📋 2025-06-05 17:11:15,015 - INFO -    After unwanted keywords filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019268Z","level":"info","event":"📋 [2025-06-05 17:11:15] 📅 Applying year range filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019302Z","level":"info","event":"📋 2025-06-05 17:11:15,015 - INFO - 📅 Applying year range filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019337Z","level":"info","event":"📋 [2025-06-05 17:11:15]    After year filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019373Z","level":"info","event":"📋 2025-06-05 17:11:15,015 - INFO -    After year filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019450Z","level":"info","event":"📋 [2025-06-05 17:11:15] ⭐ Calculating relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019497Z","level":"info","event":"📋 2025-06-05 17:11:15,015 - INFO - ⭐ Calculating relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019538Z","level":"info","event":"📋 [2025-06-05 17:11:15] 🎯 Applying relevance and victim filters...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019583Z","level":"info","event":"📋 2025-06-05 17:11:15,016 - INFO - 🎯 Applying relevance and victim filters...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019638Z","level":"info","event":"📋 [2025-06-05 17:11:15]    After relevance/victim filter: 1 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019687Z","level":"info","event":"📋 2025-06-05 17:11:15,016 - INFO -    After relevance/victim filter: 1 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019737Z","level":"info","event":"📋 [2025-06-05 17:11:15] 🔄 Removing URL duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019782Z","level":"info","event":"📋 2025-06-05 17:11:15,017 - INFO - 🔄 Removing URL duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019829Z","level":"info","event":"📋 [2025-06-05 17:11:15]    After URL deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019869Z","level":"info","event":"📋 2025-06-05 17:11:15,017 - INFO -    After URL deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019908Z","level":"info","event":"📋 [2025-06-05 17:11:15] 🌦️ Identifying climate events...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019943Z","level":"info","event":"📋 2025-06-05 17:11:15,017 - INFO - 🌦️ Identifying climate events...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.019978Z","level":"info","event":"📋 [2025-06-05 17:11:15] 🔄 Removing event-based duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.020013Z","level":"info","event":"📋 2025-06-05 17:11:15,018 - INFO - 🔄 Removing event-based duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.020674Z","level":"info","event":"📋 [2025-06-05 17:11:15]    After event deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.020749Z","level":"info","event":"📋 2025-06-05 17:11:15,020 - INFO -    After event deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.023536Z","level":"info","event":"📋 [2025-06-05 17:11:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.023796Z","level":"info","event":"📋 2025-06-05 17:11:15,023 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.023849Z","level":"info","event":"📋 [2025-06-05 17:11:15] Comprehensive Filtering Results","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.023894Z","level":"info","event":"📋 2025-06-05 17:11:15,023 - INFO - Comprehensive Filtering Results","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.023934Z","level":"info","event":"📋 [2025-06-05 17:11:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.023981Z","level":"info","event":"📋 2025-06-05 17:11:15,023 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.024059Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Articles After All Filters: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.024208Z","level":"info","event":"📋 2025-06-05 17:11:15,023 - INFO -   Articles After All Filters: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.024404Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Articles with Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.024452Z","level":"info","event":"📋 2025-06-05 17:11:15,023 - INFO -   Articles with Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.024588Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Articles without Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.024998Z","level":"info","event":"📋 2025-06-05 17:11:15,023 - INFO -   Articles without Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.025067Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Total Fatalities: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.025158Z","level":"info","event":"📋 2025-06-05 17:11:15,023 - INFO -   Total Fatalities: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.025245Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Total Injured: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.027929Z","level":"info","event":"📋 2025-06-05 17:11:15,023 - INFO -   Total Injured: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.028167Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Total Evacuated: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.028259Z","level":"info","event":"📋 2025-06-05 17:11:15,023 - INFO -   Total Evacuated: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.029152Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Total Displaced: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.030395Z","level":"info","event":"📋 2025-06-05 17:11:15,023 - INFO -   Total Displaced: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.030757Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Total Missing: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.031138Z","level":"info","event":"📋 2025-06-05 17:11:15,023 - INFO -   Total Missing: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.032623Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Average Relevance Score: 1.00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035139Z","level":"info","event":"📋 2025-06-05 17:11:15,023 - INFO -   Average Relevance Score: 1.00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035210Z","level":"info","event":"📋 [2025-06-05 17:11:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035253Z","level":"info","event":"📋 2025-06-05 17:11:15,023 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035289Z","level":"info","event":"📋 [2025-06-05 17:11:15] 💾 Saving comprehensively filtered articles...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035325Z","level":"info","event":"📋 2025-06-05 17:11:15,023 - INFO - 💾 Saving comprehensively filtered articles...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035359Z","level":"info","event":"📋 📥 Novos artigos recebidos: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035438Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035476Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035510Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035573Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035607Z","level":"info","event":"📋 [2025-06-05 17:11:15] ✅ Articles without victims saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035641Z","level":"info","event":"📋 2025-06-05 17:11:15,024 - INFO - ✅ Articles without victims saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035674Z","level":"info","event":"📋 [2025-06-05 17:11:15] ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035709Z","level":"info","event":"📋 2025-06-05 17:11:15,025 - INFO - ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035760Z","level":"info","event":"📋 [2025-06-05 17:11:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035807Z","level":"info","event":"📋 2025-06-05 17:11:15,025 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035854Z","level":"info","event":"📋 [2025-06-05 17:11:15] Comprehensive Filtering Completed Successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035897Z","level":"info","event":"📋 2025-06-05 17:11:15,025 - INFO - Comprehensive Filtering Completed Successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035940Z","level":"info","event":"📋 [2025-06-05 17:11:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.035985Z","level":"info","event":"📋 2025-06-05 17:11:15,025 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.036031Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Articles with Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.036077Z","level":"info","event":"📋 2025-06-05 17:11:15,025 - INFO -   Articles with Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.036134Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Articles without Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.036183Z","level":"info","event":"📋 2025-06-05 17:11:15,025 - INFO -   Articles without Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.036232Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Total Articles Processed: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.036278Z","level":"info","event":"📋 2025-06-05 17:11:15,025 - INFO -   Total Articles Processed: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.036323Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Filter Rate: 25.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.036362Z","level":"info","event":"📋 2025-06-05 17:11:15,025 - INFO -   Filter Rate: 25.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.036415Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Victim Rate: 0.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.036466Z","level":"info","event":"📋 2025-06-05 17:11:15,025 - INFO -   Victim Rate: 0.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.036515Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.036560Z","level":"info","event":"📋 2025-06-05 17:11:15,025 - INFO -   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.036654Z","level":"info","event":"📋 [2025-06-05 17:11:15]   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.036703Z","level":"info","event":"📋 2025-06-05 17:11:15,025 - INFO -   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.036748Z","level":"info","event":"📋 [2025-06-05 17:11:15] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.037336Z","level":"info","event":"📋 2025-06-05 17:11:15,025 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.039128Z","level":"info","event":"📋 [2025-06-05 17:11:15] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.039202Z","level":"info","event":"📋 2025-06-05 17:11:15,025 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.115346Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.115536Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.115657Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.115749Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.115853Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.115919Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json (512 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:11:15.116248","level":"info","event":"Done. Returned value was: [2025-06-05 17:11:15] Starting filtrar_artigos_vitimas_airflow\n2025-06-05 17:11:15,006 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 17:11:15] Parameters: dias=1, date=2025-06-05\n2025-06-05 17:11:15,006 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 17:11:15] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n2025-06-05 17:11:15,006 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n[2025-06-05 17:11:15] 🚀 Starting filtrar_artigos_vitimas_airflow\n2025-06-05 17:11:15,006 - INFO - 🚀 Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 17:11:15] 🔍 Path setup:\n2025-06-05 17:11:15,006 - INFO - 🔍 Path setup:\n[2025-06-05 17:11:15]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-05 17:11:15,006 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-05 17:11:15]    Project root: /opt/airflow\n2025-06-05 17:11:15,006 - INFO -    Project root: /opt/airflow\n[2025-06-05 17:11:15] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 17:11:15,006 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 17:11:15] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 17:11:15,007 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 17:11:15] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 17:11:15,007 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 17:11:15] ==================================================\n2025-06-05 17:11:15,009 - INFO - ==================================================\n[2025-06-05 17:11:15] Filtering Started\n2025-06-05 17:11:15,009 - INFO - Filtering Started\n[2025-06-05 17:11:15] ==================================================\n2025-06-05 17:11:15,009 - INFO - ==================================================\n[2025-06-05 17:11:15]   Total Articles Loaded: 4\n2025-06-05 17:11:15,009 - INFO -   Total Articles Loaded: 4\n[2025-06-05 17:11:15]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 17:11:15,009 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 17:11:15]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 17:11:15,010 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 17:11:15]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 17:11:15,010 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 17:11:15]   Days Filter: 1\n2025-06-05 17:11:15,010 - INFO -   Days Filter: 1\n[2025-06-05 17:11:15] ==================================================\n2025-06-05 17:11:15,010 - INFO - ==================================================\n[2025-06-05 17:11:15] 🔍 Applying comprehensive filtering logic...\n2025-06-05 17:11:15,010 - INFO - 🔍 Applying comprehensive filtering logic...\n[2025-06-05 17:11:15] 🔧 Loading configuration data...\n2025-06-05 17:11:15,010 - INFO - 🔧 Loading configuration data...\n[2025-06-05 17:11:15] 🔍 Looking for config files in multiple paths:\n2025-06-05 17:11:15,010 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-05 17:11:15]    Checking: /opt/airflow/config\n2025-06-05 17:11:15,010 - INFO -    Checking: /opt/airflow/config\n[2025-06-05 17:11:15]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-05 17:11:15,010 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-05 17:11:15]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-05 17:11:15,010 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 17:11:15]    Checking: config\n2025-06-05 17:11:15,010 - INFO -    Checking: config\n[2025-06-05 17:11:15] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-05 17:11:15,011 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 17:11:15]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-05 17:11:15,011 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-05 17:11:15]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-05 17:11:15,011 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-05 17:11:15] ✅ Loaded municipios config with 29 districts\n2025-06-05 17:11:15,012 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-05 17:11:15] ✅ Loaded eventos config with 14 events\n2025-06-05 17:11:15,012 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-05 17:11:15] 📊 Config summary: 29 districts, 306 parishes\n2025-06-05 17:11:15,012 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-05 17:11:15] 📊 Starting comprehensive filtering with 4 articles\n2025-06-05 17:11:15,012 - INFO - 📊 Starting comprehensive filtering with 4 articles\n[2025-06-05 17:11:15] 🇵🇹 Applying national article filter...\n2025-06-05 17:11:15,013 - INFO - 🇵🇹 Applying national article filter...\n[2025-06-05 17:11:15]    After national filter: 4 articles (removed 0)\n2025-06-05 17:11:15,014 - INFO -    After national filter: 4 articles (removed 0)\n[2025-06-05 17:11:15] 🚫 Applying unwanted keywords filter...\n2025-06-05 17:11:15,014 - INFO - 🚫 Applying unwanted keywords filter...\n[2025-06-05 17:11:15]    After unwanted keywords filter: 4 articles (removed 0)\n2025-06-05 17:11:15,015 - INFO -    After unwanted keywords filter: 4 articles (removed 0)\n[2025-06-05 17:11:15] 📅 Applying year range filter...\n2025-06-05 17:11:15,015 - INFO - 📅 Applying year range filter...\n[2025-06-05 17:11:15]    After year filter: 4 articles (removed 0)\n2025-06-05 17:11:15,015 - INFO -    After year filter: 4 articles (removed 0)\n[2025-06-05 17:11:15] ⭐ Calculating relevance scores...\n2025-06-05 17:11:15,015 - INFO - ⭐ Calculating relevance scores...\n[2025-06-05 17:11:15] 🎯 Applying relevance and victim filters...\n2025-06-05 17:11:15,016 - INFO - 🎯 Applying relevance and victim filters...\n[2025-06-05 17:11:15]    After relevance/victim filter: 1 articles (removed 3)\n2025-06-05 17:11:15,016 - INFO -    After relevance/victim filter: 1 articles (removed 3)\n[2025-06-05 17:11:15] 🔄 Removing URL duplicates...\n2025-06-05 17:11:15,017 - INFO - 🔄 Removing URL duplicates...\n[2025-06-05 17:11:15]    After URL deduplication: 1 articles (removed 0)\n2025-06-05 17:11:15,017 - INFO -    After URL deduplication: 1 articles (removed 0)\n[2025-06-05 17:11:15] 🌦️ Identifying climate events...\n2025-06-05 17:11:15,017 - INFO - 🌦️ Identifying climate events...\n[2025-06-05 17:11:15] 🔄 Removing event-based duplicates...\n2025-06-05 17:11:15,018 - INFO - 🔄 Removing event-based duplicates...\n[2025-06-05 17:11:15]    After event deduplication: 1 articles (removed 0)\n2025-06-05 17:11:15,020 - INFO -    After event deduplication: 1 articles (removed 0)\n[2025-06-05 17:11:15] ==================================================\n2025-06-05 17:11:15,023 - INFO - ==================================================\n[2025-06-05 17:11:15] Comprehensive Filtering Results\n2025-06-05 17:11:15,023 - INFO - Comprehensive Filtering Results\n[2025-06-05 17:11:15] ==================================================\n2025-06-05 17:11:15,023 - INFO - ==================================================\n[2025-06-05 17:11:15]   Articles After All Filters: 1\n2025-06-05 17:11:15,023 - INFO -   Articles After All Filters: 1\n[2025-06-05 17:11:15]   Articles with Victims: 0\n2025-06-05 17:11:15,023 - INFO -   Articles with Victims: 0\n[2025-06-05 17:11:15]   Articles without Victims: 1\n2025-06-05 17:11:15,023 - INFO -   Articles without Victims: 1\n[2025-06-05 17:11:15]   Total Fatalities: 0\n2025-06-05 17:11:15,023 - INFO -   Total Fatalities: 0\n[2025-06-05 17:11:15]   Total Injured: 0\n2025-06-05 17:11:15,023 - INFO -   Total Injured: 0\n[2025-06-05 17:11:15]   Total Evacuated: 0\n2025-06-05 17:11:15,023 - INFO -   Total Evacuated: 0\n[2025-06-05 17:11:15]   Total Displaced: 0\n2025-06-05 17:11:15,023 - INFO -   Total Displaced: 0\n[2025-06-05 17:11:15]   Total Missing: 0\n2025-06-05 17:11:15,023 - INFO -   Total Missing: 0\n[2025-06-05 17:11:15]   Average Relevance Score: 1.00\n2025-06-05 17:11:15,023 - INFO -   Average Relevance Score: 1.00\n[2025-06-05 17:11:15] ==================================================\n2025-06-05 17:11:15,023 - INFO - ==================================================\n[2025-06-05 17:11:15] 💾 Saving comprehensively filtered articles...\n2025-06-05 17:11:15,023 - INFO - 💾 Saving comprehensively filtered articles...\n📥 Novos artigos recebidos: 1\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_2025-06-05.csv\n📂 IDs existentes no arquivo: 1\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-05 17:11:15] ✅ Articles without victims saved: 1 articles\n2025-06-05 17:11:15,024 - INFO - ✅ Articles without victims saved: 1 articles\n[2025-06-05 17:11:15] ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n2025-06-05 17:11:15,025 - INFO - ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n[2025-06-05 17:11:15] ==================================================\n2025-06-05 17:11:15,025 - INFO - ==================================================\n[2025-06-05 17:11:15] Comprehensive Filtering Completed Successfully\n2025-06-05 17:11:15,025 - INFO - Comprehensive Filtering Completed Successfully\n[2025-06-05 17:11:15] ==================================================\n2025-06-05 17:11:15,025 - INFO - ==================================================\n[2025-06-05 17:11:15]   Articles with Victims: 0\n2025-06-05 17:11:15,025 - INFO -   Articles with Victims: 0\n[2025-06-05 17:11:15]   Articles without Victims: 1\n2025-06-05 17:11:15,025 - INFO -   Articles without Victims: 1\n[2025-06-05 17:11:15]   Total Articles Processed: 1\n2025-06-05 17:11:15,025 - INFO -   Total Articles Processed: 1\n[2025-06-05 17:11:15]   Filter Rate: 25.0%\n2025-06-05 17:11:15,025 - INFO -   Filter Rate: 25.0%\n[2025-06-05 17:11:15]   Victim Rate: 0.0%\n2025-06-05 17:11:15,025 - INFO -   Victim Rate: 0.0%\n[2025-06-05 17:11:15]   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 17:11:15,025 - INFO -   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 17:11:15]   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n2025-06-05 17:11:15,025 - INFO -   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n[2025-06-05 17:11:15] ==================================================\n2025-06-05 17:11:15,025 - INFO - ==================================================\n[2025-06-05 17:11:15] ✅ Filtering completed. Found 0 articles with victims\n2025-06-05 17:11:15,025 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
