{"timestamp":"2025-06-05T15:33:04.875592","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T15:33:04.876668","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T15:33:04.937383Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:04.940203Z","level":"info","event":"📁 Using paths from processar task: 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:04.941421Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/04', '/opt/airflow/data/structured/2025/06/04', '/opt/airflow/data/processed/2025/06/04']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:04.941565Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:04.941638Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:04.941712Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:04.941758Z","level":"info","event":"  - Target date: 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:04.941825Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:04.945667Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:04.946364Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:04.946460Z","level":"info","event":"✅ Found input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:04.946565Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:04.946987Z","level":"info","event":"  - victims_articles: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:04.947073Z","level":"info","event":"  - no_victims_articles: /opt/airflow/data/processed/2025/06/04/artigos_sem_vitimas_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:04.947194Z","level":"info","event":"  - filtering_log: /opt/airflow/data/processed/2025/06/04/filtering_log_20250604.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:04.947268Z","level":"info","event":"  - stats_json: /opt/airflow/data/processed/2025/06/04/filtering_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:04.947356Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json --output_dir /opt/airflow/data/processed/2025/06/04 --date_str 2025-06-04 --date 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:04.947529Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.314209Z","level":"info","event":"📋 [2025-06-05 16:33:06] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.314831Z","level":"info","event":"📋 2025-06-05 16:33:06,314 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.315379Z","level":"info","event":"📋 [2025-06-05 16:33:06] Parameters: dias=1, date=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.315511Z","level":"info","event":"📋 2025-06-05 16:33:06,314 - INFO - Parameters: dias=1, date=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.315571Z","level":"info","event":"📋 [2025-06-05 16:33:06] Paths: input_file=/opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json, output_dir=/opt/airflow/data/processed/2025/06/04, date_str=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.315632Z","level":"info","event":"📋 2025-06-05 16:33:06,314 - INFO - Paths: input_file=/opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json, output_dir=/opt/airflow/data/processed/2025/06/04, date_str=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.315695Z","level":"info","event":"📋 [2025-06-05 16:33:06] 🚀 Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.315754Z","level":"info","event":"📋 2025-06-05 16:33:06,314 - INFO - 🚀 Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.315811Z","level":"info","event":"📋 [2025-06-05 16:33:06] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.315863Z","level":"info","event":"📋 2025-06-05 16:33:06,314 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.315921Z","level":"info","event":"📋 [2025-06-05 16:33:06]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.316032Z","level":"info","event":"📋 2025-06-05 16:33:06,314 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.316931Z","level":"info","event":"📋 [2025-06-05 16:33:06]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.316991Z","level":"info","event":"📋 2025-06-05 16:33:06,314 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.317052Z","level":"info","event":"📋 [2025-06-05 16:33:06] 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.317112Z","level":"info","event":"📋 2025-06-05 16:33:06,314 - INFO - 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.317172Z","level":"info","event":"📋 [2025-06-05 16:33:06] 📁 Using provided input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.317225Z","level":"info","event":"📋 2025-06-05 16:33:06,314 - INFO - 📁 Using provided input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.317272Z","level":"info","event":"📋 [2025-06-05 16:33:06] 📂 Loading articles from: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.317321Z","level":"info","event":"📋 2025-06-05 16:33:06,314 - INFO - 📂 Loading articles from: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.317397Z","level":"info","event":"📋 [2025-06-05 16:33:06] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.317453Z","level":"info","event":"📋 2025-06-05 16:33:06,317 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.317512Z","level":"info","event":"📋 [2025-06-05 16:33:06] Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.317608Z","level":"info","event":"📋 2025-06-05 16:33:06,317 - INFO - Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.317702Z","level":"info","event":"📋 [2025-06-05 16:33:06] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.317749Z","level":"info","event":"📋 2025-06-05 16:33:06,317 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.317812Z","level":"info","event":"📋 [2025-06-05 16:33:06]   Total Articles Loaded: 10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.317876Z","level":"info","event":"📋 2025-06-05 16:33:06,317 - INFO -   Total Articles Loaded: 10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.317930Z","level":"info","event":"📋 [2025-06-05 16:33:06]   Input File: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.317996Z","level":"info","event":"📋 2025-06-05 16:33:06,317 - INFO -   Input File: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.318053Z","level":"info","event":"📋 [2025-06-05 16:33:06]   Output File: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.318116Z","level":"info","event":"📋 2025-06-05 16:33:06,317 - INFO -   Output File: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.318179Z","level":"info","event":"📋 [2025-06-05 16:33:06]   Processed Data Directory: /opt/airflow/data/processed/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.318242Z","level":"info","event":"📋 2025-06-05 16:33:06,318 - INFO -   Processed Data Directory: /opt/airflow/data/processed/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.318342Z","level":"info","event":"📋 [2025-06-05 16:33:06]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.318552Z","level":"info","event":"📋 2025-06-05 16:33:06,318 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.318635Z","level":"info","event":"📋 [2025-06-05 16:33:06] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.318695Z","level":"info","event":"📋 2025-06-05 16:33:06,318 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.318767Z","level":"info","event":"📋 [2025-06-05 16:33:06] 🔍 Applying comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.319242Z","level":"info","event":"📋 2025-06-05 16:33:06,318 - INFO - 🔍 Applying comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.319308Z","level":"info","event":"📋 [2025-06-05 16:33:06] 🔧 Loading configuration data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.319347Z","level":"info","event":"📋 2025-06-05 16:33:06,318 - INFO - 🔧 Loading configuration data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.319388Z","level":"info","event":"📋 [2025-06-05 16:33:06] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.319436Z","level":"info","event":"📋 2025-06-05 16:33:06,318 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.320198Z","level":"info","event":"📋 [2025-06-05 16:33:06]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.320330Z","level":"info","event":"📋 2025-06-05 16:33:06,318 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.320679Z","level":"info","event":"📋 [2025-06-05 16:33:06]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.322212Z","level":"info","event":"📋 2025-06-05 16:33:06,318 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323175Z","level":"info","event":"📋 [2025-06-05 16:33:06]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323242Z","level":"info","event":"📋 2025-06-05 16:33:06,318 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323284Z","level":"info","event":"📋 [2025-06-05 16:33:06]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323322Z","level":"info","event":"📋 2025-06-05 16:33:06,318 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323392Z","level":"info","event":"📋 [2025-06-05 16:33:06] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323434Z","level":"info","event":"📋 2025-06-05 16:33:06,319 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323479Z","level":"info","event":"📋 [2025-06-05 16:33:06]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323530Z","level":"info","event":"📋 2025-06-05 16:33:06,319 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323573Z","level":"info","event":"📋 [2025-06-05 16:33:06]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323607Z","level":"info","event":"📋 2025-06-05 16:33:06,319 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323641Z","level":"info","event":"📋 [2025-06-05 16:33:06] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323674Z","level":"info","event":"📋 2025-06-05 16:33:06,320 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323713Z","level":"info","event":"📋 [2025-06-05 16:33:06] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323753Z","level":"info","event":"📋 2025-06-05 16:33:06,320 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323807Z","level":"info","event":"📋 [2025-06-05 16:33:06] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323848Z","level":"info","event":"📋 2025-06-05 16:33:06,320 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323883Z","level":"info","event":"📋 [2025-06-05 16:33:06] 📊 Starting comprehensive filtering with 10 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323919Z","level":"info","event":"📋 2025-06-05 16:33:06,320 - INFO - 📊 Starting comprehensive filtering with 10 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323953Z","level":"info","event":"📋 [2025-06-05 16:33:06] 🇵🇹 Applying national article filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.323986Z","level":"info","event":"📋 2025-06-05 16:33:06,321 - INFO - 🇵🇹 Applying national article filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324054Z","level":"info","event":"📋 [2025-06-05 16:33:06]    After national filter: 0 articles (removed 10)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324093Z","level":"info","event":"📋 2025-06-05 16:33:06,322 - INFO -    After national filter: 0 articles (removed 10)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324127Z","level":"info","event":"📋 [2025-06-05 16:33:06] 🚫 Applying unwanted keywords filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324170Z","level":"info","event":"📋 2025-06-05 16:33:06,322 - INFO - 🚫 Applying unwanted keywords filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324212Z","level":"info","event":"📋 [2025-06-05 16:33:06]    After unwanted keywords filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324249Z","level":"info","event":"📋 2025-06-05 16:33:06,322 - INFO -    After unwanted keywords filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324300Z","level":"info","event":"📋 [2025-06-05 16:33:06] 📅 Applying year range filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324366Z","level":"info","event":"📋 2025-06-05 16:33:06,322 - INFO - 📅 Applying year range filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324417Z","level":"info","event":"📋 [2025-06-05 16:33:06]    After year filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324464Z","level":"info","event":"📋 2025-06-05 16:33:06,322 - INFO -    After year filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324513Z","level":"info","event":"📋 [2025-06-05 16:33:06] ⭐ Calculating relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324563Z","level":"info","event":"📋 2025-06-05 16:33:06,322 - INFO - ⭐ Calculating relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324624Z","level":"info","event":"📋 [2025-06-05 16:33:06] 🎯 Applying relevance and victim filters...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324671Z","level":"info","event":"📋 2025-06-05 16:33:06,322 - INFO - 🎯 Applying relevance and victim filters...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324711Z","level":"info","event":"📋 [2025-06-05 16:33:06]    After relevance/victim filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324751Z","level":"info","event":"📋 2025-06-05 16:33:06,323 - INFO -    After relevance/victim filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324807Z","level":"info","event":"📋 [2025-06-05 16:33:06] 🌦️ Identifying climate events...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324843Z","level":"info","event":"📋 2025-06-05 16:33:06,324 - INFO - 🌦️ Identifying climate events...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324877Z","level":"info","event":"📋 [2025-06-05 16:33:06] 🔄 Removing event-based duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324923Z","level":"info","event":"📋 2025-06-05 16:33:06,324 - INFO - 🔄 Removing event-based duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.324963Z","level":"info","event":"📋 [2025-06-05 16:33:06]    After event deduplication: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.325006Z","level":"info","event":"📋 2025-06-05 16:33:06,324 - INFO -    After event deduplication: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.325069Z","level":"info","event":"📋 [2025-06-05 16:33:06] ⚠️ No articles remaining after comprehensive filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.325304Z","level":"info","event":"📋 2025-06-05 16:33:06,324 - WARNING - ⚠️ No articles remaining after comprehensive filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.325384Z","level":"info","event":"📋 [2025-06-05 16:33:06] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.325450Z","level":"info","event":"📋 2025-06-05 16:33:06,324 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.399830Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.400007Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.400203Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_20250604.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.400299Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/data/processed/2025/06/04/artigos_sem_vitimas_20250604.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.400435Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/data/processed/2025/06/04/filtering_log_20250604.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.400513Z","level":"info","event":"⚠️ stats_json: /opt/airflow/data/processed/2025/06/04/filtering_stats_20250604.json (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:33:06.401062","level":"info","event":"Done. Returned value was: [2025-06-05 16:33:06] Starting filtrar_artigos_vitimas_airflow\n2025-06-05 16:33:06,314 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 16:33:06] Parameters: dias=1, date=2025-06-04\n2025-06-05 16:33:06,314 - INFO - Parameters: dias=1, date=2025-06-04\n[2025-06-05 16:33:06] Paths: input_file=/opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json, output_dir=/opt/airflow/data/processed/2025/06/04, date_str=2025-06-04\n2025-06-05 16:33:06,314 - INFO - Paths: input_file=/opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json, output_dir=/opt/airflow/data/processed/2025/06/04, date_str=2025-06-04\n[2025-06-05 16:33:06] 🚀 Starting filtrar_artigos_vitimas_airflow\n2025-06-05 16:33:06,314 - INFO - 🚀 Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 16:33:06] 🔍 Path setup:\n2025-06-05 16:33:06,314 - INFO - 🔍 Path setup:\n[2025-06-05 16:33:06]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-05 16:33:06,314 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-05 16:33:06]    Project root: /opt/airflow\n2025-06-05 16:33:06,314 - INFO -    Project root: /opt/airflow\n[2025-06-05 16:33:06] 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/04\n2025-06-05 16:33:06,314 - INFO - 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/04\n[2025-06-05 16:33:06] 📁 Using provided input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:33:06,314 - INFO - 📁 Using provided input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:33:06] 📂 Loading articles from: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:33:06,314 - INFO - 📂 Loading articles from: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:33:06] ==================================================\n2025-06-05 16:33:06,317 - INFO - ==================================================\n[2025-06-05 16:33:06] Filtering Started\n2025-06-05 16:33:06,317 - INFO - Filtering Started\n[2025-06-05 16:33:06] ==================================================\n2025-06-05 16:33:06,317 - INFO - ==================================================\n[2025-06-05 16:33:06]   Total Articles Loaded: 10\n2025-06-05 16:33:06,317 - INFO -   Total Articles Loaded: 10\n[2025-06-05 16:33:06]   Input File: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:33:06,317 - INFO -   Input File: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:33:06]   Output File: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_2025-06-04.csv\n2025-06-05 16:33:06,317 - INFO -   Output File: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_2025-06-04.csv\n[2025-06-05 16:33:06]   Processed Data Directory: /opt/airflow/data/processed/2025/06/04\n2025-06-05 16:33:06,318 - INFO -   Processed Data Directory: /opt/airflow/data/processed/2025/06/04\n[2025-06-05 16:33:06]   Days Filter: 1\n2025-06-05 16:33:06,318 - INFO -   Days Filter: 1\n[2025-06-05 16:33:06] ==================================================\n2025-06-05 16:33:06,318 - INFO - ==================================================\n[2025-06-05 16:33:06] 🔍 Applying comprehensive filtering logic...\n2025-06-05 16:33:06,318 - INFO - 🔍 Applying comprehensive filtering logic...\n[2025-06-05 16:33:06] 🔧 Loading configuration data...\n2025-06-05 16:33:06,318 - INFO - 🔧 Loading configuration data...\n[2025-06-05 16:33:06] 🔍 Looking for config files in multiple paths:\n2025-06-05 16:33:06,318 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-05 16:33:06]    Checking: /opt/airflow/config\n2025-06-05 16:33:06,318 - INFO -    Checking: /opt/airflow/config\n[2025-06-05 16:33:06]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-05 16:33:06,318 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-05 16:33:06]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-05 16:33:06,318 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 16:33:06]    Checking: config\n2025-06-05 16:33:06,318 - INFO -    Checking: config\n[2025-06-05 16:33:06] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-05 16:33:06,319 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 16:33:06]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-05 16:33:06,319 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-05 16:33:06]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-05 16:33:06,319 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-05 16:33:06] ✅ Loaded municipios config with 29 districts\n2025-06-05 16:33:06,320 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-05 16:33:06] ✅ Loaded eventos config with 14 events\n2025-06-05 16:33:06,320 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-05 16:33:06] 📊 Config summary: 29 districts, 306 parishes\n2025-06-05 16:33:06,320 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-05 16:33:06] 📊 Starting comprehensive filtering with 10 articles\n2025-06-05 16:33:06,320 - INFO - 📊 Starting comprehensive filtering with 10 articles\n[2025-06-05 16:33:06] 🇵🇹 Applying national article filter...\n2025-06-05 16:33:06,321 - INFO - 🇵🇹 Applying national article filter...\n[2025-06-05 16:33:06]    After national filter: 0 articles (removed 10)\n2025-06-05 16:33:06,322 - INFO -    After national filter: 0 articles (removed 10)\n[2025-06-05 16:33:06] 🚫 Applying unwanted keywords filter...\n2025-06-05 16:33:06,322 - INFO - 🚫 Applying unwanted keywords filter...\n[2025-06-05 16:33:06]    After unwanted keywords filter: 0 articles (removed 0)\n2025-06-05 16:33:06,322 - INFO -    After unwanted keywords filter: 0 articles (removed 0)\n[2025-06-05 16:33:06] 📅 Applying year range filter...\n2025-06-05 16:33:06,322 - INFO - 📅 Applying year range filter...\n[2025-06-05 16:33:06]    After year filter: 0 articles (removed 0)\n2025-06-05 16:33:06,322 - INFO -    After year filter: 0 articles (removed 0)\n[2025-06-05 16:33:06] ⭐ Calculating relevance scores...\n2025-06-05 16:33:06,322 - INFO - ⭐ Calculating relevance scores...\n[2025-06-05 16:33:06] 🎯 Applying relevance and victim filters...\n2025-06-05 16:33:06,322 - INFO - 🎯 Applying relevance and victim filters...\n[2025-06-05 16:33:06]    After relevance/victim filter: 0 articles (removed 0)\n2025-06-05 16:33:06,323 - INFO -    After relevance/victim filter: 0 articles (removed 0)\n[2025-06-05 16:33:06] 🌦️ Identifying climate events...\n2025-06-05 16:33:06,324 - INFO - 🌦️ Identifying climate events...\n[2025-06-05 16:33:06] 🔄 Removing event-based duplicates...\n2025-06-05 16:33:06,324 - INFO - 🔄 Removing event-based duplicates...\n[2025-06-05 16:33:06]    After event deduplication: 0 articles (removed 0)\n2025-06-05 16:33:06,324 - INFO -    After event deduplication: 0 articles (removed 0)\n[2025-06-05 16:33:06] ⚠️ No articles remaining after comprehensive filtering.\n2025-06-05 16:33:06,324 - WARNING - ⚠️ No articles remaining after comprehensive filtering.\n[2025-06-05 16:33:06] ✅ Filtering completed. Found 0 articles with victims\n2025-06-05 16:33:06,324 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-05T16:19:26.480126","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T16:19:26.480535","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T16:19:26.524855Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:26.526313Z","level":"info","event":"📁 Using paths from processar task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:26.527950Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:26.528463Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:26.528547Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:26.528594Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:26.528636Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:26.528674Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:26.528711Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:26.532362Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:26.532844Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:26.532929Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:26.533234Z","level":"info","event":"  - victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:26.533410Z","level":"info","event":"  - no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:26.533489Z","level":"info","event":"  - filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:26.533546Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:26.533628Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:26.533723Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.783253Z","level":"info","event":"📋 [2025-06-05 17:19:27] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.783570Z","level":"info","event":"📋 2025-06-05 17:19:27,783 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.784019Z","level":"info","event":"📋 [2025-06-05 17:19:27] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.784106Z","level":"info","event":"📋 2025-06-05 17:19:27,783 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.784185Z","level":"info","event":"📋 [2025-06-05 17:19:27] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.784247Z","level":"info","event":"📋 2025-06-05 17:19:27,783 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.784303Z","level":"info","event":"📋 [2025-06-05 17:19:27] 🚀 Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.784357Z","level":"info","event":"📋 2025-06-05 17:19:27,783 - INFO - 🚀 Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.784411Z","level":"info","event":"📋 [2025-06-05 17:19:27] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.784468Z","level":"info","event":"📋 2025-06-05 17:19:27,783 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.784526Z","level":"info","event":"📋 [2025-06-05 17:19:27]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.785223Z","level":"info","event":"📋 2025-06-05 17:19:27,783 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.785567Z","level":"info","event":"📋 [2025-06-05 17:19:27]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.785951Z","level":"info","event":"📋 2025-06-05 17:19:27,783 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.786024Z","level":"info","event":"📋 [2025-06-05 17:19:27] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.786183Z","level":"info","event":"📋 2025-06-05 17:19:27,783 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.786357Z","level":"info","event":"📋 [2025-06-05 17:19:27] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.786455Z","level":"info","event":"📋 2025-06-05 17:19:27,783 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.786534Z","level":"info","event":"📋 [2025-06-05 17:19:27] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.786993Z","level":"info","event":"📋 2025-06-05 17:19:27,783 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.787088Z","level":"info","event":"📋 [2025-06-05 17:19:27] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.787136Z","level":"info","event":"📋 2025-06-05 17:19:27,785 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.787193Z","level":"info","event":"📋 [2025-06-05 17:19:27] Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.787240Z","level":"info","event":"📋 2025-06-05 17:19:27,785 - INFO - Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.787289Z","level":"info","event":"📋 [2025-06-05 17:19:27] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.787414Z","level":"info","event":"📋 2025-06-05 17:19:27,785 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.787508Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Total Articles Loaded: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.788362Z","level":"info","event":"📋 2025-06-05 17:19:27,785 - INFO -   Total Articles Loaded: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.789307Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.790218Z","level":"info","event":"📋 2025-06-05 17:19:27,785 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.791188Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.791252Z","level":"info","event":"📋 2025-06-05 17:19:27,785 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.791303Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.791395Z","level":"info","event":"📋 2025-06-05 17:19:27,785 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.791457Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.791512Z","level":"info","event":"📋 2025-06-05 17:19:27,785 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.791561Z","level":"info","event":"📋 [2025-06-05 17:19:27] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.791611Z","level":"info","event":"📋 2025-06-05 17:19:27,785 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.791661Z","level":"info","event":"📋 [2025-06-05 17:19:27] 🔍 Applying comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.791710Z","level":"info","event":"📋 2025-06-05 17:19:27,785 - INFO - 🔍 Applying comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.791759Z","level":"info","event":"📋 [2025-06-05 17:19:27] 🔧 Loading configuration data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.791804Z","level":"info","event":"📋 2025-06-05 17:19:27,785 - INFO - 🔧 Loading configuration data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.791841Z","level":"info","event":"📋 [2025-06-05 17:19:27] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.791902Z","level":"info","event":"📋 2025-06-05 17:19:27,785 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.794250Z","level":"info","event":"📋 [2025-06-05 17:19:27]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.794564Z","level":"info","event":"📋 2025-06-05 17:19:27,785 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.794633Z","level":"info","event":"📋 [2025-06-05 17:19:27]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.794691Z","level":"info","event":"📋 2025-06-05 17:19:27,785 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.794744Z","level":"info","event":"📋 [2025-06-05 17:19:27]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.794803Z","level":"info","event":"📋 2025-06-05 17:19:27,785 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.794856Z","level":"info","event":"📋 [2025-06-05 17:19:27]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.794905Z","level":"info","event":"📋 2025-06-05 17:19:27,785 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.794954Z","level":"info","event":"📋 [2025-06-05 17:19:27] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.795020Z","level":"info","event":"📋 2025-06-05 17:19:27,786 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.795072Z","level":"info","event":"📋 [2025-06-05 17:19:27]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.795122Z","level":"info","event":"📋 2025-06-05 17:19:27,786 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.795211Z","level":"info","event":"📋 [2025-06-05 17:19:27]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.795272Z","level":"info","event":"📋 2025-06-05 17:19:27,786 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.795351Z","level":"info","event":"📋 [2025-06-05 17:19:27] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.795906Z","level":"info","event":"📋 2025-06-05 17:19:27,787 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.797193Z","level":"info","event":"📋 [2025-06-05 17:19:27] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.797250Z","level":"info","event":"📋 2025-06-05 17:19:27,788 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.797300Z","level":"info","event":"📋 [2025-06-05 17:19:27] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.797351Z","level":"info","event":"📋 2025-06-05 17:19:27,788 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.797403Z","level":"info","event":"📋 [2025-06-05 17:19:27] 📊 Starting comprehensive filtering with 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.797452Z","level":"info","event":"📋 2025-06-05 17:19:27,788 - INFO - 📊 Starting comprehensive filtering with 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.797502Z","level":"info","event":"📋 [2025-06-05 17:19:27] 🇵🇹 Applying national article filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.797551Z","level":"info","event":"📋 2025-06-05 17:19:27,789 - INFO - 🇵🇹 Applying national article filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.797601Z","level":"info","event":"📋 [2025-06-05 17:19:27]    After national filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.797651Z","level":"info","event":"📋 2025-06-05 17:19:27,789 - INFO -    After national filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.797701Z","level":"info","event":"📋 [2025-06-05 17:19:27] 🚫 Applying unwanted keywords filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.797749Z","level":"info","event":"📋 2025-06-05 17:19:27,789 - INFO - 🚫 Applying unwanted keywords filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.797798Z","level":"info","event":"📋 [2025-06-05 17:19:27]    After unwanted keywords filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.797847Z","level":"info","event":"📋 2025-06-05 17:19:27,790 - INFO -    After unwanted keywords filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.797898Z","level":"info","event":"📋 [2025-06-05 17:19:27] 📅 Applying year range filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.797950Z","level":"info","event":"📋 2025-06-05 17:19:27,790 - INFO - 📅 Applying year range filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.797998Z","level":"info","event":"📋 [2025-06-05 17:19:27]    After year filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.798046Z","level":"info","event":"📋 2025-06-05 17:19:27,791 - INFO -    After year filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.798143Z","level":"info","event":"📋 [2025-06-05 17:19:27] ⭐ Calculating relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.798202Z","level":"info","event":"📋 2025-06-05 17:19:27,791 - INFO - ⭐ Calculating relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.798249Z","level":"info","event":"📋 [2025-06-05 17:19:27] 🎯 Applying relevance and victim filters...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.798300Z","level":"info","event":"📋 2025-06-05 17:19:27,792 - INFO - 🎯 Applying relevance and victim filters...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.798348Z","level":"info","event":"📋 [2025-06-05 17:19:27]    After relevance/victim filter: 1 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.798396Z","level":"info","event":"📋 2025-06-05 17:19:27,792 - INFO -    After relevance/victim filter: 1 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.798445Z","level":"info","event":"📋 [2025-06-05 17:19:27] 🔄 Removing URL duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.798493Z","level":"info","event":"📋 2025-06-05 17:19:27,792 - INFO - 🔄 Removing URL duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.798542Z","level":"info","event":"📋 [2025-06-05 17:19:27]    After URL deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.798591Z","level":"info","event":"📋 2025-06-05 17:19:27,793 - INFO -    After URL deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.798640Z","level":"info","event":"📋 [2025-06-05 17:19:27] 🌦️ Identifying climate events...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.798690Z","level":"info","event":"📋 2025-06-05 17:19:27,793 - INFO - 🌦️ Identifying climate events...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.798739Z","level":"info","event":"📋 [2025-06-05 17:19:27] 🔄 Removing event-based duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.798790Z","level":"info","event":"📋 2025-06-05 17:19:27,793 - INFO - 🔄 Removing event-based duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.798863Z","level":"info","event":"📋 [2025-06-05 17:19:27]    After event deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.798911Z","level":"info","event":"📋 2025-06-05 17:19:27,795 - INFO -    After event deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.799899Z","level":"info","event":"📋 [2025-06-05 17:19:27] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.799957Z","level":"info","event":"📋 2025-06-05 17:19:27,799 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.800018Z","level":"info","event":"📋 [2025-06-05 17:19:27] Comprehensive Filtering Results","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.800121Z","level":"info","event":"📋 2025-06-05 17:19:27,799 - INFO - Comprehensive Filtering Results","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.800175Z","level":"info","event":"📋 [2025-06-05 17:19:27] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.800225Z","level":"info","event":"📋 2025-06-05 17:19:27,800 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.800486Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Articles After All Filters: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.800635Z","level":"info","event":"📋 2025-06-05 17:19:27,800 - INFO -   Articles After All Filters: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.800780Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Articles with Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.800868Z","level":"info","event":"📋 2025-06-05 17:19:27,800 - INFO -   Articles with Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.801133Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Articles without Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.801262Z","level":"info","event":"📋 2025-06-05 17:19:27,800 - INFO -   Articles without Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.801858Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Total Fatalities: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.801949Z","level":"info","event":"📋 2025-06-05 17:19:27,800 - INFO -   Total Fatalities: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.802040Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Total Injured: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.802090Z","level":"info","event":"📋 2025-06-05 17:19:27,800 - INFO -   Total Injured: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.802267Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Total Evacuated: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.806227Z","level":"info","event":"📋 2025-06-05 17:19:27,800 - INFO -   Total Evacuated: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808187Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Total Displaced: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808267Z","level":"info","event":"📋 2025-06-05 17:19:27,800 - INFO -   Total Displaced: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808311Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Total Missing: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808351Z","level":"info","event":"📋 2025-06-05 17:19:27,800 - INFO -   Total Missing: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808390Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Average Relevance Score: 1.00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808428Z","level":"info","event":"📋 2025-06-05 17:19:27,800 - INFO -   Average Relevance Score: 1.00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808468Z","level":"info","event":"📋 [2025-06-05 17:19:27] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808504Z","level":"info","event":"📋 2025-06-05 17:19:27,800 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808541Z","level":"info","event":"📋 [2025-06-05 17:19:27] 💾 Saving comprehensively filtered articles...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808577Z","level":"info","event":"📋 2025-06-05 17:19:27,800 - INFO - 💾 Saving comprehensively filtered articles...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808612Z","level":"info","event":"📋 📥 Novos artigos recebidos: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808697Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808737Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808774Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808838Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808886Z","level":"info","event":"📋 [2025-06-05 17:19:27] ✅ Articles without victims saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808939Z","level":"info","event":"📋 2025-06-05 17:19:27,801 - INFO - ✅ Articles without victims saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.808990Z","level":"info","event":"📋 [2025-06-05 17:19:27] ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809040Z","level":"info","event":"📋 2025-06-05 17:19:27,802 - INFO - ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809091Z","level":"info","event":"📋 [2025-06-05 17:19:27] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809140Z","level":"info","event":"📋 2025-06-05 17:19:27,802 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809191Z","level":"info","event":"📋 [2025-06-05 17:19:27] Comprehensive Filtering Completed Successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809240Z","level":"info","event":"📋 2025-06-05 17:19:27,802 - INFO - Comprehensive Filtering Completed Successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809291Z","level":"info","event":"📋 [2025-06-05 17:19:27] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809339Z","level":"info","event":"📋 2025-06-05 17:19:27,802 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809389Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Articles with Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809439Z","level":"info","event":"📋 2025-06-05 17:19:27,802 - INFO -   Articles with Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809490Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Articles without Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809541Z","level":"info","event":"📋 2025-06-05 17:19:27,802 - INFO -   Articles without Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809591Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Total Articles Processed: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809644Z","level":"info","event":"📋 2025-06-05 17:19:27,802 - INFO -   Total Articles Processed: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809696Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Filter Rate: 25.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809744Z","level":"info","event":"📋 2025-06-05 17:19:27,802 - INFO -   Filter Rate: 25.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809792Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Victim Rate: 0.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809840Z","level":"info","event":"📋 2025-06-05 17:19:27,802 - INFO -   Victim Rate: 0.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809888Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.809952Z","level":"info","event":"📋 2025-06-05 17:19:27,802 - INFO -   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.810051Z","level":"info","event":"📋 [2025-06-05 17:19:27]   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.810100Z","level":"info","event":"📋 2025-06-05 17:19:27,802 - INFO -   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.810150Z","level":"info","event":"📋 [2025-06-05 17:19:27] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.810204Z","level":"info","event":"📋 2025-06-05 17:19:27,802 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.810255Z","level":"info","event":"📋 [2025-06-05 17:19:27] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.810303Z","level":"info","event":"📋 2025-06-05 17:19:27,802 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.891814Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.892020Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.892192Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.892310Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.892450Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.892546Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json (512 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:19:27.892963","level":"info","event":"Done. Returned value was: [2025-06-05 17:19:27] Starting filtrar_artigos_vitimas_airflow\n2025-06-05 17:19:27,783 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 17:19:27] Parameters: dias=1, date=2025-06-05\n2025-06-05 17:19:27,783 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 17:19:27] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n2025-06-05 17:19:27,783 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n[2025-06-05 17:19:27] 🚀 Starting filtrar_artigos_vitimas_airflow\n2025-06-05 17:19:27,783 - INFO - 🚀 Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 17:19:27] 🔍 Path setup:\n2025-06-05 17:19:27,783 - INFO - 🔍 Path setup:\n[2025-06-05 17:19:27]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-05 17:19:27,783 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-05 17:19:27]    Project root: /opt/airflow\n2025-06-05 17:19:27,783 - INFO -    Project root: /opt/airflow\n[2025-06-05 17:19:27] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 17:19:27,783 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 17:19:27] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 17:19:27,783 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 17:19:27] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 17:19:27,783 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 17:19:27] ==================================================\n2025-06-05 17:19:27,785 - INFO - ==================================================\n[2025-06-05 17:19:27] Filtering Started\n2025-06-05 17:19:27,785 - INFO - Filtering Started\n[2025-06-05 17:19:27] ==================================================\n2025-06-05 17:19:27,785 - INFO - ==================================================\n[2025-06-05 17:19:27]   Total Articles Loaded: 4\n2025-06-05 17:19:27,785 - INFO -   Total Articles Loaded: 4\n[2025-06-05 17:19:27]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 17:19:27,785 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 17:19:27]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 17:19:27,785 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 17:19:27]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 17:19:27,785 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 17:19:27]   Days Filter: 1\n2025-06-05 17:19:27,785 - INFO -   Days Filter: 1\n[2025-06-05 17:19:27] ==================================================\n2025-06-05 17:19:27,785 - INFO - ==================================================\n[2025-06-05 17:19:27] 🔍 Applying comprehensive filtering logic...\n2025-06-05 17:19:27,785 - INFO - 🔍 Applying comprehensive filtering logic...\n[2025-06-05 17:19:27] 🔧 Loading configuration data...\n2025-06-05 17:19:27,785 - INFO - 🔧 Loading configuration data...\n[2025-06-05 17:19:27] 🔍 Looking for config files in multiple paths:\n2025-06-05 17:19:27,785 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-05 17:19:27]    Checking: /opt/airflow/config\n2025-06-05 17:19:27,785 - INFO -    Checking: /opt/airflow/config\n[2025-06-05 17:19:27]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-05 17:19:27,785 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-05 17:19:27]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-05 17:19:27,785 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 17:19:27]    Checking: config\n2025-06-05 17:19:27,785 - INFO -    Checking: config\n[2025-06-05 17:19:27] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-05 17:19:27,786 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 17:19:27]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-05 17:19:27,786 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-05 17:19:27]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-05 17:19:27,786 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-05 17:19:27] ✅ Loaded municipios config with 29 districts\n2025-06-05 17:19:27,787 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-05 17:19:27] ✅ Loaded eventos config with 14 events\n2025-06-05 17:19:27,788 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-05 17:19:27] 📊 Config summary: 29 districts, 306 parishes\n2025-06-05 17:19:27,788 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-05 17:19:27] 📊 Starting comprehensive filtering with 4 articles\n2025-06-05 17:19:27,788 - INFO - 📊 Starting comprehensive filtering with 4 articles\n[2025-06-05 17:19:27] 🇵🇹 Applying national article filter...\n2025-06-05 17:19:27,789 - INFO - 🇵🇹 Applying national article filter...\n[2025-06-05 17:19:27]    After national filter: 4 articles (removed 0)\n2025-06-05 17:19:27,789 - INFO -    After national filter: 4 articles (removed 0)\n[2025-06-05 17:19:27] 🚫 Applying unwanted keywords filter...\n2025-06-05 17:19:27,789 - INFO - 🚫 Applying unwanted keywords filter...\n[2025-06-05 17:19:27]    After unwanted keywords filter: 4 articles (removed 0)\n2025-06-05 17:19:27,790 - INFO -    After unwanted keywords filter: 4 articles (removed 0)\n[2025-06-05 17:19:27] 📅 Applying year range filter...\n2025-06-05 17:19:27,790 - INFO - 📅 Applying year range filter...\n[2025-06-05 17:19:27]    After year filter: 4 articles (removed 0)\n2025-06-05 17:19:27,791 - INFO -    After year filter: 4 articles (removed 0)\n[2025-06-05 17:19:27] ⭐ Calculating relevance scores...\n2025-06-05 17:19:27,791 - INFO - ⭐ Calculating relevance scores...\n[2025-06-05 17:19:27] 🎯 Applying relevance and victim filters...\n2025-06-05 17:19:27,792 - INFO - 🎯 Applying relevance and victim filters...\n[2025-06-05 17:19:27]    After relevance/victim filter: 1 articles (removed 3)\n2025-06-05 17:19:27,792 - INFO -    After relevance/victim filter: 1 articles (removed 3)\n[2025-06-05 17:19:27] 🔄 Removing URL duplicates...\n2025-06-05 17:19:27,792 - INFO - 🔄 Removing URL duplicates...\n[2025-06-05 17:19:27]    After URL deduplication: 1 articles (removed 0)\n2025-06-05 17:19:27,793 - INFO -    After URL deduplication: 1 articles (removed 0)\n[2025-06-05 17:19:27] 🌦️ Identifying climate events...\n2025-06-05 17:19:27,793 - INFO - 🌦️ Identifying climate events...\n[2025-06-05 17:19:27] 🔄 Removing event-based duplicates...\n2025-06-05 17:19:27,793 - INFO - 🔄 Removing event-based duplicates...\n[2025-06-05 17:19:27]    After event deduplication: 1 articles (removed 0)\n2025-06-05 17:19:27,795 - INFO -    After event deduplication: 1 articles (removed 0)\n[2025-06-05 17:19:27] ==================================================\n2025-06-05 17:19:27,799 - INFO - ==================================================\n[2025-06-05 17:19:27] Comprehensive Filtering Results\n2025-06-05 17:19:27,799 - INFO - Comprehensive Filtering Results\n[2025-06-05 17:19:27] ==================================================\n2025-06-05 17:19:27,800 - INFO - ==================================================\n[2025-06-05 17:19:27]   Articles After All Filters: 1\n2025-06-05 17:19:27,800 - INFO -   Articles After All Filters: 1\n[2025-06-05 17:19:27]   Articles with Victims: 0\n2025-06-05 17:19:27,800 - INFO -   Articles with Victims: 0\n[2025-06-05 17:19:27]   Articles without Victims: 1\n2025-06-05 17:19:27,800 - INFO -   Articles without Victims: 1\n[2025-06-05 17:19:27]   Total Fatalities: 0\n2025-06-05 17:19:27,800 - INFO -   Total Fatalities: 0\n[2025-06-05 17:19:27]   Total Injured: 0\n2025-06-05 17:19:27,800 - INFO -   Total Injured: 0\n[2025-06-05 17:19:27]   Total Evacuated: 0\n2025-06-05 17:19:27,800 - INFO -   Total Evacuated: 0\n[2025-06-05 17:19:27]   Total Displaced: 0\n2025-06-05 17:19:27,800 - INFO -   Total Displaced: 0\n[2025-06-05 17:19:27]   Total Missing: 0\n2025-06-05 17:19:27,800 - INFO -   Total Missing: 0\n[2025-06-05 17:19:27]   Average Relevance Score: 1.00\n2025-06-05 17:19:27,800 - INFO -   Average Relevance Score: 1.00\n[2025-06-05 17:19:27] ==================================================\n2025-06-05 17:19:27,800 - INFO - ==================================================\n[2025-06-05 17:19:27] 💾 Saving comprehensively filtered articles...\n2025-06-05 17:19:27,800 - INFO - 💾 Saving comprehensively filtered articles...\n📥 Novos artigos recebidos: 1\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_2025-06-05.csv\n📂 IDs existentes no arquivo: 1\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-05 17:19:27] ✅ Articles without victims saved: 1 articles\n2025-06-05 17:19:27,801 - INFO - ✅ Articles without victims saved: 1 articles\n[2025-06-05 17:19:27] ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n2025-06-05 17:19:27,802 - INFO - ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n[2025-06-05 17:19:27] ==================================================\n2025-06-05 17:19:27,802 - INFO - ==================================================\n[2025-06-05 17:19:27] Comprehensive Filtering Completed Successfully\n2025-06-05 17:19:27,802 - INFO - Comprehensive Filtering Completed Successfully\n[2025-06-05 17:19:27] ==================================================\n2025-06-05 17:19:27,802 - INFO - ==================================================\n[2025-06-05 17:19:27]   Articles with Victims: 0\n2025-06-05 17:19:27,802 - INFO -   Articles with Victims: 0\n[2025-06-05 17:19:27]   Articles without Victims: 1\n2025-06-05 17:19:27,802 - INFO -   Articles without Victims: 1\n[2025-06-05 17:19:27]   Total Articles Processed: 1\n2025-06-05 17:19:27,802 - INFO -   Total Articles Processed: 1\n[2025-06-05 17:19:27]   Filter Rate: 25.0%\n2025-06-05 17:19:27,802 - INFO -   Filter Rate: 25.0%\n[2025-06-05 17:19:27]   Victim Rate: 0.0%\n2025-06-05 17:19:27,802 - INFO -   Victim Rate: 0.0%\n[2025-06-05 17:19:27]   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 17:19:27,802 - INFO -   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 17:19:27]   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n2025-06-05 17:19:27,802 - INFO -   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n[2025-06-05 17:19:27] ==================================================\n2025-06-05 17:19:27,802 - INFO - ==================================================\n[2025-06-05 17:19:27] ✅ Filtering completed. Found 0 articles with victims\n2025-06-05 17:19:27,802 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
