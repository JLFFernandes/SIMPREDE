{"timestamp":"2025-06-05T20:07:40.325603","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T20:07:40.325904","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T20:07:40.379257Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:40.382061Z","level":"info","event":"📁 Using paths from processar task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:40.382197Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:40.382457Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:40.382560Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:40.382649Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:40.382731Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:40.382798Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:40.382869Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:40.387278Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:40.387723Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:40.387865Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:40.388204Z","level":"info","event":"  - victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:40.388308Z","level":"info","event":"  - no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:40.388422Z","level":"info","event":"  - filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:40.388493Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:40.388608Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:40.388724Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.611421Z","level":"info","event":"📋 [2025-06-05 21:07:41] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.611878Z","level":"info","event":"📋 2025-06-05 21:07:41,611 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.612494Z","level":"info","event":"📋 [2025-06-05 21:07:41] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.612603Z","level":"info","event":"📋 2025-06-05 21:07:41,611 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.613527Z","level":"info","event":"📋 [2025-06-05 21:07:41] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.613619Z","level":"info","event":"📋 2025-06-05 21:07:41,611 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.613678Z","level":"info","event":"📋 [2025-06-05 21:07:41] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.613730Z","level":"info","event":"📋 2025-06-05 21:07:41,611 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.613781Z","level":"info","event":"📋 [2025-06-05 21:07:41] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.613828Z","level":"info","event":"📋 2025-06-05 21:07:41,611 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.613875Z","level":"info","event":"📋 [2025-06-05 21:07:41]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.613927Z","level":"info","event":"📋 2025-06-05 21:07:41,611 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.613974Z","level":"info","event":"📋 [2025-06-05 21:07:41]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.614035Z","level":"info","event":"📋 2025-06-05 21:07:41,611 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.614098Z","level":"info","event":"📋 [2025-06-05 21:07:41] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.614154Z","level":"info","event":"📋 2025-06-05 21:07:41,611 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.614233Z","level":"info","event":"📋 [2025-06-05 21:07:41] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.614282Z","level":"info","event":"📋 2025-06-05 21:07:41,611 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.614336Z","level":"info","event":"📋 [2025-06-05 21:07:41] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.614386Z","level":"info","event":"📋 2025-06-05 21:07:41,611 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.614444Z","level":"info","event":"📋 [2025-06-05 21:07:41] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.614559Z","level":"info","event":"📋 2025-06-05 21:07:41,613 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.614629Z","level":"info","event":"📋 [2025-06-05 21:07:41] Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.614685Z","level":"info","event":"📋 2025-06-05 21:07:41,614 - INFO - Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.614749Z","level":"info","event":"📋 [2025-06-05 21:07:41] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.614823Z","level":"info","event":"📋 2025-06-05 21:07:41,614 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.614872Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Total Articles Loaded: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.614919Z","level":"info","event":"📋 2025-06-05 21:07:41,614 - INFO -   Total Articles Loaded: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.614963Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.615207Z","level":"info","event":"📋 2025-06-05 21:07:41,614 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.615311Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.615392Z","level":"info","event":"📋 2025-06-05 21:07:41,614 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.615551Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.615644Z","level":"info","event":"📋 2025-06-05 21:07:41,614 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.615718Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.616101Z","level":"info","event":"📋 2025-06-05 21:07:41,615 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.616167Z","level":"info","event":"📋 [2025-06-05 21:07:41] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.616216Z","level":"info","event":"📋 2025-06-05 21:07:41,615 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.616270Z","level":"info","event":"📋 [2025-06-05 21:07:41] 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.616319Z","level":"info","event":"📋 2025-06-05 21:07:41,615 - INFO - 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.616360Z","level":"info","event":"📋 [2025-06-05 21:07:41] 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.616453Z","level":"info","event":"📋 2025-06-05 21:07:41,615 - INFO - 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.616611Z","level":"info","event":"📋 [2025-06-05 21:07:41] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.618542Z","level":"info","event":"📋 2025-06-05 21:07:41,615 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.619521Z","level":"info","event":"📋 [2025-06-05 21:07:41]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.619590Z","level":"info","event":"📋 2025-06-05 21:07:41,615 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.619643Z","level":"info","event":"📋 [2025-06-05 21:07:41]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.619695Z","level":"info","event":"📋 2025-06-05 21:07:41,615 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.619745Z","level":"info","event":"📋 [2025-06-05 21:07:41]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.619794Z","level":"info","event":"📋 2025-06-05 21:07:41,615 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.619844Z","level":"info","event":"📋 [2025-06-05 21:07:41]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.619892Z","level":"info","event":"📋 2025-06-05 21:07:41,615 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.619972Z","level":"info","event":"📋 [2025-06-05 21:07:41] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620022Z","level":"info","event":"📋 2025-06-05 21:07:41,615 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620071Z","level":"info","event":"📋 [2025-06-05 21:07:41]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620119Z","level":"info","event":"📋 2025-06-05 21:07:41,615 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620167Z","level":"info","event":"📋 [2025-06-05 21:07:41]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620215Z","level":"info","event":"📋 2025-06-05 21:07:41,615 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620264Z","level":"info","event":"📋 [2025-06-05 21:07:41] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620313Z","level":"info","event":"📋 2025-06-05 21:07:41,616 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620360Z","level":"info","event":"📋 [2025-06-05 21:07:41] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620411Z","level":"info","event":"📋 2025-06-05 21:07:41,616 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620455Z","level":"info","event":"📋 [2025-06-05 21:07:41] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620543Z","level":"info","event":"📋 2025-06-05 21:07:41,616 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620599Z","level":"info","event":"📋 [2025-06-05 21:07:41] 📊 Starting enhanced comprehensive filtering with 7 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620649Z","level":"info","event":"📋 2025-06-05 21:07:41,616 - INFO - 📊 Starting enhanced comprehensive filtering with 7 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620704Z","level":"info","event":"📋 [2025-06-05 21:07:41] 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620757Z","level":"info","event":"📋 2025-06-05 21:07:41,617 - INFO - 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620805Z","level":"info","event":"📋 [2025-06-05 21:07:41]    After enhanced geographic filter: 7 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620852Z","level":"info","event":"📋 2025-06-05 21:07:41,618 - INFO -    After enhanced geographic filter: 7 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620900Z","level":"info","event":"📋 [2025-06-05 21:07:41] ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620948Z","level":"info","event":"📋 2025-06-05 21:07:41,618 - INFO - ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.620994Z","level":"info","event":"📋 [2025-06-05 21:07:41]    After quality filter: 6 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.621041Z","level":"info","event":"📋 2025-06-05 21:07:41,618 - INFO -    After quality filter: 6 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.622555Z","level":"info","event":"📋 [2025-06-05 21:07:41] 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.623529Z","level":"info","event":"📋 2025-06-05 21:07:41,618 - INFO - 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.624049Z","level":"info","event":"📋 [2025-06-05 21:07:41]    After enhanced keyword filter: 1 articles (removed 5)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.624184Z","level":"info","event":"📋 2025-06-05 21:07:41,618 - INFO -    After enhanced keyword filter: 1 articles (removed 5)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.624260Z","level":"info","event":"📋 [2025-06-05 21:07:41] 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.624314Z","level":"info","event":"📋 2025-06-05 21:07:41,618 - INFO - 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.624398Z","level":"info","event":"📋 [2025-06-05 21:07:41]    After temporal filter: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.624592Z","level":"info","event":"📋 2025-06-05 21:07:41,619 - INFO -    After temporal filter: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.624718Z","level":"info","event":"📋 [2025-06-05 21:07:41] 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.624777Z","level":"info","event":"📋 2025-06-05 21:07:41,619 - INFO - 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.624821Z","level":"info","event":"📋 [2025-06-05 21:07:41]    After victim validation: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.624862Z","level":"info","event":"📋 2025-06-05 21:07:41,619 - INFO -    After victim validation: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.624933Z","level":"info","event":"📋 [2025-06-05 21:07:41] ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.624973Z","level":"info","event":"📋 2025-06-05 21:07:41,619 - INFO - ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.625049Z","level":"info","event":"📋 [2025-06-05 21:07:41]    After relevance score filter (min 2): 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.625096Z","level":"info","event":"📋 2025-06-05 21:07:41,621 - INFO -    After relevance score filter (min 2): 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.625139Z","level":"info","event":"📋 [2025-06-05 21:07:41] 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.625180Z","level":"info","event":"📋 2025-06-05 21:07:41,621 - INFO - 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.625221Z","level":"info","event":"📋 [2025-06-05 21:07:41]    After URL deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.625262Z","level":"info","event":"📋 2025-06-05 21:07:41,621 - INFO -    After URL deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.625302Z","level":"info","event":"📋 [2025-06-05 21:07:41]    After content similarity deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.625343Z","level":"info","event":"📋 2025-06-05 21:07:41,622 - INFO -    After content similarity deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.625383Z","level":"info","event":"📋 [2025-06-05 21:07:41] 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.626570Z","level":"info","event":"📋 2025-06-05 21:07:41,622 - INFO - 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.627551Z","level":"info","event":"📋 [2025-06-05 21:07:41] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.627692Z","level":"info","event":"📋 2025-06-05 21:07:41,627 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.627837Z","level":"info","event":"📋 [2025-06-05 21:07:41] Enhanced Filtering Results","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.628084Z","level":"info","event":"📋 2025-06-05 21:07:41,627 - INFO - Enhanced Filtering Results","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.628245Z","level":"info","event":"📋 [2025-06-05 21:07:41] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.628454Z","level":"info","event":"📋 2025-06-05 21:07:41,627 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.628524Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Articles After Enhanced Filters: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.628586Z","level":"info","event":"📋 2025-06-05 21:07:41,627 - INFO -   Articles After Enhanced Filters: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.628738Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Articles with Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.628809Z","level":"info","event":"📋 2025-06-05 21:07:41,627 - INFO -   Articles with Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.628970Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Articles without Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.629353Z","level":"info","event":"📋 2025-06-05 21:07:41,627 - INFO -   Articles without Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.630259Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Total Fatalities: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.630540Z","level":"info","event":"📋 2025-06-05 21:07:41,627 - INFO -   Total Fatalities: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.630667Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Total Injured: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.630981Z","level":"info","event":"📋 2025-06-05 21:07:41,627 - INFO -   Total Injured: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.632569Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Total Evacuated: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.634530Z","level":"info","event":"📋 2025-06-05 21:07:41,627 - INFO -   Total Evacuated: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.634653Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Total Displaced: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.634712Z","level":"info","event":"📋 2025-06-05 21:07:41,627 - INFO -   Total Displaced: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.634757Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Total Missing: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.634800Z","level":"info","event":"📋 2025-06-05 21:07:41,627 - INFO -   Total Missing: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.634857Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Average Relevance Score: 6.00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.634921Z","level":"info","event":"📋 2025-06-05 21:07:41,627 - INFO -   Average Relevance Score: 6.00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.634978Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Top Event Types: {'desconhecido': 1}","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.635023Z","level":"info","event":"📋 2025-06-05 21:07:41,627 - INFO -   Top Event Types: {'desconhecido': 1}","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.635076Z","level":"info","event":"📋 [2025-06-05 21:07:41] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.635128Z","level":"info","event":"📋 2025-06-05 21:07:41,627 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.635180Z","level":"info","event":"📋 [2025-06-05 21:07:41] 💾 Saving enhanced filtered articles...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.635230Z","level":"info","event":"📋 2025-06-05 21:07:41,627 - INFO - 💾 Saving enhanced filtered articles...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.635347Z","level":"info","event":"📋 📥 Novos artigos recebidos: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.635602Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.635724Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.635822Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.635873Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.635928Z","level":"info","event":"📋 📥 Novos artigos recebidos: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.636044Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_vitimas_filtrados.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.636087Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.636134Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.636187Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.636236Z","level":"info","event":"📋 [2025-06-05 21:07:41] ✅ Filtered articles with victims saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.636285Z","level":"info","event":"📋 2025-06-05 21:07:41,629 - INFO - ✅ Filtered articles with victims saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.638629Z","level":"info","event":"📋 [2025-06-05 21:07:41] ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.638875Z","level":"info","event":"📋 2025-06-05 21:07:41,631 - INFO - ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.638947Z","level":"info","event":"📋 [2025-06-05 21:07:41] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.639033Z","level":"info","event":"📋 2025-06-05 21:07:41,631 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.639120Z","level":"info","event":"📋 [2025-06-05 21:07:41] Enhanced Filtering Completed Successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.639174Z","level":"info","event":"📋 2025-06-05 21:07:41,631 - INFO - Enhanced Filtering Completed Successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.639236Z","level":"info","event":"📋 [2025-06-05 21:07:41] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.639291Z","level":"info","event":"📋 2025-06-05 21:07:41,631 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.639346Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Articles with Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.639400Z","level":"info","event":"📋 2025-06-05 21:07:41,631 - INFO -   Articles with Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.639458Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Articles without Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.639534Z","level":"info","event":"📋 2025-06-05 21:07:41,631 - INFO -   Articles without Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.639722Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Total Articles Processed: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.639813Z","level":"info","event":"📋 2025-06-05 21:07:41,631 - INFO -   Total Articles Processed: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.639877Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Enhanced Filter Rate: 14.3%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.639939Z","level":"info","event":"📋 2025-06-05 21:07:41,631 - INFO -   Enhanced Filter Rate: 14.3%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.640044Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Victim Rate: 100.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.640319Z","level":"info","event":"📋 2025-06-05 21:07:41,631 - INFO -   Victim Rate: 100.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.640468Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.640628Z","level":"info","event":"📋 2025-06-05 21:07:41,631 - INFO -   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.640760Z","level":"info","event":"📋 [2025-06-05 21:07:41]   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.640898Z","level":"info","event":"📋 2025-06-05 21:07:41,631 - INFO -   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.640978Z","level":"info","event":"📋 [2025-06-05 21:07:41] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.641039Z","level":"info","event":"📋 2025-06-05 21:07:41,631 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.641112Z","level":"info","event":"📋 [2025-06-05 21:07:41] ✅ Filtering completed. Found 1 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.641247Z","level":"info","event":"📋 2025-06-05 21:07:41,631 - INFO - ✅ Filtering completed. Found 1 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.755832Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.756017Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.756194Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.756287Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.756377Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.756513Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json (418 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:41.759186","level":"info","event":"Done. Returned value was: [2025-06-05 21:07:41] Starting filtrar_artigos_vitimas_airflow\n2025-06-05 21:07:41,611 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 21:07:41] Parameters: dias=1, date=2025-06-05\n2025-06-05 21:07:41,611 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 21:07:41] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n2025-06-05 21:07:41,611 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n[2025-06-05 21:07:41] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n2025-06-05 21:07:41,611 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n[2025-06-05 21:07:41] 🔍 Path setup:\n2025-06-05 21:07:41,611 - INFO - 🔍 Path setup:\n[2025-06-05 21:07:41]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-05 21:07:41,611 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-05 21:07:41]    Project root: /opt/airflow\n2025-06-05 21:07:41,611 - INFO -    Project root: /opt/airflow\n[2025-06-05 21:07:41] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 21:07:41,611 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 21:07:41] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 21:07:41,611 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 21:07:41] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 21:07:41,611 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 21:07:41] ==================================================\n2025-06-05 21:07:41,613 - INFO - ==================================================\n[2025-06-05 21:07:41] Enhanced Filtering Started\n2025-06-05 21:07:41,614 - INFO - Enhanced Filtering Started\n[2025-06-05 21:07:41] ==================================================\n2025-06-05 21:07:41,614 - INFO - ==================================================\n[2025-06-05 21:07:41]   Total Articles Loaded: 7\n2025-06-05 21:07:41,614 - INFO -   Total Articles Loaded: 7\n[2025-06-05 21:07:41]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 21:07:41,614 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 21:07:41]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 21:07:41,614 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 21:07:41]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 21:07:41,614 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 21:07:41]   Days Filter: 1\n2025-06-05 21:07:41,615 - INFO -   Days Filter: 1\n[2025-06-05 21:07:41] ==================================================\n2025-06-05 21:07:41,615 - INFO - ==================================================\n[2025-06-05 21:07:41] 🔍 Applying enhanced comprehensive filtering logic...\n2025-06-05 21:07:41,615 - INFO - 🔍 Applying enhanced comprehensive filtering logic...\n[2025-06-05 21:07:41] 🔧 Loading configuration data for enhanced filtering...\n2025-06-05 21:07:41,615 - INFO - 🔧 Loading configuration data for enhanced filtering...\n[2025-06-05 21:07:41] 🔍 Looking for config files in multiple paths:\n2025-06-05 21:07:41,615 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-05 21:07:41]    Checking: /opt/airflow/config\n2025-06-05 21:07:41,615 - INFO -    Checking: /opt/airflow/config\n[2025-06-05 21:07:41]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-05 21:07:41,615 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-05 21:07:41]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-05 21:07:41,615 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 21:07:41]    Checking: config\n2025-06-05 21:07:41,615 - INFO -    Checking: config\n[2025-06-05 21:07:41] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-05 21:07:41,615 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 21:07:41]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-05 21:07:41,615 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-05 21:07:41]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-05 21:07:41,615 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-05 21:07:41] ✅ Loaded municipios config with 29 districts\n2025-06-05 21:07:41,616 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-05 21:07:41] ✅ Loaded eventos config with 14 events\n2025-06-05 21:07:41,616 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-05 21:07:41] 📊 Config summary: 29 districts, 306 parishes\n2025-06-05 21:07:41,616 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-05 21:07:41] 📊 Starting enhanced comprehensive filtering with 7 articles\n2025-06-05 21:07:41,616 - INFO - 📊 Starting enhanced comprehensive filtering with 7 articles\n[2025-06-05 21:07:41] 🇵🇹 Applying enhanced geographic filter...\n2025-06-05 21:07:41,617 - INFO - 🇵🇹 Applying enhanced geographic filter...\n[2025-06-05 21:07:41]    After enhanced geographic filter: 7 articles (removed 0)\n2025-06-05 21:07:41,618 - INFO -    After enhanced geographic filter: 7 articles (removed 0)\n[2025-06-05 21:07:41] ✨ Applying content quality filter...\n2025-06-05 21:07:41,618 - INFO - ✨ Applying content quality filter...\n[2025-06-05 21:07:41]    After quality filter: 6 articles (removed 1)\n2025-06-05 21:07:41,618 - INFO -    After quality filter: 6 articles (removed 1)\n[2025-06-05 21:07:41] 🔍 Applying enhanced keyword filtering...\n2025-06-05 21:07:41,618 - INFO - 🔍 Applying enhanced keyword filtering...\n[2025-06-05 21:07:41]    After enhanced keyword filter: 1 articles (removed 5)\n2025-06-05 21:07:41,618 - INFO -    After enhanced keyword filter: 1 articles (removed 5)\n[2025-06-05 21:07:41] 📅 Applying temporal relevance filter...\n2025-06-05 21:07:41,618 - INFO - 📅 Applying temporal relevance filter...\n[2025-06-05 21:07:41]    After temporal filter: 1 articles (removed 0)\n2025-06-05 21:07:41,619 - INFO -    After temporal filter: 1 articles (removed 0)\n[2025-06-05 21:07:41] 👥 Applying enhanced victim validation...\n2025-06-05 21:07:41,619 - INFO - 👥 Applying enhanced victim validation...\n[2025-06-05 21:07:41]    After victim validation: 1 articles (removed 0)\n2025-06-05 21:07:41,619 - INFO -    After victim validation: 1 articles (removed 0)\n[2025-06-05 21:07:41] ⭐ Calculating enhanced relevance scores...\n2025-06-05 21:07:41,619 - INFO - ⭐ Calculating enhanced relevance scores...\n[2025-06-05 21:07:41]    After relevance score filter (min 2): 1 articles (removed 0)\n2025-06-05 21:07:41,621 - INFO -    After relevance score filter (min 2): 1 articles (removed 0)\n[2025-06-05 21:07:41] 🔄 Removing duplicates with enhanced logic...\n2025-06-05 21:07:41,621 - INFO - 🔄 Removing duplicates with enhanced logic...\n[2025-06-05 21:07:41]    After URL deduplication: 1 articles (removed 0)\n2025-06-05 21:07:41,621 - INFO -    After URL deduplication: 1 articles (removed 0)\n[2025-06-05 21:07:41]    After content similarity deduplication: 1 articles (removed 0)\n2025-06-05 21:07:41,622 - INFO -    After content similarity deduplication: 1 articles (removed 0)\n[2025-06-05 21:07:41] 🌦️ Enhanced climate event identification...\n2025-06-05 21:07:41,622 - INFO - 🌦️ Enhanced climate event identification...\n[2025-06-05 21:07:41] ==================================================\n2025-06-05 21:07:41,627 - INFO - ==================================================\n[2025-06-05 21:07:41] Enhanced Filtering Results\n2025-06-05 21:07:41,627 - INFO - Enhanced Filtering Results\n[2025-06-05 21:07:41] ==================================================\n2025-06-05 21:07:41,627 - INFO - ==================================================\n[2025-06-05 21:07:41]   Articles After Enhanced Filters: 1\n2025-06-05 21:07:41,627 - INFO -   Articles After Enhanced Filters: 1\n[2025-06-05 21:07:41]   Articles with Victims: 1\n2025-06-05 21:07:41,627 - INFO -   Articles with Victims: 1\n[2025-06-05 21:07:41]   Articles without Victims: 0\n2025-06-05 21:07:41,627 - INFO -   Articles without Victims: 0\n[2025-06-05 21:07:41]   Total Fatalities: 0\n2025-06-05 21:07:41,627 - INFO -   Total Fatalities: 0\n[2025-06-05 21:07:41]   Total Injured: 8\n2025-06-05 21:07:41,627 - INFO -   Total Injured: 8\n[2025-06-05 21:07:41]   Total Evacuated: 0\n2025-06-05 21:07:41,627 - INFO -   Total Evacuated: 0\n[2025-06-05 21:07:41]   Total Displaced: 0\n2025-06-05 21:07:41,627 - INFO -   Total Displaced: 0\n[2025-06-05 21:07:41]   Total Missing: 0\n2025-06-05 21:07:41,627 - INFO -   Total Missing: 0\n[2025-06-05 21:07:41]   Average Relevance Score: 6.00\n2025-06-05 21:07:41,627 - INFO -   Average Relevance Score: 6.00\n[2025-06-05 21:07:41]   Top Event Types: {'desconhecido': 1}\n2025-06-05 21:07:41,627 - INFO -   Top Event Types: {'desconhecido': 1}\n[2025-06-05 21:07:41] ==================================================\n2025-06-05 21:07:41,627 - INFO - ==================================================\n[2025-06-05 21:07:41] 💾 Saving enhanced filtered articles...\n2025-06-05 21:07:41,627 - INFO - 💾 Saving enhanced filtered articles...\n📥 Novos artigos recebidos: 1\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n📂 IDs existentes no arquivo: 1\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 1\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_vitimas_filtrados.csv\n📂 IDs existentes no arquivo: 1\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-05 21:07:41] ✅ Filtered articles with victims saved: 1 articles\n2025-06-05 21:07:41,629 - INFO - ✅ Filtered articles with victims saved: 1 articles\n[2025-06-05 21:07:41] ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n2025-06-05 21:07:41,631 - INFO - ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n[2025-06-05 21:07:41] ==================================================\n2025-06-05 21:07:41,631 - INFO - ==================================================\n[2025-06-05 21:07:41] Enhanced Filtering Completed Successfully\n2025-06-05 21:07:41,631 - INFO - Enhanced Filtering Completed Successfully\n[2025-06-05 21:07:41] ==================================================\n2025-06-05 21:07:41,631 - INFO - ==================================================\n[2025-06-05 21:07:41]   Articles with Victims: 1\n2025-06-05 21:07:41,631 - INFO -   Articles with Victims: 1\n[2025-06-05 21:07:41]   Articles without Victims: 0\n2025-06-05 21:07:41,631 - INFO -   Articles without Victims: 0\n[2025-06-05 21:07:41]   Total Articles Processed: 1\n2025-06-05 21:07:41,631 - INFO -   Total Articles Processed: 1\n[2025-06-05 21:07:41]   Enhanced Filter Rate: 14.3%\n2025-06-05 21:07:41,631 - INFO -   Enhanced Filter Rate: 14.3%\n[2025-06-05 21:07:41]   Victim Rate: 100.0%\n2025-06-05 21:07:41,631 - INFO -   Victim Rate: 100.0%\n[2025-06-05 21:07:41]   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 21:07:41,631 - INFO -   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 21:07:41]   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n2025-06-05 21:07:41,631 - INFO -   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n[2025-06-05 21:07:41] ==================================================\n2025-06-05 21:07:41,631 - INFO - ==================================================\n[2025-06-05 21:07:41] ✅ Filtering completed. Found 1 articles with victims\n2025-06-05 21:07:41,631 - INFO - ✅ Filtering completed. Found 1 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
