{"timestamp":"2025-06-05T17:08:48.653387","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T17:08:48.653731","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T17:08:48.681477Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:48.682861Z","level":"info","event":"📁 Using paths from processar task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:48.684063Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:48.684568Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:48.684689Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:48.684749Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:48.684815Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:48.684869Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:48.684919Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:48.688765Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:48.688907Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:48.689144Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:48.689305Z","level":"info","event":"  - victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:48.689597Z","level":"info","event":"  - no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:48.689677Z","level":"info","event":"  - filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:48.689755Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:48.689822Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:48.689909Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.885672Z","level":"info","event":"📋 [2025-06-05 18:08:49] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.886108Z","level":"info","event":"📋 2025-06-05 18:08:49,885 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.887097Z","level":"info","event":"📋 [2025-06-05 18:08:49] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.887344Z","level":"info","event":"📋 2025-06-05 18:08:49,885 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.887773Z","level":"info","event":"📋 [2025-06-05 18:08:49] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.887897Z","level":"info","event":"📋 2025-06-05 18:08:49,885 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.887980Z","level":"info","event":"📋 [2025-06-05 18:08:49] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.888076Z","level":"info","event":"📋 2025-06-05 18:08:49,885 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.888413Z","level":"info","event":"📋 [2025-06-05 18:08:49] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.888508Z","level":"info","event":"📋 2025-06-05 18:08:49,885 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.888592Z","level":"info","event":"📋 [2025-06-05 18:08:49]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.889029Z","level":"info","event":"📋 2025-06-05 18:08:49,885 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.889091Z","level":"info","event":"📋 [2025-06-05 18:08:49]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.889143Z","level":"info","event":"📋 2025-06-05 18:08:49,885 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.889202Z","level":"info","event":"📋 [2025-06-05 18:08:49] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.889257Z","level":"info","event":"📋 2025-06-05 18:08:49,885 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.889365Z","level":"info","event":"📋 [2025-06-05 18:08:49] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.889421Z","level":"info","event":"📋 2025-06-05 18:08:49,885 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.889521Z","level":"info","event":"📋 [2025-06-05 18:08:49] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.889598Z","level":"info","event":"📋 2025-06-05 18:08:49,885 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.889827Z","level":"info","event":"📋 [2025-06-05 18:08:49] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.890903Z","level":"info","event":"📋 2025-06-05 18:08:49,887 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.891840Z","level":"info","event":"📋 [2025-06-05 18:08:49] Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.892822Z","level":"info","event":"📋 2025-06-05 18:08:49,887 - INFO - Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.892887Z","level":"info","event":"📋 [2025-06-05 18:08:49] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.892929Z","level":"info","event":"📋 2025-06-05 18:08:49,887 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.892966Z","level":"info","event":"📋 [2025-06-05 18:08:49]   Total Articles Loaded: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893003Z","level":"info","event":"📋 2025-06-05 18:08:49,887 - INFO -   Total Articles Loaded: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893038Z","level":"info","event":"📋 [2025-06-05 18:08:49]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893073Z","level":"info","event":"📋 2025-06-05 18:08:49,887 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893107Z","level":"info","event":"📋 [2025-06-05 18:08:49]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893142Z","level":"info","event":"📋 2025-06-05 18:08:49,887 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893184Z","level":"info","event":"📋 [2025-06-05 18:08:49]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893224Z","level":"info","event":"📋 2025-06-05 18:08:49,887 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893258Z","level":"info","event":"📋 [2025-06-05 18:08:49]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893291Z","level":"info","event":"📋 2025-06-05 18:08:49,887 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893324Z","level":"info","event":"📋 [2025-06-05 18:08:49] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893360Z","level":"info","event":"📋 2025-06-05 18:08:49,887 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893394Z","level":"info","event":"📋 [2025-06-05 18:08:49] 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893428Z","level":"info","event":"📋 2025-06-05 18:08:49,887 - INFO - 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893461Z","level":"info","event":"📋 [2025-06-05 18:08:49] 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893496Z","level":"info","event":"📋 2025-06-05 18:08:49,887 - INFO - 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893560Z","level":"info","event":"📋 [2025-06-05 18:08:49] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893595Z","level":"info","event":"📋 2025-06-05 18:08:49,887 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893630Z","level":"info","event":"📋 [2025-06-05 18:08:49]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893662Z","level":"info","event":"📋 2025-06-05 18:08:49,887 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893695Z","level":"info","event":"📋 [2025-06-05 18:08:49]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893728Z","level":"info","event":"📋 2025-06-05 18:08:49,887 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893761Z","level":"info","event":"📋 [2025-06-05 18:08:49]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893796Z","level":"info","event":"📋 2025-06-05 18:08:49,887 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893839Z","level":"info","event":"📋 [2025-06-05 18:08:49]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893871Z","level":"info","event":"📋 2025-06-05 18:08:49,887 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893904Z","level":"info","event":"📋 [2025-06-05 18:08:49] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893938Z","level":"info","event":"📋 2025-06-05 18:08:49,888 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.893973Z","level":"info","event":"📋 [2025-06-05 18:08:49]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.894007Z","level":"info","event":"📋 2025-06-05 18:08:49,888 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.894040Z","level":"info","event":"📋 [2025-06-05 18:08:49]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.894101Z","level":"info","event":"📋 2025-06-05 18:08:49,888 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.894136Z","level":"info","event":"📋 [2025-06-05 18:08:49] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.894168Z","level":"info","event":"📋 2025-06-05 18:08:49,889 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.894848Z","level":"info","event":"📋 [2025-06-05 18:08:49] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.895841Z","level":"info","event":"📋 2025-06-05 18:08:49,889 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.896819Z","level":"info","event":"📋 [2025-06-05 18:08:49] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.896906Z","level":"info","event":"📋 2025-06-05 18:08:49,889 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.896942Z","level":"info","event":"📋 [2025-06-05 18:08:49] 📊 Starting enhanced comprehensive filtering with 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.896976Z","level":"info","event":"📋 2025-06-05 18:08:49,889 - INFO - 📊 Starting enhanced comprehensive filtering with 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897010Z","level":"info","event":"📋 [2025-06-05 18:08:49] 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897045Z","level":"info","event":"📋 2025-06-05 18:08:49,890 - INFO - 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897077Z","level":"info","event":"📋 [2025-06-05 18:08:49]    After enhanced geographic filter: 3 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897111Z","level":"info","event":"📋 2025-06-05 18:08:49,891 - INFO -    After enhanced geographic filter: 3 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897143Z","level":"info","event":"📋 [2025-06-05 18:08:49] ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897175Z","level":"info","event":"📋 2025-06-05 18:08:49,891 - INFO - ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897207Z","level":"info","event":"📋 [2025-06-05 18:08:49]    After quality filter: 2 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897239Z","level":"info","event":"📋 2025-06-05 18:08:49,891 - INFO -    After quality filter: 2 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897276Z","level":"info","event":"📋 [2025-06-05 18:08:49] 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897308Z","level":"info","event":"📋 2025-06-05 18:08:49,891 - INFO - 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897340Z","level":"info","event":"📋 [2025-06-05 18:08:49]    After enhanced keyword filter: 0 articles (removed 2)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897373Z","level":"info","event":"📋 2025-06-05 18:08:49,892 - INFO -    After enhanced keyword filter: 0 articles (removed 2)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897404Z","level":"info","event":"📋 [2025-06-05 18:08:49] 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897444Z","level":"info","event":"📋 2025-06-05 18:08:49,892 - INFO - 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897485Z","level":"info","event":"📋 [2025-06-05 18:08:49]    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897517Z","level":"info","event":"📋 2025-06-05 18:08:49,892 - INFO -    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897550Z","level":"info","event":"📋 [2025-06-05 18:08:49] 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897582Z","level":"info","event":"📋 2025-06-05 18:08:49,892 - INFO - 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897614Z","level":"info","event":"📋 [2025-06-05 18:08:49]    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897646Z","level":"info","event":"📋 2025-06-05 18:08:49,892 - INFO -    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897698Z","level":"info","event":"📋 [2025-06-05 18:08:49] ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897737Z","level":"info","event":"📋 2025-06-05 18:08:49,892 - INFO - ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897793Z","level":"info","event":"📋 [2025-06-05 18:08:49]    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897861Z","level":"info","event":"📋 2025-06-05 18:08:49,894 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897914Z","level":"info","event":"📋 [2025-06-05 18:08:49] 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897953Z","level":"info","event":"📋 2025-06-05 18:08:49,894 - INFO - 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.897991Z","level":"info","event":"📋 [2025-06-05 18:08:49] 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.898027Z","level":"info","event":"📋 2025-06-05 18:08:49,894 - INFO - 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.898063Z","level":"info","event":"📋 [2025-06-05 18:08:49] ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.898098Z","level":"info","event":"📋 2025-06-05 18:08:49,894 - WARNING - ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.898133Z","level":"info","event":"📋 [2025-06-05 18:08:49] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.898170Z","level":"info","event":"📋 2025-06-05 18:08:49,894 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.992841Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.993027Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.993200Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.993289Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.993362Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.993438Z","level":"info","event":"⚠️ stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:49.993679","level":"info","event":"Done. Returned value was: [2025-06-05 18:08:49] Starting filtrar_artigos_vitimas_airflow\n2025-06-05 18:08:49,885 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 18:08:49] Parameters: dias=1, date=2025-06-05\n2025-06-05 18:08:49,885 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 18:08:49] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n2025-06-05 18:08:49,885 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n[2025-06-05 18:08:49] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n2025-06-05 18:08:49,885 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n[2025-06-05 18:08:49] 🔍 Path setup:\n2025-06-05 18:08:49,885 - INFO - 🔍 Path setup:\n[2025-06-05 18:08:49]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-05 18:08:49,885 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-05 18:08:49]    Project root: /opt/airflow\n2025-06-05 18:08:49,885 - INFO -    Project root: /opt/airflow\n[2025-06-05 18:08:49] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 18:08:49,885 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 18:08:49] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:08:49,885 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:08:49] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:08:49,885 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:08:49] ==================================================\n2025-06-05 18:08:49,887 - INFO - ==================================================\n[2025-06-05 18:08:49] Enhanced Filtering Started\n2025-06-05 18:08:49,887 - INFO - Enhanced Filtering Started\n[2025-06-05 18:08:49] ==================================================\n2025-06-05 18:08:49,887 - INFO - ==================================================\n[2025-06-05 18:08:49]   Total Articles Loaded: 3\n2025-06-05 18:08:49,887 - INFO -   Total Articles Loaded: 3\n[2025-06-05 18:08:49]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:08:49,887 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:08:49]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 18:08:49,887 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 18:08:49]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 18:08:49,887 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 18:08:49]   Days Filter: 1\n2025-06-05 18:08:49,887 - INFO -   Days Filter: 1\n[2025-06-05 18:08:49] ==================================================\n2025-06-05 18:08:49,887 - INFO - ==================================================\n[2025-06-05 18:08:49] 🔍 Applying enhanced comprehensive filtering logic...\n2025-06-05 18:08:49,887 - INFO - 🔍 Applying enhanced comprehensive filtering logic...\n[2025-06-05 18:08:49] 🔧 Loading configuration data for enhanced filtering...\n2025-06-05 18:08:49,887 - INFO - 🔧 Loading configuration data for enhanced filtering...\n[2025-06-05 18:08:49] 🔍 Looking for config files in multiple paths:\n2025-06-05 18:08:49,887 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-05 18:08:49]    Checking: /opt/airflow/config\n2025-06-05 18:08:49,887 - INFO -    Checking: /opt/airflow/config\n[2025-06-05 18:08:49]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-05 18:08:49,887 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-05 18:08:49]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-05 18:08:49,887 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 18:08:49]    Checking: config\n2025-06-05 18:08:49,887 - INFO -    Checking: config\n[2025-06-05 18:08:49] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-05 18:08:49,888 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 18:08:49]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-05 18:08:49,888 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-05 18:08:49]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-05 18:08:49,888 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-05 18:08:49] ✅ Loaded municipios config with 29 districts\n2025-06-05 18:08:49,889 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-05 18:08:49] ✅ Loaded eventos config with 14 events\n2025-06-05 18:08:49,889 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-05 18:08:49] 📊 Config summary: 29 districts, 306 parishes\n2025-06-05 18:08:49,889 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-05 18:08:49] 📊 Starting enhanced comprehensive filtering with 3 articles\n2025-06-05 18:08:49,889 - INFO - 📊 Starting enhanced comprehensive filtering with 3 articles\n[2025-06-05 18:08:49] 🇵🇹 Applying enhanced geographic filter...\n2025-06-05 18:08:49,890 - INFO - 🇵🇹 Applying enhanced geographic filter...\n[2025-06-05 18:08:49]    After enhanced geographic filter: 3 articles (removed 0)\n2025-06-05 18:08:49,891 - INFO -    After enhanced geographic filter: 3 articles (removed 0)\n[2025-06-05 18:08:49] ✨ Applying content quality filter...\n2025-06-05 18:08:49,891 - INFO - ✨ Applying content quality filter...\n[2025-06-05 18:08:49]    After quality filter: 2 articles (removed 1)\n2025-06-05 18:08:49,891 - INFO -    After quality filter: 2 articles (removed 1)\n[2025-06-05 18:08:49] 🔍 Applying enhanced keyword filtering...\n2025-06-05 18:08:49,891 - INFO - 🔍 Applying enhanced keyword filtering...\n[2025-06-05 18:08:49]    After enhanced keyword filter: 0 articles (removed 2)\n2025-06-05 18:08:49,892 - INFO -    After enhanced keyword filter: 0 articles (removed 2)\n[2025-06-05 18:08:49] 📅 Applying temporal relevance filter...\n2025-06-05 18:08:49,892 - INFO - 📅 Applying temporal relevance filter...\n[2025-06-05 18:08:49]    After temporal filter: 0 articles (removed 0)\n2025-06-05 18:08:49,892 - INFO -    After temporal filter: 0 articles (removed 0)\n[2025-06-05 18:08:49] 👥 Applying enhanced victim validation...\n2025-06-05 18:08:49,892 - INFO - 👥 Applying enhanced victim validation...\n[2025-06-05 18:08:49]    After victim validation: 0 articles (removed 0)\n2025-06-05 18:08:49,892 - INFO -    After victim validation: 0 articles (removed 0)\n[2025-06-05 18:08:49] ⭐ Calculating enhanced relevance scores...\n2025-06-05 18:08:49,892 - INFO - ⭐ Calculating enhanced relevance scores...\n[2025-06-05 18:08:49]    After relevance score filter (min 2): 0 articles (removed 0)\n2025-06-05 18:08:49,894 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)\n[2025-06-05 18:08:49] 🔄 Removing duplicates with enhanced logic...\n2025-06-05 18:08:49,894 - INFO - 🔄 Removing duplicates with enhanced logic...\n[2025-06-05 18:08:49] 🌦️ Enhanced climate event identification...\n2025-06-05 18:08:49,894 - INFO - 🌦️ Enhanced climate event identification...\n[2025-06-05 18:08:49] ⚠️ No articles remaining after enhanced filtering.\n2025-06-05 18:08:49,894 - WARNING - ⚠️ No articles remaining after enhanced filtering.\n[2025-06-05 18:08:49] ✅ Filtering completed. Found 0 articles with victims\n2025-06-05 18:08:49,894 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-05T20:00:04.816424","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T20:00:04.816730","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T20:00:04.840665Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.843070Z","level":"info","event":"📁 Using paths from processar task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.843443Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.843757Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.843898Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.843969Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.844024Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.844067Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.844105Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.848088Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.848376Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.848502Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.848563Z","level":"info","event":"  - victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.848622Z","level":"info","event":"  - no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.848681Z","level":"info","event":"  - filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.848747Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.848823Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:04.848905Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.961901Z","level":"info","event":"📋 [2025-06-05 21:00:05] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.962579Z","level":"info","event":"📋 2025-06-05 21:00:05,961 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.962715Z","level":"info","event":"📋 [2025-06-05 21:00:05] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.962775Z","level":"info","event":"📋 2025-06-05 21:00:05,961 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.962828Z","level":"info","event":"📋 [2025-06-05 21:00:05] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.962880Z","level":"info","event":"📋 2025-06-05 21:00:05,961 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.962938Z","level":"info","event":"📋 [2025-06-05 21:00:05] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.962987Z","level":"info","event":"📋 2025-06-05 21:00:05,961 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.963043Z","level":"info","event":"📋 [2025-06-05 21:00:05] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.963116Z","level":"info","event":"📋 2025-06-05 21:00:05,962 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.963995Z","level":"info","event":"📋 [2025-06-05 21:00:05]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.964078Z","level":"info","event":"📋 2025-06-05 21:00:05,962 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.964128Z","level":"info","event":"📋 [2025-06-05 21:00:05]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.964182Z","level":"info","event":"📋 2025-06-05 21:00:05,962 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.964230Z","level":"info","event":"📋 [2025-06-05 21:00:05] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.964283Z","level":"info","event":"📋 2025-06-05 21:00:05,962 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.964335Z","level":"info","event":"📋 [2025-06-05 21:00:05] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.964389Z","level":"info","event":"📋 2025-06-05 21:00:05,962 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.964439Z","level":"info","event":"📋 [2025-06-05 21:00:05] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.964490Z","level":"info","event":"📋 2025-06-05 21:00:05,962 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.964594Z","level":"info","event":"📋 [2025-06-05 21:00:05] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.964643Z","level":"info","event":"📋 2025-06-05 21:00:05,964 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.964691Z","level":"info","event":"📋 [2025-06-05 21:00:05] Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.964738Z","level":"info","event":"📋 2025-06-05 21:00:05,964 - INFO - Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.964793Z","level":"info","event":"📋 [2025-06-05 21:00:05] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.964860Z","level":"info","event":"📋 2025-06-05 21:00:05,964 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.964914Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Total Articles Loaded: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.964984Z","level":"info","event":"📋 2025-06-05 21:00:05,964 - INFO -   Total Articles Loaded: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.965055Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.965106Z","level":"info","event":"📋 2025-06-05 21:00:05,964 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.965163Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.965240Z","level":"info","event":"📋 2025-06-05 21:00:05,965 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.965292Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.965388Z","level":"info","event":"📋 2025-06-05 21:00:05,965 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.965574Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.965670Z","level":"info","event":"📋 2025-06-05 21:00:05,965 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.965759Z","level":"info","event":"📋 [2025-06-05 21:00:05] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.965926Z","level":"info","event":"📋 2025-06-05 21:00:05,965 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.965993Z","level":"info","event":"📋 [2025-06-05 21:00:05] 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.966386Z","level":"info","event":"📋 2025-06-05 21:00:05,965 - INFO - 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.966452Z","level":"info","event":"📋 [2025-06-05 21:00:05] 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.966534Z","level":"info","event":"📋 2025-06-05 21:00:05,965 - INFO - 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.966614Z","level":"info","event":"📋 [2025-06-05 21:00:05] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.966687Z","level":"info","event":"📋 2025-06-05 21:00:05,965 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.966751Z","level":"info","event":"📋 [2025-06-05 21:00:05]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.969134Z","level":"info","event":"📋 2025-06-05 21:00:05,965 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.969190Z","level":"info","event":"📋 [2025-06-05 21:00:05]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.969241Z","level":"info","event":"📋 2025-06-05 21:00:05,965 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.969295Z","level":"info","event":"📋 [2025-06-05 21:00:05]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.969348Z","level":"info","event":"📋 2025-06-05 21:00:05,965 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.969397Z","level":"info","event":"📋 [2025-06-05 21:00:05]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.969443Z","level":"info","event":"📋 2025-06-05 21:00:05,965 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.969517Z","level":"info","event":"📋 [2025-06-05 21:00:05] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.969565Z","level":"info","event":"📋 2025-06-05 21:00:05,965 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.969615Z","level":"info","event":"📋 [2025-06-05 21:00:05]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.969667Z","level":"info","event":"📋 2025-06-05 21:00:05,965 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.969715Z","level":"info","event":"📋 [2025-06-05 21:00:05]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.969763Z","level":"info","event":"📋 2025-06-05 21:00:05,965 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.969808Z","level":"info","event":"📋 [2025-06-05 21:00:05] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.969854Z","level":"info","event":"📋 2025-06-05 21:00:05,966 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.969903Z","level":"info","event":"📋 [2025-06-05 21:00:05] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.969950Z","level":"info","event":"📋 2025-06-05 21:00:05,966 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970043Z","level":"info","event":"📋 [2025-06-05 21:00:05] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970093Z","level":"info","event":"📋 2025-06-05 21:00:05,966 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970141Z","level":"info","event":"📋 [2025-06-05 21:00:05] 📊 Starting enhanced comprehensive filtering with 7 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970193Z","level":"info","event":"📋 2025-06-05 21:00:05,966 - INFO - 📊 Starting enhanced comprehensive filtering with 7 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970238Z","level":"info","event":"📋 [2025-06-05 21:00:05] 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970276Z","level":"info","event":"📋 2025-06-05 21:00:05,967 - INFO - 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970330Z","level":"info","event":"📋 [2025-06-05 21:00:05]    After enhanced geographic filter: 7 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970392Z","level":"info","event":"📋 2025-06-05 21:00:05,967 - INFO -    After enhanced geographic filter: 7 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970446Z","level":"info","event":"📋 [2025-06-05 21:00:05] ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970485Z","level":"info","event":"📋 2025-06-05 21:00:05,968 - INFO - ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970542Z","level":"info","event":"📋 [2025-06-05 21:00:05]    After quality filter: 6 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970581Z","level":"info","event":"📋 2025-06-05 21:00:05,968 - INFO -    After quality filter: 6 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970631Z","level":"info","event":"📋 [2025-06-05 21:00:05] 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970685Z","level":"info","event":"📋 2025-06-05 21:00:05,968 - INFO - 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970735Z","level":"info","event":"📋 [2025-06-05 21:00:05]    After enhanced keyword filter: 1 articles (removed 5)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970778Z","level":"info","event":"📋 2025-06-05 21:00:05,968 - INFO -    After enhanced keyword filter: 1 articles (removed 5)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970825Z","level":"info","event":"📋 [2025-06-05 21:00:05] 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970870Z","level":"info","event":"📋 2025-06-05 21:00:05,968 - INFO - 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970920Z","level":"info","event":"📋 [2025-06-05 21:00:05]    After temporal filter: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.970968Z","level":"info","event":"📋 2025-06-05 21:00:05,968 - INFO -    After temporal filter: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.971014Z","level":"info","event":"📋 [2025-06-05 21:00:05] 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.971076Z","level":"info","event":"📋 2025-06-05 21:00:05,969 - INFO - 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.971143Z","level":"info","event":"📋 [2025-06-05 21:00:05]    After victim validation: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.971227Z","level":"info","event":"📋 2025-06-05 21:00:05,970 - INFO -    After victim validation: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.971276Z","level":"info","event":"📋 [2025-06-05 21:00:05] ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.971324Z","level":"info","event":"📋 2025-06-05 21:00:05,970 - INFO - ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.971871Z","level":"info","event":"📋 [2025-06-05 21:00:05]    After relevance score filter (min 2): 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.971927Z","level":"info","event":"📋 2025-06-05 21:00:05,971 - INFO -    After relevance score filter (min 2): 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.971985Z","level":"info","event":"📋 [2025-06-05 21:00:05] 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.972050Z","level":"info","event":"📋 2025-06-05 21:00:05,971 - INFO - 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.972325Z","level":"info","event":"📋 [2025-06-05 21:00:05]    After URL deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.972379Z","level":"info","event":"📋 2025-06-05 21:00:05,972 - INFO -    After URL deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.972980Z","level":"info","event":"📋 [2025-06-05 21:00:05]    After content similarity deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.973042Z","level":"info","event":"📋 2025-06-05 21:00:05,972 - INFO -    After content similarity deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.973289Z","level":"info","event":"📋 [2025-06-05 21:00:05] 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.973341Z","level":"info","event":"📋 2025-06-05 21:00:05,973 - INFO - 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.975932Z","level":"info","event":"📋 [2025-06-05 21:00:05] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.976011Z","level":"info","event":"📋 2025-06-05 21:00:05,975 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.976099Z","level":"info","event":"📋 [2025-06-05 21:00:05] Enhanced Filtering Results","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.976194Z","level":"info","event":"📋 2025-06-05 21:00:05,976 - INFO - Enhanced Filtering Results","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.976267Z","level":"info","event":"📋 [2025-06-05 21:00:05] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.976354Z","level":"info","event":"📋 2025-06-05 21:00:05,976 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.976434Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Articles After Enhanced Filters: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.976505Z","level":"info","event":"📋 2025-06-05 21:00:05,976 - INFO -   Articles After Enhanced Filters: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.976604Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Articles with Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.976768Z","level":"info","event":"📋 2025-06-05 21:00:05,976 - INFO -   Articles with Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.976856Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Articles without Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.976923Z","level":"info","event":"📋 2025-06-05 21:00:05,976 - INFO -   Articles without Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.976980Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Total Fatalities: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.977057Z","level":"info","event":"📋 2025-06-05 21:00:05,976 - INFO -   Total Fatalities: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.977124Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Total Injured: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.977188Z","level":"info","event":"📋 2025-06-05 21:00:05,976 - INFO -   Total Injured: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.977248Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Total Evacuated: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.977323Z","level":"info","event":"📋 2025-06-05 21:00:05,976 - INFO -   Total Evacuated: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.978500Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Total Displaced: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.978582Z","level":"info","event":"📋 2025-06-05 21:00:05,976 - INFO -   Total Displaced: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.978666Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Total Missing: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.978711Z","level":"info","event":"📋 2025-06-05 21:00:05,976 - INFO -   Total Missing: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.980068Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Average Relevance Score: 6.00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.984080Z","level":"info","event":"📋 2025-06-05 21:00:05,976 - INFO -   Average Relevance Score: 6.00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985039Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Top Event Types: {'desconhecido': 1}","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985116Z","level":"info","event":"📋 2025-06-05 21:00:05,976 - INFO -   Top Event Types: {'desconhecido': 1}","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985160Z","level":"info","event":"📋 [2025-06-05 21:00:05] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985198Z","level":"info","event":"📋 2025-06-05 21:00:05,976 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985235Z","level":"info","event":"📋 [2025-06-05 21:00:05] 💾 Saving enhanced filtered articles...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985271Z","level":"info","event":"📋 2025-06-05 21:00:05,976 - INFO - 💾 Saving enhanced filtered articles...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985306Z","level":"info","event":"📋 📥 Novos artigos recebidos: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985342Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985416Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985455Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985525Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985567Z","level":"info","event":"📋 📥 Novos artigos recebidos: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985601Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_vitimas_filtrados.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985636Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985672Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985709Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985745Z","level":"info","event":"📋 [2025-06-05 21:00:05] ✅ Filtered articles with victims saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985779Z","level":"info","event":"📋 2025-06-05 21:00:05,977 - INFO - ✅ Filtered articles with victims saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985813Z","level":"info","event":"📋 [2025-06-05 21:00:05] ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985851Z","level":"info","event":"📋 2025-06-05 21:00:05,978 - INFO - ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985887Z","level":"info","event":"📋 [2025-06-05 21:00:05] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985920Z","level":"info","event":"📋 2025-06-05 21:00:05,978 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985957Z","level":"info","event":"📋 [2025-06-05 21:00:05] Enhanced Filtering Completed Successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.985992Z","level":"info","event":"📋 2025-06-05 21:00:05,978 - INFO - Enhanced Filtering Completed Successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.986029Z","level":"info","event":"📋 [2025-06-05 21:00:05] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.986063Z","level":"info","event":"📋 2025-06-05 21:00:05,978 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.986098Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Articles with Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.986133Z","level":"info","event":"📋 2025-06-05 21:00:05,978 - INFO -   Articles with Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.986169Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Articles without Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.986201Z","level":"info","event":"📋 2025-06-05 21:00:05,978 - INFO -   Articles without Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.986234Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Total Articles Processed: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.986267Z","level":"info","event":"📋 2025-06-05 21:00:05,978 - INFO -   Total Articles Processed: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.986312Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Enhanced Filter Rate: 14.3%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.986362Z","level":"info","event":"📋 2025-06-05 21:00:05,978 - INFO -   Enhanced Filter Rate: 14.3%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.989091Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Victim Rate: 100.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.989157Z","level":"info","event":"📋 2025-06-05 21:00:05,978 - INFO -   Victim Rate: 100.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.989219Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.989267Z","level":"info","event":"📋 2025-06-05 21:00:05,978 - INFO -   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.989317Z","level":"info","event":"📋 [2025-06-05 21:00:05]   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.989366Z","level":"info","event":"📋 2025-06-05 21:00:05,978 - INFO -   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.989415Z","level":"info","event":"📋 [2025-06-05 21:00:05] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.989461Z","level":"info","event":"📋 2025-06-05 21:00:05,978 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.989507Z","level":"info","event":"📋 [2025-06-05 21:00:05] ✅ Filtering completed. Found 1 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:05.989552Z","level":"info","event":"📋 2025-06-05 21:00:05,979 - INFO - ✅ Filtering completed. Found 1 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.047299Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.047461Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.047584Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.047649Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.047727Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.047809Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json (418 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.048121","level":"info","event":"Done. Returned value was: [2025-06-05 21:00:05] Starting filtrar_artigos_vitimas_airflow\n2025-06-05 21:00:05,961 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 21:00:05] Parameters: dias=1, date=2025-06-05\n2025-06-05 21:00:05,961 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 21:00:05] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n2025-06-05 21:00:05,961 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n[2025-06-05 21:00:05] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n2025-06-05 21:00:05,961 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n[2025-06-05 21:00:05] 🔍 Path setup:\n2025-06-05 21:00:05,962 - INFO - 🔍 Path setup:\n[2025-06-05 21:00:05]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-05 21:00:05,962 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-05 21:00:05]    Project root: /opt/airflow\n2025-06-05 21:00:05,962 - INFO -    Project root: /opt/airflow\n[2025-06-05 21:00:05] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 21:00:05,962 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 21:00:05] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 21:00:05,962 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 21:00:05] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 21:00:05,962 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 21:00:05] ==================================================\n2025-06-05 21:00:05,964 - INFO - ==================================================\n[2025-06-05 21:00:05] Enhanced Filtering Started\n2025-06-05 21:00:05,964 - INFO - Enhanced Filtering Started\n[2025-06-05 21:00:05] ==================================================\n2025-06-05 21:00:05,964 - INFO - ==================================================\n[2025-06-05 21:00:05]   Total Articles Loaded: 7\n2025-06-05 21:00:05,964 - INFO -   Total Articles Loaded: 7\n[2025-06-05 21:00:05]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 21:00:05,964 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 21:00:05]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 21:00:05,965 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 21:00:05]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 21:00:05,965 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 21:00:05]   Days Filter: 1\n2025-06-05 21:00:05,965 - INFO -   Days Filter: 1\n[2025-06-05 21:00:05] ==================================================\n2025-06-05 21:00:05,965 - INFO - ==================================================\n[2025-06-05 21:00:05] 🔍 Applying enhanced comprehensive filtering logic...\n2025-06-05 21:00:05,965 - INFO - 🔍 Applying enhanced comprehensive filtering logic...\n[2025-06-05 21:00:05] 🔧 Loading configuration data for enhanced filtering...\n2025-06-05 21:00:05,965 - INFO - 🔧 Loading configuration data for enhanced filtering...\n[2025-06-05 21:00:05] 🔍 Looking for config files in multiple paths:\n2025-06-05 21:00:05,965 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-05 21:00:05]    Checking: /opt/airflow/config\n2025-06-05 21:00:05,965 - INFO -    Checking: /opt/airflow/config\n[2025-06-05 21:00:05]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-05 21:00:05,965 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-05 21:00:05]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-05 21:00:05,965 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 21:00:05]    Checking: config\n2025-06-05 21:00:05,965 - INFO -    Checking: config\n[2025-06-05 21:00:05] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-05 21:00:05,965 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 21:00:05]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-05 21:00:05,965 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-05 21:00:05]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-05 21:00:05,965 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-05 21:00:05] ✅ Loaded municipios config with 29 districts\n2025-06-05 21:00:05,966 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-05 21:00:05] ✅ Loaded eventos config with 14 events\n2025-06-05 21:00:05,966 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-05 21:00:05] 📊 Config summary: 29 districts, 306 parishes\n2025-06-05 21:00:05,966 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-05 21:00:05] 📊 Starting enhanced comprehensive filtering with 7 articles\n2025-06-05 21:00:05,966 - INFO - 📊 Starting enhanced comprehensive filtering with 7 articles\n[2025-06-05 21:00:05] 🇵🇹 Applying enhanced geographic filter...\n2025-06-05 21:00:05,967 - INFO - 🇵🇹 Applying enhanced geographic filter...\n[2025-06-05 21:00:05]    After enhanced geographic filter: 7 articles (removed 0)\n2025-06-05 21:00:05,967 - INFO -    After enhanced geographic filter: 7 articles (removed 0)\n[2025-06-05 21:00:05] ✨ Applying content quality filter...\n2025-06-05 21:00:05,968 - INFO - ✨ Applying content quality filter...\n[2025-06-05 21:00:05]    After quality filter: 6 articles (removed 1)\n2025-06-05 21:00:05,968 - INFO -    After quality filter: 6 articles (removed 1)\n[2025-06-05 21:00:05] 🔍 Applying enhanced keyword filtering...\n2025-06-05 21:00:05,968 - INFO - 🔍 Applying enhanced keyword filtering...\n[2025-06-05 21:00:05]    After enhanced keyword filter: 1 articles (removed 5)\n2025-06-05 21:00:05,968 - INFO -    After enhanced keyword filter: 1 articles (removed 5)\n[2025-06-05 21:00:05] 📅 Applying temporal relevance filter...\n2025-06-05 21:00:05,968 - INFO - 📅 Applying temporal relevance filter...\n[2025-06-05 21:00:05]    After temporal filter: 1 articles (removed 0)\n2025-06-05 21:00:05,968 - INFO -    After temporal filter: 1 articles (removed 0)\n[2025-06-05 21:00:05] 👥 Applying enhanced victim validation...\n2025-06-05 21:00:05,969 - INFO - 👥 Applying enhanced victim validation...\n[2025-06-05 21:00:05]    After victim validation: 1 articles (removed 0)\n2025-06-05 21:00:05,970 - INFO -    After victim validation: 1 articles (removed 0)\n[2025-06-05 21:00:05] ⭐ Calculating enhanced relevance scores...\n2025-06-05 21:00:05,970 - INFO - ⭐ Calculating enhanced relevance scores...\n[2025-06-05 21:00:05]    After relevance score filter (min 2): 1 articles (removed 0)\n2025-06-05 21:00:05,971 - INFO -    After relevance score filter (min 2): 1 articles (removed 0)\n[2025-06-05 21:00:05] 🔄 Removing duplicates with enhanced logic...\n2025-06-05 21:00:05,971 - INFO - 🔄 Removing duplicates with enhanced logic...\n[2025-06-05 21:00:05]    After URL deduplication: 1 articles (removed 0)\n2025-06-05 21:00:05,972 - INFO -    After URL deduplication: 1 articles (removed 0)\n[2025-06-05 21:00:05]    After content similarity deduplication: 1 articles (removed 0)\n2025-06-05 21:00:05,972 - INFO -    After content similarity deduplication: 1 articles (removed 0)\n[2025-06-05 21:00:05] 🌦️ Enhanced climate event identification...\n2025-06-05 21:00:05,973 - INFO - 🌦️ Enhanced climate event identification...\n[2025-06-05 21:00:05] ==================================================\n2025-06-05 21:00:05,975 - INFO - ==================================================\n[2025-06-05 21:00:05] Enhanced Filtering Results\n2025-06-05 21:00:05,976 - INFO - Enhanced Filtering Results\n[2025-06-05 21:00:05] ==================================================\n2025-06-05 21:00:05,976 - INFO - ==================================================\n[2025-06-05 21:00:05]   Articles After Enhanced Filters: 1\n2025-06-05 21:00:05,976 - INFO -   Articles After Enhanced Filters: 1\n[2025-06-05 21:00:05]   Articles with Victims: 1\n2025-06-05 21:00:05,976 - INFO -   Articles with Victims: 1\n[2025-06-05 21:00:05]   Articles without Victims: 0\n2025-06-05 21:00:05,976 - INFO -   Articles without Victims: 0\n[2025-06-05 21:00:05]   Total Fatalities: 0\n2025-06-05 21:00:05,976 - INFO -   Total Fatalities: 0\n[2025-06-05 21:00:05]   Total Injured: 8\n2025-06-05 21:00:05,976 - INFO -   Total Injured: 8\n[2025-06-05 21:00:05]   Total Evacuated: 0\n2025-06-05 21:00:05,976 - INFO -   Total Evacuated: 0\n[2025-06-05 21:00:05]   Total Displaced: 0\n2025-06-05 21:00:05,976 - INFO -   Total Displaced: 0\n[2025-06-05 21:00:05]   Total Missing: 0\n2025-06-05 21:00:05,976 - INFO -   Total Missing: 0\n[2025-06-05 21:00:05]   Average Relevance Score: 6.00\n2025-06-05 21:00:05,976 - INFO -   Average Relevance Score: 6.00\n[2025-06-05 21:00:05]   Top Event Types: {'desconhecido': 1}\n2025-06-05 21:00:05,976 - INFO -   Top Event Types: {'desconhecido': 1}\n[2025-06-05 21:00:05] ==================================================\n2025-06-05 21:00:05,976 - INFO - ==================================================\n[2025-06-05 21:00:05] 💾 Saving enhanced filtered articles...\n2025-06-05 21:00:05,976 - INFO - 💾 Saving enhanced filtered articles...\n📥 Novos artigos recebidos: 1\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n📂 IDs existentes no arquivo: 1\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 1\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_vitimas_filtrados.csv\n📂 IDs existentes no arquivo: 1\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-05 21:00:05] ✅ Filtered articles with victims saved: 1 articles\n2025-06-05 21:00:05,977 - INFO - ✅ Filtered articles with victims saved: 1 articles\n[2025-06-05 21:00:05] ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n2025-06-05 21:00:05,978 - INFO - ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n[2025-06-05 21:00:05] ==================================================\n2025-06-05 21:00:05,978 - INFO - ==================================================\n[2025-06-05 21:00:05] Enhanced Filtering Completed Successfully\n2025-06-05 21:00:05,978 - INFO - Enhanced Filtering Completed Successfully\n[2025-06-05 21:00:05] ==================================================\n2025-06-05 21:00:05,978 - INFO - ==================================================\n[2025-06-05 21:00:05]   Articles with Victims: 1\n2025-06-05 21:00:05,978 - INFO -   Articles with Victims: 1\n[2025-06-05 21:00:05]   Articles without Victims: 0\n2025-06-05 21:00:05,978 - INFO -   Articles without Victims: 0\n[2025-06-05 21:00:05]   Total Articles Processed: 1\n2025-06-05 21:00:05,978 - INFO -   Total Articles Processed: 1\n[2025-06-05 21:00:05]   Enhanced Filter Rate: 14.3%\n2025-06-05 21:00:05,978 - INFO -   Enhanced Filter Rate: 14.3%\n[2025-06-05 21:00:05]   Victim Rate: 100.0%\n2025-06-05 21:00:05,978 - INFO -   Victim Rate: 100.0%\n[2025-06-05 21:00:05]   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 21:00:05,978 - INFO -   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 21:00:05]   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n2025-06-05 21:00:05,978 - INFO -   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n[2025-06-05 21:00:05] ==================================================\n2025-06-05 21:00:05,978 - INFO - ==================================================\n[2025-06-05 21:00:05] ✅ Filtering completed. Found 1 articles with victims\n2025-06-05 21:00:05,979 - INFO - ✅ Filtering completed. Found 1 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-05T20:06:08.815399","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T20:06:08.815828","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T20:06:08.863480Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:08.864340Z","level":"info","event":"📁 Using paths from processar task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:08.866333Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:08.866697Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:08.866852Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:08.866927Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:08.867003Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:08.867066Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:08.867131Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:08.872168Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:08.872469Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:08.872598Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:08.872681Z","level":"info","event":"  - victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:08.872764Z","level":"info","event":"  - no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:08.872840Z","level":"info","event":"  - filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:08.872913Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:08.872986Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:08.873156Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.277096Z","level":"info","event":"📋 [2025-06-05 21:06:10] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.277472Z","level":"info","event":"📋 2025-06-05 21:06:10,276 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.277849Z","level":"info","event":"📋 [2025-06-05 21:06:10] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.278106Z","level":"info","event":"📋 2025-06-05 21:06:10,277 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.279124Z","level":"info","event":"📋 [2025-06-05 21:06:10] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.279209Z","level":"info","event":"📋 2025-06-05 21:06:10,277 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.279279Z","level":"info","event":"📋 [2025-06-05 21:06:10] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.279335Z","level":"info","event":"📋 2025-06-05 21:06:10,277 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.279395Z","level":"info","event":"📋 [2025-06-05 21:06:10] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.279447Z","level":"info","event":"📋 2025-06-05 21:06:10,277 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.279501Z","level":"info","event":"📋 [2025-06-05 21:06:10]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.279556Z","level":"info","event":"📋 2025-06-05 21:06:10,277 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.279610Z","level":"info","event":"📋 [2025-06-05 21:06:10]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.279661Z","level":"info","event":"📋 2025-06-05 21:06:10,277 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.279715Z","level":"info","event":"📋 [2025-06-05 21:06:10] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.279769Z","level":"info","event":"📋 2025-06-05 21:06:10,277 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.279819Z","level":"info","event":"📋 [2025-06-05 21:06:10] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.279878Z","level":"info","event":"📋 2025-06-05 21:06:10,277 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.279977Z","level":"info","event":"📋 [2025-06-05 21:06:10] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.280095Z","level":"info","event":"📋 2025-06-05 21:06:10,277 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.280188Z","level":"info","event":"📋 [2025-06-05 21:06:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.280243Z","level":"info","event":"📋 2025-06-05 21:06:10,279 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.280313Z","level":"info","event":"📋 [2025-06-05 21:06:10] Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.280370Z","level":"info","event":"📋 2025-06-05 21:06:10,279 - INFO - Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.280417Z","level":"info","event":"📋 [2025-06-05 21:06:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.280476Z","level":"info","event":"📋 2025-06-05 21:06:10,279 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.280527Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Total Articles Loaded: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.280575Z","level":"info","event":"📋 2025-06-05 21:06:10,279 - INFO -   Total Articles Loaded: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.280623Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.280678Z","level":"info","event":"📋 2025-06-05 21:06:10,279 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.280731Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.280909Z","level":"info","event":"📋 2025-06-05 21:06:10,279 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.280999Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.281067Z","level":"info","event":"📋 2025-06-05 21:06:10,279 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.281146Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.281368Z","level":"info","event":"📋 2025-06-05 21:06:10,280 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.281423Z","level":"info","event":"📋 [2025-06-05 21:06:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.281464Z","level":"info","event":"📋 2025-06-05 21:06:10,280 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.281957Z","level":"info","event":"📋 [2025-06-05 21:06:10] 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.282021Z","level":"info","event":"📋 2025-06-05 21:06:10,280 - INFO - 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.282074Z","level":"info","event":"📋 [2025-06-05 21:06:10] 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.282129Z","level":"info","event":"📋 2025-06-05 21:06:10,280 - INFO - 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.282179Z","level":"info","event":"📋 [2025-06-05 21:06:10] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.282241Z","level":"info","event":"📋 2025-06-05 21:06:10,280 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.282312Z","level":"info","event":"📋 [2025-06-05 21:06:10]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.282382Z","level":"info","event":"📋 2025-06-05 21:06:10,280 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.283314Z","level":"info","event":"📋 [2025-06-05 21:06:10]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.285271Z","level":"info","event":"📋 2025-06-05 21:06:10,280 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.285336Z","level":"info","event":"📋 [2025-06-05 21:06:10]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.285384Z","level":"info","event":"📋 2025-06-05 21:06:10,280 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.285427Z","level":"info","event":"📋 [2025-06-05 21:06:10]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.285471Z","level":"info","event":"📋 2025-06-05 21:06:10,280 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.285513Z","level":"info","event":"📋 [2025-06-05 21:06:10] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.285557Z","level":"info","event":"📋 2025-06-05 21:06:10,281 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.285599Z","level":"info","event":"📋 [2025-06-05 21:06:10]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.285640Z","level":"info","event":"📋 2025-06-05 21:06:10,281 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.285680Z","level":"info","event":"📋 [2025-06-05 21:06:10]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.285722Z","level":"info","event":"📋 2025-06-05 21:06:10,281 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.285792Z","level":"info","event":"📋 [2025-06-05 21:06:10] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.285835Z","level":"info","event":"📋 2025-06-05 21:06:10,282 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.285904Z","level":"info","event":"📋 [2025-06-05 21:06:10] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.285946Z","level":"info","event":"📋 2025-06-05 21:06:10,282 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.285987Z","level":"info","event":"📋 [2025-06-05 21:06:10] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286029Z","level":"info","event":"📋 2025-06-05 21:06:10,282 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286070Z","level":"info","event":"📋 [2025-06-05 21:06:10] 📊 Starting enhanced comprehensive filtering with 7 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286111Z","level":"info","event":"📋 2025-06-05 21:06:10,282 - INFO - 📊 Starting enhanced comprehensive filtering with 7 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286151Z","level":"info","event":"📋 [2025-06-05 21:06:10] 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286192Z","level":"info","event":"📋 2025-06-05 21:06:10,283 - INFO - 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286232Z","level":"info","event":"📋 [2025-06-05 21:06:10]    After enhanced geographic filter: 7 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286279Z","level":"info","event":"📋 2025-06-05 21:06:10,283 - INFO -    After enhanced geographic filter: 7 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286320Z","level":"info","event":"📋 [2025-06-05 21:06:10] ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286360Z","level":"info","event":"📋 2025-06-05 21:06:10,283 - INFO - ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286422Z","level":"info","event":"📋 [2025-06-05 21:06:10]    After quality filter: 6 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286498Z","level":"info","event":"📋 2025-06-05 21:06:10,284 - INFO -    After quality filter: 6 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286542Z","level":"info","event":"📋 [2025-06-05 21:06:10] 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286588Z","level":"info","event":"📋 2025-06-05 21:06:10,284 - INFO - 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286642Z","level":"info","event":"📋 [2025-06-05 21:06:10]    After enhanced keyword filter: 1 articles (removed 5)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286691Z","level":"info","event":"📋 2025-06-05 21:06:10,284 - INFO -    After enhanced keyword filter: 1 articles (removed 5)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286743Z","level":"info","event":"📋 [2025-06-05 21:06:10] 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286793Z","level":"info","event":"📋 2025-06-05 21:06:10,284 - INFO - 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286842Z","level":"info","event":"📋 [2025-06-05 21:06:10]    After temporal filter: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286891Z","level":"info","event":"📋 2025-06-05 21:06:10,284 - INFO -    After temporal filter: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.286971Z","level":"info","event":"📋 [2025-06-05 21:06:10] 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.287024Z","level":"info","event":"📋 2025-06-05 21:06:10,284 - INFO - 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.287075Z","level":"info","event":"📋 [2025-06-05 21:06:10]    After victim validation: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.287136Z","level":"info","event":"📋 2025-06-05 21:06:10,285 - INFO -    After victim validation: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.287186Z","level":"info","event":"📋 [2025-06-05 21:06:10] ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.287235Z","level":"info","event":"📋 2025-06-05 21:06:10,285 - INFO - ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.287602Z","level":"info","event":"📋 [2025-06-05 21:06:10]    After relevance score filter (min 2): 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.287659Z","level":"info","event":"📋 2025-06-05 21:06:10,287 - INFO -    After relevance score filter (min 2): 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.287726Z","level":"info","event":"📋 [2025-06-05 21:06:10] 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.287781Z","level":"info","event":"📋 2025-06-05 21:06:10,287 - INFO - 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.288139Z","level":"info","event":"📋 [2025-06-05 21:06:10]    After URL deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.288216Z","level":"info","event":"📋 2025-06-05 21:06:10,288 - INFO -    After URL deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.288884Z","level":"info","event":"📋 [2025-06-05 21:06:10]    After content similarity deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.288955Z","level":"info","event":"📋 2025-06-05 21:06:10,288 - INFO -    After content similarity deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.289224Z","level":"info","event":"📋 [2025-06-05 21:06:10] 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.289278Z","level":"info","event":"📋 2025-06-05 21:06:10,289 - INFO - 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.292020Z","level":"info","event":"📋 [2025-06-05 21:06:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.292103Z","level":"info","event":"📋 2025-06-05 21:06:10,291 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.292171Z","level":"info","event":"📋 [2025-06-05 21:06:10] Enhanced Filtering Results","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.292272Z","level":"info","event":"📋 2025-06-05 21:06:10,292 - INFO - Enhanced Filtering Results","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.292322Z","level":"info","event":"📋 [2025-06-05 21:06:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.292379Z","level":"info","event":"📋 2025-06-05 21:06:10,292 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.292716Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Articles After Enhanced Filters: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.292831Z","level":"info","event":"📋 2025-06-05 21:06:10,292 - INFO -   Articles After Enhanced Filters: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.292924Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Articles with Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.293108Z","level":"info","event":"📋 2025-06-05 21:06:10,292 - INFO -   Articles with Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.293189Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Articles without Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.293269Z","level":"info","event":"📋 2025-06-05 21:06:10,292 - INFO -   Articles without Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.293355Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Total Fatalities: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.293461Z","level":"info","event":"📋 2025-06-05 21:06:10,292 - INFO -   Total Fatalities: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.293558Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Total Injured: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.293718Z","level":"info","event":"📋 2025-06-05 21:06:10,292 - INFO -   Total Injured: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.293800Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Total Evacuated: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.293894Z","level":"info","event":"📋 2025-06-05 21:06:10,292 - INFO -   Total Evacuated: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.294028Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Total Displaced: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.297294Z","level":"info","event":"📋 2025-06-05 21:06:10,292 - INFO -   Total Displaced: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.297469Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Total Missing: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.297565Z","level":"info","event":"📋 2025-06-05 21:06:10,292 - INFO -   Total Missing: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.297645Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Average Relevance Score: 6.00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.297701Z","level":"info","event":"📋 2025-06-05 21:06:10,292 - INFO -   Average Relevance Score: 6.00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.297748Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Top Event Types: {'desconhecido': 1}","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.297786Z","level":"info","event":"📋 2025-06-05 21:06:10,292 - INFO -   Top Event Types: {'desconhecido': 1}","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.297822Z","level":"info","event":"📋 [2025-06-05 21:06:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.297863Z","level":"info","event":"📋 2025-06-05 21:06:10,292 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.297906Z","level":"info","event":"📋 [2025-06-05 21:06:10] 💾 Saving enhanced filtered articles...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.297956Z","level":"info","event":"📋 2025-06-05 21:06:10,292 - INFO - 💾 Saving enhanced filtered articles...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.297994Z","level":"info","event":"📋 📥 Novos artigos recebidos: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298061Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298161Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298203Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298240Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298290Z","level":"info","event":"📋 📥 Novos artigos recebidos: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298419Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_vitimas_filtrados.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298487Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298530Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298570Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298677Z","level":"info","event":"📋 [2025-06-05 21:06:10] ✅ Filtered articles with victims saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298723Z","level":"info","event":"📋 2025-06-05 21:06:10,293 - INFO - ✅ Filtered articles with victims saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298761Z","level":"info","event":"📋 [2025-06-05 21:06:10] ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298799Z","level":"info","event":"📋 2025-06-05 21:06:10,294 - INFO - ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298834Z","level":"info","event":"📋 [2025-06-05 21:06:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298871Z","level":"info","event":"📋 2025-06-05 21:06:10,294 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298907Z","level":"info","event":"📋 [2025-06-05 21:06:10] Enhanced Filtering Completed Successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298942Z","level":"info","event":"📋 2025-06-05 21:06:10,294 - INFO - Enhanced Filtering Completed Successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.298978Z","level":"info","event":"📋 [2025-06-05 21:06:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299014Z","level":"info","event":"📋 2025-06-05 21:06:10,294 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299048Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Articles with Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299084Z","level":"info","event":"📋 2025-06-05 21:06:10,294 - INFO -   Articles with Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299118Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Articles without Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299152Z","level":"info","event":"📋 2025-06-05 21:06:10,294 - INFO -   Articles without Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299187Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Total Articles Processed: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299256Z","level":"info","event":"📋 2025-06-05 21:06:10,294 - INFO -   Total Articles Processed: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299291Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Enhanced Filter Rate: 14.3%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299327Z","level":"info","event":"📋 2025-06-05 21:06:10,294 - INFO -   Enhanced Filter Rate: 14.3%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299362Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Victim Rate: 100.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299399Z","level":"info","event":"📋 2025-06-05 21:06:10,294 - INFO -   Victim Rate: 100.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299436Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299474Z","level":"info","event":"📋 2025-06-05 21:06:10,294 - INFO -   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299509Z","level":"info","event":"📋 [2025-06-05 21:06:10]   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299544Z","level":"info","event":"📋 2025-06-05 21:06:10,294 - INFO -   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299578Z","level":"info","event":"📋 [2025-06-05 21:06:10] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299611Z","level":"info","event":"📋 2025-06-05 21:06:10,294 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299644Z","level":"info","event":"📋 [2025-06-05 21:06:10] ✅ Filtering completed. Found 1 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.299680Z","level":"info","event":"📋 2025-06-05 21:06:10,294 - INFO - ✅ Filtering completed. Found 1 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.391160Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.391398Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.391528Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.391682Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.391758Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.391863Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json (418 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.392113","level":"info","event":"Done. Returned value was: [2025-06-05 21:06:10] Starting filtrar_artigos_vitimas_airflow\n2025-06-05 21:06:10,276 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 21:06:10] Parameters: dias=1, date=2025-06-05\n2025-06-05 21:06:10,277 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 21:06:10] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n2025-06-05 21:06:10,277 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n[2025-06-05 21:06:10] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n2025-06-05 21:06:10,277 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n[2025-06-05 21:06:10] 🔍 Path setup:\n2025-06-05 21:06:10,277 - INFO - 🔍 Path setup:\n[2025-06-05 21:06:10]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-05 21:06:10,277 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-05 21:06:10]    Project root: /opt/airflow\n2025-06-05 21:06:10,277 - INFO -    Project root: /opt/airflow\n[2025-06-05 21:06:10] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 21:06:10,277 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 21:06:10] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 21:06:10,277 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 21:06:10] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 21:06:10,277 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 21:06:10] ==================================================\n2025-06-05 21:06:10,279 - INFO - ==================================================\n[2025-06-05 21:06:10] Enhanced Filtering Started\n2025-06-05 21:06:10,279 - INFO - Enhanced Filtering Started\n[2025-06-05 21:06:10] ==================================================\n2025-06-05 21:06:10,279 - INFO - ==================================================\n[2025-06-05 21:06:10]   Total Articles Loaded: 7\n2025-06-05 21:06:10,279 - INFO -   Total Articles Loaded: 7\n[2025-06-05 21:06:10]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 21:06:10,279 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 21:06:10]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 21:06:10,279 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 21:06:10]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 21:06:10,279 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 21:06:10]   Days Filter: 1\n2025-06-05 21:06:10,280 - INFO -   Days Filter: 1\n[2025-06-05 21:06:10] ==================================================\n2025-06-05 21:06:10,280 - INFO - ==================================================\n[2025-06-05 21:06:10] 🔍 Applying enhanced comprehensive filtering logic...\n2025-06-05 21:06:10,280 - INFO - 🔍 Applying enhanced comprehensive filtering logic...\n[2025-06-05 21:06:10] 🔧 Loading configuration data for enhanced filtering...\n2025-06-05 21:06:10,280 - INFO - 🔧 Loading configuration data for enhanced filtering...\n[2025-06-05 21:06:10] 🔍 Looking for config files in multiple paths:\n2025-06-05 21:06:10,280 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-05 21:06:10]    Checking: /opt/airflow/config\n2025-06-05 21:06:10,280 - INFO -    Checking: /opt/airflow/config\n[2025-06-05 21:06:10]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-05 21:06:10,280 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-05 21:06:10]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-05 21:06:10,280 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 21:06:10]    Checking: config\n2025-06-05 21:06:10,280 - INFO -    Checking: config\n[2025-06-05 21:06:10] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-05 21:06:10,281 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 21:06:10]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-05 21:06:10,281 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-05 21:06:10]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-05 21:06:10,281 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-05 21:06:10] ✅ Loaded municipios config with 29 districts\n2025-06-05 21:06:10,282 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-05 21:06:10] ✅ Loaded eventos config with 14 events\n2025-06-05 21:06:10,282 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-05 21:06:10] 📊 Config summary: 29 districts, 306 parishes\n2025-06-05 21:06:10,282 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-05 21:06:10] 📊 Starting enhanced comprehensive filtering with 7 articles\n2025-06-05 21:06:10,282 - INFO - 📊 Starting enhanced comprehensive filtering with 7 articles\n[2025-06-05 21:06:10] 🇵🇹 Applying enhanced geographic filter...\n2025-06-05 21:06:10,283 - INFO - 🇵🇹 Applying enhanced geographic filter...\n[2025-06-05 21:06:10]    After enhanced geographic filter: 7 articles (removed 0)\n2025-06-05 21:06:10,283 - INFO -    After enhanced geographic filter: 7 articles (removed 0)\n[2025-06-05 21:06:10] ✨ Applying content quality filter...\n2025-06-05 21:06:10,283 - INFO - ✨ Applying content quality filter...\n[2025-06-05 21:06:10]    After quality filter: 6 articles (removed 1)\n2025-06-05 21:06:10,284 - INFO -    After quality filter: 6 articles (removed 1)\n[2025-06-05 21:06:10] 🔍 Applying enhanced keyword filtering...\n2025-06-05 21:06:10,284 - INFO - 🔍 Applying enhanced keyword filtering...\n[2025-06-05 21:06:10]    After enhanced keyword filter: 1 articles (removed 5)\n2025-06-05 21:06:10,284 - INFO -    After enhanced keyword filter: 1 articles (removed 5)\n[2025-06-05 21:06:10] 📅 Applying temporal relevance filter...\n2025-06-05 21:06:10,284 - INFO - 📅 Applying temporal relevance filter...\n[2025-06-05 21:06:10]    After temporal filter: 1 articles (removed 0)\n2025-06-05 21:06:10,284 - INFO -    After temporal filter: 1 articles (removed 0)\n[2025-06-05 21:06:10] 👥 Applying enhanced victim validation...\n2025-06-05 21:06:10,284 - INFO - 👥 Applying enhanced victim validation...\n[2025-06-05 21:06:10]    After victim validation: 1 articles (removed 0)\n2025-06-05 21:06:10,285 - INFO -    After victim validation: 1 articles (removed 0)\n[2025-06-05 21:06:10] ⭐ Calculating enhanced relevance scores...\n2025-06-05 21:06:10,285 - INFO - ⭐ Calculating enhanced relevance scores...\n[2025-06-05 21:06:10]    After relevance score filter (min 2): 1 articles (removed 0)\n2025-06-05 21:06:10,287 - INFO -    After relevance score filter (min 2): 1 articles (removed 0)\n[2025-06-05 21:06:10] 🔄 Removing duplicates with enhanced logic...\n2025-06-05 21:06:10,287 - INFO - 🔄 Removing duplicates with enhanced logic...\n[2025-06-05 21:06:10]    After URL deduplication: 1 articles (removed 0)\n2025-06-05 21:06:10,288 - INFO -    After URL deduplication: 1 articles (removed 0)\n[2025-06-05 21:06:10]    After content similarity deduplication: 1 articles (removed 0)\n2025-06-05 21:06:10,288 - INFO -    After content similarity deduplication: 1 articles (removed 0)\n[2025-06-05 21:06:10] 🌦️ Enhanced climate event identification...\n2025-06-05 21:06:10,289 - INFO - 🌦️ Enhanced climate event identification...\n[2025-06-05 21:06:10] ==================================================\n2025-06-05 21:06:10,291 - INFO - ==================================================\n[2025-06-05 21:06:10] Enhanced Filtering Results\n2025-06-05 21:06:10,292 - INFO - Enhanced Filtering Results\n[2025-06-05 21:06:10] ==================================================\n2025-06-05 21:06:10,292 - INFO - ==================================================\n[2025-06-05 21:06:10]   Articles After Enhanced Filters: 1\n2025-06-05 21:06:10,292 - INFO -   Articles After Enhanced Filters: 1\n[2025-06-05 21:06:10]   Articles with Victims: 1\n2025-06-05 21:06:10,292 - INFO -   Articles with Victims: 1\n[2025-06-05 21:06:10]   Articles without Victims: 0\n2025-06-05 21:06:10,292 - INFO -   Articles without Victims: 0\n[2025-06-05 21:06:10]   Total Fatalities: 0\n2025-06-05 21:06:10,292 - INFO -   Total Fatalities: 0\n[2025-06-05 21:06:10]   Total Injured: 8\n2025-06-05 21:06:10,292 - INFO -   Total Injured: 8\n[2025-06-05 21:06:10]   Total Evacuated: 0\n2025-06-05 21:06:10,292 - INFO -   Total Evacuated: 0\n[2025-06-05 21:06:10]   Total Displaced: 0\n2025-06-05 21:06:10,292 - INFO -   Total Displaced: 0\n[2025-06-05 21:06:10]   Total Missing: 0\n2025-06-05 21:06:10,292 - INFO -   Total Missing: 0\n[2025-06-05 21:06:10]   Average Relevance Score: 6.00\n2025-06-05 21:06:10,292 - INFO -   Average Relevance Score: 6.00\n[2025-06-05 21:06:10]   Top Event Types: {'desconhecido': 1}\n2025-06-05 21:06:10,292 - INFO -   Top Event Types: {'desconhecido': 1}\n[2025-06-05 21:06:10] ==================================================\n2025-06-05 21:06:10,292 - INFO - ==================================================\n[2025-06-05 21:06:10] 💾 Saving enhanced filtered articles...\n2025-06-05 21:06:10,292 - INFO - 💾 Saving enhanced filtered articles...\n📥 Novos artigos recebidos: 1\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n📂 IDs existentes no arquivo: 1\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 1\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_vitimas_filtrados.csv\n📂 IDs existentes no arquivo: 1\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-05 21:06:10] ✅ Filtered articles with victims saved: 1 articles\n2025-06-05 21:06:10,293 - INFO - ✅ Filtered articles with victims saved: 1 articles\n[2025-06-05 21:06:10] ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n2025-06-05 21:06:10,294 - INFO - ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n[2025-06-05 21:06:10] ==================================================\n2025-06-05 21:06:10,294 - INFO - ==================================================\n[2025-06-05 21:06:10] Enhanced Filtering Completed Successfully\n2025-06-05 21:06:10,294 - INFO - Enhanced Filtering Completed Successfully\n[2025-06-05 21:06:10] ==================================================\n2025-06-05 21:06:10,294 - INFO - ==================================================\n[2025-06-05 21:06:10]   Articles with Victims: 1\n2025-06-05 21:06:10,294 - INFO -   Articles with Victims: 1\n[2025-06-05 21:06:10]   Articles without Victims: 0\n2025-06-05 21:06:10,294 - INFO -   Articles without Victims: 0\n[2025-06-05 21:06:10]   Total Articles Processed: 1\n2025-06-05 21:06:10,294 - INFO -   Total Articles Processed: 1\n[2025-06-05 21:06:10]   Enhanced Filter Rate: 14.3%\n2025-06-05 21:06:10,294 - INFO -   Enhanced Filter Rate: 14.3%\n[2025-06-05 21:06:10]   Victim Rate: 100.0%\n2025-06-05 21:06:10,294 - INFO -   Victim Rate: 100.0%\n[2025-06-05 21:06:10]   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 21:06:10,294 - INFO -   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 21:06:10]   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n2025-06-05 21:06:10,294 - INFO -   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n[2025-06-05 21:06:10] ==================================================\n2025-06-05 21:06:10,294 - INFO - ==================================================\n[2025-06-05 21:06:10] ✅ Filtering completed. Found 1 articles with victims\n2025-06-05 21:06:10,294 - INFO - ✅ Filtering completed. Found 1 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
