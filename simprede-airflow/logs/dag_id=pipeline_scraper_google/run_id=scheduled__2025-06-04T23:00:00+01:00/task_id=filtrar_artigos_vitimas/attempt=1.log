{"timestamp":"2025-06-05T14:38:52.737720","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T14:38:52.741696","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T14:38:52.868194Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:38:52.869592Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:38:52.870010Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:38:52.870212Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/artigos_google_municipios_pt_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:38:52.870638Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:38:52.871079Z","level":"info","event":"❌ No input file found in any expected location","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:38:52.871803Z","level":"info","event":"📁 Searching all subdirectories in /opt/airflow/scripts/google_scraper/data:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T14:38:52.847047","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"Exception","exc_value":"Input file not found in any location. Searched: ['/opt/airflow/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv', '/opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv', '/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/artigos_google_municipios_pt_20250605.csv', '/opt/airflow/scripts/google_scraper/data/structured/artigos_google_municipios_pt_2025-06-05.csv']. Please check if the previous task completed successfully.","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":838,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1130,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":212,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":235,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/google_scraper_dag.py","lineno":373,"name":"filtrar_vitimas_task"}]}]}
{"timestamp":"2025-06-05T15:54:46.620173","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T15:54:46.620599","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T15:54:48.033877Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:48.036950Z","level":"info","event":"📁 Using paths from processar task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:48.049558Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:48.051543Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:48.052020Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:48.052281Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:48.052505Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:48.052777Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:48.053172Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:48.068194Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:48.069417Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:48.069708Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:48.070370Z","level":"info","event":"  - victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:48.071064Z","level":"info","event":"  - no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:48.072007Z","level":"info","event":"  - filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:48.072776Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:48.073178Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:48.073688Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.422726Z","level":"info","event":"📋 [2025-06-05 16:54:50] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.423184Z","level":"info","event":"📋 2025-06-05 16:54:50,422 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.424129Z","level":"info","event":"📋 [2025-06-05 16:54:50] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.424589Z","level":"info","event":"📋 2025-06-05 16:54:50,422 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.424754Z","level":"info","event":"📋 [2025-06-05 16:54:50] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.424878Z","level":"info","event":"📋 2025-06-05 16:54:50,422 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.425076Z","level":"info","event":"📋 [2025-06-05 16:54:50] 🚀 Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.425949Z","level":"info","event":"📋 2025-06-05 16:54:50,422 - INFO - 🚀 Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.427234Z","level":"info","event":"📋 [2025-06-05 16:54:50] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.427379Z","level":"info","event":"📋 2025-06-05 16:54:50,422 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.427556Z","level":"info","event":"📋 [2025-06-05 16:54:50]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.427716Z","level":"info","event":"📋 2025-06-05 16:54:50,422 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.427833Z","level":"info","event":"📋 [2025-06-05 16:54:50]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.427923Z","level":"info","event":"📋 2025-06-05 16:54:50,422 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.428202Z","level":"info","event":"📋 [2025-06-05 16:54:50] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.428306Z","level":"info","event":"📋 2025-06-05 16:54:50,422 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.428413Z","level":"info","event":"📋 [2025-06-05 16:54:50] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.428513Z","level":"info","event":"📋 2025-06-05 16:54:50,423 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.428632Z","level":"info","event":"📋 [2025-06-05 16:54:50] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.428738Z","level":"info","event":"📋 2025-06-05 16:54:50,423 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.428881Z","level":"info","event":"📋 [2025-06-05 16:54:50] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.428993Z","level":"info","event":"📋 2025-06-05 16:54:50,427 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.429077Z","level":"info","event":"📋 [2025-06-05 16:54:50] Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.429426Z","level":"info","event":"📋 2025-06-05 16:54:50,427 - INFO - Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.429607Z","level":"info","event":"📋 [2025-06-05 16:54:50] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.429920Z","level":"info","event":"📋 2025-06-05 16:54:50,428 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.430659Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Total Articles Loaded: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.430937Z","level":"info","event":"📋 2025-06-05 16:54:50,428 - INFO -   Total Articles Loaded: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.431071Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.432003Z","level":"info","event":"📋 2025-06-05 16:54:50,428 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.432121Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.432231Z","level":"info","event":"📋 2025-06-05 16:54:50,428 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.432439Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.432602Z","level":"info","event":"📋 2025-06-05 16:54:50,428 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.432936Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.434491Z","level":"info","event":"📋 2025-06-05 16:54:50,428 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.435376Z","level":"info","event":"📋 [2025-06-05 16:54:50] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.435483Z","level":"info","event":"📋 2025-06-05 16:54:50,428 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.435558Z","level":"info","event":"📋 [2025-06-05 16:54:50] 🔍 Applying comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.435627Z","level":"info","event":"📋 2025-06-05 16:54:50,428 - INFO - 🔍 Applying comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.435696Z","level":"info","event":"📋 [2025-06-05 16:54:50] 🔧 Loading configuration data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.435829Z","level":"info","event":"📋 2025-06-05 16:54:50,428 - INFO - 🔧 Loading configuration data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.435900Z","level":"info","event":"📋 [2025-06-05 16:54:50] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.435968Z","level":"info","event":"📋 2025-06-05 16:54:50,429 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.436051Z","level":"info","event":"📋 [2025-06-05 16:54:50]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.436137Z","level":"info","event":"📋 2025-06-05 16:54:50,429 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.436241Z","level":"info","event":"📋 [2025-06-05 16:54:50]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.436378Z","level":"info","event":"📋 2025-06-05 16:54:50,429 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.436453Z","level":"info","event":"📋 [2025-06-05 16:54:50]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.436529Z","level":"info","event":"📋 2025-06-05 16:54:50,429 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.436593Z","level":"info","event":"📋 [2025-06-05 16:54:50]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.436657Z","level":"info","event":"📋 2025-06-05 16:54:50,429 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.436721Z","level":"info","event":"📋 [2025-06-05 16:54:50] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.436786Z","level":"info","event":"📋 2025-06-05 16:54:50,430 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.436851Z","level":"info","event":"📋 [2025-06-05 16:54:50]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.436956Z","level":"info","event":"📋 2025-06-05 16:54:50,430 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.437041Z","level":"info","event":"📋 [2025-06-05 16:54:50]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.437133Z","level":"info","event":"📋 2025-06-05 16:54:50,430 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.437217Z","level":"info","event":"📋 [2025-06-05 16:54:50] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.437285Z","level":"info","event":"📋 2025-06-05 16:54:50,432 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.437366Z","level":"info","event":"📋 [2025-06-05 16:54:50] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.437443Z","level":"info","event":"📋 2025-06-05 16:54:50,433 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.437518Z","level":"info","event":"📋 [2025-06-05 16:54:50] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.437584Z","level":"info","event":"📋 2025-06-05 16:54:50,433 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.437649Z","level":"info","event":"📋 [2025-06-05 16:54:50] 📊 Starting comprehensive filtering with 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.437714Z","level":"info","event":"📋 2025-06-05 16:54:50,433 - INFO - 📊 Starting comprehensive filtering with 2 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.437812Z","level":"info","event":"📋 [2025-06-05 16:54:50] 🇵🇹 Applying national article filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.437881Z","level":"info","event":"📋 2025-06-05 16:54:50,435 - INFO - 🇵🇹 Applying national article filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.438007Z","level":"info","event":"📋 [2025-06-05 16:54:50]    After national filter: 2 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.438083Z","level":"info","event":"📋 2025-06-05 16:54:50,436 - INFO -    After national filter: 2 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.438149Z","level":"info","event":"📋 [2025-06-05 16:54:50] 🚫 Applying unwanted keywords filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.438215Z","level":"info","event":"📋 2025-06-05 16:54:50,436 - INFO - 🚫 Applying unwanted keywords filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.440047Z","level":"info","event":"📋 [2025-06-05 16:54:50]    After unwanted keywords filter: 2 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.440144Z","level":"info","event":"📋 2025-06-05 16:54:50,439 - INFO -    After unwanted keywords filter: 2 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.440215Z","level":"info","event":"📋 [2025-06-05 16:54:50] 📅 Applying year range filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.440329Z","level":"info","event":"📋 2025-06-05 16:54:50,440 - INFO - 📅 Applying year range filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.440473Z","level":"info","event":"📋 [2025-06-05 16:54:50]    After year filter: 2 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.440586Z","level":"info","event":"📋 2025-06-05 16:54:50,440 - INFO -    After year filter: 2 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.440657Z","level":"info","event":"📋 [2025-06-05 16:54:50] ⭐ Calculating relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.440733Z","level":"info","event":"📋 2025-06-05 16:54:50,440 - INFO - ⭐ Calculating relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.440941Z","level":"info","event":"📋 [2025-06-05 16:54:50] 🎯 Applying relevance and victim filters...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.441033Z","level":"info","event":"📋 2025-06-05 16:54:50,440 - INFO - 🎯 Applying relevance and victim filters...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.442951Z","level":"info","event":"📋 [2025-06-05 16:54:50]    After relevance/victim filter: 1 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.443042Z","level":"info","event":"📋 2025-06-05 16:54:50,442 - INFO -    After relevance/victim filter: 1 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.443144Z","level":"info","event":"📋 [2025-06-05 16:54:50] 🔄 Removing URL duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.443257Z","level":"info","event":"📋 2025-06-05 16:54:50,442 - INFO - 🔄 Removing URL duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.444189Z","level":"info","event":"📋 [2025-06-05 16:54:50]    After URL deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.444287Z","level":"info","event":"📋 2025-06-05 16:54:50,444 - INFO -    After URL deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.445206Z","level":"info","event":"📋 [2025-06-05 16:54:50] 🌦️ Identifying climate events...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.445288Z","level":"info","event":"📋 2025-06-05 16:54:50,445 - INFO - 🌦️ Identifying climate events...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.445659Z","level":"info","event":"📋 [2025-06-05 16:54:50] 🔄 Removing event-based duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.445814Z","level":"info","event":"📋 2025-06-05 16:54:50,445 - INFO - 🔄 Removing event-based duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.448514Z","level":"info","event":"📋 [2025-06-05 16:54:50]    After event deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.448607Z","level":"info","event":"📋 2025-06-05 16:54:50,448 - INFO -    After event deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.467143Z","level":"info","event":"📋 [2025-06-05 16:54:50] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.467380Z","level":"info","event":"📋 2025-06-05 16:54:50,466 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.467558Z","level":"info","event":"📋 [2025-06-05 16:54:50] Comprehensive Filtering Results","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.467885Z","level":"info","event":"📋 2025-06-05 16:54:50,466 - INFO - Comprehensive Filtering Results","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.468138Z","level":"info","event":"📋 [2025-06-05 16:54:50] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.468251Z","level":"info","event":"📋 2025-06-05 16:54:50,466 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.468398Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Articles After All Filters: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.468583Z","level":"info","event":"📋 2025-06-05 16:54:50,466 - INFO -   Articles After All Filters: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.468726Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Articles with Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.468949Z","level":"info","event":"📋 2025-06-05 16:54:50,466 - INFO -   Articles with Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.469224Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Articles without Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.469478Z","level":"info","event":"📋 2025-06-05 16:54:50,466 - INFO -   Articles without Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.469594Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Total Fatalities: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.469713Z","level":"info","event":"📋 2025-06-05 16:54:50,466 - INFO -   Total Fatalities: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.471439Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Total Injured: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.472366Z","level":"info","event":"📋 2025-06-05 16:54:50,466 - INFO -   Total Injured: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.472460Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Total Evacuated: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.472537Z","level":"info","event":"📋 2025-06-05 16:54:50,466 - INFO -   Total Evacuated: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.472603Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Total Displaced: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.472666Z","level":"info","event":"📋 2025-06-05 16:54:50,466 - INFO -   Total Displaced: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.472730Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Total Missing: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.472801Z","level":"info","event":"📋 2025-06-05 16:54:50,466 - INFO -   Total Missing: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.472918Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Average Relevance Score: 1.00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.472982Z","level":"info","event":"📋 2025-06-05 16:54:50,466 - INFO -   Average Relevance Score: 1.00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.475375Z","level":"info","event":"📋 [2025-06-05 16:54:50] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.475460Z","level":"info","event":"📋 2025-06-05 16:54:50,466 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.475524Z","level":"info","event":"📋 [2025-06-05 16:54:50] 💾 Saving comprehensively filtered articles...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.475593Z","level":"info","event":"📋 2025-06-05 16:54:50,466 - INFO - 💾 Saving comprehensively filtered articles...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.475657Z","level":"info","event":"📋 📥 Novos artigos recebidos: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.475803Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.475873Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.475937Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.478372Z","level":"info","event":"📋 💾 Guardados 1 artigos no arquivo /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_2025-06-05.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.478520Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.478656Z","level":"info","event":"📋 [2025-06-05 16:54:50] ✅ Articles without victims saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.478803Z","level":"info","event":"📋 2025-06-05 16:54:50,468 - INFO - ✅ Articles without victims saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.478914Z","level":"info","event":"📋 [2025-06-05 16:54:50] ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.479043Z","level":"info","event":"📋 2025-06-05 16:54:50,469 - INFO - ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.479153Z","level":"info","event":"📋 [2025-06-05 16:54:50] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.479302Z","level":"info","event":"📋 2025-06-05 16:54:50,469 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.479445Z","level":"info","event":"📋 [2025-06-05 16:54:50] Comprehensive Filtering Completed Successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.479586Z","level":"info","event":"📋 2025-06-05 16:54:50,469 - INFO - Comprehensive Filtering Completed Successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.479748Z","level":"info","event":"📋 [2025-06-05 16:54:50] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.479843Z","level":"info","event":"📋 2025-06-05 16:54:50,469 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.480020Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Articles with Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.480094Z","level":"info","event":"📋 2025-06-05 16:54:50,469 - INFO -   Articles with Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.480176Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Articles without Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.480255Z","level":"info","event":"📋 2025-06-05 16:54:50,469 - INFO -   Articles without Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.480355Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Total Articles Processed: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.480469Z","level":"info","event":"📋 2025-06-05 16:54:50,469 - INFO -   Total Articles Processed: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.480573Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Filter Rate: 50.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.480645Z","level":"info","event":"📋 2025-06-05 16:54:50,470 - INFO -   Filter Rate: 50.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.480725Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Victim Rate: 0.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.480804Z","level":"info","event":"📋 2025-06-05 16:54:50,470 - INFO -   Victim Rate: 0.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.480874Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.480959Z","level":"info","event":"📋 2025-06-05 16:54:50,470 - INFO -   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.481044Z","level":"info","event":"📋 [2025-06-05 16:54:50]   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.481116Z","level":"info","event":"📋 2025-06-05 16:54:50,470 - INFO -   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.481186Z","level":"info","event":"📋 [2025-06-05 16:54:50] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.481257Z","level":"info","event":"📋 2025-06-05 16:54:50,470 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.481328Z","level":"info","event":"📋 [2025-06-05 16:54:50] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.481444Z","level":"info","event":"📋 2025-06-05 16:54:50,470 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.585389Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.585605Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.585777Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.585926Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.586143Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.586311Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json (512 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:54:50.587015","level":"info","event":"Done. Returned value was: [2025-06-05 16:54:50] Starting filtrar_artigos_vitimas_airflow\n2025-06-05 16:54:50,422 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 16:54:50] Parameters: dias=1, date=2025-06-05\n2025-06-05 16:54:50,422 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 16:54:50] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n2025-06-05 16:54:50,422 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n[2025-06-05 16:54:50] 🚀 Starting filtrar_artigos_vitimas_airflow\n2025-06-05 16:54:50,422 - INFO - 🚀 Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 16:54:50] 🔍 Path setup:\n2025-06-05 16:54:50,422 - INFO - 🔍 Path setup:\n[2025-06-05 16:54:50]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-05 16:54:50,422 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-05 16:54:50]    Project root: /opt/airflow\n2025-06-05 16:54:50,422 - INFO -    Project root: /opt/airflow\n[2025-06-05 16:54:50] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 16:54:50,422 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 16:54:50] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 16:54:50,423 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 16:54:50] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 16:54:50,423 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 16:54:50] ==================================================\n2025-06-05 16:54:50,427 - INFO - ==================================================\n[2025-06-05 16:54:50] Filtering Started\n2025-06-05 16:54:50,427 - INFO - Filtering Started\n[2025-06-05 16:54:50] ==================================================\n2025-06-05 16:54:50,428 - INFO - ==================================================\n[2025-06-05 16:54:50]   Total Articles Loaded: 2\n2025-06-05 16:54:50,428 - INFO -   Total Articles Loaded: 2\n[2025-06-05 16:54:50]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 16:54:50,428 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 16:54:50]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 16:54:50,428 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 16:54:50]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 16:54:50,428 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 16:54:50]   Days Filter: 1\n2025-06-05 16:54:50,428 - INFO -   Days Filter: 1\n[2025-06-05 16:54:50] ==================================================\n2025-06-05 16:54:50,428 - INFO - ==================================================\n[2025-06-05 16:54:50] 🔍 Applying comprehensive filtering logic...\n2025-06-05 16:54:50,428 - INFO - 🔍 Applying comprehensive filtering logic...\n[2025-06-05 16:54:50] 🔧 Loading configuration data...\n2025-06-05 16:54:50,428 - INFO - 🔧 Loading configuration data...\n[2025-06-05 16:54:50] 🔍 Looking for config files in multiple paths:\n2025-06-05 16:54:50,429 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-05 16:54:50]    Checking: /opt/airflow/config\n2025-06-05 16:54:50,429 - INFO -    Checking: /opt/airflow/config\n[2025-06-05 16:54:50]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-05 16:54:50,429 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-05 16:54:50]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-05 16:54:50,429 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 16:54:50]    Checking: config\n2025-06-05 16:54:50,429 - INFO -    Checking: config\n[2025-06-05 16:54:50] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-05 16:54:50,430 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 16:54:50]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-05 16:54:50,430 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-05 16:54:50]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-05 16:54:50,430 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-05 16:54:50] ✅ Loaded municipios config with 29 districts\n2025-06-05 16:54:50,432 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-05 16:54:50] ✅ Loaded eventos config with 14 events\n2025-06-05 16:54:50,433 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-05 16:54:50] 📊 Config summary: 29 districts, 306 parishes\n2025-06-05 16:54:50,433 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-05 16:54:50] 📊 Starting comprehensive filtering with 2 articles\n2025-06-05 16:54:50,433 - INFO - 📊 Starting comprehensive filtering with 2 articles\n[2025-06-05 16:54:50] 🇵🇹 Applying national article filter...\n2025-06-05 16:54:50,435 - INFO - 🇵🇹 Applying national article filter...\n[2025-06-05 16:54:50]    After national filter: 2 articles (removed 0)\n2025-06-05 16:54:50,436 - INFO -    After national filter: 2 articles (removed 0)\n[2025-06-05 16:54:50] 🚫 Applying unwanted keywords filter...\n2025-06-05 16:54:50,436 - INFO - 🚫 Applying unwanted keywords filter...\n[2025-06-05 16:54:50]    After unwanted keywords filter: 2 articles (removed 0)\n2025-06-05 16:54:50,439 - INFO -    After unwanted keywords filter: 2 articles (removed 0)\n[2025-06-05 16:54:50] 📅 Applying year range filter...\n2025-06-05 16:54:50,440 - INFO - 📅 Applying year range filter...\n[2025-06-05 16:54:50]    After year filter: 2 articles (removed 0)\n2025-06-05 16:54:50,440 - INFO -    After year filter: 2 articles (removed 0)\n[2025-06-05 16:54:50] ⭐ Calculating relevance scores...\n2025-06-05 16:54:50,440 - INFO - ⭐ Calculating relevance scores...\n[2025-06-05 16:54:50] 🎯 Applying relevance and victim filters...\n2025-06-05 16:54:50,440 - INFO - 🎯 Applying relevance and victim filters...\n[2025-06-05 16:54:50]    After relevance/victim filter: 1 articles (removed 1)\n2025-06-05 16:54:50,442 - INFO -    After relevance/victim filter: 1 articles (removed 1)\n[2025-06-05 16:54:50] 🔄 Removing URL duplicates...\n2025-06-05 16:54:50,442 - INFO - 🔄 Removing URL duplicates...\n[2025-06-05 16:54:50]    After URL deduplication: 1 articles (removed 0)\n2025-06-05 16:54:50,444 - INFO -    After URL deduplication: 1 articles (removed 0)\n[2025-06-05 16:54:50] 🌦️ Identifying climate events...\n2025-06-05 16:54:50,445 - INFO - 🌦️ Identifying climate events...\n[2025-06-05 16:54:50] 🔄 Removing event-based duplicates...\n2025-06-05 16:54:50,445 - INFO - 🔄 Removing event-based duplicates...\n[2025-06-05 16:54:50]    After event deduplication: 1 articles (removed 0)\n2025-06-05 16:54:50,448 - INFO -    After event deduplication: 1 articles (removed 0)\n[2025-06-05 16:54:50] ==================================================\n2025-06-05 16:54:50,466 - INFO - ==================================================\n[2025-06-05 16:54:50] Comprehensive Filtering Results\n2025-06-05 16:54:50,466 - INFO - Comprehensive Filtering Results\n[2025-06-05 16:54:50] ==================================================\n2025-06-05 16:54:50,466 - INFO - ==================================================\n[2025-06-05 16:54:50]   Articles After All Filters: 1\n2025-06-05 16:54:50,466 - INFO -   Articles After All Filters: 1\n[2025-06-05 16:54:50]   Articles with Victims: 0\n2025-06-05 16:54:50,466 - INFO -   Articles with Victims: 0\n[2025-06-05 16:54:50]   Articles without Victims: 1\n2025-06-05 16:54:50,466 - INFO -   Articles without Victims: 1\n[2025-06-05 16:54:50]   Total Fatalities: 0\n2025-06-05 16:54:50,466 - INFO -   Total Fatalities: 0\n[2025-06-05 16:54:50]   Total Injured: 0\n2025-06-05 16:54:50,466 - INFO -   Total Injured: 0\n[2025-06-05 16:54:50]   Total Evacuated: 0\n2025-06-05 16:54:50,466 - INFO -   Total Evacuated: 0\n[2025-06-05 16:54:50]   Total Displaced: 0\n2025-06-05 16:54:50,466 - INFO -   Total Displaced: 0\n[2025-06-05 16:54:50]   Total Missing: 0\n2025-06-05 16:54:50,466 - INFO -   Total Missing: 0\n[2025-06-05 16:54:50]   Average Relevance Score: 1.00\n2025-06-05 16:54:50,466 - INFO -   Average Relevance Score: 1.00\n[2025-06-05 16:54:50] ==================================================\n2025-06-05 16:54:50,466 - INFO - ==================================================\n[2025-06-05 16:54:50] 💾 Saving comprehensively filtered articles...\n2025-06-05 16:54:50,466 - INFO - 💾 Saving comprehensively filtered articles...\n📥 Novos artigos recebidos: 1\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_2025-06-05.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 1\n💾 Guardados 1 artigos no arquivo /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_2025-06-05.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_2025-06-05.csv\n[2025-06-05 16:54:50] ✅ Articles without victims saved: 1 articles\n2025-06-05 16:54:50,468 - INFO - ✅ Articles without victims saved: 1 articles\n[2025-06-05 16:54:50] ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n2025-06-05 16:54:50,469 - INFO - ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n[2025-06-05 16:54:50] ==================================================\n2025-06-05 16:54:50,469 - INFO - ==================================================\n[2025-06-05 16:54:50] Comprehensive Filtering Completed Successfully\n2025-06-05 16:54:50,469 - INFO - Comprehensive Filtering Completed Successfully\n[2025-06-05 16:54:50] ==================================================\n2025-06-05 16:54:50,469 - INFO - ==================================================\n[2025-06-05 16:54:50]   Articles with Victims: 0\n2025-06-05 16:54:50,469 - INFO -   Articles with Victims: 0\n[2025-06-05 16:54:50]   Articles without Victims: 1\n2025-06-05 16:54:50,469 - INFO -   Articles without Victims: 1\n[2025-06-05 16:54:50]   Total Articles Processed: 1\n2025-06-05 16:54:50,469 - INFO -   Total Articles Processed: 1\n[2025-06-05 16:54:50]   Filter Rate: 50.0%\n2025-06-05 16:54:50,470 - INFO -   Filter Rate: 50.0%\n[2025-06-05 16:54:50]   Victim Rate: 0.0%\n2025-06-05 16:54:50,470 - INFO -   Victim Rate: 0.0%\n[2025-06-05 16:54:50]   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 16:54:50,470 - INFO -   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 16:54:50]   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n2025-06-05 16:54:50,470 - INFO -   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n[2025-06-05 16:54:50] ==================================================\n2025-06-05 16:54:50,470 - INFO - ==================================================\n[2025-06-05 16:54:50] ✅ Filtering completed. Found 0 articles with victims\n2025-06-05 16:54:50,470 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
