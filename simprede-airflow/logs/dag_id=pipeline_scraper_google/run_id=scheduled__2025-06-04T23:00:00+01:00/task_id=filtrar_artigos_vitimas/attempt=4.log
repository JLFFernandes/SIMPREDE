{"timestamp":"2025-06-05T15:39:22.967363","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T15:39:22.967980","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T15:39:24.790065Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.792706Z","level":"info","event":"📁 Using paths from processar task: 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.801628Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/04', '/opt/airflow/data/structured/2025/06/04', '/opt/airflow/data/processed/2025/06/04']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.802122Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.802278Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.802452Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.802569Z","level":"info","event":"  - Target date: 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.802686Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.814190Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.815728Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.816044Z","level":"info","event":"✅ Found input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.816495Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.817017Z","level":"info","event":"  - victims_articles: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.817556Z","level":"info","event":"  - no_victims_articles: /opt/airflow/data/processed/2025/06/04/artigos_sem_vitimas_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.817826Z","level":"info","event":"  - filtering_log: /opt/airflow/data/processed/2025/06/04/filtering_log_20250604.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.818032Z","level":"info","event":"  - stats_json: /opt/airflow/data/processed/2025/06/04/filtering_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.818206Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json --output_dir /opt/airflow/data/processed/2025/06/04 --date_str 2025-06-04 --date 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.818455Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.107233Z","level":"info","event":"📋 [2025-06-05 16:39:29] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.108440Z","level":"info","event":"📋 2025-06-05 16:39:29,105 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.108746Z","level":"info","event":"📋 [2025-06-05 16:39:29] Parameters: dias=1, date=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.109958Z","level":"info","event":"📋 2025-06-05 16:39:29,106 - INFO - Parameters: dias=1, date=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.110212Z","level":"info","event":"📋 [2025-06-05 16:39:29] Paths: input_file=/opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json, output_dir=/opt/airflow/data/processed/2025/06/04, date_str=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.110664Z","level":"info","event":"📋 2025-06-05 16:39:29,106 - INFO - Paths: input_file=/opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json, output_dir=/opt/airflow/data/processed/2025/06/04, date_str=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.111226Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🚀 Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.112203Z","level":"info","event":"📋 2025-06-05 16:39:29,106 - INFO - 🚀 Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.184705Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.185066Z","level":"info","event":"📋 2025-06-05 16:39:29,107 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.185394Z","level":"info","event":"📋 [2025-06-05 16:39:29]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.185638Z","level":"info","event":"📋 2025-06-05 16:39:29,107 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.185819Z","level":"info","event":"📋 [2025-06-05 16:39:29]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.186005Z","level":"info","event":"📋 2025-06-05 16:39:29,107 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.186167Z","level":"info","event":"📋 [2025-06-05 16:39:29] 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.186323Z","level":"info","event":"📋 2025-06-05 16:39:29,107 - INFO - 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.186473Z","level":"info","event":"📋 [2025-06-05 16:39:29] 📁 Using provided input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.186793Z","level":"info","event":"📋 2025-06-05 16:39:29,109 - INFO - 📁 Using provided input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.187698Z","level":"info","event":"📋 [2025-06-05 16:39:29] 📂 Loading articles from: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.187916Z","level":"info","event":"📋 2025-06-05 16:39:29,109 - INFO - 📂 Loading articles from: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.188082Z","level":"info","event":"📋 [2025-06-05 16:39:29] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.188422Z","level":"info","event":"📋 2025-06-05 16:39:29,116 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.188684Z","level":"info","event":"📋 [2025-06-05 16:39:29] Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.188837Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO - Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.189080Z","level":"info","event":"📋 [2025-06-05 16:39:29] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.189224Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.189354Z","level":"info","event":"📋 [2025-06-05 16:39:29]   Total Articles Loaded: 10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.189480Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO -   Total Articles Loaded: 10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.189604Z","level":"info","event":"📋 [2025-06-05 16:39:29]   Input File: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.189728Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO -   Input File: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.189875Z","level":"info","event":"📋 [2025-06-05 16:39:29]   Output File: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.189988Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO -   Output File: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.190113Z","level":"info","event":"📋 [2025-06-05 16:39:29]   Processed Data Directory: /opt/airflow/data/processed/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.190738Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO -   Processed Data Directory: /opt/airflow/data/processed/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.191055Z","level":"info","event":"📋 [2025-06-05 16:39:29]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.191560Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.191956Z","level":"info","event":"📋 [2025-06-05 16:39:29] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.193122Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.195596Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🔍 Applying comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.195908Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO - 🔍 Applying comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.196457Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🔧 Loading configuration data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.196669Z","level":"info","event":"📋 2025-06-05 16:39:29,123 - INFO - 🔧 Loading configuration data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.197872Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.198241Z","level":"info","event":"📋 2025-06-05 16:39:29,123 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.198490Z","level":"info","event":"📋 [2025-06-05 16:39:29]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.199120Z","level":"info","event":"📋 2025-06-05 16:39:29,123 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.199587Z","level":"info","event":"📋 [2025-06-05 16:39:29]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.199844Z","level":"info","event":"📋 2025-06-05 16:39:29,123 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.200118Z","level":"info","event":"📋 [2025-06-05 16:39:29]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.200354Z","level":"info","event":"📋 2025-06-05 16:39:29,123 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.200783Z","level":"info","event":"📋 [2025-06-05 16:39:29]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.201052Z","level":"info","event":"📋 2025-06-05 16:39:29,123 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.201279Z","level":"info","event":"📋 [2025-06-05 16:39:29] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.202895Z","level":"info","event":"📋 2025-06-05 16:39:29,135 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.204404Z","level":"info","event":"📋 [2025-06-05 16:39:29]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.205851Z","level":"info","event":"📋 2025-06-05 16:39:29,136 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.206925Z","level":"info","event":"📋 [2025-06-05 16:39:29]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.210641Z","level":"info","event":"📋 2025-06-05 16:39:29,136 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.211174Z","level":"info","event":"📋 [2025-06-05 16:39:29] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.211697Z","level":"info","event":"📋 2025-06-05 16:39:29,139 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.211978Z","level":"info","event":"📋 [2025-06-05 16:39:29] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.212130Z","level":"info","event":"📋 2025-06-05 16:39:29,140 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.212249Z","level":"info","event":"📋 [2025-06-05 16:39:29] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.212468Z","level":"info","event":"📋 2025-06-05 16:39:29,140 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.212671Z","level":"info","event":"📋 [2025-06-05 16:39:29] 📊 Starting comprehensive filtering with 10 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.212806Z","level":"info","event":"📋 2025-06-05 16:39:29,141 - INFO - 📊 Starting comprehensive filtering with 10 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.212924Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🇵🇹 Applying national article filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.213040Z","level":"info","event":"📋 2025-06-05 16:39:29,145 - INFO - 🇵🇹 Applying national article filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.213263Z","level":"info","event":"📋 [2025-06-05 16:39:29]    After national filter: 0 articles (removed 10)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.213372Z","level":"info","event":"📋 2025-06-05 16:39:29,149 - INFO -    After national filter: 0 articles (removed 10)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.213466Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🚫 Applying unwanted keywords filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.213649Z","level":"info","event":"📋 2025-06-05 16:39:29,149 - INFO - 🚫 Applying unwanted keywords filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.213833Z","level":"info","event":"📋 [2025-06-05 16:39:29]    After unwanted keywords filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.214424Z","level":"info","event":"📋 2025-06-05 16:39:29,149 - INFO -    After unwanted keywords filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.216694Z","level":"info","event":"📋 [2025-06-05 16:39:29] 📅 Applying year range filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.218926Z","level":"info","event":"📋 2025-06-05 16:39:29,149 - INFO - 📅 Applying year range filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.219860Z","level":"info","event":"📋 [2025-06-05 16:39:29]    After year filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.220147Z","level":"info","event":"📋 2025-06-05 16:39:29,150 - INFO -    After year filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.220320Z","level":"info","event":"📋 [2025-06-05 16:39:29] ⭐ Calculating relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.220469Z","level":"info","event":"📋 2025-06-05 16:39:29,150 - INFO - ⭐ Calculating relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.220654Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🎯 Applying relevance and victim filters...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.220816Z","level":"info","event":"📋 2025-06-05 16:39:29,151 - INFO - 🎯 Applying relevance and victim filters...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.222543Z","level":"info","event":"📋 [2025-06-05 16:39:29]    After relevance/victim filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.222817Z","level":"info","event":"📋 2025-06-05 16:39:29,154 - INFO -    After relevance/victim filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.222977Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🌦️ Identifying climate events...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.223142Z","level":"info","event":"📋 2025-06-05 16:39:29,155 - INFO - 🌦️ Identifying climate events...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.223289Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🔄 Removing event-based duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.223436Z","level":"info","event":"📋 2025-06-05 16:39:29,156 - INFO - 🔄 Removing event-based duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.223573Z","level":"info","event":"📋 [2025-06-05 16:39:29]    After event deduplication: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.223709Z","level":"info","event":"📋 2025-06-05 16:39:29,156 - INFO -    After event deduplication: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.223871Z","level":"info","event":"📋 [2025-06-05 16:39:29] ⚠️ No articles remaining after comprehensive filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.224219Z","level":"info","event":"📋 2025-06-05 16:39:29,156 - WARNING - ⚠️ No articles remaining after comprehensive filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.224389Z","level":"info","event":"📋 [2025-06-05 16:39:29] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.224598Z","level":"info","event":"📋 2025-06-05 16:39:29,157 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.468152Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.469133Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.470189Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_20250604.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.470727Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/data/processed/2025/06/04/artigos_sem_vitimas_20250604.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.471032Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/data/processed/2025/06/04/filtering_log_20250604.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.471366Z","level":"info","event":"⚠️ stats_json: /opt/airflow/data/processed/2025/06/04/filtering_stats_20250604.json (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.479152","level":"info","event":"Done. Returned value was: [2025-06-05 16:39:29] Starting filtrar_artigos_vitimas_airflow\n2025-06-05 16:39:29,105 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 16:39:29] Parameters: dias=1, date=2025-06-04\n2025-06-05 16:39:29,106 - INFO - Parameters: dias=1, date=2025-06-04\n[2025-06-05 16:39:29] Paths: input_file=/opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json, output_dir=/opt/airflow/data/processed/2025/06/04, date_str=2025-06-04\n2025-06-05 16:39:29,106 - INFO - Paths: input_file=/opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json, output_dir=/opt/airflow/data/processed/2025/06/04, date_str=2025-06-04\n[2025-06-05 16:39:29] 🚀 Starting filtrar_artigos_vitimas_airflow\n2025-06-05 16:39:29,106 - INFO - 🚀 Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 16:39:29] 🔍 Path setup:\n2025-06-05 16:39:29,107 - INFO - 🔍 Path setup:\n[2025-06-05 16:39:29]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-05 16:39:29,107 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-05 16:39:29]    Project root: /opt/airflow\n2025-06-05 16:39:29,107 - INFO -    Project root: /opt/airflow\n[2025-06-05 16:39:29] 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/04\n2025-06-05 16:39:29,107 - INFO - 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/04\n[2025-06-05 16:39:29] 📁 Using provided input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:39:29,109 - INFO - 📁 Using provided input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:39:29] 📂 Loading articles from: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:39:29,109 - INFO - 📂 Loading articles from: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:39:29] ==================================================\n2025-06-05 16:39:29,116 - INFO - ==================================================\n[2025-06-05 16:39:29] Filtering Started\n2025-06-05 16:39:29,122 - INFO - Filtering Started\n[2025-06-05 16:39:29] ==================================================\n2025-06-05 16:39:29,122 - INFO - ==================================================\n[2025-06-05 16:39:29]   Total Articles Loaded: 10\n2025-06-05 16:39:29,122 - INFO -   Total Articles Loaded: 10\n[2025-06-05 16:39:29]   Input File: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:39:29,122 - INFO -   Input File: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:39:29]   Output File: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_2025-06-04.csv\n2025-06-05 16:39:29,122 - INFO -   Output File: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_2025-06-04.csv\n[2025-06-05 16:39:29]   Processed Data Directory: /opt/airflow/data/processed/2025/06/04\n2025-06-05 16:39:29,122 - INFO -   Processed Data Directory: /opt/airflow/data/processed/2025/06/04\n[2025-06-05 16:39:29]   Days Filter: 1\n2025-06-05 16:39:29,122 - INFO -   Days Filter: 1\n[2025-06-05 16:39:29] ==================================================\n2025-06-05 16:39:29,122 - INFO - ==================================================\n[2025-06-05 16:39:29] 🔍 Applying comprehensive filtering logic...\n2025-06-05 16:39:29,122 - INFO - 🔍 Applying comprehensive filtering logic...\n[2025-06-05 16:39:29] 🔧 Loading configuration data...\n2025-06-05 16:39:29,123 - INFO - 🔧 Loading configuration data...\n[2025-06-05 16:39:29] 🔍 Looking for config files in multiple paths:\n2025-06-05 16:39:29,123 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-05 16:39:29]    Checking: /opt/airflow/config\n2025-06-05 16:39:29,123 - INFO -    Checking: /opt/airflow/config\n[2025-06-05 16:39:29]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-05 16:39:29,123 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-05 16:39:29]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-05 16:39:29,123 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 16:39:29]    Checking: config\n2025-06-05 16:39:29,123 - INFO -    Checking: config\n[2025-06-05 16:39:29] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-05 16:39:29,135 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 16:39:29]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-05 16:39:29,136 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-05 16:39:29]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-05 16:39:29,136 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-05 16:39:29] ✅ Loaded municipios config with 29 districts\n2025-06-05 16:39:29,139 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-05 16:39:29] ✅ Loaded eventos config with 14 events\n2025-06-05 16:39:29,140 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-05 16:39:29] 📊 Config summary: 29 districts, 306 parishes\n2025-06-05 16:39:29,140 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-05 16:39:29] 📊 Starting comprehensive filtering with 10 articles\n2025-06-05 16:39:29,141 - INFO - 📊 Starting comprehensive filtering with 10 articles\n[2025-06-05 16:39:29] 🇵🇹 Applying national article filter...\n2025-06-05 16:39:29,145 - INFO - 🇵🇹 Applying national article filter...\n[2025-06-05 16:39:29]    After national filter: 0 articles (removed 10)\n2025-06-05 16:39:29,149 - INFO -    After national filter: 0 articles (removed 10)\n[2025-06-05 16:39:29] 🚫 Applying unwanted keywords filter...\n2025-06-05 16:39:29,149 - INFO - 🚫 Applying unwanted keywords filter...\n[2025-06-05 16:39:29]    After unwanted keywords filter: 0 articles (removed 0)\n2025-06-05 16:39:29,149 - INFO -    After unwanted keywords filter: 0 articles (removed 0)\n[2025-06-05 16:39:29] 📅 Applying year range filter...\n2025-06-05 16:39:29,149 - INFO - 📅 Applying year range filter...\n[2025-06-05 16:39:29]    After year filter: 0 articles (removed 0)\n2025-06-05 16:39:29,150 - INFO -    After year filter: 0 articles (removed 0)\n[2025-06-05 16:39:29] ⭐ Calculating relevance scores...\n2025-06-05 16:39:29,150 - INFO - ⭐ Calculating relevance scores...\n[2025-06-05 16:39:29] 🎯 Applying relevance and victim filters...\n2025-06-05 16:39:29,151 - INFO - 🎯 Applying relevance and victim filters...\n[2025-06-05 16:39:29]    After relevance/victim filter: 0 articles (removed 0)\n2025-06-05 16:39:29,154 - INFO -    After relevance/victim filter: 0 articles (removed 0)\n[2025-06-05 16:39:29] 🌦️ Identifying climate events...\n2025-06-05 16:39:29,155 - INFO - 🌦️ Identifying climate events...\n[2025-06-05 16:39:29] 🔄 Removing event-based duplicates...\n2025-06-05 16:39:29,156 - INFO - 🔄 Removing event-based duplicates...\n[2025-06-05 16:39:29]    After event deduplication: 0 articles (removed 0)\n2025-06-05 16:39:29,156 - INFO -    After event deduplication: 0 articles (removed 0)\n[2025-06-05 16:39:29] ⚠️ No articles remaining after comprehensive filtering.\n2025-06-05 16:39:29,156 - WARNING - ⚠️ No articles remaining after comprehensive filtering.\n[2025-06-05 16:39:29] ✅ Filtering completed. Found 0 articles with victims\n2025-06-05 16:39:29,157 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-05T16:23:51.042285","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T16:23:51.043620","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T16:23:51.125051Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:51.128046Z","level":"info","event":"📁 Using paths from processar task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:51.129109Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:51.130754Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:51.130857Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:51.130925Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:51.130999Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:51.131076Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:51.131143Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:51.137297Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:51.138553Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:51.139182Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:51.139403Z","level":"info","event":"  - victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:51.139663Z","level":"info","event":"  - no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:51.139779Z","level":"info","event":"  - filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:51.139859Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:51.139938Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:51.140042Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.966219Z","level":"info","event":"📋 [2025-06-05 17:23:52] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.966694Z","level":"info","event":"📋 2025-06-05 17:23:52,965 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.967238Z","level":"info","event":"📋 [2025-06-05 17:23:52] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.967328Z","level":"info","event":"📋 2025-06-05 17:23:52,965 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.967441Z","level":"info","event":"📋 [2025-06-05 17:23:52] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.967533Z","level":"info","event":"📋 2025-06-05 17:23:52,965 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.968134Z","level":"info","event":"📋 [2025-06-05 17:23:52] 🚀 Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969017Z","level":"info","event":"📋 2025-06-05 17:23:52,965 - INFO - 🚀 Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969073Z","level":"info","event":"📋 [2025-06-05 17:23:52] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969113Z","level":"info","event":"📋 2025-06-05 17:23:52,965 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969155Z","level":"info","event":"📋 [2025-06-05 17:23:52]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969205Z","level":"info","event":"📋 2025-06-05 17:23:52,966 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969247Z","level":"info","event":"📋 [2025-06-05 17:23:52]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969289Z","level":"info","event":"📋 2025-06-05 17:23:52,966 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969326Z","level":"info","event":"📋 [2025-06-05 17:23:52] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969394Z","level":"info","event":"📋 2025-06-05 17:23:52,966 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969482Z","level":"info","event":"📋 [2025-06-05 17:23:52] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969527Z","level":"info","event":"📋 2025-06-05 17:23:52,966 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969565Z","level":"info","event":"📋 [2025-06-05 17:23:52] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969615Z","level":"info","event":"📋 2025-06-05 17:23:52,966 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969651Z","level":"info","event":"📋 [2025-06-05 17:23:52] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969685Z","level":"info","event":"📋 2025-06-05 17:23:52,969 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969733Z","level":"info","event":"📋 [2025-06-05 17:23:52] Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969826Z","level":"info","event":"📋 2025-06-05 17:23:52,969 - INFO - Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969874Z","level":"info","event":"📋 [2025-06-05 17:23:52] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969922Z","level":"info","event":"📋 2025-06-05 17:23:52,969 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.969995Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Total Articles Loaded: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.970064Z","level":"info","event":"📋 2025-06-05 17:23:52,969 - INFO -   Total Articles Loaded: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.970132Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.970181Z","level":"info","event":"📋 2025-06-05 17:23:52,970 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.970247Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.970519Z","level":"info","event":"📋 2025-06-05 17:23:52,970 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.970562Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.970637Z","level":"info","event":"📋 2025-06-05 17:23:52,970 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.970681Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.970807Z","level":"info","event":"📋 2025-06-05 17:23:52,970 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.970893Z","level":"info","event":"📋 [2025-06-05 17:23:52] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.971480Z","level":"info","event":"📋 2025-06-05 17:23:52,970 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.971566Z","level":"info","event":"📋 [2025-06-05 17:23:52] 🔍 Applying comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.971634Z","level":"info","event":"📋 2025-06-05 17:23:52,970 - INFO - 🔍 Applying comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.971687Z","level":"info","event":"📋 [2025-06-05 17:23:52] 🔧 Loading configuration data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.971741Z","level":"info","event":"📋 2025-06-05 17:23:52,970 - INFO - 🔧 Loading configuration data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.971800Z","level":"info","event":"📋 [2025-06-05 17:23:52] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.971904Z","level":"info","event":"📋 2025-06-05 17:23:52,970 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.971976Z","level":"info","event":"📋 [2025-06-05 17:23:52]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.972232Z","level":"info","event":"📋 2025-06-05 17:23:52,970 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.974039Z","level":"info","event":"📋 [2025-06-05 17:23:52]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.975008Z","level":"info","event":"📋 2025-06-05 17:23:52,970 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.975081Z","level":"info","event":"📋 [2025-06-05 17:23:52]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.975140Z","level":"info","event":"📋 2025-06-05 17:23:52,970 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.975199Z","level":"info","event":"📋 [2025-06-05 17:23:52]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.975248Z","level":"info","event":"📋 2025-06-05 17:23:52,970 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.975335Z","level":"info","event":"📋 [2025-06-05 17:23:52] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.975392Z","level":"info","event":"📋 2025-06-05 17:23:52,970 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.975431Z","level":"info","event":"📋 [2025-06-05 17:23:52]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.975469Z","level":"info","event":"📋 2025-06-05 17:23:52,970 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.975539Z","level":"info","event":"📋 [2025-06-05 17:23:52]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.975581Z","level":"info","event":"📋 2025-06-05 17:23:52,970 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.978009Z","level":"info","event":"📋 [2025-06-05 17:23:52] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.978093Z","level":"info","event":"📋 2025-06-05 17:23:52,971 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.978146Z","level":"info","event":"📋 [2025-06-05 17:23:52] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.978225Z","level":"info","event":"📋 2025-06-05 17:23:52,972 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.978294Z","level":"info","event":"📋 [2025-06-05 17:23:52] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.978340Z","level":"info","event":"📋 2025-06-05 17:23:52,972 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.978385Z","level":"info","event":"📋 [2025-06-05 17:23:52] 📊 Starting comprehensive filtering with 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.978423Z","level":"info","event":"📋 2025-06-05 17:23:52,972 - INFO - 📊 Starting comprehensive filtering with 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.978469Z","level":"info","event":"📋 [2025-06-05 17:23:52] 🇵🇹 Applying national article filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.978516Z","level":"info","event":"📋 2025-06-05 17:23:52,973 - INFO - 🇵🇹 Applying national article filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.978582Z","level":"info","event":"📋 [2025-06-05 17:23:52]    After national filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.978625Z","level":"info","event":"📋 2025-06-05 17:23:52,973 - INFO -    After national filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.978666Z","level":"info","event":"📋 [2025-06-05 17:23:52] 🚫 Applying unwanted keywords filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.978703Z","level":"info","event":"📋 2025-06-05 17:23:52,973 - INFO - 🚫 Applying unwanted keywords filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.978740Z","level":"info","event":"📋 [2025-06-05 17:23:52]    After unwanted keywords filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.980044Z","level":"info","event":"📋 2025-06-05 17:23:52,974 - INFO -    After unwanted keywords filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.980999Z","level":"info","event":"📋 [2025-06-05 17:23:52] 📅 Applying year range filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.981072Z","level":"info","event":"📋 2025-06-05 17:23:52,974 - INFO - 📅 Applying year range filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.981145Z","level":"info","event":"📋 [2025-06-05 17:23:52]    After year filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.981184Z","level":"info","event":"📋 2025-06-05 17:23:52,975 - INFO -    After year filter: 4 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.981252Z","level":"info","event":"📋 [2025-06-05 17:23:52] ⭐ Calculating relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.981300Z","level":"info","event":"📋 2025-06-05 17:23:52,975 - INFO - ⭐ Calculating relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.981402Z","level":"info","event":"📋 [2025-06-05 17:23:52] 🎯 Applying relevance and victim filters...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.981549Z","level":"info","event":"📋 2025-06-05 17:23:52,975 - INFO - 🎯 Applying relevance and victim filters...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.981633Z","level":"info","event":"📋 [2025-06-05 17:23:52]    After relevance/victim filter: 1 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.981676Z","level":"info","event":"📋 2025-06-05 17:23:52,976 - INFO -    After relevance/victim filter: 1 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.981720Z","level":"info","event":"📋 [2025-06-05 17:23:52] 🔄 Removing URL duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.981758Z","level":"info","event":"📋 2025-06-05 17:23:52,976 - INFO - 🔄 Removing URL duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.981797Z","level":"info","event":"📋 [2025-06-05 17:23:52]    After URL deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.981835Z","level":"info","event":"📋 2025-06-05 17:23:52,976 - INFO -    After URL deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.981873Z","level":"info","event":"📋 [2025-06-05 17:23:52] 🌦️ Identifying climate events...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.981911Z","level":"info","event":"📋 2025-06-05 17:23:52,977 - INFO - 🌦️ Identifying climate events...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.981948Z","level":"info","event":"📋 [2025-06-05 17:23:52] 🔄 Removing event-based duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.982000Z","level":"info","event":"📋 2025-06-05 17:23:52,977 - INFO - 🔄 Removing event-based duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.982039Z","level":"info","event":"📋 [2025-06-05 17:23:52]    After event deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.982076Z","level":"info","event":"📋 2025-06-05 17:23:52,977 - INFO -    After event deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.982566Z","level":"info","event":"📋 [2025-06-05 17:23:52] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.982619Z","level":"info","event":"📋 2025-06-05 17:23:52,982 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.982700Z","level":"info","event":"📋 [2025-06-05 17:23:52] Comprehensive Filtering Results","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.982803Z","level":"info","event":"📋 2025-06-05 17:23:52,982 - INFO - Comprehensive Filtering Results","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.983049Z","level":"info","event":"📋 [2025-06-05 17:23:52] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.983158Z","level":"info","event":"📋 2025-06-05 17:23:52,982 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.983281Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Articles After All Filters: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.983624Z","level":"info","event":"📋 2025-06-05 17:23:52,982 - INFO -   Articles After All Filters: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.984096Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Articles with Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.984218Z","level":"info","event":"📋 2025-06-05 17:23:52,982 - INFO -   Articles with Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.984352Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Articles without Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.985033Z","level":"info","event":"📋 2025-06-05 17:23:52,982 - INFO -   Articles without Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.986056Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Total Fatalities: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987001Z","level":"info","event":"📋 2025-06-05 17:23:52,982 - INFO -   Total Fatalities: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987060Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Total Injured: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987107Z","level":"info","event":"📋 2025-06-05 17:23:52,982 - INFO -   Total Injured: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987160Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Total Evacuated: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987216Z","level":"info","event":"📋 2025-06-05 17:23:52,982 - INFO -   Total Evacuated: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987292Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Total Displaced: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987335Z","level":"info","event":"📋 2025-06-05 17:23:52,982 - INFO -   Total Displaced: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987372Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Total Missing: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987409Z","level":"info","event":"📋 2025-06-05 17:23:52,982 - INFO -   Total Missing: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987445Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Average Relevance Score: 1.00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987481Z","level":"info","event":"📋 2025-06-05 17:23:52,982 - INFO -   Average Relevance Score: 1.00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987517Z","level":"info","event":"📋 [2025-06-05 17:23:52] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987552Z","level":"info","event":"📋 2025-06-05 17:23:52,982 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987587Z","level":"info","event":"📋 [2025-06-05 17:23:52] 💾 Saving comprehensively filtered articles...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987623Z","level":"info","event":"📋 2025-06-05 17:23:52,982 - INFO - 💾 Saving comprehensively filtered articles...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987659Z","level":"info","event":"📋 📥 Novos artigos recebidos: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987695Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987763Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987807Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987872Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987908Z","level":"info","event":"📋 [2025-06-05 17:23:52] ✅ Articles without victims saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987945Z","level":"info","event":"📋 2025-06-05 17:23:52,983 - INFO - ✅ Articles without victims saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.987993Z","level":"info","event":"📋 [2025-06-05 17:23:52] ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.988041Z","level":"info","event":"📋 2025-06-05 17:23:52,984 - INFO - ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.988086Z","level":"info","event":"📋 [2025-06-05 17:23:52] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.988123Z","level":"info","event":"📋 2025-06-05 17:23:52,984 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.988159Z","level":"info","event":"📋 [2025-06-05 17:23:52] Comprehensive Filtering Completed Successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.988194Z","level":"info","event":"📋 2025-06-05 17:23:52,984 - INFO - Comprehensive Filtering Completed Successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.988233Z","level":"info","event":"📋 [2025-06-05 17:23:52] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.988267Z","level":"info","event":"📋 2025-06-05 17:23:52,984 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.988303Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Articles with Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.988339Z","level":"info","event":"📋 2025-06-05 17:23:52,984 - INFO -   Articles with Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.988374Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Articles without Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.989043Z","level":"info","event":"📋 2025-06-05 17:23:52,984 - INFO -   Articles without Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.990036Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Total Articles Processed: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.991001Z","level":"info","event":"📋 2025-06-05 17:23:52,984 - INFO -   Total Articles Processed: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.991057Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Filter Rate: 25.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.991095Z","level":"info","event":"📋 2025-06-05 17:23:52,984 - INFO -   Filter Rate: 25.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.991134Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Victim Rate: 0.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.991170Z","level":"info","event":"📋 2025-06-05 17:23:52,984 - INFO -   Victim Rate: 0.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.991209Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.991246Z","level":"info","event":"📋 2025-06-05 17:23:52,984 - INFO -   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.991418Z","level":"info","event":"📋 [2025-06-05 17:23:52]   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.991539Z","level":"info","event":"📋 2025-06-05 17:23:52,984 - INFO -   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.991677Z","level":"info","event":"📋 [2025-06-05 17:23:52] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.991728Z","level":"info","event":"📋 2025-06-05 17:23:52,984 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.991773Z","level":"info","event":"📋 [2025-06-05 17:23:52] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:52.991812Z","level":"info","event":"📋 2025-06-05 17:23:52,984 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:53.195294Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:53.195540Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:53.195735Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:53.195833Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:53.195928Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:53.196037Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json (512 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:23:53.196748","level":"info","event":"Done. Returned value was: [2025-06-05 17:23:52] Starting filtrar_artigos_vitimas_airflow\n2025-06-05 17:23:52,965 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 17:23:52] Parameters: dias=1, date=2025-06-05\n2025-06-05 17:23:52,965 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 17:23:52] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n2025-06-05 17:23:52,965 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n[2025-06-05 17:23:52] 🚀 Starting filtrar_artigos_vitimas_airflow\n2025-06-05 17:23:52,965 - INFO - 🚀 Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 17:23:52] 🔍 Path setup:\n2025-06-05 17:23:52,965 - INFO - 🔍 Path setup:\n[2025-06-05 17:23:52]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-05 17:23:52,966 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-05 17:23:52]    Project root: /opt/airflow\n2025-06-05 17:23:52,966 - INFO -    Project root: /opt/airflow\n[2025-06-05 17:23:52] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 17:23:52,966 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 17:23:52] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 17:23:52,966 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 17:23:52] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 17:23:52,966 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 17:23:52] ==================================================\n2025-06-05 17:23:52,969 - INFO - ==================================================\n[2025-06-05 17:23:52] Filtering Started\n2025-06-05 17:23:52,969 - INFO - Filtering Started\n[2025-06-05 17:23:52] ==================================================\n2025-06-05 17:23:52,969 - INFO - ==================================================\n[2025-06-05 17:23:52]   Total Articles Loaded: 4\n2025-06-05 17:23:52,969 - INFO -   Total Articles Loaded: 4\n[2025-06-05 17:23:52]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 17:23:52,970 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 17:23:52]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 17:23:52,970 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 17:23:52]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 17:23:52,970 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 17:23:52]   Days Filter: 1\n2025-06-05 17:23:52,970 - INFO -   Days Filter: 1\n[2025-06-05 17:23:52] ==================================================\n2025-06-05 17:23:52,970 - INFO - ==================================================\n[2025-06-05 17:23:52] 🔍 Applying comprehensive filtering logic...\n2025-06-05 17:23:52,970 - INFO - 🔍 Applying comprehensive filtering logic...\n[2025-06-05 17:23:52] 🔧 Loading configuration data...\n2025-06-05 17:23:52,970 - INFO - 🔧 Loading configuration data...\n[2025-06-05 17:23:52] 🔍 Looking for config files in multiple paths:\n2025-06-05 17:23:52,970 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-05 17:23:52]    Checking: /opt/airflow/config\n2025-06-05 17:23:52,970 - INFO -    Checking: /opt/airflow/config\n[2025-06-05 17:23:52]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-05 17:23:52,970 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-05 17:23:52]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-05 17:23:52,970 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 17:23:52]    Checking: config\n2025-06-05 17:23:52,970 - INFO -    Checking: config\n[2025-06-05 17:23:52] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-05 17:23:52,970 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 17:23:52]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-05 17:23:52,970 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-05 17:23:52]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-05 17:23:52,970 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-05 17:23:52] ✅ Loaded municipios config with 29 districts\n2025-06-05 17:23:52,971 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-05 17:23:52] ✅ Loaded eventos config with 14 events\n2025-06-05 17:23:52,972 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-05 17:23:52] 📊 Config summary: 29 districts, 306 parishes\n2025-06-05 17:23:52,972 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-05 17:23:52] 📊 Starting comprehensive filtering with 4 articles\n2025-06-05 17:23:52,972 - INFO - 📊 Starting comprehensive filtering with 4 articles\n[2025-06-05 17:23:52] 🇵🇹 Applying national article filter...\n2025-06-05 17:23:52,973 - INFO - 🇵🇹 Applying national article filter...\n[2025-06-05 17:23:52]    After national filter: 4 articles (removed 0)\n2025-06-05 17:23:52,973 - INFO -    After national filter: 4 articles (removed 0)\n[2025-06-05 17:23:52] 🚫 Applying unwanted keywords filter...\n2025-06-05 17:23:52,973 - INFO - 🚫 Applying unwanted keywords filter...\n[2025-06-05 17:23:52]    After unwanted keywords filter: 4 articles (removed 0)\n2025-06-05 17:23:52,974 - INFO -    After unwanted keywords filter: 4 articles (removed 0)\n[2025-06-05 17:23:52] 📅 Applying year range filter...\n2025-06-05 17:23:52,974 - INFO - 📅 Applying year range filter...\n[2025-06-05 17:23:52]    After year filter: 4 articles (removed 0)\n2025-06-05 17:23:52,975 - INFO -    After year filter: 4 articles (removed 0)\n[2025-06-05 17:23:52] ⭐ Calculating relevance scores...\n2025-06-05 17:23:52,975 - INFO - ⭐ Calculating relevance scores...\n[2025-06-05 17:23:52] 🎯 Applying relevance and victim filters...\n2025-06-05 17:23:52,975 - INFO - 🎯 Applying relevance and victim filters...\n[2025-06-05 17:23:52]    After relevance/victim filter: 1 articles (removed 3)\n2025-06-05 17:23:52,976 - INFO -    After relevance/victim filter: 1 articles (removed 3)\n[2025-06-05 17:23:52] 🔄 Removing URL duplicates...\n2025-06-05 17:23:52,976 - INFO - 🔄 Removing URL duplicates...\n[2025-06-05 17:23:52]    After URL deduplication: 1 articles (removed 0)\n2025-06-05 17:23:52,976 - INFO -    After URL deduplication: 1 articles (removed 0)\n[2025-06-05 17:23:52] 🌦️ Identifying climate events...\n2025-06-05 17:23:52,977 - INFO - 🌦️ Identifying climate events...\n[2025-06-05 17:23:52] 🔄 Removing event-based duplicates...\n2025-06-05 17:23:52,977 - INFO - 🔄 Removing event-based duplicates...\n[2025-06-05 17:23:52]    After event deduplication: 1 articles (removed 0)\n2025-06-05 17:23:52,977 - INFO -    After event deduplication: 1 articles (removed 0)\n[2025-06-05 17:23:52] ==================================================\n2025-06-05 17:23:52,982 - INFO - ==================================================\n[2025-06-05 17:23:52] Comprehensive Filtering Results\n2025-06-05 17:23:52,982 - INFO - Comprehensive Filtering Results\n[2025-06-05 17:23:52] ==================================================\n2025-06-05 17:23:52,982 - INFO - ==================================================\n[2025-06-05 17:23:52]   Articles After All Filters: 1\n2025-06-05 17:23:52,982 - INFO -   Articles After All Filters: 1\n[2025-06-05 17:23:52]   Articles with Victims: 0\n2025-06-05 17:23:52,982 - INFO -   Articles with Victims: 0\n[2025-06-05 17:23:52]   Articles without Victims: 1\n2025-06-05 17:23:52,982 - INFO -   Articles without Victims: 1\n[2025-06-05 17:23:52]   Total Fatalities: 0\n2025-06-05 17:23:52,982 - INFO -   Total Fatalities: 0\n[2025-06-05 17:23:52]   Total Injured: 0\n2025-06-05 17:23:52,982 - INFO -   Total Injured: 0\n[2025-06-05 17:23:52]   Total Evacuated: 0\n2025-06-05 17:23:52,982 - INFO -   Total Evacuated: 0\n[2025-06-05 17:23:52]   Total Displaced: 0\n2025-06-05 17:23:52,982 - INFO -   Total Displaced: 0\n[2025-06-05 17:23:52]   Total Missing: 0\n2025-06-05 17:23:52,982 - INFO -   Total Missing: 0\n[2025-06-05 17:23:52]   Average Relevance Score: 1.00\n2025-06-05 17:23:52,982 - INFO -   Average Relevance Score: 1.00\n[2025-06-05 17:23:52] ==================================================\n2025-06-05 17:23:52,982 - INFO - ==================================================\n[2025-06-05 17:23:52] 💾 Saving comprehensively filtered articles...\n2025-06-05 17:23:52,982 - INFO - 💾 Saving comprehensively filtered articles...\n📥 Novos artigos recebidos: 1\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_2025-06-05.csv\n📂 IDs existentes no arquivo: 1\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-05 17:23:52] ✅ Articles without victims saved: 1 articles\n2025-06-05 17:23:52,983 - INFO - ✅ Articles without victims saved: 1 articles\n[2025-06-05 17:23:52] ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n2025-06-05 17:23:52,984 - INFO - ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n[2025-06-05 17:23:52] ==================================================\n2025-06-05 17:23:52,984 - INFO - ==================================================\n[2025-06-05 17:23:52] Comprehensive Filtering Completed Successfully\n2025-06-05 17:23:52,984 - INFO - Comprehensive Filtering Completed Successfully\n[2025-06-05 17:23:52] ==================================================\n2025-06-05 17:23:52,984 - INFO - ==================================================\n[2025-06-05 17:23:52]   Articles with Victims: 0\n2025-06-05 17:23:52,984 - INFO -   Articles with Victims: 0\n[2025-06-05 17:23:52]   Articles without Victims: 1\n2025-06-05 17:23:52,984 - INFO -   Articles without Victims: 1\n[2025-06-05 17:23:52]   Total Articles Processed: 1\n2025-06-05 17:23:52,984 - INFO -   Total Articles Processed: 1\n[2025-06-05 17:23:52]   Filter Rate: 25.0%\n2025-06-05 17:23:52,984 - INFO -   Filter Rate: 25.0%\n[2025-06-05 17:23:52]   Victim Rate: 0.0%\n2025-06-05 17:23:52,984 - INFO -   Victim Rate: 0.0%\n[2025-06-05 17:23:52]   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 17:23:52,984 - INFO -   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 17:23:52]   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n2025-06-05 17:23:52,984 - INFO -   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n[2025-06-05 17:23:52] ==================================================\n2025-06-05 17:23:52,984 - INFO - ==================================================\n[2025-06-05 17:23:52] ✅ Filtering completed. Found 0 articles with victims\n2025-06-05 17:23:52,984 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
