{"timestamp":"2025-06-05T15:39:22.967363","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T15:39:22.967980","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T15:39:24.790065Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.792706Z","level":"info","event":"📁 Using paths from processar task: 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.801628Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/04', '/opt/airflow/data/structured/2025/06/04', '/opt/airflow/data/processed/2025/06/04']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.802122Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.802278Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.802452Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.802569Z","level":"info","event":"  - Target date: 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.802686Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.814190Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/structured/2025/06/04/artigos_google_municipios_pt_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.815728Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.816044Z","level":"info","event":"✅ Found input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.816495Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.817017Z","level":"info","event":"  - victims_articles: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.817556Z","level":"info","event":"  - no_victims_articles: /opt/airflow/data/processed/2025/06/04/artigos_sem_vitimas_20250604.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.817826Z","level":"info","event":"  - filtering_log: /opt/airflow/data/processed/2025/06/04/filtering_log_20250604.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.818032Z","level":"info","event":"  - stats_json: /opt/airflow/data/processed/2025/06/04/filtering_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.818206Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json --output_dir /opt/airflow/data/processed/2025/06/04 --date_str 2025-06-04 --date 2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:24.818455Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.107233Z","level":"info","event":"📋 [2025-06-05 16:39:29] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.108440Z","level":"info","event":"📋 2025-06-05 16:39:29,105 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.108746Z","level":"info","event":"📋 [2025-06-05 16:39:29] Parameters: dias=1, date=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.109958Z","level":"info","event":"📋 2025-06-05 16:39:29,106 - INFO - Parameters: dias=1, date=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.110212Z","level":"info","event":"📋 [2025-06-05 16:39:29] Paths: input_file=/opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json, output_dir=/opt/airflow/data/processed/2025/06/04, date_str=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.110664Z","level":"info","event":"📋 2025-06-05 16:39:29,106 - INFO - Paths: input_file=/opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json, output_dir=/opt/airflow/data/processed/2025/06/04, date_str=2025-06-04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.111226Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🚀 Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.112203Z","level":"info","event":"📋 2025-06-05 16:39:29,106 - INFO - 🚀 Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.184705Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.185066Z","level":"info","event":"📋 2025-06-05 16:39:29,107 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.185394Z","level":"info","event":"📋 [2025-06-05 16:39:29]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.185638Z","level":"info","event":"📋 2025-06-05 16:39:29,107 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.185819Z","level":"info","event":"📋 [2025-06-05 16:39:29]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.186005Z","level":"info","event":"📋 2025-06-05 16:39:29,107 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.186167Z","level":"info","event":"📋 [2025-06-05 16:39:29] 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.186323Z","level":"info","event":"📋 2025-06-05 16:39:29,107 - INFO - 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.186473Z","level":"info","event":"📋 [2025-06-05 16:39:29] 📁 Using provided input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.186793Z","level":"info","event":"📋 2025-06-05 16:39:29,109 - INFO - 📁 Using provided input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.187698Z","level":"info","event":"📋 [2025-06-05 16:39:29] 📂 Loading articles from: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.187916Z","level":"info","event":"📋 2025-06-05 16:39:29,109 - INFO - 📂 Loading articles from: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.188082Z","level":"info","event":"📋 [2025-06-05 16:39:29] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.188422Z","level":"info","event":"📋 2025-06-05 16:39:29,116 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.188684Z","level":"info","event":"📋 [2025-06-05 16:39:29] Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.188837Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO - Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.189080Z","level":"info","event":"📋 [2025-06-05 16:39:29] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.189224Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.189354Z","level":"info","event":"📋 [2025-06-05 16:39:29]   Total Articles Loaded: 10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.189480Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO -   Total Articles Loaded: 10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.189604Z","level":"info","event":"📋 [2025-06-05 16:39:29]   Input File: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.189728Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO -   Input File: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.189875Z","level":"info","event":"📋 [2025-06-05 16:39:29]   Output File: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.189988Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO -   Output File: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_2025-06-04.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.190113Z","level":"info","event":"📋 [2025-06-05 16:39:29]   Processed Data Directory: /opt/airflow/data/processed/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.190738Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO -   Processed Data Directory: /opt/airflow/data/processed/2025/06/04","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.191055Z","level":"info","event":"📋 [2025-06-05 16:39:29]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.191560Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.191956Z","level":"info","event":"📋 [2025-06-05 16:39:29] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.193122Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.195596Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🔍 Applying comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.195908Z","level":"info","event":"📋 2025-06-05 16:39:29,122 - INFO - 🔍 Applying comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.196457Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🔧 Loading configuration data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.196669Z","level":"info","event":"📋 2025-06-05 16:39:29,123 - INFO - 🔧 Loading configuration data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.197872Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.198241Z","level":"info","event":"📋 2025-06-05 16:39:29,123 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.198490Z","level":"info","event":"📋 [2025-06-05 16:39:29]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.199120Z","level":"info","event":"📋 2025-06-05 16:39:29,123 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.199587Z","level":"info","event":"📋 [2025-06-05 16:39:29]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.199844Z","level":"info","event":"📋 2025-06-05 16:39:29,123 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.200118Z","level":"info","event":"📋 [2025-06-05 16:39:29]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.200354Z","level":"info","event":"📋 2025-06-05 16:39:29,123 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.200783Z","level":"info","event":"📋 [2025-06-05 16:39:29]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.201052Z","level":"info","event":"📋 2025-06-05 16:39:29,123 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.201279Z","level":"info","event":"📋 [2025-06-05 16:39:29] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.202895Z","level":"info","event":"📋 2025-06-05 16:39:29,135 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.204404Z","level":"info","event":"📋 [2025-06-05 16:39:29]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.205851Z","level":"info","event":"📋 2025-06-05 16:39:29,136 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.206925Z","level":"info","event":"📋 [2025-06-05 16:39:29]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.210641Z","level":"info","event":"📋 2025-06-05 16:39:29,136 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.211174Z","level":"info","event":"📋 [2025-06-05 16:39:29] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.211697Z","level":"info","event":"📋 2025-06-05 16:39:29,139 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.211978Z","level":"info","event":"📋 [2025-06-05 16:39:29] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.212130Z","level":"info","event":"📋 2025-06-05 16:39:29,140 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.212249Z","level":"info","event":"📋 [2025-06-05 16:39:29] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.212468Z","level":"info","event":"📋 2025-06-05 16:39:29,140 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.212671Z","level":"info","event":"📋 [2025-06-05 16:39:29] 📊 Starting comprehensive filtering with 10 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.212806Z","level":"info","event":"📋 2025-06-05 16:39:29,141 - INFO - 📊 Starting comprehensive filtering with 10 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.212924Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🇵🇹 Applying national article filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.213040Z","level":"info","event":"📋 2025-06-05 16:39:29,145 - INFO - 🇵🇹 Applying national article filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.213263Z","level":"info","event":"📋 [2025-06-05 16:39:29]    After national filter: 0 articles (removed 10)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.213372Z","level":"info","event":"📋 2025-06-05 16:39:29,149 - INFO -    After national filter: 0 articles (removed 10)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.213466Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🚫 Applying unwanted keywords filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.213649Z","level":"info","event":"📋 2025-06-05 16:39:29,149 - INFO - 🚫 Applying unwanted keywords filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.213833Z","level":"info","event":"📋 [2025-06-05 16:39:29]    After unwanted keywords filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.214424Z","level":"info","event":"📋 2025-06-05 16:39:29,149 - INFO -    After unwanted keywords filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.216694Z","level":"info","event":"📋 [2025-06-05 16:39:29] 📅 Applying year range filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.218926Z","level":"info","event":"📋 2025-06-05 16:39:29,149 - INFO - 📅 Applying year range filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.219860Z","level":"info","event":"📋 [2025-06-05 16:39:29]    After year filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.220147Z","level":"info","event":"📋 2025-06-05 16:39:29,150 - INFO -    After year filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.220320Z","level":"info","event":"📋 [2025-06-05 16:39:29] ⭐ Calculating relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.220469Z","level":"info","event":"📋 2025-06-05 16:39:29,150 - INFO - ⭐ Calculating relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.220654Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🎯 Applying relevance and victim filters...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.220816Z","level":"info","event":"📋 2025-06-05 16:39:29,151 - INFO - 🎯 Applying relevance and victim filters...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.222543Z","level":"info","event":"📋 [2025-06-05 16:39:29]    After relevance/victim filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.222817Z","level":"info","event":"📋 2025-06-05 16:39:29,154 - INFO -    After relevance/victim filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.222977Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🌦️ Identifying climate events...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.223142Z","level":"info","event":"📋 2025-06-05 16:39:29,155 - INFO - 🌦️ Identifying climate events...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.223289Z","level":"info","event":"📋 [2025-06-05 16:39:29] 🔄 Removing event-based duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.223436Z","level":"info","event":"📋 2025-06-05 16:39:29,156 - INFO - 🔄 Removing event-based duplicates...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.223573Z","level":"info","event":"📋 [2025-06-05 16:39:29]    After event deduplication: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.223709Z","level":"info","event":"📋 2025-06-05 16:39:29,156 - INFO -    After event deduplication: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.223871Z","level":"info","event":"📋 [2025-06-05 16:39:29] ⚠️ No articles remaining after comprehensive filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.224219Z","level":"info","event":"📋 2025-06-05 16:39:29,156 - WARNING - ⚠️ No articles remaining after comprehensive filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.224389Z","level":"info","event":"📋 [2025-06-05 16:39:29] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.224598Z","level":"info","event":"📋 2025-06-05 16:39:29,157 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.468152Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.469133Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.470189Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_20250604.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.470727Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/data/processed/2025/06/04/artigos_sem_vitimas_20250604.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.471032Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/data/processed/2025/06/04/filtering_log_20250604.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.471366Z","level":"info","event":"⚠️ stats_json: /opt/airflow/data/processed/2025/06/04/filtering_stats_20250604.json (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T15:39:29.479152","level":"info","event":"Done. Returned value was: [2025-06-05 16:39:29] Starting filtrar_artigos_vitimas_airflow\n2025-06-05 16:39:29,105 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 16:39:29] Parameters: dias=1, date=2025-06-04\n2025-06-05 16:39:29,106 - INFO - Parameters: dias=1, date=2025-06-04\n[2025-06-05 16:39:29] Paths: input_file=/opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json, output_dir=/opt/airflow/data/processed/2025/06/04, date_str=2025-06-04\n2025-06-05 16:39:29,106 - INFO - Paths: input_file=/opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json, output_dir=/opt/airflow/data/processed/2025/06/04, date_str=2025-06-04\n[2025-06-05 16:39:29] 🚀 Starting filtrar_artigos_vitimas_airflow\n2025-06-05 16:39:29,106 - INFO - 🚀 Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 16:39:29] 🔍 Path setup:\n2025-06-05 16:39:29,107 - INFO - 🔍 Path setup:\n[2025-06-05 16:39:29]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-05 16:39:29,107 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-05 16:39:29]    Project root: /opt/airflow\n2025-06-05 16:39:29,107 - INFO -    Project root: /opt/airflow\n[2025-06-05 16:39:29] 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/04\n2025-06-05 16:39:29,107 - INFO - 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/04\n[2025-06-05 16:39:29] 📁 Using provided input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:39:29,109 - INFO - 📁 Using provided input file: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:39:29] 📂 Loading articles from: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:39:29,109 - INFO - 📂 Loading articles from: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:39:29] ==================================================\n2025-06-05 16:39:29,116 - INFO - ==================================================\n[2025-06-05 16:39:29] Filtering Started\n2025-06-05 16:39:29,122 - INFO - Filtering Started\n[2025-06-05 16:39:29] ==================================================\n2025-06-05 16:39:29,122 - INFO - ==================================================\n[2025-06-05 16:39:29]   Total Articles Loaded: 10\n2025-06-05 16:39:29,122 - INFO -   Total Articles Loaded: 10\n[2025-06-05 16:39:29]   Input File: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n2025-06-05 16:39:29,122 - INFO -   Input File: /opt/airflow/data/structured/2025/06/04/processing_stats_20250604.json\n[2025-06-05 16:39:29]   Output File: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_2025-06-04.csv\n2025-06-05 16:39:29,122 - INFO -   Output File: /opt/airflow/data/processed/2025/06/04/artigos_vitimas_filtrados_2025-06-04.csv\n[2025-06-05 16:39:29]   Processed Data Directory: /opt/airflow/data/processed/2025/06/04\n2025-06-05 16:39:29,122 - INFO -   Processed Data Directory: /opt/airflow/data/processed/2025/06/04\n[2025-06-05 16:39:29]   Days Filter: 1\n2025-06-05 16:39:29,122 - INFO -   Days Filter: 1\n[2025-06-05 16:39:29] ==================================================\n2025-06-05 16:39:29,122 - INFO - ==================================================\n[2025-06-05 16:39:29] 🔍 Applying comprehensive filtering logic...\n2025-06-05 16:39:29,122 - INFO - 🔍 Applying comprehensive filtering logic...\n[2025-06-05 16:39:29] 🔧 Loading configuration data...\n2025-06-05 16:39:29,123 - INFO - 🔧 Loading configuration data...\n[2025-06-05 16:39:29] 🔍 Looking for config files in multiple paths:\n2025-06-05 16:39:29,123 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-05 16:39:29]    Checking: /opt/airflow/config\n2025-06-05 16:39:29,123 - INFO -    Checking: /opt/airflow/config\n[2025-06-05 16:39:29]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-05 16:39:29,123 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-05 16:39:29]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-05 16:39:29,123 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 16:39:29]    Checking: config\n2025-06-05 16:39:29,123 - INFO -    Checking: config\n[2025-06-05 16:39:29] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-05 16:39:29,135 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 16:39:29]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-05 16:39:29,136 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-05 16:39:29]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-05 16:39:29,136 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-05 16:39:29] ✅ Loaded municipios config with 29 districts\n2025-06-05 16:39:29,139 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-05 16:39:29] ✅ Loaded eventos config with 14 events\n2025-06-05 16:39:29,140 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-05 16:39:29] 📊 Config summary: 29 districts, 306 parishes\n2025-06-05 16:39:29,140 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-05 16:39:29] 📊 Starting comprehensive filtering with 10 articles\n2025-06-05 16:39:29,141 - INFO - 📊 Starting comprehensive filtering with 10 articles\n[2025-06-05 16:39:29] 🇵🇹 Applying national article filter...\n2025-06-05 16:39:29,145 - INFO - 🇵🇹 Applying national article filter...\n[2025-06-05 16:39:29]    After national filter: 0 articles (removed 10)\n2025-06-05 16:39:29,149 - INFO -    After national filter: 0 articles (removed 10)\n[2025-06-05 16:39:29] 🚫 Applying unwanted keywords filter...\n2025-06-05 16:39:29,149 - INFO - 🚫 Applying unwanted keywords filter...\n[2025-06-05 16:39:29]    After unwanted keywords filter: 0 articles (removed 0)\n2025-06-05 16:39:29,149 - INFO -    After unwanted keywords filter: 0 articles (removed 0)\n[2025-06-05 16:39:29] 📅 Applying year range filter...\n2025-06-05 16:39:29,149 - INFO - 📅 Applying year range filter...\n[2025-06-05 16:39:29]    After year filter: 0 articles (removed 0)\n2025-06-05 16:39:29,150 - INFO -    After year filter: 0 articles (removed 0)\n[2025-06-05 16:39:29] ⭐ Calculating relevance scores...\n2025-06-05 16:39:29,150 - INFO - ⭐ Calculating relevance scores...\n[2025-06-05 16:39:29] 🎯 Applying relevance and victim filters...\n2025-06-05 16:39:29,151 - INFO - 🎯 Applying relevance and victim filters...\n[2025-06-05 16:39:29]    After relevance/victim filter: 0 articles (removed 0)\n2025-06-05 16:39:29,154 - INFO -    After relevance/victim filter: 0 articles (removed 0)\n[2025-06-05 16:39:29] 🌦️ Identifying climate events...\n2025-06-05 16:39:29,155 - INFO - 🌦️ Identifying climate events...\n[2025-06-05 16:39:29] 🔄 Removing event-based duplicates...\n2025-06-05 16:39:29,156 - INFO - 🔄 Removing event-based duplicates...\n[2025-06-05 16:39:29]    After event deduplication: 0 articles (removed 0)\n2025-06-05 16:39:29,156 - INFO -    After event deduplication: 0 articles (removed 0)\n[2025-06-05 16:39:29] ⚠️ No articles remaining after comprehensive filtering.\n2025-06-05 16:39:29,156 - WARNING - ⚠️ No articles remaining after comprehensive filtering.\n[2025-06-05 16:39:29] ✅ Filtering completed. Found 0 articles with victims\n2025-06-05 16:39:29,157 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
