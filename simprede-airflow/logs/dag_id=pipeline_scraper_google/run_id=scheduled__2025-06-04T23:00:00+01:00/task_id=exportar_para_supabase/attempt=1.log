{"timestamp":"2025-06-05T17:08:50.769276","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T17:08:50.769657","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T17:08:50.793125Z","level":"info","event":"🔄 Starting export_supabase task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.793361Z","level":"info","event":"📅 Using current date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.793777Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.793860Z","level":"info","event":"📅 Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.793942Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.794043Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.794114Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.794191Z","level":"info","event":"  - Database table: artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.794265Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.802537Z","level":"info","event":"📋 Found 2 files from processar task via XCom","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.802669Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.802794Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.803247Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.803375Z","level":"info","event":"✅ Found file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (916 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.803600Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.803721Z","level":"info","event":"✅ Found file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (916 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.803780Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.803874Z","level":"info","event":"✅ Found file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.803945Z","level":"info","event":"📋 Selected input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (916 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.804024Z","level":"info","event":"📊 Processing all relevant disaster-related articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.804145Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.804205Z","level":"info","event":"  - export_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.804265Z","level":"info","event":"  - export_stats: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.804328Z","level":"info","event":"  - backup_csv: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.804380Z","level":"info","event":"🔄 Running export command: python /opt/airflow/scripts/google_scraper/exportador_bd/export_to_supabase_airflow.py --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/05 --date_str 2025-06-05 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:50.804452Z","level":"info","event":"⏰ Waiting for export completion with timeout: 600 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.727067Z","level":"info","event":"📋 [2025-06-05 18:08:51] A iniciar export_to_supabase_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.727336Z","level":"info","event":"📋 2025-06-05 18:08:51,726 - INFO - A iniciar export_to_supabase_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.727449Z","level":"info","event":"📋 [2025-06-05 18:08:51] Parâmetros: date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.728586Z","level":"info","event":"📋 2025-06-05 18:08:51,726 - INFO - Parâmetros: date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.728702Z","level":"info","event":"📋 [2025-06-05 18:08:51] Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.728866Z","level":"info","event":"📋 2025-06-05 18:08:51,726 - INFO - Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.728965Z","level":"info","event":"📋 [2025-06-05 18:08:51] 🚀 A iniciar exportação para Supabase para a data: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.729025Z","level":"info","event":"📋 2025-06-05 18:08:51,726 - INFO - 🚀 A iniciar exportação para Supabase para a data: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.729080Z","level":"info","event":"📋 [2025-06-05 18:08:51] 📋 Tabela de destino: artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.729145Z","level":"info","event":"📋 2025-06-05 18:08:51,726 - INFO - 📋 Tabela de destino: artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.729196Z","level":"info","event":"📋 [2025-06-05 18:08:51] 📁 A usar diretório de saída controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.729266Z","level":"info","event":"📋 2025-06-05 18:08:51,726 - INFO - 📁 A usar diretório de saída controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.729358Z","level":"info","event":"📋 [2025-06-05 18:08:51] ✅ A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.729487Z","level":"info","event":"📋 2025-06-05 18:08:51,726 - INFO - ✅ A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.729564Z","level":"info","event":"📋 [2025-06-05 18:08:51] 📂 A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.729629Z","level":"info","event":"📋 2025-06-05 18:08:51,726 - INFO - 📂 A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.729715Z","level":"info","event":"📋 [2025-06-05 18:08:51] 📊 Carregados 3 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.729789Z","level":"info","event":"📋 2025-06-05 18:08:51,728 - INFO - 📊 Carregados 3 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.730044Z","level":"info","event":"📋 [2025-06-05 18:08:51] 📋 A processar todos os artigos relevantes relacionados com desastres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.730178Z","level":"info","event":"📋 2025-06-05 18:08:51,728 - INFO - 📋 A processar todos os artigos relevantes relacionados com desastres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.730258Z","level":"info","event":"📋 [2025-06-05 18:08:51] 🔍 Verificação inicial do ambiente...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.730317Z","level":"info","event":"📋 2025-06-05 18:08:51,728 - INFO - 🔍 Verificação inicial do ambiente...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.730941Z","level":"info","event":"📋 [2025-06-05 18:08:51]   DB_HOST do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.731101Z","level":"info","event":"📋 2025-06-05 18:08:51,729 - INFO -   DB_HOST do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.731292Z","level":"info","event":"📋 [2025-06-05 18:08:51]   DB_USER do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.731859Z","level":"info","event":"📋 2025-06-05 18:08:51,729 - INFO -   DB_USER do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.731924Z","level":"info","event":"📋 [2025-06-05 18:08:51]   DB_PASSWORD do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.732012Z","level":"info","event":"📋 2025-06-05 18:08:51,729 - INFO -   DB_PASSWORD do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.732072Z","level":"info","event":"📋 [2025-06-05 18:08:51] 🔍 Configuração da base de dados não encontrada no ambiente, procurando ficheiro .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.732124Z","level":"info","event":"📋 2025-06-05 18:08:51,729 - INFO - 🔍 Configuração da base de dados não encontrada no ambiente, procurando ficheiro .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.732211Z","level":"info","event":"📋 [2025-06-05 18:08:51] 🔍 Verificando 6 localizações possíveis do .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.732909Z","level":"info","event":"📋 2025-06-05 18:08:51,729 - INFO - 🔍 Verificando 6 localizações possíveis do .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.733006Z","level":"info","event":"📋 [2025-06-05 18:08:51]   A verificar: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.733077Z","level":"info","event":"📋 2025-06-05 18:08:51,729 - INFO -   A verificar: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.733169Z","level":"info","event":"📋 [2025-06-05 18:08:51]   ❌ Não encontrado: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.733254Z","level":"info","event":"📋 2025-06-05 18:08:51,730 - INFO -   ❌ Não encontrado: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.733324Z","level":"info","event":"📋 [2025-06-05 18:08:51]   A verificar: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.733392Z","level":"info","event":"📋 2025-06-05 18:08:51,730 - INFO -   A verificar: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.733446Z","level":"info","event":"📋 [2025-06-05 18:08:51] ✅ Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.734672Z","level":"info","event":"📋 2025-06-05 18:08:51,731 - INFO - ✅ Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.734743Z","level":"info","event":"📋 [2025-06-05 18:08:51] 📄 Tamanho do ficheiro .env: 184 caracteres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.734799Z","level":"info","event":"📋 2025-06-05 18:08:51,731 - INFO - 📄 Tamanho do ficheiro .env: 184 caracteres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.734871Z","level":"info","event":"📋 [2025-06-05 18:08:51]   ✅ Definido DB_HOST do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.734920Z","level":"info","event":"📋 2025-06-05 18:08:51,731 - INFO -   ✅ Definido DB_HOST do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.734972Z","level":"info","event":"📋 [2025-06-05 18:08:51]   ✅ Definido DB_PORT do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.735031Z","level":"info","event":"📋 2025-06-05 18:08:51,731 - INFO -   ✅ Definido DB_PORT do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.735089Z","level":"info","event":"📋 [2025-06-05 18:08:51]   ✅ Definido DB_NAME do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.735161Z","level":"info","event":"📋 2025-06-05 18:08:51,731 - INFO -   ✅ Definido DB_NAME do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.735225Z","level":"info","event":"📋 [2025-06-05 18:08:51]   ✅ Definido DB_USER do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.735294Z","level":"info","event":"📋 2025-06-05 18:08:51,731 - INFO -   ✅ Definido DB_USER do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.735370Z","level":"info","event":"📋 [2025-06-05 18:08:51]   ✅ Definido DB_PASSWORD do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.735441Z","level":"info","event":"📋 2025-06-05 18:08:51,731 - INFO -   ✅ Definido DB_PASSWORD do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.735524Z","level":"info","event":"📋 [2025-06-05 18:08:51]   ✅ Definido DB_SSLMODE do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.735580Z","level":"info","event":"📋 2025-06-05 18:08:51,731 - INFO -   ✅ Definido DB_SSLMODE do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.735686Z","level":"info","event":"📋 [2025-06-05 18:08:51]   ✅ Definido DB_SCHEMA do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.735764Z","level":"info","event":"📋 2025-06-05 18:08:51,731 - INFO -   ✅ Definido DB_SCHEMA do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.735819Z","level":"info","event":"📋 [2025-06-05 18:08:51] 🔍 Verificação final da configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.735916Z","level":"info","event":"📋 2025-06-05 18:08:51,732 - INFO - 🔍 Verificação final da configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.735967Z","level":"info","event":"📋 [2025-06-05 18:08:51]   DB_HOST: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.736028Z","level":"info","event":"📋 2025-06-05 18:08:51,732 - INFO -   DB_HOST: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.736078Z","level":"info","event":"📋 [2025-06-05 18:08:51]   DB_USER: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.736118Z","level":"info","event":"📋 2025-06-05 18:08:51,732 - INFO -   DB_USER: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.736166Z","level":"info","event":"📋 [2025-06-05 18:08:51]   DB_PASSWORD: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.736226Z","level":"info","event":"📋 2025-06-05 18:08:51,732 - INFO -   DB_PASSWORD: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.736282Z","level":"info","event":"📋 [2025-06-05 18:08:51]   DB_PORT: 6543","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.736333Z","level":"info","event":"📋 2025-06-05 18:08:51,732 - INFO -   DB_PORT: 6543","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.736388Z","level":"info","event":"📋 [2025-06-05 18:08:51]   DB_NAME: postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.736445Z","level":"info","event":"📋 2025-06-05 18:08:51,732 - INFO -   DB_NAME: postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.736499Z","level":"info","event":"📋 [2025-06-05 18:08:51]   DB_SCHEMA: google_scraper","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.736563Z","level":"info","event":"📋 2025-06-05 18:08:51,732 - INFO -   DB_SCHEMA: google_scraper","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.736630Z","level":"info","event":"📋 [2025-06-05 18:08:51] ✅ Configuração da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.736692Z","level":"info","event":"📋 2025-06-05 18:08:51,732 - INFO - ✅ Configuração da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.736741Z","level":"info","event":"📋 [2025-06-05 18:08:51] 🔗 A conectar à base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:51.736779Z","level":"info","event":"📋 2025-06-05 18:08:51,732 - INFO - 🔗 A conectar à base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.139634Z","level":"info","event":"📋 [2025-06-05 18:08:52] ✅ Conectado à base de dados com sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.140099Z","level":"info","event":"📋 2025-06-05 18:08:52,139 - INFO - ✅ Conectado à base de dados com sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.209886Z","level":"info","event":"📋 [2025-06-05 18:08:52] 🗑️ Tabela existente google_scraper.artigos_filtrados_20250605_staging eliminada se existia","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.210166Z","level":"info","event":"📋 2025-06-05 18:08:52,209 - INFO - 🗑️ Tabela existente google_scraper.artigos_filtrados_20250605_staging eliminada se existia","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.308169Z","level":"info","event":"📋 [2025-06-05 18:08:52] ✅ Tabela google_scraper.artigos_filtrados_20250605_staging criada com esquema correto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.309024Z","level":"info","event":"📋 2025-06-05 18:08:52,307 - INFO - ✅ Tabela google_scraper.artigos_filtrados_20250605_staging criada com esquema correto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.428031Z","level":"info","event":"📋 [2025-06-05 18:08:52] ✅ Índices criados para a tabela google_scraper.artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.430943Z","level":"info","event":"📋 2025-06-05 18:08:52,425 - INFO - ✅ Índices criados para a tabela google_scraper.artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.431339Z","level":"info","event":"📋 [2025-06-05 18:08:52] 🔧 A preparar dataframe para inserção na base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.431589Z","level":"info","event":"📋 2025-06-05 18:08:52,426 - INFO - 🔧 A preparar dataframe para inserção na base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.431797Z","level":"info","event":"📋 [2025-06-05 18:08:52] 📅 A converter formatos de data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.432091Z","level":"info","event":"📋 2025-06-05 18:08:52,426 - INFO - 📅 A converter formatos de data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.436873Z","level":"info","event":"📋 [2025-06-05 18:08:52] ✅ Preparadas 3 linhas para inserção","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.437864Z","level":"info","event":"📋 2025-06-05 18:08:52,436 - INFO - ✅ Preparadas 3 linhas para inserção","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.622676Z","level":"info","event":"📋 [2025-06-05 18:08:52] ✅ Inseridos/atualizados 3 artigos (falharam: 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.623220Z","level":"info","event":"📋 2025-06-05 18:08:52,622 - INFO - ✅ Inseridos/atualizados 3 artigos (falharam: 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.631287Z","level":"info","event":"📋 [2025-06-05 18:08:52] 💾 Backup de exportação guardado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.631767Z","level":"info","event":"📋 2025-06-05 18:08:52,630 - INFO - 💾 Backup de exportação guardado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.634023Z","level":"info","event":"📋 [2025-06-05 18:08:52] ✅ Estatísticas de exportação guardadas: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.636143Z","level":"info","event":"📋 2025-06-05 18:08:52,633 - INFO - ✅ Estatísticas de exportação guardadas: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.638016Z","level":"info","event":"📋 [2025-06-05 18:08:52] 📋 Localização de backup de exportação preparada: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.638877Z","level":"info","event":"📋 2025-06-05 18:08:52,633 - INFO - 📋 Localização de backup de exportação preparada: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.639217Z","level":"info","event":"📋 [2025-06-05 18:08:52] ✅ Exportação concluída com sucesso. Inseridos/atualizados 3 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.639333Z","level":"info","event":"📋 2025-06-05 18:08:52,633 - INFO - ✅ Exportação concluída com sucesso. Inseridos/atualizados 3 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.639552Z","level":"info","event":"📋 [2025-06-05 18:08:52] 🔗 Ligação à base de dados fechada","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.641862Z","level":"info","event":"📋 2025-06-05 18:08:52,634 - INFO - 🔗 Ligação à base de dados fechada","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.642201Z","level":"info","event":"📋 [2025-06-05 18:08:52] ✅ Exportação concluída com sucesso. Processados 3 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.642318Z","level":"info","event":"📋 2025-06-05 18:08:52,635 - INFO - ✅ Exportação concluída com sucesso. Processados 3 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.719044Z","level":"info","event":"✅ Export completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.719235Z","level":"info","event":"🔍 Verifying export outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.719442Z","level":"info","event":"⚠️ export_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.719563Z","level":"info","event":"✅ export_stats: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json (929 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.719686Z","level":"info","event":"✅ backup_csv: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv (914 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:08:52.719986","level":"info","event":"Done. Returned value was: [2025-06-05 18:08:51] A iniciar export_to_supabase_airflow\n2025-06-05 18:08:51,726 - INFO - A iniciar export_to_supabase_airflow\n[2025-06-05 18:08:51] Parâmetros: date=2025-06-05\n2025-06-05 18:08:51,726 - INFO - Parâmetros: date=2025-06-05\n[2025-06-05 18:08:51] Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n2025-06-05 18:08:51,726 - INFO - Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n[2025-06-05 18:08:51] 🚀 A iniciar exportação para Supabase para a data: 2025-06-05\n2025-06-05 18:08:51,726 - INFO - 🚀 A iniciar exportação para Supabase para a data: 2025-06-05\n[2025-06-05 18:08:51] 📋 Tabela de destino: artigos_filtrados_20250605_staging\n2025-06-05 18:08:51,726 - INFO - 📋 Tabela de destino: artigos_filtrados_20250605_staging\n[2025-06-05 18:08:51] 📁 A usar diretório de saída controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 18:08:51,726 - INFO - 📁 A usar diretório de saída controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 18:08:51] ✅ A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:08:51,726 - INFO - ✅ A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:08:51] 📂 A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:08:51,726 - INFO - 📂 A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:08:51] 📊 Carregados 3 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']\n2025-06-05 18:08:51,728 - INFO - 📊 Carregados 3 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']\n[2025-06-05 18:08:51] 📋 A processar todos os artigos relevantes relacionados com desastres\n2025-06-05 18:08:51,728 - INFO - 📋 A processar todos os artigos relevantes relacionados com desastres\n[2025-06-05 18:08:51] 🔍 Verificação inicial do ambiente...\n2025-06-05 18:08:51,728 - INFO - 🔍 Verificação inicial do ambiente...\n[2025-06-05 18:08:51]   DB_HOST do ambiente: NÃO_ENCONTRADO\n2025-06-05 18:08:51,729 - INFO -   DB_HOST do ambiente: NÃO_ENCONTRADO\n[2025-06-05 18:08:51]   DB_USER do ambiente: NÃO_ENCONTRADO\n2025-06-05 18:08:51,729 - INFO -   DB_USER do ambiente: NÃO_ENCONTRADO\n[2025-06-05 18:08:51]   DB_PASSWORD do ambiente: NÃO_ENCONTRADO\n2025-06-05 18:08:51,729 - INFO -   DB_PASSWORD do ambiente: NÃO_ENCONTRADO\n[2025-06-05 18:08:51] 🔍 Configuração da base de dados não encontrada no ambiente, procurando ficheiro .env...\n2025-06-05 18:08:51,729 - INFO - 🔍 Configuração da base de dados não encontrada no ambiente, procurando ficheiro .env...\n[2025-06-05 18:08:51] 🔍 Verificando 6 localizações possíveis do .env...\n2025-06-05 18:08:51,729 - INFO - 🔍 Verificando 6 localizações possíveis do .env...\n[2025-06-05 18:08:51]   A verificar: /opt/airflow/.env\n2025-06-05 18:08:51,729 - INFO -   A verificar: /opt/airflow/.env\n[2025-06-05 18:08:51]   ❌ Não encontrado: /opt/airflow/.env\n2025-06-05 18:08:51,730 - INFO -   ❌ Não encontrado: /opt/airflow/.env\n[2025-06-05 18:08:51]   A verificar: /opt/airflow/scripts/google_scraper/.env\n2025-06-05 18:08:51,730 - INFO -   A verificar: /opt/airflow/scripts/google_scraper/.env\n[2025-06-05 18:08:51] ✅ Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env\n2025-06-05 18:08:51,731 - INFO - ✅ Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env\n[2025-06-05 18:08:51] 📄 Tamanho do ficheiro .env: 184 caracteres\n2025-06-05 18:08:51,731 - INFO - 📄 Tamanho do ficheiro .env: 184 caracteres\n[2025-06-05 18:08:51]   ✅ Definido DB_HOST do .env\n2025-06-05 18:08:51,731 - INFO -   ✅ Definido DB_HOST do .env\n[2025-06-05 18:08:51]   ✅ Definido DB_PORT do .env\n2025-06-05 18:08:51,731 - INFO -   ✅ Definido DB_PORT do .env\n[2025-06-05 18:08:51]   ✅ Definido DB_NAME do .env\n2025-06-05 18:08:51,731 - INFO -   ✅ Definido DB_NAME do .env\n[2025-06-05 18:08:51]   ✅ Definido DB_USER do .env\n2025-06-05 18:08:51,731 - INFO -   ✅ Definido DB_USER do .env\n[2025-06-05 18:08:51]   ✅ Definido DB_PASSWORD do .env\n2025-06-05 18:08:51,731 - INFO -   ✅ Definido DB_PASSWORD do .env\n[2025-06-05 18:08:51]   ✅ Definido DB_SSLMODE do .env\n2025-06-05 18:08:51,731 - INFO -   ✅ Definido DB_SSLMODE do .env\n[2025-06-05 18:08:51]   ✅ Definido DB_SCHEMA do .env\n2025-06-05 18:08:51,731 - INFO -   ✅ Definido DB_SCHEMA do .env\n[2025-06-05 18:08:51] 🔍 Verificação final da configuração...\n2025-06-05 18:08:51,732 - INFO - 🔍 Verificação final da configuração...\n[2025-06-05 18:08:51]   DB_HOST: DEFINIDO\n2025-06-05 18:08:51,732 - INFO -   DB_HOST: DEFINIDO\n[2025-06-05 18:08:51]   DB_USER: DEFINIDO\n2025-06-05 18:08:51,732 - INFO -   DB_USER: DEFINIDO\n[2025-06-05 18:08:51]   DB_PASSWORD: DEFINIDO\n2025-06-05 18:08:51,732 - INFO -   DB_PASSWORD: DEFINIDO\n[2025-06-05 18:08:51]   DB_PORT: 6543\n2025-06-05 18:08:51,732 - INFO -   DB_PORT: 6543\n[2025-06-05 18:08:51]   DB_NAME: postgres\n2025-06-05 18:08:51,732 - INFO -   DB_NAME: postgres\n[2025-06-05 18:08:51]   DB_SCHEMA: google_scraper\n2025-06-05 18:08:51,732 - INFO -   DB_SCHEMA: google_scraper\n[2025-06-05 18:08:51] ✅ Configuração da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres\n2025-06-05 18:08:51,732 - INFO - ✅ Configuração da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres\n[2025-06-05 18:08:51] 🔗 A conectar à base de dados...\n2025-06-05 18:08:51,732 - INFO - 🔗 A conectar à base de dados...\n[2025-06-05 18:08:52] ✅ Conectado à base de dados com sucesso\n2025-06-05 18:08:52,139 - INFO - ✅ Conectado à base de dados com sucesso\n[2025-06-05 18:08:52] 🗑️ Tabela existente google_scraper.artigos_filtrados_20250605_staging eliminada se existia\n2025-06-05 18:08:52,209 - INFO - 🗑️ Tabela existente google_scraper.artigos_filtrados_20250605_staging eliminada se existia\n[2025-06-05 18:08:52] ✅ Tabela google_scraper.artigos_filtrados_20250605_staging criada com esquema correto\n2025-06-05 18:08:52,307 - INFO - ✅ Tabela google_scraper.artigos_filtrados_20250605_staging criada com esquema correto\n[2025-06-05 18:08:52] ✅ Índices criados para a tabela google_scraper.artigos_filtrados_20250605_staging\n2025-06-05 18:08:52,425 - INFO - ✅ Índices criados para a tabela google_scraper.artigos_filtrados_20250605_staging\n[2025-06-05 18:08:52] 🔧 A preparar dataframe para inserção na base de dados...\n2025-06-05 18:08:52,426 - INFO - 🔧 A preparar dataframe para inserção na base de dados...\n[2025-06-05 18:08:52] 📅 A converter formatos de data...\n2025-06-05 18:08:52,426 - INFO - 📅 A converter formatos de data...\n[2025-06-05 18:08:52] ✅ Preparadas 3 linhas para inserção\n2025-06-05 18:08:52,436 - INFO - ✅ Preparadas 3 linhas para inserção\n[2025-06-05 18:08:52] ✅ Inseridos/atualizados 3 artigos (falharam: 0)\n2025-06-05 18:08:52,622 - INFO - ✅ Inseridos/atualizados 3 artigos (falharam: 0)\n[2025-06-05 18:08:52] 💾 Backup de exportação guardado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv\n2025-06-05 18:08:52,630 - INFO - 💾 Backup de exportação guardado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv\n[2025-06-05 18:08:52] ✅ Estatísticas de exportação guardadas: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json\n2025-06-05 18:08:52,633 - INFO - ✅ Estatísticas de exportação guardadas: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json\n[2025-06-05 18:08:52] 📋 Localização de backup de exportação preparada: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv\n2025-06-05 18:08:52,633 - INFO - 📋 Localização de backup de exportação preparada: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv\n[2025-06-05 18:08:52] ✅ Exportação concluída com sucesso. Inseridos/atualizados 3 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250605_staging\n2025-06-05 18:08:52,633 - INFO - ✅ Exportação concluída com sucesso. Inseridos/atualizados 3 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250605_staging\n[2025-06-05 18:08:52] 🔗 Ligação à base de dados fechada\n2025-06-05 18:08:52,634 - INFO - 🔗 Ligação à base de dados fechada\n[2025-06-05 18:08:52] ✅ Exportação concluída com sucesso. Processados 3 artigos\n2025-06-05 18:08:52,635 - INFO - ✅ Exportação concluída com sucesso. Processados 3 artigos\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-05T20:00:06.921383","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T20:00:06.921786","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T20:00:06.943511Z","level":"info","event":"🔄 Starting export_supabase task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.943702Z","level":"info","event":"📅 Using current date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.944029Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.944079Z","level":"info","event":"📅 Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.944118Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.944155Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.944188Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.944222Z","level":"info","event":"  - Database table: artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.944269Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.949692Z","level":"info","event":"📋 Found 2 files from processar task via XCom","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.949780Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.950173Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.950248Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.950471Z","level":"info","event":"✅ Found file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (1907 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.950558Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.950614Z","level":"info","event":"✅ Found file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (1907 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.950675Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.950742Z","level":"info","event":"✅ Found file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.950810Z","level":"info","event":"📋 Selected input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (1907 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.950874Z","level":"info","event":"📊 Processing all relevant disaster-related articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.950936Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.951053Z","level":"info","event":"  - export_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.951114Z","level":"info","event":"  - export_stats: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.951183Z","level":"info","event":"  - backup_csv: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.951237Z","level":"info","event":"🔄 Running export command: python /opt/airflow/scripts/google_scraper/exportador_bd/export_to_supabase_airflow.py --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/05 --date_str 2025-06-05 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:06.951311Z","level":"info","event":"⏰ Waiting for export completion with timeout: 600 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.822933Z","level":"info","event":"📋 [2025-06-05 21:00:07] A iniciar export_to_supabase_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.823254Z","level":"info","event":"📋 2025-06-05 21:00:07,822 - INFO - A iniciar export_to_supabase_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.823342Z","level":"info","event":"📋 [2025-06-05 21:00:07] Parâmetros: date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.823535Z","level":"info","event":"📋 2025-06-05 21:00:07,822 - INFO - Parâmetros: date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.823643Z","level":"info","event":"📋 [2025-06-05 21:00:07] Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.824621Z","level":"info","event":"📋 2025-06-05 21:00:07,822 - INFO - Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.824705Z","level":"info","event":"📋 [2025-06-05 21:00:07] 🚀 A iniciar exportação para Supabase para a data: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.824763Z","level":"info","event":"📋 2025-06-05 21:00:07,822 - INFO - 🚀 A iniciar exportação para Supabase para a data: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.824817Z","level":"info","event":"📋 [2025-06-05 21:00:07] 📋 Tabela de destino: artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.824869Z","level":"info","event":"📋 2025-06-05 21:00:07,823 - INFO - 📋 Tabela de destino: artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.824923Z","level":"info","event":"📋 [2025-06-05 21:00:07] 📁 A usar diretório de saída controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.824980Z","level":"info","event":"📋 2025-06-05 21:00:07,823 - INFO - 📁 A usar diretório de saída controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.825034Z","level":"info","event":"📋 [2025-06-05 21:00:07] ✅ A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.825130Z","level":"info","event":"📋 2025-06-05 21:00:07,823 - INFO - ✅ A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.825190Z","level":"info","event":"📋 [2025-06-05 21:00:07] 📂 A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.825246Z","level":"info","event":"📋 2025-06-05 21:00:07,823 - INFO - 📂 A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.825321Z","level":"info","event":"📋 [2025-06-05 21:00:07] 📊 Carregados 7 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.825374Z","level":"info","event":"📋 2025-06-05 21:00:07,824 - INFO - 📊 Carregados 7 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.825423Z","level":"info","event":"📋 [2025-06-05 21:00:07] 📋 A processar todos os artigos relevantes relacionados com desastres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.825474Z","level":"info","event":"📋 2025-06-05 21:00:07,825 - INFO - 📋 A processar todos os artigos relevantes relacionados com desastres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.825538Z","level":"info","event":"📋 [2025-06-05 21:00:07] 🔍 Verificação inicial do ambiente...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.825586Z","level":"info","event":"📋 2025-06-05 21:00:07,825 - INFO - 🔍 Verificação inicial do ambiente...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.825645Z","level":"info","event":"📋 [2025-06-05 21:00:07]   DB_HOST do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.825700Z","level":"info","event":"📋 2025-06-05 21:00:07,825 - INFO -   DB_HOST do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.825798Z","level":"info","event":"📋 [2025-06-05 21:00:07]   DB_USER do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.825849Z","level":"info","event":"📋 2025-06-05 21:00:07,825 - INFO -   DB_USER do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.825898Z","level":"info","event":"📋 [2025-06-05 21:00:07]   DB_PASSWORD do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.825954Z","level":"info","event":"📋 2025-06-05 21:00:07,825 - INFO -   DB_PASSWORD do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.826004Z","level":"info","event":"📋 [2025-06-05 21:00:07] 🔍 Configuração da base de dados não encontrada no ambiente, procurando ficheiro .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.826274Z","level":"info","event":"📋 2025-06-05 21:00:07,825 - INFO - 🔍 Configuração da base de dados não encontrada no ambiente, procurando ficheiro .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.826336Z","level":"info","event":"📋 [2025-06-05 21:00:07] 🔍 Verificando 6 localizações possíveis do .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.826422Z","level":"info","event":"📋 2025-06-05 21:00:07,826 - INFO - 🔍 Verificando 6 localizações possíveis do .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.826476Z","level":"info","event":"📋 [2025-06-05 21:00:07]   A verificar: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.826558Z","level":"info","event":"📋 2025-06-05 21:00:07,826 - INFO -   A verificar: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.826623Z","level":"info","event":"📋 [2025-06-05 21:00:07]   ❌ Não encontrado: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.826863Z","level":"info","event":"📋 2025-06-05 21:00:07,826 - INFO -   ❌ Não encontrado: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.826934Z","level":"info","event":"📋 [2025-06-05 21:00:07]   A verificar: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.826985Z","level":"info","event":"📋 2025-06-05 21:00:07,826 - INFO -   A verificar: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.827065Z","level":"info","event":"📋 [2025-06-05 21:00:07]   ❌ Não encontrado: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.827117Z","level":"info","event":"📋 2025-06-05 21:00:07,826 - INFO -   ❌ Não encontrado: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.827884Z","level":"info","event":"📋 [2025-06-05 21:00:07]   A verificar: /opt/airflow/scripts/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.827994Z","level":"info","event":"📋 2025-06-05 21:00:07,826 - INFO -   A verificar: /opt/airflow/scripts/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.828106Z","level":"info","event":"📋 [2025-06-05 21:00:07]   ❌ Não encontrado: /opt/airflow/scripts/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.828250Z","level":"info","event":"📋 2025-06-05 21:00:07,826 - INFO -   ❌ Não encontrado: /opt/airflow/scripts/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.828290Z","level":"info","event":"📋 [2025-06-05 21:00:07]   A verificar: /opt/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.828327Z","level":"info","event":"📋 2025-06-05 21:00:07,826 - INFO -   A verificar: /opt/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.828362Z","level":"info","event":"📋 [2025-06-05 21:00:07]   ❌ Não encontrado: /opt/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.830063Z","level":"info","event":"📋 2025-06-05 21:00:07,826 - INFO -   ❌ Não encontrado: /opt/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.832072Z","level":"info","event":"📋 [2025-06-05 21:00:07]   A verificar: /opt/airflow/scripts/google_scraper/exportador_bd/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.834049Z","level":"info","event":"📋 2025-06-05 21:00:07,826 - INFO -   A verificar: /opt/airflow/scripts/google_scraper/exportador_bd/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.834135Z","level":"info","event":"📋 [2025-06-05 21:00:07]   ❌ Não encontrado: /opt/airflow/scripts/google_scraper/exportador_bd/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.834238Z","level":"info","event":"📋 2025-06-05 21:00:07,827 - INFO -   ❌ Não encontrado: /opt/airflow/scripts/google_scraper/exportador_bd/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.834292Z","level":"info","event":"📋 [2025-06-05 21:00:07]   A verificar: /Users/ruicarvalho/Desktop/projects/SIMPREDE/simprede-airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.834383Z","level":"info","event":"📋 2025-06-05 21:00:07,827 - INFO -   A verificar: /Users/ruicarvalho/Desktop/projects/SIMPREDE/simprede-airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.834437Z","level":"info","event":"📋 [2025-06-05 21:00:07]   ❌ Não encontrado: /Users/ruicarvalho/Desktop/projects/SIMPREDE/simprede-airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.834486Z","level":"info","event":"📋 2025-06-05 21:00:07,827 - INFO -   ❌ Não encontrado: /Users/ruicarvalho/Desktop/projects/SIMPREDE/simprede-airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.834537Z","level":"info","event":"📋 [2025-06-05 21:00:07] ⚠️ Nenhum ficheiro .env encontrado em qualquer localização","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.834587Z","level":"info","event":"📋 2025-06-05 21:00:07,827 - WARNING - ⚠️ Nenhum ficheiro .env encontrado em qualquer localização","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.834636Z","level":"info","event":"📋 [2025-06-05 21:00:07] 🔍 Verificação final da configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.834686Z","level":"info","event":"📋 2025-06-05 21:00:07,827 - INFO - 🔍 Verificação final da configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.834736Z","level":"info","event":"📋 [2025-06-05 21:00:07]   DB_HOST: EM_FALTA","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.834785Z","level":"info","event":"📋 2025-06-05 21:00:07,827 - INFO -   DB_HOST: EM_FALTA","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.834833Z","level":"info","event":"📋 [2025-06-05 21:00:07]   DB_USER: EM_FALTA","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.834882Z","level":"info","event":"📋 2025-06-05 21:00:07,827 - INFO -   DB_USER: EM_FALTA","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.834932Z","level":"info","event":"📋 [2025-06-05 21:00:07]   DB_PASSWORD: EM_FALTA","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.834981Z","level":"info","event":"📋 2025-06-05 21:00:07,827 - INFO -   DB_PASSWORD: EM_FALTA","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835036Z","level":"info","event":"📋 [2025-06-05 21:00:07]   DB_PORT: 6543","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835084Z","level":"info","event":"📋 2025-06-05 21:00:07,827 - INFO -   DB_PORT: 6543","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835133Z","level":"info","event":"📋 [2025-06-05 21:00:07]   DB_NAME: postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835181Z","level":"info","event":"📋 2025-06-05 21:00:07,827 - INFO -   DB_NAME: postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835229Z","level":"info","event":"📋 [2025-06-05 21:00:07]   DB_SCHEMA: google_scraper","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835278Z","level":"info","event":"📋 2025-06-05 21:00:07,827 - INFO -   DB_SCHEMA: google_scraper","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835328Z","level":"info","event":"📋 [2025-06-05 21:00:07] ❌ Configuração obrigatória da base de dados em falta: ['host', 'user', 'password']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835379Z","level":"info","event":"📋 2025-06-05 21:00:07,827 - ERROR - ❌ Configuração obrigatória da base de dados em falta: ['host', 'user', 'password']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835430Z","level":"info","event":"📋 [2025-06-05 21:00:07] Variáveis de ambiente disponíveis:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835479Z","level":"info","event":"📋 [2025-06-05 21:00:07]   DB_HOST: NÃO_DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835562Z","level":"info","event":"📋 [2025-06-05 21:00:07]   DB_PORT: NÃO_DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835643Z","level":"info","event":"📋 [2025-06-05 21:00:07]   DB_NAME: NÃO_DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835699Z","level":"info","event":"📋 [2025-06-05 21:00:07]   DB_USER: NÃO_DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835749Z","level":"info","event":"📋 [2025-06-05 21:00:07]   DB_PASSWORD: NÃO_DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835796Z","level":"info","event":"📋 [2025-06-05 21:00:07]   DB_SSLMODE: NÃO_DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835845Z","level":"info","event":"📋 [2025-06-05 21:00:07]   DB_SCHEMA: NÃO_DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835894Z","level":"info","event":"📋 [2025-06-05 21:00:07] 🔄 Tentativa de configuração direta de variáveis de ambiente do .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835943Z","level":"info","event":"📋 2025-06-05 21:00:07,827 - INFO - 🔄 Tentativa de configuração direta de variáveis de ambiente do .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.835993Z","level":"info","event":"📋 [2025-06-05 21:00:07] ❌ Erro de configuração da base de dados: Configuração obrigatória da base de dados em falta: ['host', 'user', 'password']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836044Z","level":"info","event":"📋 2025-06-05 21:00:07,827 - ERROR - ❌ Erro de configuração da base de dados: Configuração obrigatória da base de dados em falta: ['host', 'user', 'password']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836094Z","level":"info","event":"📋 [2025-06-05 21:00:07] ❌ Exportação falhou: Configuração obrigatória da base de dados em falta: ['host', 'user', 'password']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836141Z","level":"info","event":"📋 2025-06-05 21:00:07,827 - ERROR - ❌ Exportação falhou: Configuração obrigatória da base de dados em falta: ['host', 'user', 'password']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836179Z","level":"info","event":"📋 [2025-06-05 21:00:07] ❌ Traceback completo: Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836225Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_bd/export_to_supabase_airflow.py\", line 707, in main","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836275Z","level":"info","event":"📋     result = export_to_supabase(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836323Z","level":"info","event":"📋              ^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836372Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_bd/export_to_supabase_airflow.py\", line 611, in export_to_supabase","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836424Z","level":"info","event":"📋     db_config = get_database_config()","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836474Z","level":"info","event":"📋                 ^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836520Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_bd/export_to_supabase_airflow.py\", line 243, in get_database_config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836568Z","level":"info","event":"📋     raise ValueError(f\"Configuração obrigatória da base de dados em falta: {missing_fields}\")","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836617Z","level":"info","event":"📋 ValueError: Configuração obrigatória da base de dados em falta: ['host', 'user', 'password']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836698Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836737Z","level":"info","event":"📋 2025-06-05 21:00:07,828 - ERROR - ❌ Traceback completo: Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836801Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_bd/export_to_supabase_airflow.py\", line 707, in main","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836848Z","level":"info","event":"📋     result = export_to_supabase(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836896Z","level":"info","event":"📋              ^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836944Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_bd/export_to_supabase_airflow.py\", line 611, in export_to_supabase","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.836992Z","level":"info","event":"📋     db_config = get_database_config()","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.837040Z","level":"info","event":"📋                 ^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.837089Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_bd/export_to_supabase_airflow.py\", line 243, in get_database_config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.837139Z","level":"info","event":"📋     raise ValueError(f\"Configuração obrigatória da base de dados em falta: {missing_fields}\")","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.837187Z","level":"info","event":"📋 ValueError: Configuração obrigatória da base de dados em falta: ['host', 'user', 'password']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.837235Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.895151Z","level":"info","event":"❌ Export failed with return code 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.895365Z","level":"info","event":"❌ Unexpected error in export task: Export failed with return code 1:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:00:07.895215","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"Exception","exc_value":"Export failed with return code 1: ","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":838,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1130,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":212,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":235,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/google_scraper_dag.py","lineno":926,"name":"export_supabase_task"}]}]}
{"timestamp":"2025-06-05T20:06:10.736466","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T20:06:10.736847","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T20:06:10.764121Z","level":"info","event":"🔄 Starting export_supabase task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.764312Z","level":"info","event":"📅 Using current date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.764530Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.764626Z","level":"info","event":"📅 Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.764667Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.764703Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.764737Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.764772Z","level":"info","event":"  - Database table: artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.764806Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.770672Z","level":"info","event":"📋 Found 2 files from processar task via XCom","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.770772Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.771157Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.771238Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.771493Z","level":"info","event":"✅ Found file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (1907 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.771595Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.771667Z","level":"info","event":"✅ Found file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (1907 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.771728Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.771793Z","level":"info","event":"✅ Found file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.771858Z","level":"info","event":"📋 Selected input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (1907 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.771923Z","level":"info","event":"📊 Processing all relevant disaster-related articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.771986Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.772050Z","level":"info","event":"  - export_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.772104Z","level":"info","event":"  - export_stats: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.772207Z","level":"info","event":"  - backup_csv: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.772276Z","level":"info","event":"🔄 Running export command: python /opt/airflow/scripts/google_scraper/exportador_bd/export_to_supabase_airflow.py --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/05 --date_str 2025-06-05 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:10.772351Z","level":"info","event":"⏰ Waiting for export completion with timeout: 600 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.611504Z","level":"info","event":"📋 [2025-06-05 21:06:11] A iniciar export_to_supabase_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.611851Z","level":"info","event":"📋 2025-06-05 21:06:11,611 - INFO - A iniciar export_to_supabase_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.612107Z","level":"info","event":"📋 [2025-06-05 21:06:11] Parâmetros: date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.612216Z","level":"info","event":"📋 2025-06-05 21:06:11,611 - INFO - Parâmetros: date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.613131Z","level":"info","event":"📋 [2025-06-05 21:06:11] Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.613214Z","level":"info","event":"📋 2025-06-05 21:06:11,611 - INFO - Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.613271Z","level":"info","event":"📋 [2025-06-05 21:06:11] 🚀 A iniciar exportação para Supabase para a data: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.613324Z","level":"info","event":"📋 2025-06-05 21:06:11,611 - INFO - 🚀 A iniciar exportação para Supabase para a data: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.613381Z","level":"info","event":"📋 [2025-06-05 21:06:11] 📋 Tabela de destino: artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.613432Z","level":"info","event":"📋 2025-06-05 21:06:11,611 - INFO - 📋 Tabela de destino: artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.613480Z","level":"info","event":"📋 [2025-06-05 21:06:11] 📁 A usar diretório de saída controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.613526Z","level":"info","event":"📋 2025-06-05 21:06:11,611 - INFO - 📁 A usar diretório de saída controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.613574Z","level":"info","event":"📋 [2025-06-05 21:06:11] ✅ A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.613623Z","level":"info","event":"📋 2025-06-05 21:06:11,611 - INFO - ✅ A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.613713Z","level":"info","event":"📋 [2025-06-05 21:06:11] 📂 A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.613760Z","level":"info","event":"📋 2025-06-05 21:06:11,611 - INFO - 📂 A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.613844Z","level":"info","event":"📋 [2025-06-05 21:06:11] 📊 Carregados 7 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.613898Z","level":"info","event":"📋 2025-06-05 21:06:11,613 - INFO - 📊 Carregados 7 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.613945Z","level":"info","event":"📋 [2025-06-05 21:06:11] 📋 A processar todos os artigos relevantes relacionados com desastres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.613995Z","level":"info","event":"📋 2025-06-05 21:06:11,613 - INFO - 📋 A processar todos os artigos relevantes relacionados com desastres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.614054Z","level":"info","event":"📋 [2025-06-05 21:06:11] 🔍 Verificação inicial do ambiente...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.614106Z","level":"info","event":"📋 2025-06-05 21:06:11,613 - INFO - 🔍 Verificação inicial do ambiente...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.614162Z","level":"info","event":"📋 [2025-06-05 21:06:11]   DB_HOST do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.614221Z","level":"info","event":"📋 2025-06-05 21:06:11,614 - INFO -   DB_HOST do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.614317Z","level":"info","event":"📋 [2025-06-05 21:06:11]   DB_USER do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.614380Z","level":"info","event":"📋 2025-06-05 21:06:11,614 - INFO -   DB_USER do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.614453Z","level":"info","event":"📋 [2025-06-05 21:06:11]   DB_PASSWORD do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.614551Z","level":"info","event":"📋 2025-06-05 21:06:11,614 - INFO -   DB_PASSWORD do ambiente: NÃO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.614604Z","level":"info","event":"📋 [2025-06-05 21:06:11] 🔍 Configuração da base de dados não encontrada no ambiente, procurando ficheiro .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.614669Z","level":"info","event":"📋 2025-06-05 21:06:11,614 - INFO - 🔍 Configuração da base de dados não encontrada no ambiente, procurando ficheiro .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.614931Z","level":"info","event":"📋 [2025-06-05 21:06:11] 🔍 Verificando 6 localizações possíveis do .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.614999Z","level":"info","event":"📋 2025-06-05 21:06:11,614 - INFO - 🔍 Verificando 6 localizações possíveis do .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.615078Z","level":"info","event":"📋 [2025-06-05 21:06:11]   A verificar: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.615169Z","level":"info","event":"📋 2025-06-05 21:06:11,614 - INFO -   A verificar: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.615240Z","level":"info","event":"📋 [2025-06-05 21:06:11]   ❌ Não encontrado: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.615452Z","level":"info","event":"📋 2025-06-05 21:06:11,614 - INFO -   ❌ Não encontrado: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.615500Z","level":"info","event":"📋 [2025-06-05 21:06:11]   A verificar: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.615547Z","level":"info","event":"📋 2025-06-05 21:06:11,614 - INFO -   A verificar: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.615607Z","level":"info","event":"📋 [2025-06-05 21:06:11] ✅ Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.616212Z","level":"info","event":"📋 2025-06-05 21:06:11,615 - INFO - ✅ Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.616317Z","level":"info","event":"📋 [2025-06-05 21:06:11] 📄 Tamanho do ficheiro .env: 210 caracteres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.616931Z","level":"info","event":"📋 2025-06-05 21:06:11,615 - INFO - 📄 Tamanho do ficheiro .env: 210 caracteres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.617045Z","level":"info","event":"📋 [2025-06-05 21:06:11]   ✅ Definido DB_USER do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.617137Z","level":"info","event":"📋 2025-06-05 21:06:11,615 - INFO -   ✅ Definido DB_USER do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.617221Z","level":"info","event":"📋 [2025-06-05 21:06:11]   ✅ Definido DB_PASSWORD do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.617366Z","level":"info","event":"📋 2025-06-05 21:06:11,615 - INFO -   ✅ Definido DB_PASSWORD do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.617461Z","level":"info","event":"📋 [2025-06-05 21:06:11]   ✅ Definido DB_HOST do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.617586Z","level":"info","event":"📋 2025-06-05 21:06:11,615 - INFO -   ✅ Definido DB_HOST do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.617657Z","level":"info","event":"📋 [2025-06-05 21:06:11]   ✅ Definido DB_PORT do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.617762Z","level":"info","event":"📋 2025-06-05 21:06:11,615 - INFO -   ✅ Definido DB_PORT do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.617833Z","level":"info","event":"📋 [2025-06-05 21:06:11]   ✅ Definido DB_NAME do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.617911Z","level":"info","event":"📋 2025-06-05 21:06:11,615 - INFO -   ✅ Definido DB_NAME do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.617986Z","level":"info","event":"📋 [2025-06-05 21:06:11]   ✅ Definido DB_SCHEMA do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.618054Z","level":"info","event":"📋 2025-06-05 21:06:11,615 - INFO -   ✅ Definido DB_SCHEMA do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.618119Z","level":"info","event":"📋 [2025-06-05 21:06:11] 🔍 Verificação final da configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.618180Z","level":"info","event":"📋 2025-06-05 21:06:11,615 - INFO - 🔍 Verificação final da configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.618272Z","level":"info","event":"📋 [2025-06-05 21:06:11]   DB_HOST: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.618374Z","level":"info","event":"📋 2025-06-05 21:06:11,615 - INFO -   DB_HOST: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.618441Z","level":"info","event":"📋 [2025-06-05 21:06:11]   DB_USER: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.618509Z","level":"info","event":"📋 2025-06-05 21:06:11,615 - INFO -   DB_USER: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.618569Z","level":"info","event":"📋 [2025-06-05 21:06:11]   DB_PASSWORD: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.618624Z","level":"info","event":"📋 2025-06-05 21:06:11,615 - INFO -   DB_PASSWORD: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.618698Z","level":"info","event":"📋 [2025-06-05 21:06:11]   DB_PORT: 6543","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.618755Z","level":"info","event":"📋 2025-06-05 21:06:11,615 - INFO -   DB_PORT: 6543","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.618819Z","level":"info","event":"📋 [2025-06-05 21:06:11]   DB_NAME: postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.618882Z","level":"info","event":"📋 2025-06-05 21:06:11,615 - INFO -   DB_NAME: postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.618945Z","level":"info","event":"📋 [2025-06-05 21:06:11]   DB_SCHEMA: google_scraper","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.619000Z","level":"info","event":"📋 2025-06-05 21:06:11,615 - INFO -   DB_SCHEMA: google_scraper","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.619063Z","level":"info","event":"📋 [2025-06-05 21:06:11] ✅ Configuração da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.619124Z","level":"info","event":"📋 2025-06-05 21:06:11,615 - INFO - ✅ Configuração da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.619196Z","level":"info","event":"📋 [2025-06-05 21:06:11] 🔗 A conectar à base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.619264Z","level":"info","event":"📋 2025-06-05 21:06:11,615 - INFO - 🔗 A conectar à base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.914527Z","level":"info","event":"📋 [2025-06-05 21:06:11] ✅ Conectado à base de dados com sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:11.915447Z","level":"info","event":"📋 2025-06-05 21:06:11,914 - INFO - ✅ Conectado à base de dados com sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.054247Z","level":"info","event":"📋 [2025-06-05 21:06:12] 🗑️ Tabela existente google_scraper.artigos_filtrados_20250605_staging eliminada se existia","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.055496Z","level":"info","event":"📋 2025-06-05 21:06:12,053 - INFO - 🗑️ Tabela existente google_scraper.artigos_filtrados_20250605_staging eliminada se existia","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.135479Z","level":"info","event":"📋 [2025-06-05 21:06:12] ✅ Tabela google_scraper.artigos_filtrados_20250605_staging criada com esquema correto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.136233Z","level":"info","event":"📋 2025-06-05 21:06:12,135 - INFO - ✅ Tabela google_scraper.artigos_filtrados_20250605_staging criada com esquema correto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.229540Z","level":"info","event":"📋 [2025-06-05 21:06:12] ✅ Índices criados para a tabela google_scraper.artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.235193Z","level":"info","event":"📋 2025-06-05 21:06:12,229 - INFO - ✅ Índices criados para a tabela google_scraper.artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.235945Z","level":"info","event":"📋 [2025-06-05 21:06:12] 🔧 A preparar dataframe para inserção na base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.236243Z","level":"info","event":"📋 2025-06-05 21:06:12,229 - INFO - 🔧 A preparar dataframe para inserção na base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.236553Z","level":"info","event":"📋 [2025-06-05 21:06:12] 📅 A converter formatos de data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.236798Z","level":"info","event":"📋 2025-06-05 21:06:12,229 - INFO - 📅 A converter formatos de data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.241121Z","level":"info","event":"📋 [2025-06-05 21:06:12] ✅ Preparadas 7 linhas para inserção","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.241364Z","level":"info","event":"📋 2025-06-05 21:06:12,240 - INFO - ✅ Preparadas 7 linhas para inserção","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.557310Z","level":"info","event":"📋 [2025-06-05 21:06:12] ✅ Inseridos/atualizados 7 artigos (falharam: 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.559405Z","level":"info","event":"📋 2025-06-05 21:06:12,557 - INFO - ✅ Inseridos/atualizados 7 artigos (falharam: 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.561609Z","level":"info","event":"📋 [2025-06-05 21:06:12] 💾 Backup de exportação guardado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.561904Z","level":"info","event":"📋 2025-06-05 21:06:12,561 - INFO - 💾 Backup de exportação guardado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.563048Z","level":"info","event":"📋 [2025-06-05 21:06:12] ✅ Estatísticas de exportação guardadas: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.565391Z","level":"info","event":"📋 2025-06-05 21:06:12,562 - INFO - ✅ Estatísticas de exportação guardadas: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.566349Z","level":"info","event":"📋 [2025-06-05 21:06:12] 📋 Localização de backup de exportação preparada: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.567368Z","level":"info","event":"📋 2025-06-05 21:06:12,562 - INFO - 📋 Localização de backup de exportação preparada: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.568319Z","level":"info","event":"📋 [2025-06-05 21:06:12] ✅ Exportação concluída com sucesso. Inseridos/atualizados 7 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.568501Z","level":"info","event":"📋 2025-06-05 21:06:12,562 - INFO - ✅ Exportação concluída com sucesso. Inseridos/atualizados 7 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.568620Z","level":"info","event":"📋 [2025-06-05 21:06:12] 🔗 Ligação à base de dados fechada","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.568788Z","level":"info","event":"📋 2025-06-05 21:06:12,562 - INFO - 🔗 Ligação à base de dados fechada","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.568898Z","level":"info","event":"📋 [2025-06-05 21:06:12] ✅ Exportação concluída com sucesso. Processados 7 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.568950Z","level":"info","event":"📋 2025-06-05 21:06:12,562 - INFO - ✅ Exportação concluída com sucesso. Processados 7 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.672062Z","level":"info","event":"✅ Export completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.672278Z","level":"info","event":"🔍 Verifying export outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.672497Z","level":"info","event":"⚠️ export_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.672632Z","level":"info","event":"✅ export_stats: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json (929 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.672732Z","level":"info","event":"✅ backup_csv: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv (1909 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:06:12.673410","level":"info","event":"Done. Returned value was: [2025-06-05 21:06:11] A iniciar export_to_supabase_airflow\n2025-06-05 21:06:11,611 - INFO - A iniciar export_to_supabase_airflow\n[2025-06-05 21:06:11] Parâmetros: date=2025-06-05\n2025-06-05 21:06:11,611 - INFO - Parâmetros: date=2025-06-05\n[2025-06-05 21:06:11] Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n2025-06-05 21:06:11,611 - INFO - Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n[2025-06-05 21:06:11] 🚀 A iniciar exportação para Supabase para a data: 2025-06-05\n2025-06-05 21:06:11,611 - INFO - 🚀 A iniciar exportação para Supabase para a data: 2025-06-05\n[2025-06-05 21:06:11] 📋 Tabela de destino: artigos_filtrados_20250605_staging\n2025-06-05 21:06:11,611 - INFO - 📋 Tabela de destino: artigos_filtrados_20250605_staging\n[2025-06-05 21:06:11] 📁 A usar diretório de saída controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 21:06:11,611 - INFO - 📁 A usar diretório de saída controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 21:06:11] ✅ A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 21:06:11,611 - INFO - ✅ A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 21:06:11] 📂 A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 21:06:11,611 - INFO - 📂 A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 21:06:11] 📊 Carregados 7 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']\n2025-06-05 21:06:11,613 - INFO - 📊 Carregados 7 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']\n[2025-06-05 21:06:11] 📋 A processar todos os artigos relevantes relacionados com desastres\n2025-06-05 21:06:11,613 - INFO - 📋 A processar todos os artigos relevantes relacionados com desastres\n[2025-06-05 21:06:11] 🔍 Verificação inicial do ambiente...\n2025-06-05 21:06:11,613 - INFO - 🔍 Verificação inicial do ambiente...\n[2025-06-05 21:06:11]   DB_HOST do ambiente: NÃO_ENCONTRADO\n2025-06-05 21:06:11,614 - INFO -   DB_HOST do ambiente: NÃO_ENCONTRADO\n[2025-06-05 21:06:11]   DB_USER do ambiente: NÃO_ENCONTRADO\n2025-06-05 21:06:11,614 - INFO -   DB_USER do ambiente: NÃO_ENCONTRADO\n[2025-06-05 21:06:11]   DB_PASSWORD do ambiente: NÃO_ENCONTRADO\n2025-06-05 21:06:11,614 - INFO -   DB_PASSWORD do ambiente: NÃO_ENCONTRADO\n[2025-06-05 21:06:11] 🔍 Configuração da base de dados não encontrada no ambiente, procurando ficheiro .env...\n2025-06-05 21:06:11,614 - INFO - 🔍 Configuração da base de dados não encontrada no ambiente, procurando ficheiro .env...\n[2025-06-05 21:06:11] 🔍 Verificando 6 localizações possíveis do .env...\n2025-06-05 21:06:11,614 - INFO - 🔍 Verificando 6 localizações possíveis do .env...\n[2025-06-05 21:06:11]   A verificar: /opt/airflow/.env\n2025-06-05 21:06:11,614 - INFO -   A verificar: /opt/airflow/.env\n[2025-06-05 21:06:11]   ❌ Não encontrado: /opt/airflow/.env\n2025-06-05 21:06:11,614 - INFO -   ❌ Não encontrado: /opt/airflow/.env\n[2025-06-05 21:06:11]   A verificar: /opt/airflow/scripts/google_scraper/.env\n2025-06-05 21:06:11,614 - INFO -   A verificar: /opt/airflow/scripts/google_scraper/.env\n[2025-06-05 21:06:11] ✅ Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env\n2025-06-05 21:06:11,615 - INFO - ✅ Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env\n[2025-06-05 21:06:11] 📄 Tamanho do ficheiro .env: 210 caracteres\n2025-06-05 21:06:11,615 - INFO - 📄 Tamanho do ficheiro .env: 210 caracteres\n[2025-06-05 21:06:11]   ✅ Definido DB_USER do .env\n2025-06-05 21:06:11,615 - INFO -   ✅ Definido DB_USER do .env\n[2025-06-05 21:06:11]   ✅ Definido DB_PASSWORD do .env\n2025-06-05 21:06:11,615 - INFO -   ✅ Definido DB_PASSWORD do .env\n[2025-06-05 21:06:11]   ✅ Definido DB_HOST do .env\n2025-06-05 21:06:11,615 - INFO -   ✅ Definido DB_HOST do .env\n[2025-06-05 21:06:11]   ✅ Definido DB_PORT do .env\n2025-06-05 21:06:11,615 - INFO -   ✅ Definido DB_PORT do .env\n[2025-06-05 21:06:11]   ✅ Definido DB_NAME do .env\n2025-06-05 21:06:11,615 - INFO -   ✅ Definido DB_NAME do .env\n[2025-06-05 21:06:11]   ✅ Definido DB_SCHEMA do .env\n2025-06-05 21:06:11,615 - INFO -   ✅ Definido DB_SCHEMA do .env\n[2025-06-05 21:06:11] 🔍 Verificação final da configuração...\n2025-06-05 21:06:11,615 - INFO - 🔍 Verificação final da configuração...\n[2025-06-05 21:06:11]   DB_HOST: DEFINIDO\n2025-06-05 21:06:11,615 - INFO -   DB_HOST: DEFINIDO\n[2025-06-05 21:06:11]   DB_USER: DEFINIDO\n2025-06-05 21:06:11,615 - INFO -   DB_USER: DEFINIDO\n[2025-06-05 21:06:11]   DB_PASSWORD: DEFINIDO\n2025-06-05 21:06:11,615 - INFO -   DB_PASSWORD: DEFINIDO\n[2025-06-05 21:06:11]   DB_PORT: 6543\n2025-06-05 21:06:11,615 - INFO -   DB_PORT: 6543\n[2025-06-05 21:06:11]   DB_NAME: postgres\n2025-06-05 21:06:11,615 - INFO -   DB_NAME: postgres\n[2025-06-05 21:06:11]   DB_SCHEMA: google_scraper\n2025-06-05 21:06:11,615 - INFO -   DB_SCHEMA: google_scraper\n[2025-06-05 21:06:11] ✅ Configuração da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres\n2025-06-05 21:06:11,615 - INFO - ✅ Configuração da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres\n[2025-06-05 21:06:11] 🔗 A conectar à base de dados...\n2025-06-05 21:06:11,615 - INFO - 🔗 A conectar à base de dados...\n[2025-06-05 21:06:11] ✅ Conectado à base de dados com sucesso\n2025-06-05 21:06:11,914 - INFO - ✅ Conectado à base de dados com sucesso\n[2025-06-05 21:06:12] 🗑️ Tabela existente google_scraper.artigos_filtrados_20250605_staging eliminada se existia\n2025-06-05 21:06:12,053 - INFO - 🗑️ Tabela existente google_scraper.artigos_filtrados_20250605_staging eliminada se existia\n[2025-06-05 21:06:12] ✅ Tabela google_scraper.artigos_filtrados_20250605_staging criada com esquema correto\n2025-06-05 21:06:12,135 - INFO - ✅ Tabela google_scraper.artigos_filtrados_20250605_staging criada com esquema correto\n[2025-06-05 21:06:12] ✅ Índices criados para a tabela google_scraper.artigos_filtrados_20250605_staging\n2025-06-05 21:06:12,229 - INFO - ✅ Índices criados para a tabela google_scraper.artigos_filtrados_20250605_staging\n[2025-06-05 21:06:12] 🔧 A preparar dataframe para inserção na base de dados...\n2025-06-05 21:06:12,229 - INFO - 🔧 A preparar dataframe para inserção na base de dados...\n[2025-06-05 21:06:12] 📅 A converter formatos de data...\n2025-06-05 21:06:12,229 - INFO - 📅 A converter formatos de data...\n[2025-06-05 21:06:12] ✅ Preparadas 7 linhas para inserção\n2025-06-05 21:06:12,240 - INFO - ✅ Preparadas 7 linhas para inserção\n[2025-06-05 21:06:12] ✅ Inseridos/atualizados 7 artigos (falharam: 0)\n2025-06-05 21:06:12,557 - INFO - ✅ Inseridos/atualizados 7 artigos (falharam: 0)\n[2025-06-05 21:06:12] 💾 Backup de exportação guardado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv\n2025-06-05 21:06:12,561 - INFO - 💾 Backup de exportação guardado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv\n[2025-06-05 21:06:12] ✅ Estatísticas de exportação guardadas: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json\n2025-06-05 21:06:12,562 - INFO - ✅ Estatísticas de exportação guardadas: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json\n[2025-06-05 21:06:12] 📋 Localização de backup de exportação preparada: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv\n2025-06-05 21:06:12,562 - INFO - 📋 Localização de backup de exportação preparada: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv\n[2025-06-05 21:06:12] ✅ Exportação concluída com sucesso. Inseridos/atualizados 7 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250605_staging\n2025-06-05 21:06:12,562 - INFO - ✅ Exportação concluída com sucesso. Inseridos/atualizados 7 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250605_staging\n[2025-06-05 21:06:12] 🔗 Ligação à base de dados fechada\n2025-06-05 21:06:12,562 - INFO - 🔗 Ligação à base de dados fechada\n[2025-06-05 21:06:12] ✅ Exportação concluída com sucesso. Processados 7 artigos\n2025-06-05 21:06:12,562 - INFO - ✅ Exportação concluída com sucesso. Processados 7 artigos\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
