{"timestamp":"2025-06-05T20:07:42.435153","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T20:07:42.435718","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T20:07:42.540933Z","level":"info","event":"ğŸ”„ Starting export_supabase task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.541349Z","level":"info","event":"ğŸ“… Using current date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.541601Z","level":"info","event":"ğŸ“ Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.541700Z","level":"info","event":"ğŸ“… Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.541770Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.541836Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.541898Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.541959Z","level":"info","event":"  - Database table: artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.542019Z","level":"info","event":"ğŸ“ Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.554429Z","level":"info","event":"ğŸ“‹ Found 2 files from processar task via XCom","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.554692Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.555357Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.555752Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.555900Z","level":"info","event":"âœ… Found file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (1907 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.556022Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.556130Z","level":"info","event":"âœ… Found file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (1907 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.556202Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.556352Z","level":"info","event":"âœ… Found file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.556430Z","level":"info","event":"ğŸ“‹ Selected input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (1907 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.556490Z","level":"info","event":"ğŸ“Š Processing all relevant disaster-related articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.556685Z","level":"info","event":"ğŸ“ Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.557219Z","level":"info","event":"  - export_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.557363Z","level":"info","event":"  - export_stats: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.557469Z","level":"info","event":"  - backup_csv: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.557818Z","level":"info","event":"ğŸ”„ Running export command: python /opt/airflow/scripts/google_scraper/exportador_bd/export_to_supabase_airflow.py --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/05 --date_str 2025-06-05 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:42.558385Z","level":"info","event":"â° Waiting for export completion with timeout: 600 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.559976Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] A iniciar export_to_supabase_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.560639Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,559 - INFO - A iniciar export_to_supabase_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.560893Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] ParÃ¢metros: date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.561028Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,559 - INFO - ParÃ¢metros: date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.561638Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.562193Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,560 - INFO - Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.562265Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] ğŸš€ A iniciar exportaÃ§Ã£o para Supabase para a data: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.562330Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,560 - INFO - ğŸš€ A iniciar exportaÃ§Ã£o para Supabase para a data: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.562380Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] ğŸ“‹ Tabela de destino: artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.562430Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,560 - INFO - ğŸ“‹ Tabela de destino: artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.562485Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] ğŸ“ A usar diretÃ³rio de saÃ­da controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.562549Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,560 - INFO - ğŸ“ A usar diretÃ³rio de saÃ­da controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.562598Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] âœ… A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.562710Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,560 - INFO - âœ… A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.562765Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] ğŸ“‚ A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.562824Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,560 - INFO - ğŸ“‚ A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.562918Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] ğŸ“Š Carregados 7 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.563320Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,562 - INFO - ğŸ“Š Carregados 7 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.563439Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] ğŸ“‹ A processar todos os artigos relevantes relacionados com desastres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.563929Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,562 - INFO - ğŸ“‹ A processar todos os artigos relevantes relacionados com desastres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.564042Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] ğŸ” VerificaÃ§Ã£o inicial do ambiente...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.564111Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,562 - INFO - ğŸ” VerificaÃ§Ã£o inicial do ambiente...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.564171Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   DB_HOST do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.564242Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,563 - INFO -   DB_HOST do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.564298Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   DB_USER do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.565009Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,563 - INFO -   DB_USER do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.565099Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   DB_PASSWORD do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.565179Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,563 - INFO -   DB_PASSWORD do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.565286Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] ğŸ” ConfiguraÃ§Ã£o da base de dados nÃ£o encontrada no ambiente, procurando ficheiro .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.565372Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,563 - INFO - ğŸ” ConfiguraÃ§Ã£o da base de dados nÃ£o encontrada no ambiente, procurando ficheiro .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.565522Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] ğŸ” Verificando 6 localizaÃ§Ãµes possÃ­veis do .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.565614Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,563 - INFO - ğŸ” Verificando 6 localizaÃ§Ãµes possÃ­veis do .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.565696Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   A verificar: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.565760Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,563 - INFO -   A verificar: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.565817Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   âŒ NÃ£o encontrado: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.565884Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,563 - INFO -   âŒ NÃ£o encontrado: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.565974Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   A verificar: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.566081Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,563 - INFO -   A verificar: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.566153Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] âœ… Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.566210Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,563 - INFO - âœ… Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.566275Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] ğŸ“„ Tamanho do ficheiro .env: 210 caracteres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.566348Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,563 - INFO - ğŸ“„ Tamanho do ficheiro .env: 210 caracteres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.566418Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   âœ… Definido DB_USER do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.566480Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,563 - INFO -   âœ… Definido DB_USER do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.566585Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   âœ… Definido DB_PASSWORD do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.566686Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,563 - INFO -   âœ… Definido DB_PASSWORD do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.566802Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   âœ… Definido DB_HOST do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.566947Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,563 - INFO -   âœ… Definido DB_HOST do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.567017Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   âœ… Definido DB_PORT do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.567077Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,563 - INFO -   âœ… Definido DB_PORT do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.567133Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   âœ… Definido DB_NAME do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.567201Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,563 - INFO -   âœ… Definido DB_NAME do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.567264Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   âœ… Definido DB_SCHEMA do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.567336Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,563 - INFO -   âœ… Definido DB_SCHEMA do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.567442Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] ğŸ” VerificaÃ§Ã£o final da configuraÃ§Ã£o...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.567541Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,563 - INFO - ğŸ” VerificaÃ§Ã£o final da configuraÃ§Ã£o...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.567612Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   DB_HOST: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.567690Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,564 - INFO -   DB_HOST: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.567767Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   DB_USER: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.567839Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,564 - INFO -   DB_USER: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.567908Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   DB_PASSWORD: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.567974Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,564 - INFO -   DB_PASSWORD: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.568045Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   DB_PORT: 6543","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.568111Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,564 - INFO -   DB_PORT: 6543","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.568171Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   DB_NAME: postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.568221Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,564 - INFO -   DB_NAME: postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.568284Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43]   DB_SCHEMA: google_scraper","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.568378Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,564 - INFO -   DB_SCHEMA: google_scraper","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.568444Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] âœ… ConfiguraÃ§Ã£o da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.568510Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,564 - INFO - âœ… ConfiguraÃ§Ã£o da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.568569Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] ğŸ”— A conectar Ã  base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.568622Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,564 - INFO - ğŸ”— A conectar Ã  base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.871488Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] âœ… Conectado Ã  base de dados com sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.873017Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,870 - INFO - âœ… Conectado Ã  base de dados com sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.923310Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] ğŸ—‘ï¸ Tabela existente google_scraper.artigos_filtrados_20250605_staging eliminada se existia","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.923712Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,923 - INFO - ğŸ—‘ï¸ Tabela existente google_scraper.artigos_filtrados_20250605_staging eliminada se existia","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.990642Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:43] âœ… Tabela google_scraper.artigos_filtrados_20250605_staging criada com esquema correto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:43.991125Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:43,988 - INFO - âœ… Tabela google_scraper.artigos_filtrados_20250605_staging criada com esquema correto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.105486Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:44] âœ… Ãndices criados para a tabela google_scraper.artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.108725Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:44,105 - INFO - âœ… Ãndices criados para a tabela google_scraper.artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.110562Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:44] ğŸ”§ A preparar dataframe para inserÃ§Ã£o na base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.111021Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:44,105 - INFO - ğŸ”§ A preparar dataframe para inserÃ§Ã£o na base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.111267Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:44] ğŸ“… A converter formatos de data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.111487Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:44,105 - INFO - ğŸ“… A converter formatos de data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.114106Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:44] âœ… Preparadas 7 linhas para inserÃ§Ã£o","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.114476Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:44,113 - INFO - âœ… Preparadas 7 linhas para inserÃ§Ã£o","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.449659Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:44] âœ… Inseridos/atualizados 7 artigos (falharam: 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.450062Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:44,449 - INFO - âœ… Inseridos/atualizados 7 artigos (falharam: 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.454059Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:44] ğŸ’¾ Backup de exportaÃ§Ã£o guardado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.454441Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:44,453 - INFO - ğŸ’¾ Backup de exportaÃ§Ã£o guardado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.455570Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:44] âœ… EstatÃ­sticas de exportaÃ§Ã£o guardadas: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.459573Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:44,454 - INFO - âœ… EstatÃ­sticas de exportaÃ§Ã£o guardadas: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.460534Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:44] ğŸ“‹ LocalizaÃ§Ã£o de backup de exportaÃ§Ã£o preparada: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.460624Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:44,454 - INFO - ğŸ“‹ LocalizaÃ§Ã£o de backup de exportaÃ§Ã£o preparada: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.460685Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:44] âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Inseridos/atualizados 7 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.460739Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:44,454 - INFO - âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Inseridos/atualizados 7 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.460836Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:44] ğŸ”— LigaÃ§Ã£o Ã  base de dados fechada","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.460893Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:44,455 - INFO - ğŸ”— LigaÃ§Ã£o Ã  base de dados fechada","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.460938Z","level":"info","event":"ğŸ“‹ [2025-06-05 21:07:44] âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Processados 7 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.460983Z","level":"info","event":"ğŸ“‹ 2025-06-05 21:07:44,455 - INFO - âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Processados 7 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.555269Z","level":"info","event":"âœ… Export completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.555494Z","level":"info","event":"ğŸ” Verifying export outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.555637Z","level":"info","event":"âš ï¸ export_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.555770Z","level":"info","event":"âœ… export_stats: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json (929 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.555884Z","level":"info","event":"âœ… backup_csv: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv (1909 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T20:07:44.556672","level":"info","event":"Done. Returned value was: [2025-06-05 21:07:43] A iniciar export_to_supabase_airflow\n2025-06-05 21:07:43,559 - INFO - A iniciar export_to_supabase_airflow\n[2025-06-05 21:07:43] ParÃ¢metros: date=2025-06-05\n2025-06-05 21:07:43,559 - INFO - ParÃ¢metros: date=2025-06-05\n[2025-06-05 21:07:43] Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n2025-06-05 21:07:43,560 - INFO - Caminhos: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n[2025-06-05 21:07:43] ğŸš€ A iniciar exportaÃ§Ã£o para Supabase para a data: 2025-06-05\n2025-06-05 21:07:43,560 - INFO - ğŸš€ A iniciar exportaÃ§Ã£o para Supabase para a data: 2025-06-05\n[2025-06-05 21:07:43] ğŸ“‹ Tabela de destino: artigos_filtrados_20250605_staging\n2025-06-05 21:07:43,560 - INFO - ğŸ“‹ Tabela de destino: artigos_filtrados_20250605_staging\n[2025-06-05 21:07:43] ğŸ“ A usar diretÃ³rio de saÃ­da controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 21:07:43,560 - INFO - ğŸ“ A usar diretÃ³rio de saÃ­da controlado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 21:07:43] âœ… A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 21:07:43,560 - INFO - âœ… A usar ficheiro de entrada fornecido: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 21:07:43] ğŸ“‚ A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 21:07:43,560 - INFO - ğŸ“‚ A carregar artigos de: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 21:07:43] ğŸ“Š Carregados 7 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']\n2025-06-05 21:07:43,562 - INFO - ğŸ“Š Carregados 7 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']\n[2025-06-05 21:07:43] ğŸ“‹ A processar todos os artigos relevantes relacionados com desastres\n2025-06-05 21:07:43,562 - INFO - ğŸ“‹ A processar todos os artigos relevantes relacionados com desastres\n[2025-06-05 21:07:43] ğŸ” VerificaÃ§Ã£o inicial do ambiente...\n2025-06-05 21:07:43,562 - INFO - ğŸ” VerificaÃ§Ã£o inicial do ambiente...\n[2025-06-05 21:07:43]   DB_HOST do ambiente: NÃƒO_ENCONTRADO\n2025-06-05 21:07:43,563 - INFO -   DB_HOST do ambiente: NÃƒO_ENCONTRADO\n[2025-06-05 21:07:43]   DB_USER do ambiente: NÃƒO_ENCONTRADO\n2025-06-05 21:07:43,563 - INFO -   DB_USER do ambiente: NÃƒO_ENCONTRADO\n[2025-06-05 21:07:43]   DB_PASSWORD do ambiente: NÃƒO_ENCONTRADO\n2025-06-05 21:07:43,563 - INFO -   DB_PASSWORD do ambiente: NÃƒO_ENCONTRADO\n[2025-06-05 21:07:43] ğŸ” ConfiguraÃ§Ã£o da base de dados nÃ£o encontrada no ambiente, procurando ficheiro .env...\n2025-06-05 21:07:43,563 - INFO - ğŸ” ConfiguraÃ§Ã£o da base de dados nÃ£o encontrada no ambiente, procurando ficheiro .env...\n[2025-06-05 21:07:43] ğŸ” Verificando 6 localizaÃ§Ãµes possÃ­veis do .env...\n2025-06-05 21:07:43,563 - INFO - ğŸ” Verificando 6 localizaÃ§Ãµes possÃ­veis do .env...\n[2025-06-05 21:07:43]   A verificar: /opt/airflow/.env\n2025-06-05 21:07:43,563 - INFO -   A verificar: /opt/airflow/.env\n[2025-06-05 21:07:43]   âŒ NÃ£o encontrado: /opt/airflow/.env\n2025-06-05 21:07:43,563 - INFO -   âŒ NÃ£o encontrado: /opt/airflow/.env\n[2025-06-05 21:07:43]   A verificar: /opt/airflow/scripts/google_scraper/.env\n2025-06-05 21:07:43,563 - INFO -   A verificar: /opt/airflow/scripts/google_scraper/.env\n[2025-06-05 21:07:43] âœ… Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env\n2025-06-05 21:07:43,563 - INFO - âœ… Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env\n[2025-06-05 21:07:43] ğŸ“„ Tamanho do ficheiro .env: 210 caracteres\n2025-06-05 21:07:43,563 - INFO - ğŸ“„ Tamanho do ficheiro .env: 210 caracteres\n[2025-06-05 21:07:43]   âœ… Definido DB_USER do .env\n2025-06-05 21:07:43,563 - INFO -   âœ… Definido DB_USER do .env\n[2025-06-05 21:07:43]   âœ… Definido DB_PASSWORD do .env\n2025-06-05 21:07:43,563 - INFO -   âœ… Definido DB_PASSWORD do .env\n[2025-06-05 21:07:43]   âœ… Definido DB_HOST do .env\n2025-06-05 21:07:43,563 - INFO -   âœ… Definido DB_HOST do .env\n[2025-06-05 21:07:43]   âœ… Definido DB_PORT do .env\n2025-06-05 21:07:43,563 - INFO -   âœ… Definido DB_PORT do .env\n[2025-06-05 21:07:43]   âœ… Definido DB_NAME do .env\n2025-06-05 21:07:43,563 - INFO -   âœ… Definido DB_NAME do .env\n[2025-06-05 21:07:43]   âœ… Definido DB_SCHEMA do .env\n2025-06-05 21:07:43,563 - INFO -   âœ… Definido DB_SCHEMA do .env\n[2025-06-05 21:07:43] ğŸ” VerificaÃ§Ã£o final da configuraÃ§Ã£o...\n2025-06-05 21:07:43,563 - INFO - ğŸ” VerificaÃ§Ã£o final da configuraÃ§Ã£o...\n[2025-06-05 21:07:43]   DB_HOST: DEFINIDO\n2025-06-05 21:07:43,564 - INFO -   DB_HOST: DEFINIDO\n[2025-06-05 21:07:43]   DB_USER: DEFINIDO\n2025-06-05 21:07:43,564 - INFO -   DB_USER: DEFINIDO\n[2025-06-05 21:07:43]   DB_PASSWORD: DEFINIDO\n2025-06-05 21:07:43,564 - INFO -   DB_PASSWORD: DEFINIDO\n[2025-06-05 21:07:43]   DB_PORT: 6543\n2025-06-05 21:07:43,564 - INFO -   DB_PORT: 6543\n[2025-06-05 21:07:43]   DB_NAME: postgres\n2025-06-05 21:07:43,564 - INFO -   DB_NAME: postgres\n[2025-06-05 21:07:43]   DB_SCHEMA: google_scraper\n2025-06-05 21:07:43,564 - INFO -   DB_SCHEMA: google_scraper\n[2025-06-05 21:07:43] âœ… ConfiguraÃ§Ã£o da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres\n2025-06-05 21:07:43,564 - INFO - âœ… ConfiguraÃ§Ã£o da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres\n[2025-06-05 21:07:43] ğŸ”— A conectar Ã  base de dados...\n2025-06-05 21:07:43,564 - INFO - ğŸ”— A conectar Ã  base de dados...\n[2025-06-05 21:07:43] âœ… Conectado Ã  base de dados com sucesso\n2025-06-05 21:07:43,870 - INFO - âœ… Conectado Ã  base de dados com sucesso\n[2025-06-05 21:07:43] ğŸ—‘ï¸ Tabela existente google_scraper.artigos_filtrados_20250605_staging eliminada se existia\n2025-06-05 21:07:43,923 - INFO - ğŸ—‘ï¸ Tabela existente google_scraper.artigos_filtrados_20250605_staging eliminada se existia\n[2025-06-05 21:07:43] âœ… Tabela google_scraper.artigos_filtrados_20250605_staging criada com esquema correto\n2025-06-05 21:07:43,988 - INFO - âœ… Tabela google_scraper.artigos_filtrados_20250605_staging criada com esquema correto\n[2025-06-05 21:07:44] âœ… Ãndices criados para a tabela google_scraper.artigos_filtrados_20250605_staging\n2025-06-05 21:07:44,105 - INFO - âœ… Ãndices criados para a tabela google_scraper.artigos_filtrados_20250605_staging\n[2025-06-05 21:07:44] ğŸ”§ A preparar dataframe para inserÃ§Ã£o na base de dados...\n2025-06-05 21:07:44,105 - INFO - ğŸ”§ A preparar dataframe para inserÃ§Ã£o na base de dados...\n[2025-06-05 21:07:44] ğŸ“… A converter formatos de data...\n2025-06-05 21:07:44,105 - INFO - ğŸ“… A converter formatos de data...\n[2025-06-05 21:07:44] âœ… Preparadas 7 linhas para inserÃ§Ã£o\n2025-06-05 21:07:44,113 - INFO - âœ… Preparadas 7 linhas para inserÃ§Ã£o\n[2025-06-05 21:07:44] âœ… Inseridos/atualizados 7 artigos (falharam: 0)\n2025-06-05 21:07:44,449 - INFO - âœ… Inseridos/atualizados 7 artigos (falharam: 0)\n[2025-06-05 21:07:44] ğŸ’¾ Backup de exportaÃ§Ã£o guardado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv\n2025-06-05 21:07:44,453 - INFO - ğŸ’¾ Backup de exportaÃ§Ã£o guardado: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv\n[2025-06-05 21:07:44] âœ… EstatÃ­sticas de exportaÃ§Ã£o guardadas: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json\n2025-06-05 21:07:44,454 - INFO - âœ… EstatÃ­sticas de exportaÃ§Ã£o guardadas: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json\n[2025-06-05 21:07:44] ğŸ“‹ LocalizaÃ§Ã£o de backup de exportaÃ§Ã£o preparada: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv\n2025-06-05 21:07:44,454 - INFO - ğŸ“‹ LocalizaÃ§Ã£o de backup de exportaÃ§Ã£o preparada: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv\n[2025-06-05 21:07:44] âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Inseridos/atualizados 7 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250605_staging\n2025-06-05 21:07:44,454 - INFO - âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Inseridos/atualizados 7 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250605_staging\n[2025-06-05 21:07:44] ğŸ”— LigaÃ§Ã£o Ã  base de dados fechada\n2025-06-05 21:07:44,455 - INFO - ğŸ”— LigaÃ§Ã£o Ã  base de dados fechada\n[2025-06-05 21:07:44] âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Processados 7 artigos\n2025-06-05 21:07:44,455 - INFO - âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Processados 7 artigos\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
