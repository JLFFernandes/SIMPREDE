{"timestamp":"2025-06-05T16:26:34.931889","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T16:26:34.932335","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T16:26:35.596425Z","level":"info","event":"🔄 Starting export_supabase task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.596681Z","level":"info","event":"📅 Using current date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.600049Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.600147Z","level":"info","event":"📅 Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.600219Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.600278Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.600338Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.600402Z","level":"info","event":"  - Database table: artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.600467Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.611628Z","level":"info","event":"📋 Found 2 files from processar task via XCom","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.611884Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.612056Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.612151Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.612326Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.612424Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.612752Z","level":"info","event":"⚠️ No input files found from previous tasks","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.612854Z","level":"info","event":"🔍 Checking legacy path: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.612986Z","level":"info","event":"🔍 Checking legacy path: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.614007Z","level":"info","event":"🔍 Checking legacy path: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.614287Z","level":"info","event":"🔍 Checking legacy path: /opt/airflow/scripts/google_scraper/data/structured/artigos_vitimas_filtrados.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.614452Z","level":"info","event":"ℹ️ No input files found - this may be normal if no disaster-related articles were detected","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.614600Z","level":"info","event":"✅ Export task will proceed and handle empty data gracefully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.614659Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.614708Z","level":"info","event":"  - export_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.614750Z","level":"info","event":"  - export_stats: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.614787Z","level":"info","event":"  - backup_csv: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.614829Z","level":"info","event":"🔄 Running export command: python /opt/airflow/scripts/google_scraper/exportador_bd/export_to_supabase_airflow.py --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:35.616268Z","level":"info","event":"⏰ Waiting for export completion with timeout: 600 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.629887Z","level":"info","event":"📋 [2025-06-05 17:26:36] Starting export_to_supabase_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.630228Z","level":"info","event":"📋 2025-06-05 17:26:36,629 - INFO - Starting export_to_supabase_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.630406Z","level":"info","event":"📋 [2025-06-05 17:26:36] Parameters: date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.630510Z","level":"info","event":"📋 2025-06-05 17:26:36,629 - INFO - Parameters: date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.630599Z","level":"info","event":"📋 [2025-06-05 17:26:36] Paths: input_file=None, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.630692Z","level":"info","event":"📋 2025-06-05 17:26:36,629 - INFO - Paths: input_file=None, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.630878Z","level":"info","event":"📋 [2025-06-05 17:26:36] 🚀 Starting export to Supabase for date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.631033Z","level":"info","event":"📋 2025-06-05 17:26:36,629 - INFO - 🚀 Starting export to Supabase for date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.631128Z","level":"info","event":"📋 [2025-06-05 17:26:36] 📋 Target table: artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.631223Z","level":"info","event":"📋 2025-06-05 17:26:36,629 - INFO - 📋 Target table: artigos_filtrados_20250605_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.631303Z","level":"info","event":"📋 [2025-06-05 17:26:36] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.631534Z","level":"info","event":"📋 2025-06-05 17:26:36,629 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.631667Z","level":"info","event":"📋 [2025-06-05 17:26:36] ℹ️ No filtered articles file found for 2025-06-05. This is normal when no disaster-related events were detected.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.631929Z","level":"info","event":"📋 2025-06-05 17:26:36,630 - INFO - ℹ️ No filtered articles file found for 2025-06-05. This is normal when no disaster-related events were detected.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.632078Z","level":"info","event":"📋 [2025-06-05 17:26:36] ℹ️ No filtered articles file found. This typically means no disaster-related events were detected for this date.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.634416Z","level":"info","event":"📋 2025-06-05 17:26:36,630 - INFO - ℹ️ No filtered articles file found. This typically means no disaster-related events were detected for this date.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.634507Z","level":"info","event":"📋 [2025-06-05 17:26:36] ✅ Export task completed successfully - no data to export.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.638168Z","level":"info","event":"📋 2025-06-05 17:26:36,630 - INFO - ✅ Export task completed successfully - no data to export.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.638355Z","level":"info","event":"📋 [2025-06-05 17:26:36] ✅ Export statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.638419Z","level":"info","event":"📋 2025-06-05 17:26:36,632 - INFO - ✅ Export statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.638474Z","level":"info","event":"📋 [2025-06-05 17:26:36] ✅ Export completed successfully. Processed 0 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.638550Z","level":"info","event":"📋 2025-06-05 17:26:36,632 - INFO - ✅ Export completed successfully. Processed 0 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.718741Z","level":"info","event":"✅ Export completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.718970Z","level":"info","event":"🔍 Verifying export outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.719122Z","level":"info","event":"⚠️ export_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.719212Z","level":"info","event":"✅ export_stats: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json (307 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.719289Z","level":"info","event":"⚠️ backup_csv: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_backup_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T16:26:36.720438","level":"info","event":"Done. Returned value was: [2025-06-05 17:26:36] Starting export_to_supabase_airflow\n2025-06-05 17:26:36,629 - INFO - Starting export_to_supabase_airflow\n[2025-06-05 17:26:36] Parameters: date=2025-06-05\n2025-06-05 17:26:36,629 - INFO - Parameters: date=2025-06-05\n[2025-06-05 17:26:36] Paths: input_file=None, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n2025-06-05 17:26:36,629 - INFO - Paths: input_file=None, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n[2025-06-05 17:26:36] 🚀 Starting export to Supabase for date: 2025-06-05\n2025-06-05 17:26:36,629 - INFO - 🚀 Starting export to Supabase for date: 2025-06-05\n[2025-06-05 17:26:36] 📋 Target table: artigos_filtrados_20250605_staging\n2025-06-05 17:26:36,629 - INFO - 📋 Target table: artigos_filtrados_20250605_staging\n[2025-06-05 17:26:36] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 17:26:36,629 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 17:26:36] ℹ️ No filtered articles file found for 2025-06-05. This is normal when no disaster-related events were detected.\n2025-06-05 17:26:36,630 - INFO - ℹ️ No filtered articles file found for 2025-06-05. This is normal when no disaster-related events were detected.\n[2025-06-05 17:26:36] ℹ️ No filtered articles file found. This typically means no disaster-related events were detected for this date.\n2025-06-05 17:26:36,630 - INFO - ℹ️ No filtered articles file found. This typically means no disaster-related events were detected for this date.\n[2025-06-05 17:26:36] ✅ Export task completed successfully - no data to export.\n2025-06-05 17:26:36,630 - INFO - ✅ Export task completed successfully - no data to export.\n[2025-06-05 17:26:36] ✅ Export statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json\n2025-06-05 17:26:36,632 - INFO - ✅ Export statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/export_stats_20250605.json\n[2025-06-05 17:26:36] ✅ Export completed successfully. Processed 0 articles\n2025-06-05 17:26:36,632 - INFO - ✅ Export completed successfully. Processed 0 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
