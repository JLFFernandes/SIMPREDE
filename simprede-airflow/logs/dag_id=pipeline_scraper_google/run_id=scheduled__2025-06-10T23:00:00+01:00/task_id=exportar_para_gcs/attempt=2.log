{"timestamp":"2025-06-11T14:23:27.381276","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-11T14:23:27.381962","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-11T14:23:27.427035Z","level":"info","event":"🔄 Starting export_to_gcs task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.427905Z","level":"info","event":"📁 Using paths from export_supabase task: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.430502Z","level":"info","event":"📅 Using provided execution date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.431435Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/11', '/opt/airflow/data/structured/2025/06/11', '/opt/airflow/data/processed/2025/06/11']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.431525Z","level":"info","event":"📅 GCS Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.431587Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.431996Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.432069Z","level":"info","event":"  - Target date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.432181Z","level":"info","event":"  - Base data directory: /opt/airflow/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.432275Z","level":"info","event":"  - GCS Project ID: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.432326Z","level":"info","event":"  - GCS Bucket: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.432382Z","level":"info","event":"🔄 Running GCS export command: python /opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py --date 2025-06-11 --base_data_dir /opt/airflow/data --output_dir /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.432461Z","level":"info","event":"⏰ Waiting for GCS export completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.983482Z","level":"info","event":"📋 2025-06-11 15:23:27,983 - INFO - 2025-06-11 15:23:27 - Starting export_to_gcs_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.983742Z","level":"info","event":"📋 2025-06-11 15:23:27,983 - INFO - 2025-06-11 15:23:27 - Parameters: date=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.984329Z","level":"info","event":"📋 2025-06-11 15:23:27,983 - INFO - 2025-06-11 15:23:27 - Paths: base_data_dir=/opt/airflow/data, output_dir=/opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.984444Z","level":"info","event":"📋 2025-06-11 15:23:27,983 - INFO - 2025-06-11 15:23:27 - GCS: project_id=None, bucket=None","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.984578Z","level":"info","event":"📋 2025-06-11 15:23:27,983 - INFO - 2025-06-11 15:23:27 - Airflow logs: include=True, dir=/opt/airflow/logs","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.984652Z","level":"info","event":"📋 2025-06-11 15:23:27,983 - INFO - 2025-06-11 15:23:27 - Cleanup: enabled=True, partial_success=False, dry_run=False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.984729Z","level":"info","event":"📋 2025-06-11 15:23:27,983 - INFO - 2025-06-11 15:23:27 - 🚀 Starting GCS export for date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.984792Z","level":"info","event":"📋 2025-06-11 15:23:27,983 - INFO - 2025-06-11 15:23:27 - 📁 Base data directory: /opt/airflow/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.984890Z","level":"info","event":"📋 2025-06-11 15:23:27,983 - INFO - 2025-06-11 15:23:27 - 📋 Include Airflow logs: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.984936Z","level":"info","event":"📋 2025-06-11 15:23:27,983 - INFO - 2025-06-11 15:23:27 - 🧹 Cleanup after export: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.984995Z","level":"info","event":"📋 2025-06-11 15:23:27,983 - INFO - 2025-06-11 15:23:27 - 🧹 Cleanup on partial success: False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.985103Z","level":"info","event":"📋 2025-06-11 15:23:27,983 - INFO - 2025-06-11 15:23:27 - 🧹 Dry run cleanup: False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.985169Z","level":"info","event":"📋 2025-06-11 15:23:27,983 - INFO - 2025-06-11 15:23:27 - 🔧 GCS Configuration:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.985442Z","level":"info","event":"📋 2025-06-11 15:23:27,983 - INFO - 2025-06-11 15:23:27 -   - Project ID: simprede-461309","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.985577Z","level":"info","event":"📋 2025-06-11 15:23:27,983 - INFO - 2025-06-11 15:23:27 -   - Bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.985649Z","level":"info","event":"📋 2025-06-11 15:23:27,983 - INFO - 2025-06-11 15:23:27 -   - Credentials: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.985767Z","level":"info","event":"📋 2025-06-11 15:23:27,984 - WARNING - 2025-06-11 15:23:27 - ⚠️ Application default credentials failed: File /opt/airflow/config/gcs-credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.985952Z","level":"info","event":"📋 2025-06-11 15:23:27,985 - ERROR - 2025-06-11 15:23:27 - ❌ All authentication methods failed:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.986002Z","level":"info","event":"📋 2025-06-11 15:23:27,985 - ERROR - 2025-06-11 15:23:27 -    - Service account: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.986047Z","level":"info","event":"📋 2025-06-11 15:23:27,985 - ERROR - 2025-06-11 15:23:27 -    - Default credentials: File /opt/airflow/config/gcs-credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.986094Z","level":"info","event":"📋 2025-06-11 15:23:27,985 - ERROR - 2025-06-11 15:23:27 -    - Auto-detection: File /opt/airflow/config/gcs-credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.987082Z","level":"info","event":"📋 2025-06-11 15:23:27,985 - ERROR - 2025-06-11 15:23:27 - ❌ Failed to initialize GCS client: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.987910Z","level":"info","event":"📋 2025-06-11 15:23:27,985 - ERROR - 2025-06-11 15:23:27 - ❌ Failed to initialize GCS exporter: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.988869Z","level":"info","event":"📋 2025-06-11 15:23:27,985 - ERROR - 2025-06-11 15:23:27 - ❌ GCS export failed: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.988989Z","level":"info","event":"📋 2025-06-11 15:23:27,986 - ERROR - 2025-06-11 15:23:27 - ❌ Full traceback: Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989046Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 84, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989090Z","level":"info","event":"📋     self.client = storage.Client(project=project_id)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989178Z","level":"info","event":"📋                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989226Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/storage/client.py\", line 173, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989276Z","level":"info","event":"📋     super(Client, self).__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989322Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 339, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989367Z","level":"info","event":"📋     Client.__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989413Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 196, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989459Z","level":"info","event":"📋     credentials, _ = google.auth.default(scopes=scopes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989505Z","level":"info","event":"📋                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989550Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 651, in default","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989598Z","level":"info","event":"📋     credentials, project_id = checker()","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989644Z","level":"info","event":"📋                               ^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989690Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 644, in <lambda>","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989743Z","level":"info","event":"📋     lambda: _get_explicit_environ_credentials(quota_project_id=quota_project_id),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989790Z","level":"info","event":"📋             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989837Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 293, in _get_explicit_environ_credentials","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989890Z","level":"info","event":"📋     credentials, project_id = load_credentials_from_file(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989936Z","level":"info","event":"📋                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.989982Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 125, in load_credentials_from_file","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.990027Z","level":"info","event":"📋     raise exceptions.DefaultCredentialsError(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.990071Z","level":"info","event":"📋 google.auth.exceptions.DefaultCredentialsError: File /opt/airflow/config/gcs-credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.990116Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.990167Z","level":"info","event":"📋 During handling of the above exception, another exception occurred:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.990215Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.990259Z","level":"info","event":"📋 Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.990340Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 91, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.991414Z","level":"info","event":"📋     self.client = storage.Client()","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.991899Z","level":"info","event":"📋                   ^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.992868Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/storage/client.py\", line 173, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.992941Z","level":"info","event":"📋     super(Client, self).__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.992988Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 339, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993034Z","level":"info","event":"📋     Client.__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993075Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 196, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993118Z","level":"info","event":"📋     credentials, _ = google.auth.default(scopes=scopes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993165Z","level":"info","event":"📋                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993211Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 651, in default","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993256Z","level":"info","event":"📋     credentials, project_id = checker()","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993300Z","level":"info","event":"📋                               ^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993345Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 644, in <lambda>","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993392Z","level":"info","event":"📋     lambda: _get_explicit_environ_credentials(quota_project_id=quota_project_id),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993436Z","level":"info","event":"📋             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993481Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 293, in _get_explicit_environ_credentials","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993525Z","level":"info","event":"📋     credentials, project_id = load_credentials_from_file(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993569Z","level":"info","event":"📋                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993615Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 125, in load_credentials_from_file","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993659Z","level":"info","event":"📋     raise exceptions.DefaultCredentialsError(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993703Z","level":"info","event":"📋 google.auth.exceptions.DefaultCredentialsError: File /opt/airflow/config/gcs-credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993789Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993832Z","level":"info","event":"📋 During handling of the above exception, another exception occurred:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993882Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993924Z","level":"info","event":"📋 Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.993967Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 762, in main","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.994012Z","level":"info","event":"📋     result = export_to_gcs(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.994079Z","level":"info","event":"📋              ^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.994121Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 588, in export_to_gcs","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.994165Z","level":"info","event":"📋     exporter = GCSExporter(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.994208Z","level":"info","event":"📋                ^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.994253Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 99, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.994297Z","level":"info","event":"📋     raise Exception(\"No valid GCP authentication method found\")","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.994341Z","level":"info","event":"📋 Exception: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:27.994384Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:28.015332Z","level":"info","event":"❌ GCS export failed with return code 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:28.015493Z","level":"info","event":"❌ Unexpected error in GCS export task: GCS export failed with return code 1:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:23:28.015400","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"Exception","exc_value":"GCS export failed with return code 1: ","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":838,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1130,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":212,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":235,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/google_scraper_dag.py","lineno":1079,"name":"export_to_gcs_task"}]}]}
