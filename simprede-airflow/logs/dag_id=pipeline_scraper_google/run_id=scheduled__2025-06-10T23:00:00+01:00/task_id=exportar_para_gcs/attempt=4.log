{"timestamp":"2025-06-11T14:24:59.117122","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-11T14:24:59.117506","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-11T14:24:59.143732Z","level":"info","event":"🔄 Starting export_to_gcs task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.143937Z","level":"info","event":"📁 Using paths from export_supabase task: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.146344Z","level":"info","event":"📅 Using provided execution date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.146621Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/11', '/opt/airflow/data/structured/2025/06/11', '/opt/airflow/data/processed/2025/06/11']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.147017Z","level":"info","event":"📅 GCS Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.147082Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.147325Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.147454Z","level":"info","event":"  - Target date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.147551Z","level":"info","event":"  - Base data directory: /opt/airflow/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.147628Z","level":"info","event":"  - GCS Project ID: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.147694Z","level":"info","event":"  - GCS Bucket: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.147901Z","level":"info","event":"🔄 Running GCS export command: python /opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py --date 2025-06-11 --base_data_dir /opt/airflow/data --output_dir /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.148010Z","level":"info","event":"⏰ Waiting for GCS export completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.716482Z","level":"info","event":"📋 2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - Starting export_to_gcs_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.716733Z","level":"info","event":"📋 2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - Parameters: date=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.716910Z","level":"info","event":"📋 2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - Paths: base_data_dir=/opt/airflow/data, output_dir=/opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.717067Z","level":"info","event":"📋 2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - GCS: project_id=None, bucket=None","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.717162Z","level":"info","event":"📋 2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - Airflow logs: include=True, dir=/opt/airflow/logs","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.717555Z","level":"info","event":"📋 2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - Cleanup: enabled=True, partial_success=False, dry_run=False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.717681Z","level":"info","event":"📋 2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - 🚀 Starting GCS export for date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.717753Z","level":"info","event":"📋 2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - 📁 Base data directory: /opt/airflow/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.717878Z","level":"info","event":"📋 2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - 📋 Include Airflow logs: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.717933Z","level":"info","event":"📋 2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - 🧹 Cleanup after export: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.717983Z","level":"info","event":"📋 2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - 🧹 Cleanup on partial success: False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.718028Z","level":"info","event":"📋 2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - 🧹 Dry run cleanup: False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.718074Z","level":"info","event":"📋 2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - 🔧 GCS Configuration:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.718119Z","level":"info","event":"📋 2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 -   - Project ID: simprede-461309","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.718166Z","level":"info","event":"📋 2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 -   - Bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.718213Z","level":"info","event":"📋 2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 -   - Credentials: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:59.758369Z","level":"info","event":"📋 2025-06-11 15:24:59,758 - INFO - 2025-06-11 15:24:59 - ✅ Initialized GCS client with service account: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.173606Z","level":"info","event":"📋 2025-06-11 15:25:00,173 - INFO - 2025-06-11 15:25:00 - ✅ Bucket 'simprede-data-pipeline' already exists","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.177883Z","level":"info","event":"📋 2025-06-11 15:25:00,177 - INFO - 2025-06-11 15:25:00 - 📁 Found data directory: /opt/airflow/data/raw/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.178446Z","level":"info","event":"📋 2025-06-11 15:25:00,178 - INFO - 2025-06-11 15:25:00 - 📁 Found data directory: /opt/airflow/data/structured/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.178774Z","level":"info","event":"📋 2025-06-11 15:25:00,178 - INFO - 2025-06-11 15:25:00 - 📁 Found data directory: /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.178909Z","level":"info","event":"📋 2025-06-11 15:25:00,178 - INFO - 2025-06-11 15:25:00 - 📤 Exporting data directory: /opt/airflow/data/raw/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.178999Z","level":"info","event":"📋 2025-06-11 15:25:00,178 - INFO - 2025-06-11 15:25:00 - 📁 Scanning directory: /opt/airflow/data/raw/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.179919Z","level":"info","event":"📋 2025-06-11 15:25:00,179 - INFO - 2025-06-11 15:25:00 - 📤 Uploading /opt/airflow/data/raw/2025/06/11/google_news_articles_20250611.csv → gs://simprede-data-pipeline/data/raw/2025/06/11/google_news_articles_20250611.csv (0.01 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.338007Z","level":"info","event":"📋 2025-06-11 15:25:00,337 - INFO - 2025-06-11 15:25:00 - ✅ Successfully uploaded: data/raw/2025/06/11/google_news_articles_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.338970Z","level":"info","event":"📋 2025-06-11 15:25:00,338 - INFO - 2025-06-11 15:25:00 - 📤 Uploading /opt/airflow/data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv → gs://simprede-data-pipeline/data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv (0.01 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.457482Z","level":"info","event":"📋 2025-06-11 15:25:00,456 - INFO - 2025-06-11 15:25:00 - ✅ Successfully uploaded: data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.458427Z","level":"info","event":"📋 2025-06-11 15:25:00,458 - INFO - 2025-06-11 15:25:00 - 📤 Uploading /opt/airflow/data/raw/2025/06/11/intermediate_google_news_20250611.csv → gs://simprede-data-pipeline/data/raw/2025/06/11/intermediate_google_news_20250611.csv (0.44 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.693774Z","level":"info","event":"📋 2025-06-11 15:25:00,693 - INFO - 2025-06-11 15:25:00 - ✅ Successfully uploaded: data/raw/2025/06/11/intermediate_google_news_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.694558Z","level":"info","event":"📋 2025-06-11 15:25:00,694 - INFO - 2025-06-11 15:25:00 - 📤 Exporting data directory: /opt/airflow/data/structured/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.694951Z","level":"info","event":"📋 2025-06-11 15:25:00,694 - INFO - 2025-06-11 15:25:00 - 📁 Scanning directory: /opt/airflow/data/structured/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.695775Z","level":"info","event":"📋 2025-06-11 15:25:00,695 - INFO - 2025-06-11 15:25:00 - 📤 Uploading /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv → gs://simprede-data-pipeline/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv (0.01 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.811253Z","level":"info","event":"📋 2025-06-11 15:25:00,810 - INFO - 2025-06-11 15:25:00 - ✅ Successfully uploaded: data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.813039Z","level":"info","event":"📋 2025-06-11 15:25:00,812 - INFO - 2025-06-11 15:25:00 - 📤 Uploading /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json → gs://simprede-data-pipeline/data/structured/2025/06/11/processing_stats_20250611.json (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.921259Z","level":"info","event":"📋 2025-06-11 15:25:00,920 - INFO - 2025-06-11 15:25:00 - ✅ Successfully uploaded: data/structured/2025/06/11/processing_stats_20250611.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.922259Z","level":"info","event":"📋 2025-06-11 15:25:00,921 - INFO - 2025-06-11 15:25:00 - 📤 Exporting data directory: /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.922771Z","level":"info","event":"📋 2025-06-11 15:25:00,921 - INFO - 2025-06-11 15:25:00 - 📁 Scanning directory: /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:00.923769Z","level":"info","event":"📋 2025-06-11 15:25:00,923 - INFO - 2025-06-11 15:25:00 - 📤 Uploading /opt/airflow/data/processed/2025/06/11/export_stats_20250611.json → gs://simprede-data-pipeline/data/processed/2025/06/11/export_stats_20250611.json (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.055389Z","level":"info","event":"📋 2025-06-11 15:25:01,054 - INFO - 2025-06-11 15:25:01 - ✅ Successfully uploaded: data/processed/2025/06/11/export_stats_20250611.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.056379Z","level":"info","event":"📋 2025-06-11 15:25:01,056 - INFO - 2025-06-11 15:25:01 - 📤 Uploading /opt/airflow/data/processed/2025/06/11/export_backup_20250611.csv → gs://simprede-data-pipeline/data/processed/2025/06/11/export_backup_20250611.csv (0.01 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.177243Z","level":"info","event":"📋 2025-06-11 15:25:01,177 - INFO - 2025-06-11 15:25:01 - ✅ Successfully uploaded: data/processed/2025/06/11/export_backup_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.179417Z","level":"info","event":"📋 2025-06-11 15:25:01,177 - INFO - 2025-06-11 15:25:01 - 📋 Starting Airflow logs export...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.179627Z","level":"info","event":"📋 2025-06-11 15:25:01,177 - INFO - 2025-06-11 15:25:01 - 📋 Starting Airflow logs export for 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.190270Z","level":"info","event":"📋 2025-06-11 15:25:01,190 - INFO - 2025-06-11 15:25:01 - 📋 Found 1 Airflow log paths for 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.190415Z","level":"info","event":"📋 2025-06-11 15:25:01,190 - INFO - 2025-06-11 15:25:01 -   📄 /opt/airflow/logs/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.190560Z","level":"info","event":"📋 2025-06-11 15:25:01,190 - INFO - 2025-06-11 15:25:01 - 📁 Scanning directory: /opt/airflow/logs/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.191106Z","level":"info","event":"📋 2025-06-11 15:25:01,191 - INFO - 2025-06-11 15:25:01 - 📤 Uploading /opt/airflow/logs/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-11/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=1.log (0.01 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.304569Z","level":"info","event":"📋 2025-06-11 15:25:01,304 - INFO - 2025-06-11 15:25:01 - ✅ Successfully uploaded: airflow-logs/2025-06-11/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=1.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.305598Z","level":"info","event":"📋 2025-06-11 15:25:01,305 - INFO - 2025-06-11 15:25:01 - 📤 Uploading /opt/airflow/logs/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=2.log → gs://simprede-data-pipeline/airflow-logs/2025-06-11/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=2.log (0.01 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.423363Z","level":"info","event":"📋 2025-06-11 15:25:01,423 - INFO - 2025-06-11 15:25:01 - ✅ Successfully uploaded: airflow-logs/2025-06-11/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=2.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.423671Z","level":"info","event":"📋 2025-06-11 15:25:01,423 - INFO - 2025-06-11 15:25:01 - 📤 Uploading /opt/airflow/logs/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=3.log → gs://simprede-data-pipeline/airflow-logs/2025-06-11/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=3.log (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.532088Z","level":"info","event":"📋 2025-06-11 15:25:01,531 - INFO - 2025-06-11 15:25:01 - ✅ Successfully uploaded: airflow-logs/2025-06-11/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=3.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.532625Z","level":"info","event":"📋 2025-06-11 15:25:01,532 - INFO - 2025-06-11 15:25:01 - 📤 Uploading /opt/airflow/logs/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=setup_connection/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-11/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=setup_connection/attempt=1.log (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.657981Z","level":"info","event":"📋 2025-06-11 15:25:01,657 - INFO - 2025-06-11 15:25:01 - ✅ Successfully uploaded: airflow-logs/2025-06-11/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=setup_connection/attempt=1.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.658253Z","level":"info","event":"📋 2025-06-11 15:25:01,657 - INFO - 2025-06-11 15:25:01 - 📋 Airflow logs export completed: 4 uploaded, 0 failed","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.658400Z","level":"info","event":"📋 2025-06-11 15:25:01,657 - INFO - 2025-06-11 15:25:01 - 🧹 Starting cleanup of exported data directories...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.658523Z","level":"info","event":"📋 2025-06-11 15:25:01,657 - INFO - 2025-06-11 15:25:01 - 🧹 Starting cleanup of 3 data directories","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.658682Z","level":"info","event":"📋 2025-06-11 15:25:01,657 - INFO - 2025-06-11 15:25:01 - ✅ All files from /opt/airflow/data/raw/2025/06/11 uploaded successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.658802Z","level":"info","event":"📋 2025-06-11 15:25:01,658 - INFO - 2025-06-11 15:25:01 - 🗑️ Deleting directory: /opt/airflow/data/raw/2025/06/11 (0.45 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.659979Z","level":"info","event":"📋 2025-06-11 15:25:01,659 - INFO - 2025-06-11 15:25:01 - ✅ Successfully deleted directory: /opt/airflow/data/raw/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.660088Z","level":"info","event":"📋 2025-06-11 15:25:01,659 - INFO - 2025-06-11 15:25:01 - ✅ All files from /opt/airflow/data/structured/2025/06/11 uploaded successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.660380Z","level":"info","event":"📋 2025-06-11 15:25:01,660 - INFO - 2025-06-11 15:25:01 - 🗑️ Deleting directory: /opt/airflow/data/structured/2025/06/11 (0.01 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.661134Z","level":"info","event":"📋 2025-06-11 15:25:01,661 - INFO - 2025-06-11 15:25:01 - ✅ Successfully deleted directory: /opt/airflow/data/structured/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.661267Z","level":"info","event":"📋 2025-06-11 15:25:01,661 - INFO - 2025-06-11 15:25:01 - ✅ All files from /opt/airflow/data/processed/2025/06/11 uploaded successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.661555Z","level":"info","event":"📋 2025-06-11 15:25:01,661 - INFO - 2025-06-11 15:25:01 - 🗑️ Deleting directory: /opt/airflow/data/processed/2025/06/11 (0.01 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.662225Z","level":"info","event":"📋 2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 - ✅ Successfully deleted directory: /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.664844Z","level":"info","event":"📋 2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 - 🧹 Cleanup completed: 3/3 directories cleaned","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.664975Z","level":"info","event":"📋 2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 - ✅ Export completed:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.665228Z","level":"info","event":"📋 2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 -   - Data directories: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.665381Z","level":"info","event":"📋 2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 -   - Data files uploaded: 7/7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.665603Z","level":"info","event":"📋 2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 -   - Airflow logs uploaded: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.665876Z","level":"info","event":"📋 2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 -   - Total files uploaded: 11/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.665985Z","level":"info","event":"📋 2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 -   - Total size: 0.48 MB","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.666113Z","level":"info","event":"📋 2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 -   - Bucket: gs://simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.666327Z","level":"info","event":"📋 2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 -   - Directories cleaned: 3/3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.666464Z","level":"info","event":"📋 2025-06-11 15:25:01,666 - INFO - 2025-06-11 15:25:01 - ✅ Export statistics saved: /opt/airflow/data/processed/2025/06/11/gcs_export_stats_20250611.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.666648Z","level":"info","event":"📋 2025-06-11 15:25:01,666 - INFO - 2025-06-11 15:25:01 - ✅ GCS export completed successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.667874Z","level":"info","event":"📋 2025-06-11 15:25:01,666 - INFO - 2025-06-11 15:25:01 - 📊 Summary: 11 files uploaded (4 logs), 0.48 MB","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.668872Z","level":"info","event":"📋 2025-06-11 15:25:01,666 - INFO - 2025-06-11 15:25:01 - 🧹 Cleanup: 3 directories cleaned","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.741842Z","level":"info","event":"✅ GCS export completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.742509Z","level":"info","event":"📊 Successfully uploaded 11 files to GCS","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.742603Z","level":"info","event":"📊 Total size uploaded: 0.01 MB","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.742701Z","level":"info","event":"☁️ GCS bucket: gs://simprede-data-pipeline/data/raw/2025/06/11/google_news_articles_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:25:01.742856","level":"info","event":"Done. Returned value was: 2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - Starting export_to_gcs_airflow\n2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - Parameters: date=2025-06-11\n2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - Paths: base_data_dir=/opt/airflow/data, output_dir=/opt/airflow/data/processed/2025/06/11\n2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - GCS: project_id=None, bucket=None\n2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - Airflow logs: include=True, dir=/opt/airflow/logs\n2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - Cleanup: enabled=True, partial_success=False, dry_run=False\n2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - 🚀 Starting GCS export for date: 2025-06-11\n2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - 📁 Base data directory: /opt/airflow/data\n2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - 📋 Include Airflow logs: True\n2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - 🧹 Cleanup after export: True\n2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - 🧹 Cleanup on partial success: False\n2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - 🧹 Dry run cleanup: False\n2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 - 🔧 GCS Configuration:\n2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 -   - Project ID: simprede-461309\n2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 -   - Bucket: simprede-data-pipeline\n2025-06-11 15:24:59,716 - INFO - 2025-06-11 15:24:59 -   - Credentials: /opt/airflow/config/gcs-credentials.json\n2025-06-11 15:24:59,758 - INFO - 2025-06-11 15:24:59 - ✅ Initialized GCS client with service account: /opt/airflow/config/gcs-credentials.json\n2025-06-11 15:25:00,173 - INFO - 2025-06-11 15:25:00 - ✅ Bucket 'simprede-data-pipeline' already exists\n2025-06-11 15:25:00,177 - INFO - 2025-06-11 15:25:00 - 📁 Found data directory: /opt/airflow/data/raw/2025/06/11\n2025-06-11 15:25:00,178 - INFO - 2025-06-11 15:25:00 - 📁 Found data directory: /opt/airflow/data/structured/2025/06/11\n2025-06-11 15:25:00,178 - INFO - 2025-06-11 15:25:00 - 📁 Found data directory: /opt/airflow/data/processed/2025/06/11\n2025-06-11 15:25:00,178 - INFO - 2025-06-11 15:25:00 - 📤 Exporting data directory: /opt/airflow/data/raw/2025/06/11\n2025-06-11 15:25:00,178 - INFO - 2025-06-11 15:25:00 - 📁 Scanning directory: /opt/airflow/data/raw/2025/06/11\n2025-06-11 15:25:00,179 - INFO - 2025-06-11 15:25:00 - 📤 Uploading /opt/airflow/data/raw/2025/06/11/google_news_articles_20250611.csv → gs://simprede-data-pipeline/data/raw/2025/06/11/google_news_articles_20250611.csv (0.01 MB)\n2025-06-11 15:25:00,337 - INFO - 2025-06-11 15:25:00 - ✅ Successfully uploaded: data/raw/2025/06/11/google_news_articles_20250611.csv\n2025-06-11 15:25:00,338 - INFO - 2025-06-11 15:25:00 - 📤 Uploading /opt/airflow/data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv → gs://simprede-data-pipeline/data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv (0.01 MB)\n2025-06-11 15:25:00,456 - INFO - 2025-06-11 15:25:00 - ✅ Successfully uploaded: data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n2025-06-11 15:25:00,458 - INFO - 2025-06-11 15:25:00 - 📤 Uploading /opt/airflow/data/raw/2025/06/11/intermediate_google_news_20250611.csv → gs://simprede-data-pipeline/data/raw/2025/06/11/intermediate_google_news_20250611.csv (0.44 MB)\n2025-06-11 15:25:00,693 - INFO - 2025-06-11 15:25:00 - ✅ Successfully uploaded: data/raw/2025/06/11/intermediate_google_news_20250611.csv\n2025-06-11 15:25:00,694 - INFO - 2025-06-11 15:25:00 - 📤 Exporting data directory: /opt/airflow/data/structured/2025/06/11\n2025-06-11 15:25:00,694 - INFO - 2025-06-11 15:25:00 - 📁 Scanning directory: /opt/airflow/data/structured/2025/06/11\n2025-06-11 15:25:00,695 - INFO - 2025-06-11 15:25:00 - 📤 Uploading /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv → gs://simprede-data-pipeline/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv (0.01 MB)\n2025-06-11 15:25:00,810 - INFO - 2025-06-11 15:25:00 - ✅ Successfully uploaded: data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n2025-06-11 15:25:00,812 - INFO - 2025-06-11 15:25:00 - 📤 Uploading /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json → gs://simprede-data-pipeline/data/structured/2025/06/11/processing_stats_20250611.json (0.00 MB)\n2025-06-11 15:25:00,920 - INFO - 2025-06-11 15:25:00 - ✅ Successfully uploaded: data/structured/2025/06/11/processing_stats_20250611.json\n2025-06-11 15:25:00,921 - INFO - 2025-06-11 15:25:00 - 📤 Exporting data directory: /opt/airflow/data/processed/2025/06/11\n2025-06-11 15:25:00,921 - INFO - 2025-06-11 15:25:00 - 📁 Scanning directory: /opt/airflow/data/processed/2025/06/11\n2025-06-11 15:25:00,923 - INFO - 2025-06-11 15:25:00 - 📤 Uploading /opt/airflow/data/processed/2025/06/11/export_stats_20250611.json → gs://simprede-data-pipeline/data/processed/2025/06/11/export_stats_20250611.json (0.00 MB)\n2025-06-11 15:25:01,054 - INFO - 2025-06-11 15:25:01 - ✅ Successfully uploaded: data/processed/2025/06/11/export_stats_20250611.json\n2025-06-11 15:25:01,056 - INFO - 2025-06-11 15:25:01 - 📤 Uploading /opt/airflow/data/processed/2025/06/11/export_backup_20250611.csv → gs://simprede-data-pipeline/data/processed/2025/06/11/export_backup_20250611.csv (0.01 MB)\n2025-06-11 15:25:01,177 - INFO - 2025-06-11 15:25:01 - ✅ Successfully uploaded: data/processed/2025/06/11/export_backup_20250611.csv\n2025-06-11 15:25:01,177 - INFO - 2025-06-11 15:25:01 - 📋 Starting Airflow logs export...\n2025-06-11 15:25:01,177 - INFO - 2025-06-11 15:25:01 - 📋 Starting Airflow logs export for 2025-06-11\n2025-06-11 15:25:01,190 - INFO - 2025-06-11 15:25:01 - 📋 Found 1 Airflow log paths for 2025-06-11\n2025-06-11 15:25:01,190 - INFO - 2025-06-11 15:25:01 -   📄 /opt/airflow/logs/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00\n2025-06-11 15:25:01,190 - INFO - 2025-06-11 15:25:01 - 📁 Scanning directory: /opt/airflow/logs/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00\n2025-06-11 15:25:01,191 - INFO - 2025-06-11 15:25:01 - 📤 Uploading /opt/airflow/logs/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-11/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=1.log (0.01 MB)\n2025-06-11 15:25:01,304 - INFO - 2025-06-11 15:25:01 - ✅ Successfully uploaded: airflow-logs/2025-06-11/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=1.log\n2025-06-11 15:25:01,305 - INFO - 2025-06-11 15:25:01 - 📤 Uploading /opt/airflow/logs/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=2.log → gs://simprede-data-pipeline/airflow-logs/2025-06-11/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=2.log (0.01 MB)\n2025-06-11 15:25:01,423 - INFO - 2025-06-11 15:25:01 - ✅ Successfully uploaded: airflow-logs/2025-06-11/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=2.log\n2025-06-11 15:25:01,423 - INFO - 2025-06-11 15:25:01 - 📤 Uploading /opt/airflow/logs/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=3.log → gs://simprede-data-pipeline/airflow-logs/2025-06-11/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=3.log (0.00 MB)\n2025-06-11 15:25:01,531 - INFO - 2025-06-11 15:25:01 - ✅ Successfully uploaded: airflow-logs/2025-06-11/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=check_staging_table/attempt=3.log\n2025-06-11 15:25:01,532 - INFO - 2025-06-11 15:25:01 - 📤 Uploading /opt/airflow/logs/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=setup_connection/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-11/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=setup_connection/attempt=1.log (0.00 MB)\n2025-06-11 15:25:01,657 - INFO - 2025-06-11 15:25:01 - ✅ Successfully uploaded: airflow-logs/2025-06-11/dag_id=daily_eventos_processing/run_id=scheduled__2025-06-11T00:00:00+01:00/task_id=setup_connection/attempt=1.log\n2025-06-11 15:25:01,657 - INFO - 2025-06-11 15:25:01 - 📋 Airflow logs export completed: 4 uploaded, 0 failed\n2025-06-11 15:25:01,657 - INFO - 2025-06-11 15:25:01 - 🧹 Starting cleanup of exported data directories...\n2025-06-11 15:25:01,657 - INFO - 2025-06-11 15:25:01 - 🧹 Starting cleanup of 3 data directories\n2025-06-11 15:25:01,657 - INFO - 2025-06-11 15:25:01 - ✅ All files from /opt/airflow/data/raw/2025/06/11 uploaded successfully\n2025-06-11 15:25:01,658 - INFO - 2025-06-11 15:25:01 - 🗑️ Deleting directory: /opt/airflow/data/raw/2025/06/11 (0.45 MB)\n2025-06-11 15:25:01,659 - INFO - 2025-06-11 15:25:01 - ✅ Successfully deleted directory: /opt/airflow/data/raw/2025/06/11\n2025-06-11 15:25:01,659 - INFO - 2025-06-11 15:25:01 - ✅ All files from /opt/airflow/data/structured/2025/06/11 uploaded successfully\n2025-06-11 15:25:01,660 - INFO - 2025-06-11 15:25:01 - 🗑️ Deleting directory: /opt/airflow/data/structured/2025/06/11 (0.01 MB)\n2025-06-11 15:25:01,661 - INFO - 2025-06-11 15:25:01 - ✅ Successfully deleted directory: /opt/airflow/data/structured/2025/06/11\n2025-06-11 15:25:01,661 - INFO - 2025-06-11 15:25:01 - ✅ All files from /opt/airflow/data/processed/2025/06/11 uploaded successfully\n2025-06-11 15:25:01,661 - INFO - 2025-06-11 15:25:01 - 🗑️ Deleting directory: /opt/airflow/data/processed/2025/06/11 (0.01 MB)\n2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 - ✅ Successfully deleted directory: /opt/airflow/data/processed/2025/06/11\n2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 - 🧹 Cleanup completed: 3/3 directories cleaned\n2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 - ✅ Export completed:\n2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 -   - Data directories: 3\n2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 -   - Data files uploaded: 7/7\n2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 -   - Airflow logs uploaded: 4\n2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 -   - Total files uploaded: 11/11\n2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 -   - Total size: 0.48 MB\n2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 -   - Bucket: gs://simprede-data-pipeline\n2025-06-11 15:25:01,662 - INFO - 2025-06-11 15:25:01 -   - Directories cleaned: 3/3\n2025-06-11 15:25:01,666 - INFO - 2025-06-11 15:25:01 - ✅ Export statistics saved: /opt/airflow/data/processed/2025/06/11/gcs_export_stats_20250611.json\n2025-06-11 15:25:01,666 - INFO - 2025-06-11 15:25:01 - ✅ GCS export completed successfully\n2025-06-11 15:25:01,666 - INFO - 2025-06-11 15:25:01 - 📊 Summary: 11 files uploaded (4 logs), 0.48 MB\n2025-06-11 15:25:01,666 - INFO - 2025-06-11 15:25:01 - 🧹 Cleanup: 3 directories cleaned\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
