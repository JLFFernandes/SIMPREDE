{"timestamp":"2025-06-11T14:24:28.260007","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-11T14:24:28.260449","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-11T14:24:29.374260Z","level":"info","event":"🔄 Starting export_to_gcs task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.375242Z","level":"info","event":"📁 Using paths from export_supabase task: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.378080Z","level":"info","event":"📅 Using provided execution date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.379087Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/11', '/opt/airflow/data/structured/2025/06/11', '/opt/airflow/data/processed/2025/06/11']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.379481Z","level":"info","event":"📅 GCS Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.379578Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.379896Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.380016Z","level":"info","event":"  - Target date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.380085Z","level":"info","event":"  - Base data directory: /opt/airflow/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.380166Z","level":"info","event":"  - GCS Project ID: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.380234Z","level":"info","event":"  - GCS Bucket: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.380307Z","level":"info","event":"🔄 Running GCS export command: python /opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py --date 2025-06-11 --base_data_dir /opt/airflow/data --output_dir /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.380388Z","level":"info","event":"⏰ Waiting for GCS export completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.909825Z","level":"info","event":"📋 2025-06-11 15:24:29,909 - INFO - 2025-06-11 15:24:29 - Starting export_to_gcs_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.910265Z","level":"info","event":"📋 2025-06-11 15:24:29,909 - INFO - 2025-06-11 15:24:29 - Parameters: date=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.910403Z","level":"info","event":"📋 2025-06-11 15:24:29,909 - INFO - 2025-06-11 15:24:29 - Paths: base_data_dir=/opt/airflow/data, output_dir=/opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.910800Z","level":"info","event":"📋 2025-06-11 15:24:29,909 - INFO - 2025-06-11 15:24:29 - GCS: project_id=None, bucket=None","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.910861Z","level":"info","event":"📋 2025-06-11 15:24:29,910 - INFO - 2025-06-11 15:24:29 - Airflow logs: include=True, dir=/opt/airflow/logs","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.910912Z","level":"info","event":"📋 2025-06-11 15:24:29,910 - INFO - 2025-06-11 15:24:29 - Cleanup: enabled=True, partial_success=False, dry_run=False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.910963Z","level":"info","event":"📋 2025-06-11 15:24:29,910 - INFO - 2025-06-11 15:24:29 - 🚀 Starting GCS export for date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.911012Z","level":"info","event":"📋 2025-06-11 15:24:29,910 - INFO - 2025-06-11 15:24:29 - 📁 Base data directory: /opt/airflow/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.911108Z","level":"info","event":"📋 2025-06-11 15:24:29,910 - INFO - 2025-06-11 15:24:29 - 📋 Include Airflow logs: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.911158Z","level":"info","event":"📋 2025-06-11 15:24:29,910 - INFO - 2025-06-11 15:24:29 - 🧹 Cleanup after export: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.911220Z","level":"info","event":"📋 2025-06-11 15:24:29,910 - INFO - 2025-06-11 15:24:29 - 🧹 Cleanup on partial success: False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.911267Z","level":"info","event":"📋 2025-06-11 15:24:29,910 - INFO - 2025-06-11 15:24:29 - 🧹 Dry run cleanup: False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.911346Z","level":"info","event":"📋 2025-06-11 15:24:29,910 - INFO - 2025-06-11 15:24:29 - 🔧 GCS Configuration:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.911614Z","level":"info","event":"📋 2025-06-11 15:24:29,910 - INFO - 2025-06-11 15:24:29 -   - Project ID: simprede-461309","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.911732Z","level":"info","event":"📋 2025-06-11 15:24:29,910 - INFO - 2025-06-11 15:24:29 -   - Bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.911797Z","level":"info","event":"📋 2025-06-11 15:24:29,910 - INFO - 2025-06-11 15:24:29 -   - Credentials: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.911910Z","level":"info","event":"📋 2025-06-11 15:24:29,910 - WARNING - 2025-06-11 15:24:29 - ⚠️ Application default credentials failed: File /opt/airflow/config/gcs-credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.912054Z","level":"info","event":"📋 2025-06-11 15:24:29,911 - ERROR - 2025-06-11 15:24:29 - ❌ All authentication methods failed:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.912116Z","level":"info","event":"📋 2025-06-11 15:24:29,911 - ERROR - 2025-06-11 15:24:29 -    - Service account: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.913038Z","level":"info","event":"📋 2025-06-11 15:24:29,911 - ERROR - 2025-06-11 15:24:29 -    - Default credentials: File /opt/airflow/config/gcs-credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.913233Z","level":"info","event":"📋 2025-06-11 15:24:29,911 - ERROR - 2025-06-11 15:24:29 -    - Auto-detection: File /opt/airflow/config/gcs-credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.914371Z","level":"info","event":"📋 2025-06-11 15:24:29,911 - ERROR - 2025-06-11 15:24:29 - ❌ Failed to initialize GCS client: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.915180Z","level":"info","event":"📋 2025-06-11 15:24:29,911 - ERROR - 2025-06-11 15:24:29 - ❌ Failed to initialize GCS exporter: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.916188Z","level":"info","event":"📋 2025-06-11 15:24:29,911 - ERROR - 2025-06-11 15:24:29 - ❌ GCS export failed: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.917182Z","level":"info","event":"📋 2025-06-11 15:24:29,912 - ERROR - 2025-06-11 15:24:29 - ❌ Full traceback: Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.917249Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 84, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.917298Z","level":"info","event":"📋     self.client = storage.Client(project=project_id)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.917380Z","level":"info","event":"📋                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.917428Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/storage/client.py\", line 173, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.917470Z","level":"info","event":"📋     super(Client, self).__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.917515Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 339, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.917563Z","level":"info","event":"📋     Client.__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.917613Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 196, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.917661Z","level":"info","event":"📋     credentials, _ = google.auth.default(scopes=scopes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.917706Z","level":"info","event":"📋                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.917751Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 651, in default","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.920159Z","level":"info","event":"📋     credentials, project_id = checker()","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.920225Z","level":"info","event":"📋                               ^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.920271Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 644, in <lambda>","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.920317Z","level":"info","event":"📋     lambda: _get_explicit_environ_credentials(quota_project_id=quota_project_id),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.920365Z","level":"info","event":"📋             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.920412Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 293, in _get_explicit_environ_credentials","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.920459Z","level":"info","event":"📋     credentials, project_id = load_credentials_from_file(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.920505Z","level":"info","event":"📋                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.920550Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 125, in load_credentials_from_file","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.920594Z","level":"info","event":"📋     raise exceptions.DefaultCredentialsError(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.920639Z","level":"info","event":"📋 google.auth.exceptions.DefaultCredentialsError: File /opt/airflow/config/gcs-credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.920686Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.920731Z","level":"info","event":"📋 During handling of the above exception, another exception occurred:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.920778Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.920824Z","level":"info","event":"📋 Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.920907Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 91, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.920952Z","level":"info","event":"📋     self.client = storage.Client()","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.921000Z","level":"info","event":"📋                   ^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.921046Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/storage/client.py\", line 173, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.921092Z","level":"info","event":"📋     super(Client, self).__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.922186Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 339, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923146Z","level":"info","event":"📋     Client.__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923201Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 196, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923247Z","level":"info","event":"📋     credentials, _ = google.auth.default(scopes=scopes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923293Z","level":"info","event":"📋                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923340Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 651, in default","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923388Z","level":"info","event":"📋     credentials, project_id = checker()","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923434Z","level":"info","event":"📋                               ^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923483Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 644, in <lambda>","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923528Z","level":"info","event":"📋     lambda: _get_explicit_environ_credentials(quota_project_id=quota_project_id),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923577Z","level":"info","event":"📋             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923625Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 293, in _get_explicit_environ_credentials","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923667Z","level":"info","event":"📋     credentials, project_id = load_credentials_from_file(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923712Z","level":"info","event":"📋                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923758Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 125, in load_credentials_from_file","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923804Z","level":"info","event":"📋     raise exceptions.DefaultCredentialsError(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923852Z","level":"info","event":"📋 google.auth.exceptions.DefaultCredentialsError: File /opt/airflow/config/gcs-credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923932Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.923979Z","level":"info","event":"📋 During handling of the above exception, another exception occurred:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.924023Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.924067Z","level":"info","event":"📋 Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.924112Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 762, in main","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.924155Z","level":"info","event":"📋     result = export_to_gcs(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.924224Z","level":"info","event":"📋              ^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.924267Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 588, in export_to_gcs","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.924312Z","level":"info","event":"📋     exporter = GCSExporter(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.924356Z","level":"info","event":"📋                ^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.924400Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 99, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.924445Z","level":"info","event":"📋     raise Exception(\"No valid GCP authentication method found\")","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.924490Z","level":"info","event":"📋 Exception: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.924545Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.971842Z","level":"info","event":"❌ GCS export failed with return code 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.972393Z","level":"info","event":"❌ Unexpected error in GCS export task: GCS export failed with return code 1:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:24:29.971906","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"Exception","exc_value":"GCS export failed with return code 1: ","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":838,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1130,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":212,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":235,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/google_scraper_dag.py","lineno":1079,"name":"export_to_gcs_task"}]}]}
