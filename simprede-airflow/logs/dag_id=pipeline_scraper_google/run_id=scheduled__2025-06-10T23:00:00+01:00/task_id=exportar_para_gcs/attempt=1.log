{"timestamp":"2025-06-11T14:17:48.236047","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-11T14:17:48.236379","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-11T14:17:48.262565Z","level":"info","event":"🔄 Starting export_to_gcs task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.262971Z","level":"info","event":"📁 Using paths from export_supabase task: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.265301Z","level":"info","event":"📅 Using provided execution date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.265650Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/11', '/opt/airflow/data/structured/2025/06/11', '/opt/airflow/data/processed/2025/06/11']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.266105Z","level":"info","event":"📅 GCS Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.266175Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.266400Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.266486Z","level":"info","event":"  - Target date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.266563Z","level":"info","event":"  - Base data directory: /opt/airflow/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.266651Z","level":"info","event":"  - GCS Project ID: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.266716Z","level":"info","event":"  - GCS Bucket: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.266781Z","level":"info","event":"🔄 Running GCS export command: python /opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py --date 2025-06-11 --base_data_dir /opt/airflow/data --output_dir /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.266845Z","level":"info","event":"⏰ Waiting for GCS export completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.946223Z","level":"info","event":"📋 2025-06-11 15:17:48,946 - INFO - 2025-06-11 15:17:48 - Starting export_to_gcs_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.946437Z","level":"info","event":"📋 2025-06-11 15:17:48,946 - INFO - 2025-06-11 15:17:48 - Parameters: date=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.946572Z","level":"info","event":"📋 2025-06-11 15:17:48,946 - INFO - 2025-06-11 15:17:48 - Paths: base_data_dir=/opt/airflow/data, output_dir=/opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.946951Z","level":"info","event":"📋 2025-06-11 15:17:48,946 - INFO - 2025-06-11 15:17:48 - GCS: project_id=None, bucket=None","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.947035Z","level":"info","event":"📋 2025-06-11 15:17:48,946 - INFO - 2025-06-11 15:17:48 - Airflow logs: include=True, dir=/opt/airflow/logs","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.947080Z","level":"info","event":"📋 2025-06-11 15:17:48,946 - INFO - 2025-06-11 15:17:48 - Cleanup: enabled=True, partial_success=False, dry_run=False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.947125Z","level":"info","event":"📋 2025-06-11 15:17:48,946 - INFO - 2025-06-11 15:17:48 - 🚀 Starting GCS export for date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.947164Z","level":"info","event":"📋 2025-06-11 15:17:48,946 - INFO - 2025-06-11 15:17:48 - 📁 Base data directory: /opt/airflow/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.947235Z","level":"info","event":"📋 2025-06-11 15:17:48,946 - INFO - 2025-06-11 15:17:48 - 📋 Include Airflow logs: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.947272Z","level":"info","event":"📋 2025-06-11 15:17:48,946 - INFO - 2025-06-11 15:17:48 - 🧹 Cleanup after export: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.947312Z","level":"info","event":"📋 2025-06-11 15:17:48,946 - INFO - 2025-06-11 15:17:48 - 🧹 Cleanup on partial success: False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.947350Z","level":"info","event":"📋 2025-06-11 15:17:48,946 - INFO - 2025-06-11 15:17:48 - 🧹 Dry run cleanup: False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.947486Z","level":"info","event":"📋 2025-06-11 15:17:48,946 - INFO - 2025-06-11 15:17:48 - 🔧 GCS Configuration:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.947524Z","level":"info","event":"📋 2025-06-11 15:17:48,946 - INFO - 2025-06-11 15:17:48 -   - Project ID: simprede-461309","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.947559Z","level":"info","event":"📋 2025-06-11 15:17:48,946 - INFO - 2025-06-11 15:17:48 -   - Bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.947595Z","level":"info","event":"📋 2025-06-11 15:17:48,946 - INFO - 2025-06-11 15:17:48 -   - Credentials: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.947859Z","level":"info","event":"📋 2025-06-11 15:17:48,947 - WARNING - 2025-06-11 15:17:48 - ⚠️ Application default credentials failed: File /opt/airflow/config/gcs-credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.947964Z","level":"info","event":"📋 2025-06-11 15:17:48,947 - ERROR - 2025-06-11 15:17:48 - ❌ All authentication methods failed:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.948017Z","level":"info","event":"📋 2025-06-11 15:17:48,947 - ERROR - 2025-06-11 15:17:48 -    - Service account: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.948098Z","level":"info","event":"📋 2025-06-11 15:17:48,947 - ERROR - 2025-06-11 15:17:48 -    - Default credentials: File /opt/airflow/config/gcs-credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.948241Z","level":"info","event":"📋 2025-06-11 15:17:48,947 - ERROR - 2025-06-11 15:17:48 -    - Auto-detection: File /opt/airflow/config/gcs-credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.948279Z","level":"info","event":"📋 2025-06-11 15:17:48,947 - ERROR - 2025-06-11 15:17:48 - ❌ Failed to initialize GCS client: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.948314Z","level":"info","event":"📋 2025-06-11 15:17:48,947 - ERROR - 2025-06-11 15:17:48 - ❌ Failed to initialize GCS exporter: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.948348Z","level":"info","event":"📋 2025-06-11 15:17:48,947 - ERROR - 2025-06-11 15:17:48 - ❌ GCS export failed: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.950976Z","level":"info","event":"📋 2025-06-11 15:17:48,950 - ERROR - 2025-06-11 15:17:48 - ❌ Full traceback: Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.952168Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 84, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.954933Z","level":"info","event":"📋     self.client = storage.Client(project=project_id)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955061Z","level":"info","event":"📋                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955107Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/storage/client.py\", line 173, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955146Z","level":"info","event":"📋     super(Client, self).__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955182Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 339, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955216Z","level":"info","event":"📋     Client.__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955260Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 196, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955297Z","level":"info","event":"📋     credentials, _ = google.auth.default(scopes=scopes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955331Z","level":"info","event":"📋                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955373Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 651, in default","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955409Z","level":"info","event":"📋     credentials, project_id = checker()","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955442Z","level":"info","event":"📋                               ^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955476Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 644, in <lambda>","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955513Z","level":"info","event":"📋     lambda: _get_explicit_environ_credentials(quota_project_id=quota_project_id),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955548Z","level":"info","event":"📋             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955583Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 293, in _get_explicit_environ_credentials","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955617Z","level":"info","event":"📋     credentials, project_id = load_credentials_from_file(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955650Z","level":"info","event":"📋                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955684Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 125, in load_credentials_from_file","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955716Z","level":"info","event":"📋     raise exceptions.DefaultCredentialsError(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.955751Z","level":"info","event":"📋 google.auth.exceptions.DefaultCredentialsError: File /opt/airflow/config/gcs-credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956169Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956240Z","level":"info","event":"📋 During handling of the above exception, another exception occurred:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956294Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956334Z","level":"info","event":"📋 Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956397Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 91, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956457Z","level":"info","event":"📋     self.client = storage.Client()","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956496Z","level":"info","event":"📋                   ^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956532Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/storage/client.py\", line 173, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956568Z","level":"info","event":"📋     super(Client, self).__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956602Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 339, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956636Z","level":"info","event":"📋     Client.__init__(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956672Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/cloud/client/__init__.py\", line 196, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956707Z","level":"info","event":"📋     credentials, _ = google.auth.default(scopes=scopes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956742Z","level":"info","event":"📋                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956777Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 651, in default","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956832Z","level":"info","event":"📋     credentials, project_id = checker()","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956868Z","level":"info","event":"📋                               ^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956903Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 644, in <lambda>","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956946Z","level":"info","event":"📋     lambda: _get_explicit_environ_credentials(quota_project_id=quota_project_id),","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.956981Z","level":"info","event":"📋             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957014Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 293, in _get_explicit_environ_credentials","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957099Z","level":"info","event":"📋     credentials, project_id = load_credentials_from_file(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957134Z","level":"info","event":"📋                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957169Z","level":"info","event":"📋   File \"/home/airflow/.local/lib/python3.11/site-packages/google/auth/_default.py\", line 125, in load_credentials_from_file","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957207Z","level":"info","event":"📋     raise exceptions.DefaultCredentialsError(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957244Z","level":"info","event":"📋 google.auth.exceptions.DefaultCredentialsError: File /opt/airflow/config/gcs-credentials.json was not found.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957304Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957340Z","level":"info","event":"📋 During handling of the above exception, another exception occurred:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957375Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957412Z","level":"info","event":"📋 Traceback (most recent call last):","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957446Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 762, in main","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957480Z","level":"info","event":"📋     result = export_to_gcs(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957546Z","level":"info","event":"📋              ^^^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957586Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 588, in export_to_gcs","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957625Z","level":"info","event":"📋     exporter = GCSExporter(","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957662Z","level":"info","event":"📋                ^^^^^^^^^^^^","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957695Z","level":"info","event":"📋   File \"/opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py\", line 99, in __init__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957731Z","level":"info","event":"📋     raise Exception(\"No valid GCP authentication method found\")","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957765Z","level":"info","event":"📋 Exception: No valid GCP authentication method found","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:48.957803Z","level":"info","event":"📋","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:49.008797Z","level":"info","event":"❌ GCS export failed with return code 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:49.008927Z","level":"info","event":"❌ Unexpected error in GCS export task: GCS export failed with return code 1:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:49.008842","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"Exception","exc_value":"GCS export failed with return code 1: ","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":838,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1130,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":212,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":235,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.11/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/google_scraper_dag.py","lineno":1079,"name":"export_to_gcs_task"}]}]}
