{"timestamp":"2025-06-11T14:14:44.422197","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-11T14:14:44.422541","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-11T14:14:45.315213Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:45.315465Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:45.318102Z","level":"info","event":"📅 Using provided execution date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:45.318371Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/11', '/opt/airflow/data/structured/2025/06/11', '/opt/airflow/data/processed/2025/06/11']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:45.318487Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:45.318588Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:45.318645Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:45.318692Z","level":"info","event":"  - Target date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:45.318757Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:45.318837Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/raw/2025/06/11/google_news_articles_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:45.318925Z","level":"info","event":"✅ Found input file: /opt/airflow/data/raw/2025/06/11/google_news_articles_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:45.319019Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:45.319116Z","level":"info","event":"  - relevant_articles: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:45.319201Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/data/structured/2025/06/11/artigos_irrelevantes_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:45.319266Z","level":"info","event":"  - processing_log: /opt/airflow/data/structured/2025/06/11/processing_log_20250611.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:45.319334Z","level":"info","event":"  - stats_json: /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:45.319397Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/data/raw/2025/06/11/google_news_articles_20250611.csv --output_dir /opt/airflow/data/structured/2025/06/11 --date_str 2025-06-11 --date 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:45.319502Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.652050Z","level":"info","event":"📋 [2025-06-11 15:14:46] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.652341Z","level":"info","event":"📋 2025-06-11 15:14:46,651 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.652435Z","level":"info","event":"📋 [2025-06-11 15:14:46] Parameters: dias=1, date=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.652626Z","level":"info","event":"📋 2025-06-11 15:14:46,652 - INFO - Parameters: dias=1, date=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.652713Z","level":"info","event":"📋 [2025-06-11 15:14:46] Paths: input_file=/opt/airflow/data/raw/2025/06/11/google_news_articles_20250611.csv, output_dir=/opt/airflow/data/structured/2025/06/11, date_str=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.652844Z","level":"info","event":"📋 2025-06-11 15:14:46,652 - INFO - Paths: input_file=/opt/airflow/data/raw/2025/06/11/google_news_articles_20250611.csv, output_dir=/opt/airflow/data/structured/2025/06/11, date_str=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.652895Z","level":"info","event":"📋 [2025-06-11 15:14:46] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.652992Z","level":"info","event":"📋 2025-06-11 15:14:46,652 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.653079Z","level":"info","event":"📋 [2025-06-11 15:14:46] 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.653581Z","level":"info","event":"📋 2025-06-11 15:14:46,652 - INFO - 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.653683Z","level":"info","event":"📋 [2025-06-11 15:14:46] 📁 Using provided input file: /opt/airflow/data/raw/2025/06/11/google_news_articles_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.653729Z","level":"info","event":"📋 2025-06-11 15:14:46,652 - INFO - 📁 Using provided input file: /opt/airflow/data/raw/2025/06/11/google_news_articles_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.653771Z","level":"info","event":"📋 [2025-06-11 15:14:46] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.653809Z","level":"info","event":"📋 2025-06-11 15:14:46,652 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.653852Z","level":"info","event":"📋 [2025-06-11 15:14:46] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.653895Z","level":"info","event":"📋 2025-06-11 15:14:46,652 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.653935Z","level":"info","event":"📋 [2025-06-11 15:14:46] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.653971Z","level":"info","event":"📋 2025-06-11 15:14:46,652 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.654007Z","level":"info","event":"📋 [2025-06-11 15:14:46] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.654044Z","level":"info","event":"📋 2025-06-11 15:14:46,652 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.654081Z","level":"info","event":"📋 [2025-06-11 15:14:46] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.654117Z","level":"info","event":"📋 2025-06-11 15:14:46,652 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.654153Z","level":"info","event":"📋 [2025-06-11 15:14:46] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.654227Z","level":"info","event":"📋 2025-06-11 15:14:46,652 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.654409Z","level":"info","event":"📋 [2025-06-11 15:14:46] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.654462Z","level":"info","event":"📋 2025-06-11 15:14:46,654 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.654498Z","level":"info","event":"📋 [2025-06-11 15:14:46] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.654541Z","level":"info","event":"📋 2025-06-11 15:14:46,654 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.654858Z","level":"info","event":"📋 [2025-06-11 15:14:46] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.654947Z","level":"info","event":"📋 2025-06-11 15:14:46,654 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.659095Z","level":"info","event":"📋 [2025-06-11 15:14:46] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.659195Z","level":"info","event":"📋 2025-06-11 15:14:46,658 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.659452Z","level":"info","event":"📋 [2025-06-11 15:14:46] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.659506Z","level":"info","event":"📋 2025-06-11 15:14:46,658 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.659544Z","level":"info","event":"📋 [2025-06-11 15:14:46] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.659581Z","level":"info","event":"📋 2025-06-11 15:14:46,658 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.659620Z","level":"info","event":"📋 [2025-06-11 15:14:46] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.659659Z","level":"info","event":"📋 2025-06-11 15:14:46,658 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.659697Z","level":"info","event":"📋 [2025-06-11 15:14:46]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.659799Z","level":"info","event":"📋 2025-06-11 15:14:46,658 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.660641Z","level":"info","event":"📋 [2025-06-11 15:14:46]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.660983Z","level":"info","event":"📋 2025-06-11 15:14:46,658 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.661328Z","level":"info","event":"📋 [2025-06-11 15:14:46]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.661385Z","level":"info","event":"📋 2025-06-11 15:14:46,658 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.661432Z","level":"info","event":"📋 [2025-06-11 15:14:46]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.661475Z","level":"info","event":"📋 2025-06-11 15:14:46,658 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.661544Z","level":"info","event":"📋 [2025-06-11 15:14:46]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.661583Z","level":"info","event":"📋 2025-06-11 15:14:46,658 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.661642Z","level":"info","event":"📋 [2025-06-11 15:14:46] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.661680Z","level":"info","event":"📋 2025-06-11 15:14:46,658 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.663648Z","level":"info","event":"📋 [2025-06-11 15:14:46] ✅ Ficheiro CSV válido com 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.663989Z","level":"info","event":"📋 2025-06-11 15:14:46,663 - INFO - ✅ Ficheiro CSV válido com 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.664105Z","level":"info","event":"📋 [2025-06-11 15:14:46] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.664729Z","level":"info","event":"📋 2025-06-11 15:14:46,663 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.664800Z","level":"info","event":"📋 [2025-06-11 15:14:46] 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.664845Z","level":"info","event":"📋 2025-06-11 15:14:46,663 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.664885Z","level":"info","event":"📋 [2025-06-11 15:14:46] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.664925Z","level":"info","event":"📋 2025-06-11 15:14:46,663 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.664961Z","level":"info","event":"📋 [2025-06-11 15:14:46] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.664999Z","level":"info","event":"📋 2025-06-11 15:14:46,663 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.665035Z","level":"info","event":"📋 [2025-06-11 15:14:46] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.665071Z","level":"info","event":"📋 2025-06-11 15:14:46,663 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.665108Z","level":"info","event":"📋 [2025-06-11 15:14:46]   Total de Artigos para Processar: 12","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.665147Z","level":"info","event":"📋 2025-06-11 15:14:46,663 - INFO -   Total de Artigos para Processar: 12","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.665197Z","level":"info","event":"📋 [2025-06-11 15:14:46]   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/11/google_news_articles_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.665241Z","level":"info","event":"📋 2025-06-11 15:14:46,663 - INFO -   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/11/google_news_articles_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.665278Z","level":"info","event":"📋 [2025-06-11 15:14:46]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.665316Z","level":"info","event":"📋 2025-06-11 15:14:46,663 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.665390Z","level":"info","event":"📋 [2025-06-11 15:14:46]   Diretoria de Saída: /opt/airflow/data/structured/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.665431Z","level":"info","event":"📋 2025-06-11 15:14:46,663 - INFO -   Diretoria de Saída: /opt/airflow/data/structured/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.665467Z","level":"info","event":"📋 [2025-06-11 15:14:46]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.665503Z","level":"info","event":"📋 2025-06-11 15:14:46,663 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.665539Z","level":"info","event":"📋 [2025-06-11 15:14:46] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.666110Z","level":"info","event":"📋 2025-06-11 15:14:46,663 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.666188Z","level":"info","event":"📋 [2025-06-11 15:14:46] ⚠️ Último ID não encontrado em relevantes. A começar do início.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.666229Z","level":"info","event":"📋 2025-06-11 15:14:46,665 - WARNING - ⚠️ Último ID não encontrado em relevantes. A começar do início.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.666994Z","level":"info","event":"📋 [2025-06-11 15:14:46] 📦 A processar lote 1/1 (12 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:46.669640Z","level":"info","event":"📋 2025-06-11 15:14:46,666 - INFO - 📦 A processar lote 1/1 (12 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:49.188019Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:49.225870Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:49.786805Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:50.216431Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:50.221679Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:50.230849Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:50.314414Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:14:50.333068Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:02.877309Z","level":"info","event":"📋 [2025-06-11 15:15:02] 🔄 Processado: Presidente da Câmara de Viana do Alentejo sofre en...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:02.878263Z","level":"info","event":"📋 2025-06-11 15:15:02,867 - INFO - 🔄 Processado: Presidente da Câmara de Viana do Alentejo sofre en...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:10.977201Z","level":"info","event":"📋 [2025-06-11 15:15:10] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Norte do país atingido por tempestade de granizo. Veja as imagens - Notícias ao Minuto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:10.985700Z","level":"info","event":"📋 2025-06-11 15:15:10,944 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Norte do país atingido por tempestade de granizo. Veja as imagens - Notícias ao Minuto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:11.183745Z","level":"info","event":"📋 [2025-06-11 15:15:11] 🔄 Processado: Norte do país atingido por tempestade de granizo. ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:11.192268Z","level":"info","event":"📋 2025-06-11 15:15:11,178 - INFO - 🔄 Processado: Norte do país atingido por tempestade de granizo. ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:12.692547Z","level":"info","event":"📋 [2025-06-11 15:15:12] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Norte do país atingido por tempestade de granizo. Veja as imagens - Notícias ao Minuto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:12.693211Z","level":"info","event":"📋 2025-06-11 15:15:12,691 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Norte do país atingido por tempestade de granizo. Veja as imagens - Notícias ao Minuto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:12.714173Z","level":"info","event":"📋 [2025-06-11 15:15:12] 🔄 Processado: Norte do país atingido por tempestade de granizo. ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:12.715759Z","level":"info","event":"📋 2025-06-11 15:15:12,707 - INFO - 🔄 Processado: Norte do país atingido por tempestade de granizo. ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:16.515475Z","level":"info","event":"📋 [2025-06-11 15:15:16] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo nos próximos dias para os arquipélagos: Açores poderão contar com alguma instabilidade, mas de passagem rápida - Tempo.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:16.942338Z","level":"info","event":"📋 2025-06-11 15:15:16,515 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo nos próximos dias para os arquipélagos: Açores poderão contar com alguma instabilidade, mas de passagem rápida - Tempo.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:16.943211Z","level":"info","event":"📋 [2025-06-11 15:15:16] 🔄 Processado: Tempo nos próximos dias para os arquipélagos: Açor...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:16.947060Z","level":"info","event":"📋 2025-06-11 15:15:16,609 - INFO - 🔄 Processado: Tempo nos próximos dias para os arquipélagos: Açor...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:17.408957Z","level":"info","event":"📋 [2025-06-11 15:15:17] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Quarta-feira com sol, chuva fraca e forte descida da temperatura - O Amarense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:17.410034Z","level":"info","event":"📋 2025-06-11 15:15:17,409 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Quarta-feira com sol, chuva fraca e forte descida da temperatura - O Amarense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:17.414921Z","level":"info","event":"📋 [2025-06-11 15:15:17] 🔄 Processado: Tempo. Quarta-feira com sol, chuva fraca e forte d...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:17.416313Z","level":"info","event":"📋 2025-06-11 15:15:17,416 - INFO - 🔄 Processado: Tempo. Quarta-feira com sol, chuva fraca e forte d...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:34.271195Z","level":"info","event":"📋 [2025-06-11 15:15:34] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Distritos de Évora e Portalegre sob aviso amarelo devido à chuva e trovoada - Rádio Campanário","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:34.284163Z","level":"info","event":"📋 2025-06-11 15:15:34,256 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Distritos de Évora e Portalegre sob aviso amarelo devido à chuva e trovoada - Rádio Campanário","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:34.299543Z","level":"info","event":"📋 [2025-06-11 15:15:34] 🔄 Processado: Distritos de Évora e Portalegre sob aviso amarelo ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:34.304962Z","level":"info","event":"📋 2025-06-11 15:15:34,260 - INFO - 🔄 Processado: Distritos de Évora e Portalegre sob aviso amarelo ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:41.073255Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:41.952237Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:42.408448Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:46.455944Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:48.593288Z","level":"info","event":"📋 [2025-06-11 15:15:48] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempestade a caminho de Coimbra: trovoada, granizo e até vento forte - Notícias de Coimbra","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:48.594927Z","level":"info","event":"📋 2025-06-11 15:15:48,593 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempestade a caminho de Coimbra: trovoada, granizo e até vento forte - Notícias de Coimbra","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:48.606577Z","level":"info","event":"📋 [2025-06-11 15:15:48] 🔄 Processado: Tempestade a caminho de Coimbra: trovoada, granizo...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:15:48.608180Z","level":"info","event":"📋 2025-06-11 15:15:48,605 - INFO - 🔄 Processado: Tempestade a caminho de Coimbra: trovoada, granizo...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:16:04.664725Z","level":"info","event":"📋 [2025-06-11 15:16:04] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Granizo e trovoada atingem o Norte de Portugal: tempestade surpreende população - rumores.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:16:04.665702Z","level":"info","event":"📋 2025-06-11 15:16:04,659 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Granizo e trovoada atingem o Norte de Portugal: tempestade surpreende população - rumores.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:16:04.668721Z","level":"info","event":"📋 [2025-06-11 15:16:04] 🔄 Processado: Granizo e trovoada atingem o Norte de Portugal: te...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:16:04.669157Z","level":"info","event":"📋 2025-06-11 15:16:04,668 - INFO - 🔄 Processado: Granizo e trovoada atingem o Norte de Portugal: te...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:16:13.845588Z","level":"info","event":"📋 [2025-06-11 15:16:13] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempestade a caminho de Coimbra: trovoada, granizo e até vento forte - Notícias de Coimbra","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:16:13.854490Z","level":"info","event":"📋 2025-06-11 15:16:13,840 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempestade a caminho de Coimbra: trovoada, granizo e até vento forte - Notícias de Coimbra","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:16:13.859203Z","level":"info","event":"📋 [2025-06-11 15:16:13] 🔄 Processado: Tempestade a caminho de Coimbra: trovoada, granizo...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:16:13.860681Z","level":"info","event":"📋 2025-06-11 15:16:13,843 - INFO - 🔄 Processado: Tempestade a caminho de Coimbra: trovoada, granizo...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:16:16.516372Z","level":"info","event":"📋 [2025-06-11 15:16:16] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Prepara-se que vem aí chuva, granizo e trovoada nas regiões Centro e Norte - CentroTV","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:16:16.519580Z","level":"info","event":"📋 2025-06-11 15:16:16,507 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Prepara-se que vem aí chuva, granizo e trovoada nas regiões Centro e Norte - CentroTV","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:16:16.519971Z","level":"info","event":"📋 [2025-06-11 15:16:16] 🔄 Processado: Prepara-se que vem aí chuva, granizo e trovoada na...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:16:16.520128Z","level":"info","event":"📋 2025-06-11 15:16:16,510 - INFO - 🔄 Processado: Prepara-se que vem aí chuva, granizo e trovoada na...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:16:18.158332Z","level":"info","event":"📋 [2025-06-11 15:16:18] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: \"Sentimos a emoção do nosso oceano. Até chorei de orgulho\": como foi o Dia de Portugal em Osaka - Expresso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:16:18.158849Z","level":"info","event":"📋 2025-06-11 15:16:18,158 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: \"Sentimos a emoção do nosso oceano. Até chorei de orgulho\": como foi o Dia de Portugal em Osaka - Expresso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:16:18.160156Z","level":"info","event":"📋 [2025-06-11 15:16:18] 🔄 Processado: \"Sentimos a emoção do nosso oceano. Até chorei de ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:16:18.160393Z","level":"info","event":"📋 2025-06-11 15:16:18,160 - INFO - 🔄 Processado: \"Sentimos a emoção do nosso oceano. Até chorei de ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.678552Z","level":"info","event":"⚠️ ❌ Erro ao resolver URL do Google News: Message:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.679457Z","level":"info","event":"⚠️","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.744398Z","level":"info","event":"📋 [2025-06-11 15:17:34] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMipgFBVV95cUxOdnpkbWJSNFdlVlBWN1lhNFVEcHBtYUFkQkxmaHktZXQwb1hHYXI1WFduVDBuZVRmVnp5ZmVnb3ZYR0lYNjNvcDNQNWd0dFVoTWs4NkhGb2xmMmhnd1hOQTQxOEpnRWx5U2RqS3VXaldrX1BIT0pLbTF0WmlFZjRmLXVPNFYxRE1JNnR2WGFjdVJleHlwOThYeW5kbUYyTndLS0E1XzN3?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.744651Z","level":"info","event":"📋 2025-06-11 15:17:34,744 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMipgFBVV95cUxOdnpkbWJSNFdlVlBWN1lhNFVEcHBtYUFkQkxmaHktZXQwb1hHYXI1WFduVDBuZVRmVnp5ZmVnb3ZYR0lYNjNvcDNQNWd0dFVoTWs4NkhGb2xmMmhnd1hOQTQxOEpnRWx5U2RqS3VXaldrX1BIT0pLbTF0WmlFZjRmLXVPNFYxRE1JNnR2WGFjdVJleHlwOThYeW5kbUYyTndLS0E1XzN3?oc=5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.745725Z","level":"info","event":"📋 📥 Novos artigos recebidos: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.746256Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.748329Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 16","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.748618Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.749345Z","level":"info","event":"📋 💾 Guardados 5 artigos no arquivo /opt/airflow/data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.749585Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.749673Z","level":"info","event":"📋 📥 Novos artigos recebidos: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.749951Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.750470Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 16","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.750601Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.751004Z","level":"info","event":"📋 💾 Guardados 5 artigos no arquivo /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.751177Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.751311Z","level":"info","event":"📋 [2025-06-11 15:17:34] ✅ Relevant articles saved: 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.751593Z","level":"info","event":"📋 2025-06-11 15:17:34,751 - INFO - ✅ Relevant articles saved: 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.751961Z","level":"info","event":"📋 [2025-06-11 15:17:34] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.752010Z","level":"info","event":"📋 2025-06-11 15:17:34,751 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.752050Z","level":"info","event":"📋 [2025-06-11 15:17:34] ✅ Lote 1 concluído: 5 artigos (total: 5)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:34.752088Z","level":"info","event":"📋 2025-06-11 15:17:34,751 - INFO - ✅ Lote 1 concluído: 5 artigos (total: 5)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.718245Z","level":"info","event":"📋 📥 Novos artigos recebidos: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.735500Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.737029Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 21","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.737134Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.737197Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.737267Z","level":"info","event":"📋 📥 Novos artigos recebidos: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.737332Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.737385Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 21","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.737434Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.737495Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.737545Z","level":"info","event":"📋 [2025-06-11 15:17:39] ✅ Relevant articles saved: 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.737593Z","level":"info","event":"📋 2025-06-11 15:17:39,722 - INFO - ✅ Relevant articles saved: 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.737669Z","level":"info","event":"📋 [2025-06-11 15:17:39] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.737778Z","level":"info","event":"📋 2025-06-11 15:17:39,723 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.737893Z","level":"info","event":"📋 [2025-06-11 15:17:39] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.737958Z","level":"info","event":"📋 2025-06-11 15:17:39,723 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.738010Z","level":"info","event":"📋 [2025-06-11 15:17:39] Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.738063Z","level":"info","event":"📋 2025-06-11 15:17:39,723 - INFO - Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.738115Z","level":"info","event":"📋 [2025-06-11 15:17:39] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.738164Z","level":"info","event":"📋 2025-06-11 15:17:39,723 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.738212Z","level":"info","event":"📋 [2025-06-11 15:17:39]   Total de Artigos Processados: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.738260Z","level":"info","event":"📋 2025-06-11 15:17:39,723 - INFO -   Total de Artigos Processados: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.738309Z","level":"info","event":"📋 [2025-06-11 15:17:39]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.738361Z","level":"info","event":"📋 2025-06-11 15:17:39,723 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.738411Z","level":"info","event":"📋 [2025-06-11 15:17:39]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.738546Z","level":"info","event":"📋 2025-06-11 15:17:39,724 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.738605Z","level":"info","event":"📋 [2025-06-11 15:17:39]   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.738680Z","level":"info","event":"📋 2025-06-11 15:17:39,724 - INFO -   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.738770Z","level":"info","event":"📋 [2025-06-11 15:17:39]   Taxa de Sucesso: 41.7%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.738864Z","level":"info","event":"📋 2025-06-11 15:17:39,724 - INFO -   Taxa de Sucesso: 41.7%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.739026Z","level":"info","event":"📋 [2025-06-11 15:17:39] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.739097Z","level":"info","event":"📋 2025-06-11 15:17:39,724 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.739152Z","level":"info","event":"📋 [2025-06-11 15:17:39] ✅ Processing completed. Processed 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:39.739207Z","level":"info","event":"📋 2025-06-11 15:17:39,732 - INFO - ✅ Processing completed. Processed 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:40.053487Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:40.053664Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:40.053839Z","level":"info","event":"✅ relevant_articles: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv (5553 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:41.790312Z","level":"info","event":"📊 Number of processed articles: 21","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:41.790495Z","level":"info","event":"📊 Columns: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:41.790655Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/data/structured/2025/06/11/artigos_irrelevantes_2025-06-11.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:41.791312Z","level":"info","event":"⚠️ processing_log: /opt/airflow/data/structured/2025/06/11/processing_log_20250611.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:41.791397Z","level":"info","event":"✅ stats_json: /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json (393 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:41.791016","level":"info","event":"Done. Returned value was: [2025-06-11 15:14:46] Starting processar_relevantes_airflow\n2025-06-11 15:14:46,651 - INFO - Starting processar_relevantes_airflow\n[2025-06-11 15:14:46] Parameters: dias=1, date=2025-06-11\n2025-06-11 15:14:46,652 - INFO - Parameters: dias=1, date=2025-06-11\n[2025-06-11 15:14:46] Paths: input_file=/opt/airflow/data/raw/2025/06/11/google_news_articles_20250611.csv, output_dir=/opt/airflow/data/structured/2025/06/11, date_str=2025-06-11\n2025-06-11 15:14:46,652 - INFO - Paths: input_file=/opt/airflow/data/raw/2025/06/11/google_news_articles_20250611.csv, output_dir=/opt/airflow/data/structured/2025/06/11, date_str=2025-06-11\n[2025-06-11 15:14:46] 🚀 A iniciar processar_relevantes_airflow\n2025-06-11 15:14:46,652 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-11 15:14:46] 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/11\n2025-06-11 15:14:46,652 - INFO - 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/11\n[2025-06-11 15:14:46] 📁 Using provided input file: /opt/airflow/data/raw/2025/06/11/google_news_articles_20250611.csv\n2025-06-11 15:14:46,652 - INFO - 📁 Using provided input file: /opt/airflow/data/raw/2025/06/11/google_news_articles_20250611.csv\n[2025-06-11 15:14:46] 🔧 A carregar ficheiros de configuração...\n2025-06-11 15:14:46,652 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-11 15:14:46] 🔍 Checking config path: /opt/airflow/config\n2025-06-11 15:14:46,652 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-11 15:14:46] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-11 15:14:46,652 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-11 15:14:46] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-11 15:14:46,652 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-11 15:14:46] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-11 15:14:46,652 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-11 15:14:46] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-11 15:14:46,652 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-11 15:14:46] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-11 15:14:46,654 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-11 15:14:46] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-11 15:14:46,654 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-11 15:14:46] ✅ Loaded 6 keywords\n2025-06-11 15:14:46,654 - INFO - ✅ Loaded 6 keywords\n[2025-06-11 15:14:46] ✅ Loaded 3614 DICOFREG codes\n2025-06-11 15:14:46,658 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-11 15:14:46] ==================================================\n2025-06-11 15:14:46,658 - INFO - ==================================================\n[2025-06-11 15:14:46] Configuration Loaded\n2025-06-11 15:14:46,658 - INFO - Configuration Loaded\n[2025-06-11 15:14:46] ==================================================\n2025-06-11 15:14:46,658 - INFO - ==================================================\n[2025-06-11 15:14:46]   Parishes: 306\n2025-06-11 15:14:46,658 - INFO -   Parishes: 306\n[2025-06-11 15:14:46]   Municipalities: 306\n2025-06-11 15:14:46,658 - INFO -   Municipalities: 306\n[2025-06-11 15:14:46]   Districts: 29\n2025-06-11 15:14:46,658 - INFO -   Districts: 29\n[2025-06-11 15:14:46]   Keywords: 6\n2025-06-11 15:14:46,658 - INFO -   Keywords: 6\n[2025-06-11 15:14:46]   DICOFREG Codes: 3614\n2025-06-11 15:14:46,658 - INFO -   DICOFREG Codes: 3614\n[2025-06-11 15:14:46] ==================================================\n2025-06-11 15:14:46,658 - INFO - ==================================================\n[2025-06-11 15:14:46] ✅ Ficheiro CSV válido com 12 artigos\n2025-06-11 15:14:46,663 - INFO - ✅ Ficheiro CSV válido com 12 artigos\n[2025-06-11 15:14:46] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-11 15:14:46,663 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-11 15:14:46] 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos\n2025-06-11 15:14:46,663 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos\n[2025-06-11 15:14:46] ==================================================\n2025-06-11 15:14:46,663 - INFO - ==================================================\n[2025-06-11 15:14:46] Processamento Iniciado\n2025-06-11 15:14:46,663 - INFO - Processamento Iniciado\n[2025-06-11 15:14:46] ==================================================\n2025-06-11 15:14:46,663 - INFO - ==================================================\n[2025-06-11 15:14:46]   Total de Artigos para Processar: 12\n2025-06-11 15:14:46,663 - INFO -   Total de Artigos para Processar: 12\n[2025-06-11 15:14:46]   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/11/google_news_articles_20250611.csv\n2025-06-11 15:14:46,663 - INFO -   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/11/google_news_articles_20250611.csv\n[2025-06-11 15:14:46]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n2025-06-11 15:14:46,663 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n[2025-06-11 15:14:46]   Diretoria de Saída: /opt/airflow/data/structured/2025/06/11\n2025-06-11 15:14:46,663 - INFO -   Diretoria de Saída: /opt/airflow/data/structured/2025/06/11\n[2025-06-11 15:14:46]   Filtro de Dias: 1\n2025-06-11 15:14:46,663 - INFO -   Filtro de Dias: 1\n[2025-06-11 15:14:46] ==================================================\n2025-06-11 15:14:46,663 - INFO - ==================================================\n[2025-06-11 15:14:46] ⚠️ Último ID não encontrado em relevantes. A começar do início.\n2025-06-11 15:14:46,665 - WARNING - ⚠️ Último ID não encontrado em relevantes. A começar do início.\n[2025-06-11 15:14:46] 📦 A processar lote 1/1 (12 artigos)\n2025-06-11 15:14:46,666 - INFO - 📦 A processar lote 1/1 (12 artigos)\n[2025-06-11 15:15:02] 🔄 Processado: Presidente da Câmara de Viana do Alentejo sofre en...\n2025-06-11 15:15:02,867 - INFO - 🔄 Processado: Presidente da Câmara de Viana do Alentejo sofre en...\n[2025-06-11 15:15:10] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Norte do país atingido por tempestade de granizo. Veja as imagens - Notícias ao Minuto\n2025-06-11 15:15:10,944 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Norte do país atingido por tempestade de granizo. Veja as imagens - Notícias ao Minuto\n[2025-06-11 15:15:11] 🔄 Processado: Norte do país atingido por tempestade de granizo. ...\n2025-06-11 15:15:11,178 - INFO - 🔄 Processado: Norte do país atingido por tempestade de granizo. ...\n[2025-06-11 15:15:12] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Norte do país atingido por tempestade de granizo. Veja as imagens - Notícias ao Minuto\n2025-06-11 15:15:12,691 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Norte do país atingido por tempestade de granizo. Veja as imagens - Notícias ao Minuto\n[2025-06-11 15:15:12] 🔄 Processado: Norte do país atingido por tempestade de granizo. ...\n2025-06-11 15:15:12,707 - INFO - 🔄 Processado: Norte do país atingido por tempestade de granizo. ...\n[2025-06-11 15:15:16] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo nos próximos dias para os arquipélagos: Açores poderão contar com alguma instabilidade, mas de passagem rápida - Tempo.pt\n2025-06-11 15:15:16,515 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo nos próximos dias para os arquipélagos: Açores poderão contar com alguma instabilidade, mas de passagem rápida - Tempo.pt\n[2025-06-11 15:15:16] 🔄 Processado: Tempo nos próximos dias para os arquipélagos: Açor...\n2025-06-11 15:15:16,609 - INFO - 🔄 Processado: Tempo nos próximos dias para os arquipélagos: Açor...\n[2025-06-11 15:15:17] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Quarta-feira com sol, chuva fraca e forte descida da temperatura - O Amarense\n2025-06-11 15:15:17,409 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Quarta-feira com sol, chuva fraca e forte descida da temperatura - O Amarense\n[2025-06-11 15:15:17] 🔄 Processado: Tempo. Quarta-feira com sol, chuva fraca e forte d...\n2025-06-11 15:15:17,416 - INFO - 🔄 Processado: Tempo. Quarta-feira com sol, chuva fraca e forte d...\n[2025-06-11 15:15:34] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Distritos de Évora e Portalegre sob aviso amarelo devido à chuva e trovoada - Rádio Campanário\n2025-06-11 15:15:34,256 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Distritos de Évora e Portalegre sob aviso amarelo devido à chuva e trovoada - Rádio Campanário\n[2025-06-11 15:15:34] 🔄 Processado: Distritos de Évora e Portalegre sob aviso amarelo ...\n2025-06-11 15:15:34,260 - INFO - 🔄 Processado: Distritos de Évora e Portalegre sob aviso amarelo ...\n[2025-06-11 15:15:48] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempestade a caminho de Coimbra: trovoada, granizo e até vento forte - Notícias de Coimbra\n2025-06-11 15:15:48,593 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempestade a caminho de Coimbra: trovoada, granizo e até vento forte - Notícias de Coimbra\n[2025-06-11 15:15:48] 🔄 Processado: Tempestade a caminho de Coimbra: trovoada, granizo...\n2025-06-11 15:15:48,605 - INFO - 🔄 Processado: Tempestade a caminho de Coimbra: trovoada, granizo...\n[2025-06-11 15:16:04] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Granizo e trovoada atingem o Norte de Portugal: tempestade surpreende população - rumores.pt\n2025-06-11 15:16:04,659 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Granizo e trovoada atingem o Norte de Portugal: tempestade surpreende população - rumores.pt\n[2025-06-11 15:16:04] 🔄 Processado: Granizo e trovoada atingem o Norte de Portugal: te...\n2025-06-11 15:16:04,668 - INFO - 🔄 Processado: Granizo e trovoada atingem o Norte de Portugal: te...\n[2025-06-11 15:16:13] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempestade a caminho de Coimbra: trovoada, granizo e até vento forte - Notícias de Coimbra\n2025-06-11 15:16:13,840 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempestade a caminho de Coimbra: trovoada, granizo e até vento forte - Notícias de Coimbra\n[2025-06-11 15:16:13] 🔄 Processado: Tempestade a caminho de Coimbra: trovoada, granizo...\n2025-06-11 15:16:13,843 - INFO - 🔄 Processado: Tempestade a caminho de Coimbra: trovoada, granizo...\n[2025-06-11 15:16:16] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Prepara-se que vem aí chuva, granizo e trovoada nas regiões Centro e Norte - CentroTV\n2025-06-11 15:16:16,507 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Prepara-se que vem aí chuva, granizo e trovoada nas regiões Centro e Norte - CentroTV\n[2025-06-11 15:16:16] 🔄 Processado: Prepara-se que vem aí chuva, granizo e trovoada na...\n2025-06-11 15:16:16,510 - INFO - 🔄 Processado: Prepara-se que vem aí chuva, granizo e trovoada na...\n[2025-06-11 15:16:18] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: \"Sentimos a emoção do nosso oceano. Até chorei de orgulho\": como foi o Dia de Portugal em Osaka - Expresso\n2025-06-11 15:16:18,158 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: \"Sentimos a emoção do nosso oceano. Até chorei de orgulho\": como foi o Dia de Portugal em Osaka - Expresso\n[2025-06-11 15:16:18] 🔄 Processado: \"Sentimos a emoção do nosso oceano. Até chorei de ...\n2025-06-11 15:16:18,160 - INFO - 🔄 Processado: \"Sentimos a emoção do nosso oceano. Até chorei de ...\n[2025-06-11 15:17:34] ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMipgFBVV95cUxOdnpkbWJSNFdlVlBWN1lhNFVEcHBtYUFkQkxmaHktZXQwb1hHYXI1WFduVDBuZVRmVnp5ZmVnb3ZYR0lYNjNvcDNQNWd0dFVoTWs4NkhGb2xmMmhnd1hOQTQxOEpnRWx5U2RqS3VXaldrX1BIT0pLbTF0WmlFZjRmLXVPNFYxRE1JNnR2WGFjdVJleHlwOThYeW5kbUYyTndLS0E1XzN3?oc=5\n2025-06-11 15:17:34,744 - WARNING - ⚠️ Link não resolvido: https://news.google.com/rss/articles/CBMipgFBVV95cUxOdnpkbWJSNFdlVlBWN1lhNFVEcHBtYUFkQkxmaHktZXQwb1hHYXI1WFduVDBuZVRmVnp5ZmVnb3ZYR0lYNjNvcDNQNWd0dFVoTWs4NkhGb2xmMmhnd1hOQTQxOEpnRWx5U2RqS3VXaldrX1BIT0pLbTF0WmlFZjRmLXVPNFYxRE1JNnR2WGFjdVJleHlwOThYeW5kbUYyTndLS0E1XzN3?oc=5\n📥 Novos artigos recebidos: 5\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n📂 IDs existentes no arquivo: 16\n🆕 Artigos únicos para salvar: 5\n💾 Guardados 5 artigos no arquivo /opt/airflow/data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n📥 Novos artigos recebidos: 5\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n📂 IDs existentes no arquivo: 16\n🆕 Artigos únicos para salvar: 5\n💾 Guardados 5 artigos no arquivo /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n[2025-06-11 15:17:34] ✅ Relevant articles saved: 5 articles\n2025-06-11 15:17:34,751 - INFO - ✅ Relevant articles saved: 5 articles\n[2025-06-11 15:17:34] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json\n2025-06-11 15:17:34,751 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json\n[2025-06-11 15:17:34] ✅ Lote 1 concluído: 5 artigos (total: 5)\n2025-06-11 15:17:34,751 - INFO - ✅ Lote 1 concluído: 5 artigos (total: 5)\n📥 Novos artigos recebidos: 5\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n📂 IDs existentes no arquivo: 21\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 5\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n📂 IDs existentes no arquivo: 21\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-11 15:17:39] ✅ Relevant articles saved: 5 articles\n2025-06-11 15:17:39,722 - INFO - ✅ Relevant articles saved: 5 articles\n[2025-06-11 15:17:39] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json\n2025-06-11 15:17:39,723 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json\n[2025-06-11 15:17:39] ==================================================\n2025-06-11 15:17:39,723 - INFO - ==================================================\n[2025-06-11 15:17:39] Processamento Concluído com Sucesso\n2025-06-11 15:17:39,723 - INFO - Processamento Concluído com Sucesso\n[2025-06-11 15:17:39] ==================================================\n2025-06-11 15:17:39,723 - INFO - ==================================================\n[2025-06-11 15:17:39]   Total de Artigos Processados: 5\n2025-06-11 15:17:39,723 - INFO -   Total de Artigos Processados: 5\n[2025-06-11 15:17:39]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n2025-06-11 15:17:39,723 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n[2025-06-11 15:17:39]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n2025-06-11 15:17:39,724 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n[2025-06-11 15:17:39]   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json\n2025-06-11 15:17:39,724 - INFO -   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json\n[2025-06-11 15:17:39]   Taxa de Sucesso: 41.7%\n2025-06-11 15:17:39,724 - INFO -   Taxa de Sucesso: 41.7%\n[2025-06-11 15:17:39] ==================================================\n2025-06-11 15:17:39,724 - INFO - ==================================================\n[2025-06-11 15:17:39] ✅ Processing completed. Processed 5 articles\n2025-06-11 15:17:39,732 - INFO - ✅ Processing completed. Processed 5 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
