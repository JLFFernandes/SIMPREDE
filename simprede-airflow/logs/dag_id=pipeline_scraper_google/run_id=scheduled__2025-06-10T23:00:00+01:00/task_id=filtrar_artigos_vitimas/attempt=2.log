{"timestamp":"2025-06-11T14:10:13.973989","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-11T14:10:13.978505","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-11T14:10:14.224526Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:14.226587Z","level":"info","event":"📁 Using paths from processar task: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:14.233100Z","level":"info","event":"📅 Using provided execution date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:14.236442Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/11', '/opt/airflow/data/structured/2025/06/11', '/opt/airflow/data/processed/2025/06/11']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:14.236772Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:14.236960Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:14.237103Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:14.237258Z","level":"info","event":"  - Target date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:14.237418Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:14.257057Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:14.257511Z","level":"info","event":"✅ Found input file: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:14.257764Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:14.257961Z","level":"info","event":"  - victims_articles: /opt/airflow/data/processed/2025/06/11/artigos_vitimas_filtrados_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:14.258677Z","level":"info","event":"  - no_victims_articles: /opt/airflow/data/processed/2025/06/11/artigos_sem_vitimas_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:14.259003Z","level":"info","event":"  - filtering_log: /opt/airflow/data/processed/2025/06/11/filtering_log_20250611.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:14.259166Z","level":"info","event":"  - stats_json: /opt/airflow/data/processed/2025/06/11/filtering_stats_20250611.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:14.259723Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv --output_dir /opt/airflow/data/processed/2025/06/11 --date_str 2025-06-11 --date 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:14.295597Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.478017Z","level":"info","event":"📋 [2025-06-11 15:10:20] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.482440Z","level":"info","event":"📋 2025-06-11 15:10:20,475 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.485403Z","level":"info","event":"📋 [2025-06-11 15:10:20] Parameters: dias=1, date=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.488846Z","level":"info","event":"📋 2025-06-11 15:10:20,476 - INFO - Parameters: dias=1, date=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.490689Z","level":"info","event":"📋 [2025-06-11 15:10:20] Paths: input_file=/opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv, output_dir=/opt/airflow/data/processed/2025/06/11, date_str=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.491706Z","level":"info","event":"📋 2025-06-11 15:10:20,476 - INFO - Paths: input_file=/opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv, output_dir=/opt/airflow/data/processed/2025/06/11, date_str=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.492379Z","level":"info","event":"📋 [2025-06-11 15:10:20] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.493907Z","level":"info","event":"📋 2025-06-11 15:10:20,476 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.498292Z","level":"info","event":"📋 [2025-06-11 15:10:20] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.501969Z","level":"info","event":"📋 2025-06-11 15:10:20,476 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.506821Z","level":"info","event":"📋 [2025-06-11 15:10:20]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.509747Z","level":"info","event":"📋 2025-06-11 15:10:20,476 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.510738Z","level":"info","event":"📋 [2025-06-11 15:10:20]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.511145Z","level":"info","event":"📋 2025-06-11 15:10:20,476 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.511800Z","level":"info","event":"📋 [2025-06-11 15:10:20] 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.512423Z","level":"info","event":"📋 2025-06-11 15:10:20,476 - INFO - 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.514217Z","level":"info","event":"📋 [2025-06-11 15:10:20] 📁 Using provided input file: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.515691Z","level":"info","event":"📋 2025-06-11 15:10:20,480 - INFO - 📁 Using provided input file: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.516638Z","level":"info","event":"📋 [2025-06-11 15:10:20] 📂 Loading articles from: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.517271Z","level":"info","event":"📋 2025-06-11 15:10:20,480 - INFO - 📂 Loading articles from: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.517799Z","level":"info","event":"📋 [2025-06-11 15:10:20] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.519078Z","level":"info","event":"📋 2025-06-11 15:10:20,506 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.523752Z","level":"info","event":"📋 [2025-06-11 15:10:20] Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.527803Z","level":"info","event":"📋 2025-06-11 15:10:20,507 - INFO - Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.532876Z","level":"info","event":"📋 [2025-06-11 15:10:20] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.533274Z","level":"info","event":"📋 2025-06-11 15:10:20,507 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.534531Z","level":"info","event":"📋 [2025-06-11 15:10:20]   Total Articles Loaded: 16","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.534842Z","level":"info","event":"📋 2025-06-11 15:10:20,507 - INFO -   Total Articles Loaded: 16","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.536763Z","level":"info","event":"📋 [2025-06-11 15:10:20]   Input File: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.537866Z","level":"info","event":"📋 2025-06-11 15:10:20,508 - INFO -   Input File: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.538853Z","level":"info","event":"📋 [2025-06-11 15:10:20]   Output File: /opt/airflow/data/processed/2025/06/11/artigos_vitimas_filtrados_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.540180Z","level":"info","event":"📋 2025-06-11 15:10:20,508 - INFO -   Output File: /opt/airflow/data/processed/2025/06/11/artigos_vitimas_filtrados_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.540679Z","level":"info","event":"📋 [2025-06-11 15:10:20]   Processed Data Directory: /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.540990Z","level":"info","event":"📋 2025-06-11 15:10:20,508 - INFO -   Processed Data Directory: /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.541200Z","level":"info","event":"📋 [2025-06-11 15:10:20]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.541573Z","level":"info","event":"📋 2025-06-11 15:10:20,508 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.541925Z","level":"info","event":"📋 [2025-06-11 15:10:20] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.542173Z","level":"info","event":"📋 2025-06-11 15:10:20,508 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.542621Z","level":"info","event":"📋 [2025-06-11 15:10:20] 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.543119Z","level":"info","event":"📋 2025-06-11 15:10:20,508 - INFO - 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.543629Z","level":"info","event":"📋 [2025-06-11 15:10:20] 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.544053Z","level":"info","event":"📋 2025-06-11 15:10:20,508 - INFO - 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.544532Z","level":"info","event":"📋 [2025-06-11 15:10:20] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.544918Z","level":"info","event":"📋 2025-06-11 15:10:20,508 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.545569Z","level":"info","event":"📋 [2025-06-11 15:10:20]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.546508Z","level":"info","event":"📋 2025-06-11 15:10:20,508 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.547162Z","level":"info","event":"📋 [2025-06-11 15:10:20]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.547749Z","level":"info","event":"📋 2025-06-11 15:10:20,508 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.548420Z","level":"info","event":"📋 [2025-06-11 15:10:20]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.548913Z","level":"info","event":"📋 2025-06-11 15:10:20,508 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.549501Z","level":"info","event":"📋 [2025-06-11 15:10:20]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.549877Z","level":"info","event":"📋 2025-06-11 15:10:20,509 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.550212Z","level":"info","event":"📋 [2025-06-11 15:10:20] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.550527Z","level":"info","event":"📋 2025-06-11 15:10:20,511 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.550760Z","level":"info","event":"📋 [2025-06-11 15:10:20]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.551388Z","level":"info","event":"📋 2025-06-11 15:10:20,511 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.551878Z","level":"info","event":"📋 [2025-06-11 15:10:20]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.553240Z","level":"info","event":"📋 2025-06-11 15:10:20,511 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.557024Z","level":"info","event":"📋 [2025-06-11 15:10:20] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.558787Z","level":"info","event":"📋 2025-06-11 15:10:20,515 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.559735Z","level":"info","event":"📋 [2025-06-11 15:10:20] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.559982Z","level":"info","event":"📋 2025-06-11 15:10:20,518 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.561752Z","level":"info","event":"📋 [2025-06-11 15:10:20] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.562359Z","level":"info","event":"📋 2025-06-11 15:10:20,518 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.562924Z","level":"info","event":"📋 [2025-06-11 15:10:20] 📊 Starting enhanced comprehensive filtering with 16 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.567898Z","level":"info","event":"📋 2025-06-11 15:10:20,518 - INFO - 📊 Starting enhanced comprehensive filtering with 16 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.571102Z","level":"info","event":"📋 [2025-06-11 15:10:20] 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.572024Z","level":"info","event":"📋 2025-06-11 15:10:20,535 - INFO - 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.572829Z","level":"info","event":"📋 [2025-06-11 15:10:20]    After enhanced geographic filter: 13 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.573065Z","level":"info","event":"📋 2025-06-11 15:10:20,555 - INFO -    After enhanced geographic filter: 13 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.573297Z","level":"info","event":"📋 [2025-06-11 15:10:20] ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.573433Z","level":"info","event":"📋 2025-06-11 15:10:20,555 - INFO - ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.573644Z","level":"info","event":"📋 [2025-06-11 15:10:20]    After quality filter: 4 articles (removed 9)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.573814Z","level":"info","event":"📋 2025-06-11 15:10:20,562 - INFO -    After quality filter: 4 articles (removed 9)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.573941Z","level":"info","event":"📋 [2025-06-11 15:10:20] 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.574060Z","level":"info","event":"📋 2025-06-11 15:10:20,563 - INFO - 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.574268Z","level":"info","event":"📋 [2025-06-11 15:10:20]    After enhanced keyword filter: 1 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.574407Z","level":"info","event":"📋 2025-06-11 15:10:20,565 - INFO -    After enhanced keyword filter: 1 articles (removed 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.574532Z","level":"info","event":"📋 [2025-06-11 15:10:20] 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.574640Z","level":"info","event":"📋 2025-06-11 15:10:20,566 - INFO - 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.574799Z","level":"info","event":"📋 [2025-06-11 15:10:20]    After temporal filter: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.574956Z","level":"info","event":"📋 2025-06-11 15:10:20,568 - INFO -    After temporal filter: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.575065Z","level":"info","event":"📋 [2025-06-11 15:10:20] 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.575170Z","level":"info","event":"📋 2025-06-11 15:10:20,568 - INFO - 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.575276Z","level":"info","event":"📋 [2025-06-11 15:10:20]    After victim validation: 0 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.575382Z","level":"info","event":"📋 2025-06-11 15:10:20,570 - INFO -    After victim validation: 0 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.575488Z","level":"info","event":"📋 [2025-06-11 15:10:20] ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.576776Z","level":"info","event":"📋 2025-06-11 15:10:20,570 - INFO - ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.577186Z","level":"info","event":"📋 [2025-06-11 15:10:20]    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.577993Z","level":"info","event":"📋 2025-06-11 15:10:20,576 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.579146Z","level":"info","event":"📋 [2025-06-11 15:10:20] 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.581709Z","level":"info","event":"📋 2025-06-11 15:10:20,576 - INFO - 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.582026Z","level":"info","event":"📋 [2025-06-11 15:10:20]    After URL deduplication: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.582749Z","level":"info","event":"📋 2025-06-11 15:10:20,576 - INFO -    After URL deduplication: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.582967Z","level":"info","event":"📋 [2025-06-11 15:10:20]    After content similarity deduplication: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.583429Z","level":"info","event":"📋 2025-06-11 15:10:20,576 - INFO -    After content similarity deduplication: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.583726Z","level":"info","event":"📋 [2025-06-11 15:10:20] 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.583856Z","level":"info","event":"📋 2025-06-11 15:10:20,580 - INFO - 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.584050Z","level":"info","event":"📋 [2025-06-11 15:10:20] ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.585733Z","level":"info","event":"📋 2025-06-11 15:10:20,583 - WARNING - ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.586125Z","level":"info","event":"📋 [2025-06-11 15:10:20] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.586314Z","level":"info","event":"📋 2025-06-11 15:10:20,584 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.815029Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.815373Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.815745Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/data/processed/2025/06/11/artigos_vitimas_filtrados_20250611.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.815988Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/data/processed/2025/06/11/artigos_sem_vitimas_20250611.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.816227Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/data/processed/2025/06/11/filtering_log_20250611.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.816519Z","level":"info","event":"⚠️ stats_json: /opt/airflow/data/processed/2025/06/11/filtering_stats_20250611.json (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:10:20.817308","level":"info","event":"Done. Returned value was: [2025-06-11 15:10:20] Starting filtrar_artigos_vitimas_airflow\n2025-06-11 15:10:20,475 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-11 15:10:20] Parameters: dias=1, date=2025-06-11\n2025-06-11 15:10:20,476 - INFO - Parameters: dias=1, date=2025-06-11\n[2025-06-11 15:10:20] Paths: input_file=/opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv, output_dir=/opt/airflow/data/processed/2025/06/11, date_str=2025-06-11\n2025-06-11 15:10:20,476 - INFO - Paths: input_file=/opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv, output_dir=/opt/airflow/data/processed/2025/06/11, date_str=2025-06-11\n[2025-06-11 15:10:20] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n2025-06-11 15:10:20,476 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n[2025-06-11 15:10:20] 🔍 Path setup:\n2025-06-11 15:10:20,476 - INFO - 🔍 Path setup:\n[2025-06-11 15:10:20]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-11 15:10:20,476 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-11 15:10:20]    Project root: /opt/airflow\n2025-06-11 15:10:20,476 - INFO -    Project root: /opt/airflow\n[2025-06-11 15:10:20] 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/11\n2025-06-11 15:10:20,476 - INFO - 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/11\n[2025-06-11 15:10:20] 📁 Using provided input file: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n2025-06-11 15:10:20,480 - INFO - 📁 Using provided input file: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n[2025-06-11 15:10:20] 📂 Loading articles from: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n2025-06-11 15:10:20,480 - INFO - 📂 Loading articles from: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n[2025-06-11 15:10:20] ==================================================\n2025-06-11 15:10:20,506 - INFO - ==================================================\n[2025-06-11 15:10:20] Enhanced Filtering Started\n2025-06-11 15:10:20,507 - INFO - Enhanced Filtering Started\n[2025-06-11 15:10:20] ==================================================\n2025-06-11 15:10:20,507 - INFO - ==================================================\n[2025-06-11 15:10:20]   Total Articles Loaded: 16\n2025-06-11 15:10:20,507 - INFO -   Total Articles Loaded: 16\n[2025-06-11 15:10:20]   Input File: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n2025-06-11 15:10:20,508 - INFO -   Input File: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n[2025-06-11 15:10:20]   Output File: /opt/airflow/data/processed/2025/06/11/artigos_vitimas_filtrados_2025-06-11.csv\n2025-06-11 15:10:20,508 - INFO -   Output File: /opt/airflow/data/processed/2025/06/11/artigos_vitimas_filtrados_2025-06-11.csv\n[2025-06-11 15:10:20]   Processed Data Directory: /opt/airflow/data/processed/2025/06/11\n2025-06-11 15:10:20,508 - INFO -   Processed Data Directory: /opt/airflow/data/processed/2025/06/11\n[2025-06-11 15:10:20]   Days Filter: 1\n2025-06-11 15:10:20,508 - INFO -   Days Filter: 1\n[2025-06-11 15:10:20] ==================================================\n2025-06-11 15:10:20,508 - INFO - ==================================================\n[2025-06-11 15:10:20] 🔍 Applying enhanced comprehensive filtering logic...\n2025-06-11 15:10:20,508 - INFO - 🔍 Applying enhanced comprehensive filtering logic...\n[2025-06-11 15:10:20] 🔧 Loading configuration data for enhanced filtering...\n2025-06-11 15:10:20,508 - INFO - 🔧 Loading configuration data for enhanced filtering...\n[2025-06-11 15:10:20] 🔍 Looking for config files in multiple paths:\n2025-06-11 15:10:20,508 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-11 15:10:20]    Checking: /opt/airflow/config\n2025-06-11 15:10:20,508 - INFO -    Checking: /opt/airflow/config\n[2025-06-11 15:10:20]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-11 15:10:20,508 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-11 15:10:20]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-11 15:10:20,508 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-11 15:10:20]    Checking: config\n2025-06-11 15:10:20,509 - INFO -    Checking: config\n[2025-06-11 15:10:20] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-11 15:10:20,511 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-11 15:10:20]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-11 15:10:20,511 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-11 15:10:20]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-11 15:10:20,511 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-11 15:10:20] ✅ Loaded municipios config with 29 districts\n2025-06-11 15:10:20,515 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-11 15:10:20] ✅ Loaded eventos config with 14 events\n2025-06-11 15:10:20,518 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-11 15:10:20] 📊 Config summary: 29 districts, 306 parishes\n2025-06-11 15:10:20,518 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-11 15:10:20] 📊 Starting enhanced comprehensive filtering with 16 articles\n2025-06-11 15:10:20,518 - INFO - 📊 Starting enhanced comprehensive filtering with 16 articles\n[2025-06-11 15:10:20] 🇵🇹 Applying enhanced geographic filter...\n2025-06-11 15:10:20,535 - INFO - 🇵🇹 Applying enhanced geographic filter...\n[2025-06-11 15:10:20]    After enhanced geographic filter: 13 articles (removed 3)\n2025-06-11 15:10:20,555 - INFO -    After enhanced geographic filter: 13 articles (removed 3)\n[2025-06-11 15:10:20] ✨ Applying content quality filter...\n2025-06-11 15:10:20,555 - INFO - ✨ Applying content quality filter...\n[2025-06-11 15:10:20]    After quality filter: 4 articles (removed 9)\n2025-06-11 15:10:20,562 - INFO -    After quality filter: 4 articles (removed 9)\n[2025-06-11 15:10:20] 🔍 Applying enhanced keyword filtering...\n2025-06-11 15:10:20,563 - INFO - 🔍 Applying enhanced keyword filtering...\n[2025-06-11 15:10:20]    After enhanced keyword filter: 1 articles (removed 3)\n2025-06-11 15:10:20,565 - INFO -    After enhanced keyword filter: 1 articles (removed 3)\n[2025-06-11 15:10:20] 📅 Applying temporal relevance filter...\n2025-06-11 15:10:20,566 - INFO - 📅 Applying temporal relevance filter...\n[2025-06-11 15:10:20]    After temporal filter: 1 articles (removed 0)\n2025-06-11 15:10:20,568 - INFO -    After temporal filter: 1 articles (removed 0)\n[2025-06-11 15:10:20] 👥 Applying enhanced victim validation...\n2025-06-11 15:10:20,568 - INFO - 👥 Applying enhanced victim validation...\n[2025-06-11 15:10:20]    After victim validation: 0 articles (removed 1)\n2025-06-11 15:10:20,570 - INFO -    After victim validation: 0 articles (removed 1)\n[2025-06-11 15:10:20] ⭐ Calculating enhanced relevance scores...\n2025-06-11 15:10:20,570 - INFO - ⭐ Calculating enhanced relevance scores...\n[2025-06-11 15:10:20]    After relevance score filter (min 2): 0 articles (removed 0)\n2025-06-11 15:10:20,576 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)\n[2025-06-11 15:10:20] 🔄 Removing duplicates with enhanced logic...\n2025-06-11 15:10:20,576 - INFO - 🔄 Removing duplicates with enhanced logic...\n[2025-06-11 15:10:20]    After URL deduplication: 0 articles (removed 0)\n2025-06-11 15:10:20,576 - INFO -    After URL deduplication: 0 articles (removed 0)\n[2025-06-11 15:10:20]    After content similarity deduplication: 0 articles (removed 0)\n2025-06-11 15:10:20,576 - INFO -    After content similarity deduplication: 0 articles (removed 0)\n[2025-06-11 15:10:20] 🌦️ Enhanced climate event identification...\n2025-06-11 15:10:20,580 - INFO - 🌦️ Enhanced climate event identification...\n[2025-06-11 15:10:20] ⚠️ No articles remaining after enhanced filtering.\n2025-06-11 15:10:20,583 - WARNING - ⚠️ No articles remaining after enhanced filtering.\n[2025-06-11 15:10:20] ✅ Filtering completed. Found 0 articles with victims\n2025-06-11 15:10:20,584 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
