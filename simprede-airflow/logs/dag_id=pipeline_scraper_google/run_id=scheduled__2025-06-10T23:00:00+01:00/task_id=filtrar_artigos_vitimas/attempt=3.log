{"timestamp":"2025-06-11T14:17:42.298438","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-11T14:17:42.298821","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-11T14:17:42.354419Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:42.354682Z","level":"info","event":"📁 Using paths from processar task: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:42.358241Z","level":"info","event":"📅 Using provided execution date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:42.358574Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/11', '/opt/airflow/data/structured/2025/06/11', '/opt/airflow/data/processed/2025/06/11']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:42.358627Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:42.358669Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:42.358710Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:42.358747Z","level":"info","event":"  - Target date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:42.358784Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:42.361475Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:42.361876Z","level":"info","event":"✅ Found input file: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:42.361951Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:42.362022Z","level":"info","event":"  - victims_articles: /opt/airflow/data/processed/2025/06/11/artigos_vitimas_filtrados_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:42.362070Z","level":"info","event":"  - no_victims_articles: /opt/airflow/data/processed/2025/06/11/artigos_sem_vitimas_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:42.362110Z","level":"info","event":"  - filtering_log: /opt/airflow/data/processed/2025/06/11/filtering_log_20250611.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:42.362148Z","level":"info","event":"  - stats_json: /opt/airflow/data/processed/2025/06/11/filtering_stats_20250611.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:42.362186Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv --output_dir /opt/airflow/data/processed/2025/06/11 --date_str 2025-06-11 --date 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:42.363545Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.851770Z","level":"info","event":"📋 [2025-06-11 15:17:43] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.852152Z","level":"info","event":"📋 2025-06-11 15:17:43,851 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.852236Z","level":"info","event":"📋 [2025-06-11 15:17:43] Parameters: dias=1, date=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.852563Z","level":"info","event":"📋 2025-06-11 15:17:43,851 - INFO - Parameters: dias=1, date=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.853661Z","level":"info","event":"📋 [2025-06-11 15:17:43] Paths: input_file=/opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv, output_dir=/opt/airflow/data/processed/2025/06/11, date_str=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.853716Z","level":"info","event":"📋 2025-06-11 15:17:43,851 - INFO - Paths: input_file=/opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv, output_dir=/opt/airflow/data/processed/2025/06/11, date_str=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.853755Z","level":"info","event":"📋 [2025-06-11 15:17:43] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.853791Z","level":"info","event":"📋 2025-06-11 15:17:43,851 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.853840Z","level":"info","event":"📋 [2025-06-11 15:17:43] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.853894Z","level":"info","event":"📋 2025-06-11 15:17:43,851 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.853934Z","level":"info","event":"📋 [2025-06-11 15:17:43]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.853969Z","level":"info","event":"📋 2025-06-11 15:17:43,851 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854005Z","level":"info","event":"📋 [2025-06-11 15:17:43]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854061Z","level":"info","event":"📋 2025-06-11 15:17:43,852 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854096Z","level":"info","event":"📋 [2025-06-11 15:17:43] 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854131Z","level":"info","event":"📋 2025-06-11 15:17:43,852 - INFO - 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854191Z","level":"info","event":"📋 [2025-06-11 15:17:43] 📁 Using provided input file: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854229Z","level":"info","event":"📋 2025-06-11 15:17:43,852 - INFO - 📁 Using provided input file: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854264Z","level":"info","event":"📋 [2025-06-11 15:17:43] 📂 Loading articles from: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854301Z","level":"info","event":"📋 2025-06-11 15:17:43,852 - INFO - 📂 Loading articles from: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854338Z","level":"info","event":"📋 [2025-06-11 15:17:43] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854372Z","level":"info","event":"📋 2025-06-11 15:17:43,853 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854415Z","level":"info","event":"📋 [2025-06-11 15:17:43] Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854486Z","level":"info","event":"📋 2025-06-11 15:17:43,854 - INFO - Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854522Z","level":"info","event":"📋 [2025-06-11 15:17:43] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854599Z","level":"info","event":"📋 2025-06-11 15:17:43,854 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854658Z","level":"info","event":"📋 [2025-06-11 15:17:43]   Total Articles Loaded: 21","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854735Z","level":"info","event":"📋 2025-06-11 15:17:43,854 - INFO -   Total Articles Loaded: 21","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854818Z","level":"info","event":"📋 [2025-06-11 15:17:43]   Input File: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854901Z","level":"info","event":"📋 2025-06-11 15:17:43,854 - INFO -   Input File: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.854941Z","level":"info","event":"📋 [2025-06-11 15:17:43]   Output File: /opt/airflow/data/processed/2025/06/11/artigos_vitimas_filtrados_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.855012Z","level":"info","event":"📋 2025-06-11 15:17:43,854 - INFO -   Output File: /opt/airflow/data/processed/2025/06/11/artigos_vitimas_filtrados_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.855055Z","level":"info","event":"📋 [2025-06-11 15:17:43]   Processed Data Directory: /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.855291Z","level":"info","event":"📋 2025-06-11 15:17:43,854 - INFO -   Processed Data Directory: /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.855336Z","level":"info","event":"📋 [2025-06-11 15:17:43]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.855373Z","level":"info","event":"📋 2025-06-11 15:17:43,855 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.855408Z","level":"info","event":"📋 [2025-06-11 15:17:43] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.855453Z","level":"info","event":"📋 2025-06-11 15:17:43,855 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.855551Z","level":"info","event":"📋 [2025-06-11 15:17:43] 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.855619Z","level":"info","event":"📋 2025-06-11 15:17:43,855 - INFO - 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.855671Z","level":"info","event":"📋 [2025-06-11 15:17:43] 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856080Z","level":"info","event":"📋 2025-06-11 15:17:43,855 - INFO - 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856115Z","level":"info","event":"📋 [2025-06-11 15:17:43] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856148Z","level":"info","event":"📋 2025-06-11 15:17:43,855 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856185Z","level":"info","event":"📋 [2025-06-11 15:17:43]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856244Z","level":"info","event":"📋 2025-06-11 15:17:43,855 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856277Z","level":"info","event":"📋 [2025-06-11 15:17:43]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856309Z","level":"info","event":"📋 2025-06-11 15:17:43,855 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856342Z","level":"info","event":"📋 [2025-06-11 15:17:43]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856374Z","level":"info","event":"📋 2025-06-11 15:17:43,855 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856407Z","level":"info","event":"📋 [2025-06-11 15:17:43]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856439Z","level":"info","event":"📋 2025-06-11 15:17:43,855 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856490Z","level":"info","event":"📋 [2025-06-11 15:17:43] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856530Z","level":"info","event":"📋 2025-06-11 15:17:43,855 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856564Z","level":"info","event":"📋 [2025-06-11 15:17:43]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856596Z","level":"info","event":"📋 2025-06-11 15:17:43,855 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856629Z","level":"info","event":"📋 [2025-06-11 15:17:43]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856698Z","level":"info","event":"📋 2025-06-11 15:17:43,855 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.856775Z","level":"info","event":"📋 [2025-06-11 15:17:43] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.857161Z","level":"info","event":"📋 2025-06-11 15:17:43,856 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.857410Z","level":"info","event":"📋 [2025-06-11 15:17:43] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.857457Z","level":"info","event":"📋 2025-06-11 15:17:43,857 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.857493Z","level":"info","event":"📋 [2025-06-11 15:17:43] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.857528Z","level":"info","event":"📋 2025-06-11 15:17:43,857 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.857563Z","level":"info","event":"📋 [2025-06-11 15:17:43] 📊 Starting enhanced comprehensive filtering with 21 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.857598Z","level":"info","event":"📋 2025-06-11 15:17:43,857 - INFO - 📊 Starting enhanced comprehensive filtering with 21 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.859856Z","level":"info","event":"📋 [2025-06-11 15:17:43] 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.859939Z","level":"info","event":"📋 2025-06-11 15:17:43,859 - INFO - 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.861864Z","level":"info","event":"📋 [2025-06-11 15:17:43]    After enhanced geographic filter: 17 articles (removed 4)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.863674Z","level":"info","event":"📋 2025-06-11 15:17:43,861 - INFO -    After enhanced geographic filter: 17 articles (removed 4)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.863731Z","level":"info","event":"📋 [2025-06-11 15:17:43] ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.863770Z","level":"info","event":"📋 2025-06-11 15:17:43,861 - INFO - ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.863833Z","level":"info","event":"📋 [2025-06-11 15:17:43]    After quality filter: 6 articles (removed 11)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.863870Z","level":"info","event":"📋 2025-06-11 15:17:43,862 - INFO -    After quality filter: 6 articles (removed 11)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.863906Z","level":"info","event":"📋 [2025-06-11 15:17:43] 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.863941Z","level":"info","event":"📋 2025-06-11 15:17:43,862 - INFO - 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.863976Z","level":"info","event":"📋 [2025-06-11 15:17:43]    After enhanced keyword filter: 1 articles (removed 5)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.864011Z","level":"info","event":"📋 2025-06-11 15:17:43,862 - INFO -    After enhanced keyword filter: 1 articles (removed 5)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.864046Z","level":"info","event":"📋 [2025-06-11 15:17:43] 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.864080Z","level":"info","event":"📋 2025-06-11 15:17:43,862 - INFO - 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.864114Z","level":"info","event":"📋 [2025-06-11 15:17:43]    After temporal filter: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.864147Z","level":"info","event":"📋 2025-06-11 15:17:43,862 - INFO -    After temporal filter: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.864179Z","level":"info","event":"📋 [2025-06-11 15:17:43] 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.864212Z","level":"info","event":"📋 2025-06-11 15:17:43,862 - INFO - 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.864245Z","level":"info","event":"📋 [2025-06-11 15:17:43]    After victim validation: 0 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.864277Z","level":"info","event":"📋 2025-06-11 15:17:43,862 - INFO -    After victim validation: 0 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.864310Z","level":"info","event":"📋 [2025-06-11 15:17:43] ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.864846Z","level":"info","event":"📋 2025-06-11 15:17:43,862 - INFO - ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.867872Z","level":"info","event":"📋 [2025-06-11 15:17:43]    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.869857Z","level":"info","event":"📋 2025-06-11 15:17:43,863 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.869935Z","level":"info","event":"📋 [2025-06-11 15:17:43] 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.869977Z","level":"info","event":"📋 2025-06-11 15:17:43,863 - INFO - 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.870014Z","level":"info","event":"📋 [2025-06-11 15:17:43]    After URL deduplication: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.870051Z","level":"info","event":"📋 2025-06-11 15:17:43,863 - INFO -    After URL deduplication: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.870094Z","level":"info","event":"📋 [2025-06-11 15:17:43]    After content similarity deduplication: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.870140Z","level":"info","event":"📋 2025-06-11 15:17:43,863 - INFO -    After content similarity deduplication: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.870216Z","level":"info","event":"📋 [2025-06-11 15:17:43] 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.870261Z","level":"info","event":"📋 2025-06-11 15:17:43,864 - INFO - 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.870308Z","level":"info","event":"📋 [2025-06-11 15:17:43] ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.870355Z","level":"info","event":"📋 2025-06-11 15:17:43,864 - WARNING - ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.870401Z","level":"info","event":"📋 [2025-06-11 15:17:43] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.870446Z","level":"info","event":"📋 2025-06-11 15:17:43,864 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.968058Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.968256Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.968382Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/data/processed/2025/06/11/artigos_vitimas_filtrados_20250611.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.968494Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/data/processed/2025/06/11/artigos_sem_vitimas_20250611.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.968597Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/data/processed/2025/06/11/filtering_log_20250611.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.968684Z","level":"info","event":"⚠️ stats_json: /opt/airflow/data/processed/2025/06/11/filtering_stats_20250611.json (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:43.968793","level":"info","event":"Done. Returned value was: [2025-06-11 15:17:43] Starting filtrar_artigos_vitimas_airflow\n2025-06-11 15:17:43,851 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-11 15:17:43] Parameters: dias=1, date=2025-06-11\n2025-06-11 15:17:43,851 - INFO - Parameters: dias=1, date=2025-06-11\n[2025-06-11 15:17:43] Paths: input_file=/opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv, output_dir=/opt/airflow/data/processed/2025/06/11, date_str=2025-06-11\n2025-06-11 15:17:43,851 - INFO - Paths: input_file=/opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv, output_dir=/opt/airflow/data/processed/2025/06/11, date_str=2025-06-11\n[2025-06-11 15:17:43] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n2025-06-11 15:17:43,851 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n[2025-06-11 15:17:43] 🔍 Path setup:\n2025-06-11 15:17:43,851 - INFO - 🔍 Path setup:\n[2025-06-11 15:17:43]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-11 15:17:43,851 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-11 15:17:43]    Project root: /opt/airflow\n2025-06-11 15:17:43,852 - INFO -    Project root: /opt/airflow\n[2025-06-11 15:17:43] 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/11\n2025-06-11 15:17:43,852 - INFO - 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/11\n[2025-06-11 15:17:43] 📁 Using provided input file: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n2025-06-11 15:17:43,852 - INFO - 📁 Using provided input file: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n[2025-06-11 15:17:43] 📂 Loading articles from: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n2025-06-11 15:17:43,852 - INFO - 📂 Loading articles from: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n[2025-06-11 15:17:43] ==================================================\n2025-06-11 15:17:43,853 - INFO - ==================================================\n[2025-06-11 15:17:43] Enhanced Filtering Started\n2025-06-11 15:17:43,854 - INFO - Enhanced Filtering Started\n[2025-06-11 15:17:43] ==================================================\n2025-06-11 15:17:43,854 - INFO - ==================================================\n[2025-06-11 15:17:43]   Total Articles Loaded: 21\n2025-06-11 15:17:43,854 - INFO -   Total Articles Loaded: 21\n[2025-06-11 15:17:43]   Input File: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n2025-06-11 15:17:43,854 - INFO -   Input File: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n[2025-06-11 15:17:43]   Output File: /opt/airflow/data/processed/2025/06/11/artigos_vitimas_filtrados_2025-06-11.csv\n2025-06-11 15:17:43,854 - INFO -   Output File: /opt/airflow/data/processed/2025/06/11/artigos_vitimas_filtrados_2025-06-11.csv\n[2025-06-11 15:17:43]   Processed Data Directory: /opt/airflow/data/processed/2025/06/11\n2025-06-11 15:17:43,854 - INFO -   Processed Data Directory: /opt/airflow/data/processed/2025/06/11\n[2025-06-11 15:17:43]   Days Filter: 1\n2025-06-11 15:17:43,855 - INFO -   Days Filter: 1\n[2025-06-11 15:17:43] ==================================================\n2025-06-11 15:17:43,855 - INFO - ==================================================\n[2025-06-11 15:17:43] 🔍 Applying enhanced comprehensive filtering logic...\n2025-06-11 15:17:43,855 - INFO - 🔍 Applying enhanced comprehensive filtering logic...\n[2025-06-11 15:17:43] 🔧 Loading configuration data for enhanced filtering...\n2025-06-11 15:17:43,855 - INFO - 🔧 Loading configuration data for enhanced filtering...\n[2025-06-11 15:17:43] 🔍 Looking for config files in multiple paths:\n2025-06-11 15:17:43,855 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-11 15:17:43]    Checking: /opt/airflow/config\n2025-06-11 15:17:43,855 - INFO -    Checking: /opt/airflow/config\n[2025-06-11 15:17:43]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-11 15:17:43,855 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-11 15:17:43]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-11 15:17:43,855 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-11 15:17:43]    Checking: config\n2025-06-11 15:17:43,855 - INFO -    Checking: config\n[2025-06-11 15:17:43] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-11 15:17:43,855 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-11 15:17:43]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-11 15:17:43,855 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-11 15:17:43]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-11 15:17:43,855 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-11 15:17:43] ✅ Loaded municipios config with 29 districts\n2025-06-11 15:17:43,856 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-11 15:17:43] ✅ Loaded eventos config with 14 events\n2025-06-11 15:17:43,857 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-11 15:17:43] 📊 Config summary: 29 districts, 306 parishes\n2025-06-11 15:17:43,857 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-11 15:17:43] 📊 Starting enhanced comprehensive filtering with 21 articles\n2025-06-11 15:17:43,857 - INFO - 📊 Starting enhanced comprehensive filtering with 21 articles\n[2025-06-11 15:17:43] 🇵🇹 Applying enhanced geographic filter...\n2025-06-11 15:17:43,859 - INFO - 🇵🇹 Applying enhanced geographic filter...\n[2025-06-11 15:17:43]    After enhanced geographic filter: 17 articles (removed 4)\n2025-06-11 15:17:43,861 - INFO -    After enhanced geographic filter: 17 articles (removed 4)\n[2025-06-11 15:17:43] ✨ Applying content quality filter...\n2025-06-11 15:17:43,861 - INFO - ✨ Applying content quality filter...\n[2025-06-11 15:17:43]    After quality filter: 6 articles (removed 11)\n2025-06-11 15:17:43,862 - INFO -    After quality filter: 6 articles (removed 11)\n[2025-06-11 15:17:43] 🔍 Applying enhanced keyword filtering...\n2025-06-11 15:17:43,862 - INFO - 🔍 Applying enhanced keyword filtering...\n[2025-06-11 15:17:43]    After enhanced keyword filter: 1 articles (removed 5)\n2025-06-11 15:17:43,862 - INFO -    After enhanced keyword filter: 1 articles (removed 5)\n[2025-06-11 15:17:43] 📅 Applying temporal relevance filter...\n2025-06-11 15:17:43,862 - INFO - 📅 Applying temporal relevance filter...\n[2025-06-11 15:17:43]    After temporal filter: 1 articles (removed 0)\n2025-06-11 15:17:43,862 - INFO -    After temporal filter: 1 articles (removed 0)\n[2025-06-11 15:17:43] 👥 Applying enhanced victim validation...\n2025-06-11 15:17:43,862 - INFO - 👥 Applying enhanced victim validation...\n[2025-06-11 15:17:43]    After victim validation: 0 articles (removed 1)\n2025-06-11 15:17:43,862 - INFO -    After victim validation: 0 articles (removed 1)\n[2025-06-11 15:17:43] ⭐ Calculating enhanced relevance scores...\n2025-06-11 15:17:43,862 - INFO - ⭐ Calculating enhanced relevance scores...\n[2025-06-11 15:17:43]    After relevance score filter (min 2): 0 articles (removed 0)\n2025-06-11 15:17:43,863 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)\n[2025-06-11 15:17:43] 🔄 Removing duplicates with enhanced logic...\n2025-06-11 15:17:43,863 - INFO - 🔄 Removing duplicates with enhanced logic...\n[2025-06-11 15:17:43]    After URL deduplication: 0 articles (removed 0)\n2025-06-11 15:17:43,863 - INFO -    After URL deduplication: 0 articles (removed 0)\n[2025-06-11 15:17:43]    After content similarity deduplication: 0 articles (removed 0)\n2025-06-11 15:17:43,863 - INFO -    After content similarity deduplication: 0 articles (removed 0)\n[2025-06-11 15:17:43] 🌦️ Enhanced climate event identification...\n2025-06-11 15:17:43,864 - INFO - 🌦️ Enhanced climate event identification...\n[2025-06-11 15:17:43] ⚠️ No articles remaining after enhanced filtering.\n2025-06-11 15:17:43,864 - WARNING - ⚠️ No articles remaining after enhanced filtering.\n[2025-06-11 15:17:43] ✅ Filtering completed. Found 0 articles with victims\n2025-06-11 15:17:43,864 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
