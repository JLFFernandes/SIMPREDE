{"timestamp":"2025-06-11T14:17:45.016767","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-11T14:17:45.017128","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-11T14:17:45.049627Z","level":"info","event":"ğŸ”„ Starting export_supabase task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.049860Z","level":"info","event":"ğŸ“… Using current date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.050193Z","level":"info","event":"ğŸ“ Ensured directories exist: ['/opt/airflow/data/raw/2025/06/11', '/opt/airflow/data/structured/2025/06/11', '/opt/airflow/data/processed/2025/06/11']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.050244Z","level":"info","event":"ğŸ“… Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.050293Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.050336Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.050373Z","level":"info","event":"  - Target date: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.050409Z","level":"info","event":"  - Database table: artigos_filtrados_20250611_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.050444Z","level":"info","event":"ğŸ“ Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.056911Z","level":"info","event":"ğŸ“‹ Found 2 files from processar task via XCom","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.057001Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/data/processed/2025/06/11/artigos_vitimas_filtrados_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.057461Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/data/processed/2025/06/11/artigos_sem_vitimas_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.057525Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.057737Z","level":"info","event":"âœ… Found file: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv (5553 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.057843Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.057925Z","level":"info","event":"âœ… Found file: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv (5553 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.057980Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.058031Z","level":"info","event":"âœ… Found file: /opt/airflow/data/structured/2025/06/11/processing_stats_20250611.json (393 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.058086Z","level":"info","event":"ğŸ“‹ Selected input file: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv (5553 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.058139Z","level":"info","event":"ğŸ“Š Processing all relevant disaster-related articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.058191Z","level":"info","event":"ğŸ“ Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.058244Z","level":"info","event":"  - export_log: /opt/airflow/data/processed/2025/06/11/export_log_20250611.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.058320Z","level":"info","event":"  - export_stats: /opt/airflow/data/processed/2025/06/11/export_stats_20250611.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.058363Z","level":"info","event":"  - backup_csv: /opt/airflow/data/processed/2025/06/11/export_backup_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.058403Z","level":"info","event":"ğŸ”„ Running export command: python /opt/airflow/scripts/google_scraper/exportador_bd/export_to_supabase_airflow.py --output_dir /opt/airflow/data/processed/2025/06/11 --date_str 2025-06-11 --input_file /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv --date 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.058467Z","level":"info","event":"â° Waiting for export completion with timeout: 600 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.930660Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45] A iniciar export_to_supabase_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.931129Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,930 - INFO - A iniciar export_to_supabase_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.931880Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45] ParÃ¢metros: date=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.932408Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,930 - INFO - ParÃ¢metros: date=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.932855Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45] Caminhos: input_file=/opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv, output_dir=/opt/airflow/data/processed/2025/06/11, date_str=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.932944Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,930 - INFO - Caminhos: input_file=/opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv, output_dir=/opt/airflow/data/processed/2025/06/11, date_str=2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.933018Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45] ğŸš€ A iniciar exportaÃ§Ã£o para Supabase para a data: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.933076Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,930 - INFO - ğŸš€ A iniciar exportaÃ§Ã£o para Supabase para a data: 2025-06-11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.933120Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45] ğŸ“‹ Tabela de destino: artigos_filtrados_20250611_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.933159Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,930 - INFO - ğŸ“‹ Tabela de destino: artigos_filtrados_20250611_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.933204Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45] ğŸ“ A usar diretÃ³rio de saÃ­da controlado: /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.933616Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,930 - INFO - ğŸ“ A usar diretÃ³rio de saÃ­da controlado: /opt/airflow/data/processed/2025/06/11","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.933729Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45] âœ… A usar ficheiro de entrada fornecido: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.934065Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,930 - INFO - âœ… A usar ficheiro de entrada fornecido: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.934180Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45] ğŸ“‚ A carregar artigos de: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.934637Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,930 - INFO - ğŸ“‚ A carregar artigos de: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.934774Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45] ğŸ“Š Carregados 21 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.934844Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,932 - INFO - ğŸ“Š Carregados 21 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.934916Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45] ğŸ“‹ A processar todos os artigos relevantes relacionados com desastres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.934969Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,932 - INFO - ğŸ“‹ A processar todos os artigos relevantes relacionados com desastres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935015Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45] ğŸ” VerificaÃ§Ã£o inicial do ambiente...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935063Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,932 - INFO - ğŸ” VerificaÃ§Ã£o inicial do ambiente...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935103Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45]   DB_HOST do ambiente: ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935140Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,932 - INFO -   DB_HOST do ambiente: ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935176Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45]   DB_USER do ambiente: ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935213Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,932 - INFO -   DB_USER do ambiente: ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935251Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45]   DB_PASSWORD do ambiente: ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935288Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,932 - INFO -   DB_PASSWORD do ambiente: ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935326Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45] ğŸ” VerificaÃ§Ã£o final da configuraÃ§Ã£o...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935361Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,932 - INFO - ğŸ” VerificaÃ§Ã£o final da configuraÃ§Ã£o...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935397Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45]   DB_HOST: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935435Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,932 - INFO -   DB_HOST: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935471Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45]   DB_USER: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935508Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,932 - INFO -   DB_USER: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935543Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45]   DB_PASSWORD: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935616Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,932 - INFO -   DB_PASSWORD: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935669Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45]   DB_PORT: 6543","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935715Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,932 - INFO -   DB_PORT: 6543","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935761Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45]   DB_NAME: postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935811Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,932 - INFO -   DB_NAME: postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.935996Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45]   DB_SCHEMA: google_scraper","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.936077Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,932 - INFO -   DB_SCHEMA: google_scraper","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.936141Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45] âœ… ConfiguraÃ§Ã£o da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.936186Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,932 - INFO - âœ… ConfiguraÃ§Ã£o da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.936227Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:45] ğŸ”— A conectar Ã  base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:45.936290Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:45,932 - INFO - ğŸ”— A conectar Ã  base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:46.229609Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:46] âœ… Conectado Ã  base de dados com sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:46.230528Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:46,229 - INFO - âœ… Conectado Ã  base de dados com sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:46.274155Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:46] ğŸ—‘ï¸ Tabela existente google_scraper.artigos_filtrados_20250611_staging eliminada se existia","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:46.274659Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:46,273 - INFO - ğŸ—‘ï¸ Tabela existente google_scraper.artigos_filtrados_20250611_staging eliminada se existia","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:46.345300Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:46] âœ… Tabela google_scraper.artigos_filtrados_20250611_staging criada com esquema correto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:46.345762Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:46,344 - INFO - âœ… Tabela google_scraper.artigos_filtrados_20250611_staging criada com esquema correto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:46.437417Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:46] âœ… Ãndices criados para a tabela google_scraper.artigos_filtrados_20250611_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:46.440963Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:46,435 - INFO - âœ… Ãndices criados para a tabela google_scraper.artigos_filtrados_20250611_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:46.443887Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:46] ğŸ”§ A preparar dataframe para inserÃ§Ã£o na base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:46.444272Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:46,435 - INFO - ğŸ”§ A preparar dataframe para inserÃ§Ã£o na base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:46.444445Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:46] ğŸ“… A converter formatos de data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:46.444776Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:46,436 - INFO - ğŸ“… A converter formatos de data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:46.445186Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:46] âœ… Preparadas 21 linhas para inserÃ§Ã£o","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:46.445460Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:46,443 - INFO - âœ… Preparadas 21 linhas para inserÃ§Ã£o","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.327798Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:47] âœ… Inseridos/atualizados 21 artigos (falharam: 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.328937Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:47,327 - INFO - âœ… Inseridos/atualizados 21 artigos (falharam: 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.343666Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:47] ğŸ’¾ Backup de exportaÃ§Ã£o guardado: /opt/airflow/data/processed/2025/06/11/export_backup_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.344015Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:47,343 - INFO - ğŸ’¾ Backup de exportaÃ§Ã£o guardado: /opt/airflow/data/processed/2025/06/11/export_backup_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.346111Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:47] âœ… EstatÃ­sticas de exportaÃ§Ã£o guardadas: /opt/airflow/data/processed/2025/06/11/export_stats_20250611.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.348040Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:47,345 - INFO - âœ… EstatÃ­sticas de exportaÃ§Ã£o guardadas: /opt/airflow/data/processed/2025/06/11/export_stats_20250611.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.349982Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:47] ğŸ“‹ LocalizaÃ§Ã£o de backup de exportaÃ§Ã£o preparada: /opt/airflow/data/processed/2025/06/11/export_backup_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.350971Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:47,345 - INFO - ğŸ“‹ LocalizaÃ§Ã£o de backup de exportaÃ§Ã£o preparada: /opt/airflow/data/processed/2025/06/11/export_backup_20250611.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.351126Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:47] âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Inseridos/atualizados 21 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250611_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.351239Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:47,345 - INFO - âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Inseridos/atualizados 21 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250611_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.351330Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:47] ğŸ”— LigaÃ§Ã£o Ã  base de dados fechada","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.351441Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:47,345 - INFO - ğŸ”— LigaÃ§Ã£o Ã  base de dados fechada","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.351591Z","level":"info","event":"ğŸ“‹ [2025-06-11 15:17:47] âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Processados 21 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.351715Z","level":"info","event":"ğŸ“‹ 2025-06-11 15:17:47,346 - INFO - âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Processados 21 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.410234Z","level":"info","event":"âœ… Export completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.410445Z","level":"info","event":"ğŸ” Verifying export outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.410597Z","level":"info","event":"âš ï¸ export_log: /opt/airflow/data/processed/2025/06/11/export_log_20250611.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.410792Z","level":"info","event":"âœ… export_stats: /opt/airflow/data/processed/2025/06/11/export_stats_20250611.json (885 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.410877Z","level":"info","event":"âœ… backup_csv: /opt/airflow/data/processed/2025/06/11/export_backup_20250611.csv (5538 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-11T14:17:47.411206","level":"info","event":"Done. Returned value was: [2025-06-11 15:17:45] A iniciar export_to_supabase_airflow\n2025-06-11 15:17:45,930 - INFO - A iniciar export_to_supabase_airflow\n[2025-06-11 15:17:45] ParÃ¢metros: date=2025-06-11\n2025-06-11 15:17:45,930 - INFO - ParÃ¢metros: date=2025-06-11\n[2025-06-11 15:17:45] Caminhos: input_file=/opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv, output_dir=/opt/airflow/data/processed/2025/06/11, date_str=2025-06-11\n2025-06-11 15:17:45,930 - INFO - Caminhos: input_file=/opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv, output_dir=/opt/airflow/data/processed/2025/06/11, date_str=2025-06-11\n[2025-06-11 15:17:45] ğŸš€ A iniciar exportaÃ§Ã£o para Supabase para a data: 2025-06-11\n2025-06-11 15:17:45,930 - INFO - ğŸš€ A iniciar exportaÃ§Ã£o para Supabase para a data: 2025-06-11\n[2025-06-11 15:17:45] ğŸ“‹ Tabela de destino: artigos_filtrados_20250611_staging\n2025-06-11 15:17:45,930 - INFO - ğŸ“‹ Tabela de destino: artigos_filtrados_20250611_staging\n[2025-06-11 15:17:45] ğŸ“ A usar diretÃ³rio de saÃ­da controlado: /opt/airflow/data/processed/2025/06/11\n2025-06-11 15:17:45,930 - INFO - ğŸ“ A usar diretÃ³rio de saÃ­da controlado: /opt/airflow/data/processed/2025/06/11\n[2025-06-11 15:17:45] âœ… A usar ficheiro de entrada fornecido: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n2025-06-11 15:17:45,930 - INFO - âœ… A usar ficheiro de entrada fornecido: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n[2025-06-11 15:17:45] ğŸ“‚ A carregar artigos de: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n2025-06-11 15:17:45,930 - INFO - ğŸ“‚ A carregar artigos de: /opt/airflow/data/structured/2025/06/11/artigos_google_municipios_pt_2025-06-11.csv\n[2025-06-11 15:17:45] ğŸ“Š Carregados 21 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']\n2025-06-11 15:17:45,932 - INFO - ğŸ“Š Carregados 21 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']\n[2025-06-11 15:17:45] ğŸ“‹ A processar todos os artigos relevantes relacionados com desastres\n2025-06-11 15:17:45,932 - INFO - ğŸ“‹ A processar todos os artigos relevantes relacionados com desastres\n[2025-06-11 15:17:45] ğŸ” VerificaÃ§Ã£o inicial do ambiente...\n2025-06-11 15:17:45,932 - INFO - ğŸ” VerificaÃ§Ã£o inicial do ambiente...\n[2025-06-11 15:17:45]   DB_HOST do ambiente: ENCONTRADO\n2025-06-11 15:17:45,932 - INFO -   DB_HOST do ambiente: ENCONTRADO\n[2025-06-11 15:17:45]   DB_USER do ambiente: ENCONTRADO\n2025-06-11 15:17:45,932 - INFO -   DB_USER do ambiente: ENCONTRADO\n[2025-06-11 15:17:45]   DB_PASSWORD do ambiente: ENCONTRADO\n2025-06-11 15:17:45,932 - INFO -   DB_PASSWORD do ambiente: ENCONTRADO\n[2025-06-11 15:17:45] ğŸ” VerificaÃ§Ã£o final da configuraÃ§Ã£o...\n2025-06-11 15:17:45,932 - INFO - ğŸ” VerificaÃ§Ã£o final da configuraÃ§Ã£o...\n[2025-06-11 15:17:45]   DB_HOST: DEFINIDO\n2025-06-11 15:17:45,932 - INFO -   DB_HOST: DEFINIDO\n[2025-06-11 15:17:45]   DB_USER: DEFINIDO\n2025-06-11 15:17:45,932 - INFO -   DB_USER: DEFINIDO\n[2025-06-11 15:17:45]   DB_PASSWORD: DEFINIDO\n2025-06-11 15:17:45,932 - INFO -   DB_PASSWORD: DEFINIDO\n[2025-06-11 15:17:45]   DB_PORT: 6543\n2025-06-11 15:17:45,932 - INFO -   DB_PORT: 6543\n[2025-06-11 15:17:45]   DB_NAME: postgres\n2025-06-11 15:17:45,932 - INFO -   DB_NAME: postgres\n[2025-06-11 15:17:45]   DB_SCHEMA: google_scraper\n2025-06-11 15:17:45,932 - INFO -   DB_SCHEMA: google_scraper\n[2025-06-11 15:17:45] âœ… ConfiguraÃ§Ã£o da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres\n2025-06-11 15:17:45,932 - INFO - âœ… ConfiguraÃ§Ã£o da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres\n[2025-06-11 15:17:45] ğŸ”— A conectar Ã  base de dados...\n2025-06-11 15:17:45,932 - INFO - ğŸ”— A conectar Ã  base de dados...\n[2025-06-11 15:17:46] âœ… Conectado Ã  base de dados com sucesso\n2025-06-11 15:17:46,229 - INFO - âœ… Conectado Ã  base de dados com sucesso\n[2025-06-11 15:17:46] ğŸ—‘ï¸ Tabela existente google_scraper.artigos_filtrados_20250611_staging eliminada se existia\n2025-06-11 15:17:46,273 - INFO - ğŸ—‘ï¸ Tabela existente google_scraper.artigos_filtrados_20250611_staging eliminada se existia\n[2025-06-11 15:17:46] âœ… Tabela google_scraper.artigos_filtrados_20250611_staging criada com esquema correto\n2025-06-11 15:17:46,344 - INFO - âœ… Tabela google_scraper.artigos_filtrados_20250611_staging criada com esquema correto\n[2025-06-11 15:17:46] âœ… Ãndices criados para a tabela google_scraper.artigos_filtrados_20250611_staging\n2025-06-11 15:17:46,435 - INFO - âœ… Ãndices criados para a tabela google_scraper.artigos_filtrados_20250611_staging\n[2025-06-11 15:17:46] ğŸ”§ A preparar dataframe para inserÃ§Ã£o na base de dados...\n2025-06-11 15:17:46,435 - INFO - ğŸ”§ A preparar dataframe para inserÃ§Ã£o na base de dados...\n[2025-06-11 15:17:46] ğŸ“… A converter formatos de data...\n2025-06-11 15:17:46,436 - INFO - ğŸ“… A converter formatos de data...\n[2025-06-11 15:17:46] âœ… Preparadas 21 linhas para inserÃ§Ã£o\n2025-06-11 15:17:46,443 - INFO - âœ… Preparadas 21 linhas para inserÃ§Ã£o\n[2025-06-11 15:17:47] âœ… Inseridos/atualizados 21 artigos (falharam: 0)\n2025-06-11 15:17:47,327 - INFO - âœ… Inseridos/atualizados 21 artigos (falharam: 0)\n[2025-06-11 15:17:47] ğŸ’¾ Backup de exportaÃ§Ã£o guardado: /opt/airflow/data/processed/2025/06/11/export_backup_20250611.csv\n2025-06-11 15:17:47,343 - INFO - ğŸ’¾ Backup de exportaÃ§Ã£o guardado: /opt/airflow/data/processed/2025/06/11/export_backup_20250611.csv\n[2025-06-11 15:17:47] âœ… EstatÃ­sticas de exportaÃ§Ã£o guardadas: /opt/airflow/data/processed/2025/06/11/export_stats_20250611.json\n2025-06-11 15:17:47,345 - INFO - âœ… EstatÃ­sticas de exportaÃ§Ã£o guardadas: /opt/airflow/data/processed/2025/06/11/export_stats_20250611.json\n[2025-06-11 15:17:47] ğŸ“‹ LocalizaÃ§Ã£o de backup de exportaÃ§Ã£o preparada: /opt/airflow/data/processed/2025/06/11/export_backup_20250611.csv\n2025-06-11 15:17:47,345 - INFO - ğŸ“‹ LocalizaÃ§Ã£o de backup de exportaÃ§Ã£o preparada: /opt/airflow/data/processed/2025/06/11/export_backup_20250611.csv\n[2025-06-11 15:17:47] âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Inseridos/atualizados 21 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250611_staging\n2025-06-11 15:17:47,345 - INFO - âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Inseridos/atualizados 21 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250611_staging\n[2025-06-11 15:17:47] ğŸ”— LigaÃ§Ã£o Ã  base de dados fechada\n2025-06-11 15:17:47,345 - INFO - ğŸ”— LigaÃ§Ã£o Ã  base de dados fechada\n[2025-06-11 15:17:47] âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Processados 21 artigos\n2025-06-11 15:17:47,346 - INFO - âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Processados 21 artigos\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
