{"timestamp":"2025-06-05T17:38:18.066434","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T17:38:18.066832","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T17:38:18.094038Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:18.094263Z","level":"info","event":"📁 Using paths from processar task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:18.096582Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:18.096969Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:18.097090Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:18.097161Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:18.097233Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:18.097294Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:18.097364Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:18.100784Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:18.100911Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:18.101001Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:18.101267Z","level":"info","event":"  - victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:18.101404Z","level":"info","event":"  - no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:18.101472Z","level":"info","event":"  - filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:18.101539Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:18.101595Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv --output_dir /opt/airflow/scripts/google_scraper/data/processed/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:18.101683Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.287986Z","level":"info","event":"📋 [2025-06-05 18:38:19] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.288370Z","level":"info","event":"📋 2025-06-05 18:38:19,287 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.288952Z","level":"info","event":"📋 [2025-06-05 18:38:19] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.289029Z","level":"info","event":"📋 2025-06-05 18:38:19,287 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.289089Z","level":"info","event":"📋 [2025-06-05 18:38:19] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.289754Z","level":"info","event":"📋 2025-06-05 18:38:19,287 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.290057Z","level":"info","event":"📋 [2025-06-05 18:38:19] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.290125Z","level":"info","event":"📋 2025-06-05 18:38:19,287 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.290176Z","level":"info","event":"📋 [2025-06-05 18:38:19] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.290227Z","level":"info","event":"📋 2025-06-05 18:38:19,288 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.290276Z","level":"info","event":"📋 [2025-06-05 18:38:19]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.290345Z","level":"info","event":"📋 2025-06-05 18:38:19,288 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.290692Z","level":"info","event":"📋 [2025-06-05 18:38:19]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.290798Z","level":"info","event":"📋 2025-06-05 18:38:19,288 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.290850Z","level":"info","event":"📋 [2025-06-05 18:38:19] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.290928Z","level":"info","event":"📋 2025-06-05 18:38:19,288 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.291115Z","level":"info","event":"📋 [2025-06-05 18:38:19] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.291179Z","level":"info","event":"📋 2025-06-05 18:38:19,288 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.291245Z","level":"info","event":"📋 [2025-06-05 18:38:19] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.291689Z","level":"info","event":"📋 2025-06-05 18:38:19,288 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.291764Z","level":"info","event":"📋 [2025-06-05 18:38:19] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.291852Z","level":"info","event":"📋 2025-06-05 18:38:19,290 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.291932Z","level":"info","event":"📋 [2025-06-05 18:38:19] Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.292004Z","level":"info","event":"📋 2025-06-05 18:38:19,290 - INFO - Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.292819Z","level":"info","event":"📋 [2025-06-05 18:38:19] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.293733Z","level":"info","event":"📋 2025-06-05 18:38:19,290 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.294829Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Total Articles Loaded: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.295721Z","level":"info","event":"📋 2025-06-05 18:38:19,290 - INFO -   Total Articles Loaded: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.298738Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.298807Z","level":"info","event":"📋 2025-06-05 18:38:19,290 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.298850Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.298891Z","level":"info","event":"📋 2025-06-05 18:38:19,290 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.298929Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.298964Z","level":"info","event":"📋 2025-06-05 18:38:19,290 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299000Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299034Z","level":"info","event":"📋 2025-06-05 18:38:19,290 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299068Z","level":"info","event":"📋 [2025-06-05 18:38:19] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299102Z","level":"info","event":"📋 2025-06-05 18:38:19,290 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299136Z","level":"info","event":"📋 [2025-06-05 18:38:19] 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299169Z","level":"info","event":"📋 2025-06-05 18:38:19,290 - INFO - 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299206Z","level":"info","event":"📋 [2025-06-05 18:38:19] 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299240Z","level":"info","event":"📋 2025-06-05 18:38:19,290 - INFO - 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299297Z","level":"info","event":"📋 [2025-06-05 18:38:19] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299330Z","level":"info","event":"📋 2025-06-05 18:38:19,290 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299365Z","level":"info","event":"📋 [2025-06-05 18:38:19]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299401Z","level":"info","event":"📋 2025-06-05 18:38:19,290 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299437Z","level":"info","event":"📋 [2025-06-05 18:38:19]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299471Z","level":"info","event":"📋 2025-06-05 18:38:19,290 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299504Z","level":"info","event":"📋 [2025-06-05 18:38:19]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299542Z","level":"info","event":"📋 2025-06-05 18:38:19,290 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299574Z","level":"info","event":"📋 [2025-06-05 18:38:19]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299606Z","level":"info","event":"📋 2025-06-05 18:38:19,290 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299638Z","level":"info","event":"📋 [2025-06-05 18:38:19] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299670Z","level":"info","event":"📋 2025-06-05 18:38:19,291 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299709Z","level":"info","event":"📋 [2025-06-05 18:38:19]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299741Z","level":"info","event":"📋 2025-06-05 18:38:19,291 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299774Z","level":"info","event":"📋 [2025-06-05 18:38:19]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299832Z","level":"info","event":"📋 2025-06-05 18:38:19,291 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.299866Z","level":"info","event":"📋 [2025-06-05 18:38:19] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.300753Z","level":"info","event":"📋 2025-06-05 18:38:19,291 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.301805Z","level":"info","event":"📋 [2025-06-05 18:38:19] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.301872Z","level":"info","event":"📋 2025-06-05 18:38:19,292 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.301916Z","level":"info","event":"📋 [2025-06-05 18:38:19] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.301980Z","level":"info","event":"📋 2025-06-05 18:38:19,292 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302016Z","level":"info","event":"📋 [2025-06-05 18:38:19] 📊 Starting enhanced comprehensive filtering with 7 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302052Z","level":"info","event":"📋 2025-06-05 18:38:19,292 - INFO - 📊 Starting enhanced comprehensive filtering with 7 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302086Z","level":"info","event":"📋 [2025-06-05 18:38:19] 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302121Z","level":"info","event":"📋 2025-06-05 18:38:19,293 - INFO - 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302155Z","level":"info","event":"📋 [2025-06-05 18:38:19]    After enhanced geographic filter: 7 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302190Z","level":"info","event":"📋 2025-06-05 18:38:19,294 - INFO -    After enhanced geographic filter: 7 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302224Z","level":"info","event":"📋 [2025-06-05 18:38:19] ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302259Z","level":"info","event":"📋 2025-06-05 18:38:19,294 - INFO - ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302296Z","level":"info","event":"📋 [2025-06-05 18:38:19]    After quality filter: 6 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302331Z","level":"info","event":"📋 2025-06-05 18:38:19,294 - INFO -    After quality filter: 6 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302366Z","level":"info","event":"📋 [2025-06-05 18:38:19] 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302402Z","level":"info","event":"📋 2025-06-05 18:38:19,294 - INFO - 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302435Z","level":"info","event":"📋 [2025-06-05 18:38:19]    After enhanced keyword filter: 1 articles (removed 5)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302468Z","level":"info","event":"📋 2025-06-05 18:38:19,294 - INFO -    After enhanced keyword filter: 1 articles (removed 5)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302501Z","level":"info","event":"📋 [2025-06-05 18:38:19] 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302533Z","level":"info","event":"📋 2025-06-05 18:38:19,295 - INFO - 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302566Z","level":"info","event":"📋 [2025-06-05 18:38:19]    After temporal filter: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302598Z","level":"info","event":"📋 2025-06-05 18:38:19,295 - INFO -    After temporal filter: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302631Z","level":"info","event":"📋 [2025-06-05 18:38:19] 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302664Z","level":"info","event":"📋 2025-06-05 18:38:19,295 - INFO - 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302705Z","level":"info","event":"📋 [2025-06-05 18:38:19]    After victim validation: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302739Z","level":"info","event":"📋 2025-06-05 18:38:19,295 - INFO -    After victim validation: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302793Z","level":"info","event":"📋 [2025-06-05 18:38:19] ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302827Z","level":"info","event":"📋 2025-06-05 18:38:19,295 - INFO - ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302860Z","level":"info","event":"📋 [2025-06-05 18:38:19]    After relevance score filter (min 2): 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302893Z","level":"info","event":"📋 2025-06-05 18:38:19,296 - INFO -    After relevance score filter (min 2): 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302926Z","level":"info","event":"📋 [2025-06-05 18:38:19] 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302958Z","level":"info","event":"📋 2025-06-05 18:38:19,296 - INFO - 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.302991Z","level":"info","event":"📋 [2025-06-05 18:38:19]    After URL deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.303023Z","level":"info","event":"📋 2025-06-05 18:38:19,296 - INFO -    After URL deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.303061Z","level":"info","event":"📋 [2025-06-05 18:38:19]    After content similarity deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.303111Z","level":"info","event":"📋 2025-06-05 18:38:19,297 - INFO -    After content similarity deduplication: 1 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.303168Z","level":"info","event":"📋 [2025-06-05 18:38:19] 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.303208Z","level":"info","event":"📋 2025-06-05 18:38:19,297 - INFO - 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.308427Z","level":"info","event":"📋 [2025-06-05 18:38:19] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.308669Z","level":"info","event":"📋 2025-06-05 18:38:19,308 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.308793Z","level":"info","event":"📋 [2025-06-05 18:38:19] Enhanced Filtering Results","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.308888Z","level":"info","event":"📋 2025-06-05 18:38:19,308 - INFO - Enhanced Filtering Results","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.309046Z","level":"info","event":"📋 [2025-06-05 18:38:19] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.309152Z","level":"info","event":"📋 2025-06-05 18:38:19,308 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.309247Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Articles After Enhanced Filters: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.309318Z","level":"info","event":"📋 2025-06-05 18:38:19,308 - INFO -   Articles After Enhanced Filters: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.309383Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Articles with Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.309470Z","level":"info","event":"📋 2025-06-05 18:38:19,308 - INFO -   Articles with Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.309545Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Articles without Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.309665Z","level":"info","event":"📋 2025-06-05 18:38:19,308 - INFO -   Articles without Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.309788Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Total Fatalities: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.310092Z","level":"info","event":"📋 2025-06-05 18:38:19,308 - INFO -   Total Fatalities: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.310168Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Total Injured: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.310223Z","level":"info","event":"📋 2025-06-05 18:38:19,308 - INFO -   Total Injured: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.310298Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Total Evacuated: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.310358Z","level":"info","event":"📋 2025-06-05 18:38:19,308 - INFO -   Total Evacuated: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.310415Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Total Displaced: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.310525Z","level":"info","event":"📋 2025-06-05 18:38:19,308 - INFO -   Total Displaced: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.310627Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Total Missing: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.310733Z","level":"info","event":"📋 2025-06-05 18:38:19,308 - INFO -   Total Missing: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.310945Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Average Relevance Score: 6.00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.310988Z","level":"info","event":"📋 2025-06-05 18:38:19,308 - INFO -   Average Relevance Score: 6.00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.312734Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Top Event Types: {'desconhecido': 1}","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.313711Z","level":"info","event":"📋 2025-06-05 18:38:19,308 - INFO -   Top Event Types: {'desconhecido': 1}","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.313769Z","level":"info","event":"📋 [2025-06-05 18:38:19] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.313807Z","level":"info","event":"📋 2025-06-05 18:38:19,308 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.313840Z","level":"info","event":"📋 [2025-06-05 18:38:19] 💾 Saving enhanced filtered articles...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.313874Z","level":"info","event":"📋 2025-06-05 18:38:19,308 - INFO - 💾 Saving enhanced filtered articles...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.313906Z","level":"info","event":"📋 📥 Novos artigos recebidos: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.313963Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.313999Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314034Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314067Z","level":"info","event":"📋 💾 Guardados 1 artigos no arquivo /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314128Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314164Z","level":"info","event":"📋 📥 Novos artigos recebidos: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314198Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_vitimas_filtrados.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314232Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314267Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314299Z","level":"info","event":"📋 💾 Guardados 1 artigos no arquivo /opt/airflow/data/structured/2025/06/05/artigos_vitimas_filtrados.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314331Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/structured/2025/06/05/artigos_vitimas_filtrados.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314364Z","level":"info","event":"📋 [2025-06-05 18:38:19] ✅ Filtered articles with victims saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314397Z","level":"info","event":"📋 2025-06-05 18:38:19,310 - INFO - ✅ Filtered articles with victims saved: 1 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314431Z","level":"info","event":"📋 [2025-06-05 18:38:19] ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314466Z","level":"info","event":"📋 2025-06-05 18:38:19,311 - INFO - ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314500Z","level":"info","event":"📋 [2025-06-05 18:38:19] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314532Z","level":"info","event":"📋 2025-06-05 18:38:19,311 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314564Z","level":"info","event":"📋 [2025-06-05 18:38:19] Enhanced Filtering Completed Successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314596Z","level":"info","event":"📋 2025-06-05 18:38:19,311 - INFO - Enhanced Filtering Completed Successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314628Z","level":"info","event":"📋 [2025-06-05 18:38:19] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314659Z","level":"info","event":"📋 2025-06-05 18:38:19,311 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314692Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Articles with Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314730Z","level":"info","event":"📋 2025-06-05 18:38:19,311 - INFO -   Articles with Victims: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314765Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Articles without Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314797Z","level":"info","event":"📋 2025-06-05 18:38:19,311 - INFO -   Articles without Victims: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314832Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Total Articles Processed: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314891Z","level":"info","event":"📋 2025-06-05 18:38:19,311 - INFO -   Total Articles Processed: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314923Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Enhanced Filter Rate: 14.3%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314955Z","level":"info","event":"📋 2025-06-05 18:38:19,311 - INFO -   Enhanced Filter Rate: 14.3%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.314987Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Victim Rate: 100.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.315020Z","level":"info","event":"📋 2025-06-05 18:38:19,311 - INFO -   Victim Rate: 100.0%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.315052Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.315085Z","level":"info","event":"📋 2025-06-05 18:38:19,311 - INFO -   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.315119Z","level":"info","event":"📋 [2025-06-05 18:38:19]   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.315153Z","level":"info","event":"📋 2025-06-05 18:38:19,311 - INFO -   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.316756Z","level":"info","event":"📋 [2025-06-05 18:38:19] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.317710Z","level":"info","event":"📋 2025-06-05 18:38:19,311 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.317768Z","level":"info","event":"📋 [2025-06-05 18:38:19] ✅ Filtering completed. Found 1 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.317803Z","level":"info","event":"📋 2025-06-05 18:38:19,311 - INFO - ✅ Filtering completed. Found 1 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.415111Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.415388Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.415546Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.415710Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_sem_vitimas_20250605.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.415799Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.415910Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json (418 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:19.416149","level":"info","event":"Done. Returned value was: [2025-06-05 18:38:19] Starting filtrar_artigos_vitimas_airflow\n2025-06-05 18:38:19,287 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-05 18:38:19] Parameters: dias=1, date=2025-06-05\n2025-06-05 18:38:19,287 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 18:38:19] Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n2025-06-05 18:38:19,287 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv, output_dir=/opt/airflow/scripts/google_scraper/data/processed/2025/06/05, date_str=2025-06-05\n[2025-06-05 18:38:19] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n2025-06-05 18:38:19,287 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n[2025-06-05 18:38:19] 🔍 Path setup:\n2025-06-05 18:38:19,288 - INFO - 🔍 Path setup:\n[2025-06-05 18:38:19]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-05 18:38:19,288 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-05 18:38:19]    Project root: /opt/airflow\n2025-06-05 18:38:19,288 - INFO -    Project root: /opt/airflow\n[2025-06-05 18:38:19] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 18:38:19,288 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 18:38:19] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:38:19,288 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:38:19] 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:38:19,288 - INFO - 📂 Loading articles from: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:38:19] ==================================================\n2025-06-05 18:38:19,290 - INFO - ==================================================\n[2025-06-05 18:38:19] Enhanced Filtering Started\n2025-06-05 18:38:19,290 - INFO - Enhanced Filtering Started\n[2025-06-05 18:38:19] ==================================================\n2025-06-05 18:38:19,290 - INFO - ==================================================\n[2025-06-05 18:38:19]   Total Articles Loaded: 7\n2025-06-05 18:38:19,290 - INFO -   Total Articles Loaded: 7\n[2025-06-05 18:38:19]   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:38:19,290 - INFO -   Input File: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:38:19]   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 18:38:19,290 - INFO -   Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 18:38:19]   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n2025-06-05 18:38:19,290 - INFO -   Processed Data Directory: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05\n[2025-06-05 18:38:19]   Days Filter: 1\n2025-06-05 18:38:19,290 - INFO -   Days Filter: 1\n[2025-06-05 18:38:19] ==================================================\n2025-06-05 18:38:19,290 - INFO - ==================================================\n[2025-06-05 18:38:19] 🔍 Applying enhanced comprehensive filtering logic...\n2025-06-05 18:38:19,290 - INFO - 🔍 Applying enhanced comprehensive filtering logic...\n[2025-06-05 18:38:19] 🔧 Loading configuration data for enhanced filtering...\n2025-06-05 18:38:19,290 - INFO - 🔧 Loading configuration data for enhanced filtering...\n[2025-06-05 18:38:19] 🔍 Looking for config files in multiple paths:\n2025-06-05 18:38:19,290 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-05 18:38:19]    Checking: /opt/airflow/config\n2025-06-05 18:38:19,290 - INFO -    Checking: /opt/airflow/config\n[2025-06-05 18:38:19]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-05 18:38:19,290 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-05 18:38:19]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-05 18:38:19,290 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 18:38:19]    Checking: config\n2025-06-05 18:38:19,290 - INFO -    Checking: config\n[2025-06-05 18:38:19] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-05 18:38:19,291 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-05 18:38:19]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-05 18:38:19,291 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-05 18:38:19]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-05 18:38:19,291 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-05 18:38:19] ✅ Loaded municipios config with 29 districts\n2025-06-05 18:38:19,291 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-05 18:38:19] ✅ Loaded eventos config with 14 events\n2025-06-05 18:38:19,292 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-05 18:38:19] 📊 Config summary: 29 districts, 306 parishes\n2025-06-05 18:38:19,292 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-05 18:38:19] 📊 Starting enhanced comprehensive filtering with 7 articles\n2025-06-05 18:38:19,292 - INFO - 📊 Starting enhanced comprehensive filtering with 7 articles\n[2025-06-05 18:38:19] 🇵🇹 Applying enhanced geographic filter...\n2025-06-05 18:38:19,293 - INFO - 🇵🇹 Applying enhanced geographic filter...\n[2025-06-05 18:38:19]    After enhanced geographic filter: 7 articles (removed 0)\n2025-06-05 18:38:19,294 - INFO -    After enhanced geographic filter: 7 articles (removed 0)\n[2025-06-05 18:38:19] ✨ Applying content quality filter...\n2025-06-05 18:38:19,294 - INFO - ✨ Applying content quality filter...\n[2025-06-05 18:38:19]    After quality filter: 6 articles (removed 1)\n2025-06-05 18:38:19,294 - INFO -    After quality filter: 6 articles (removed 1)\n[2025-06-05 18:38:19] 🔍 Applying enhanced keyword filtering...\n2025-06-05 18:38:19,294 - INFO - 🔍 Applying enhanced keyword filtering...\n[2025-06-05 18:38:19]    After enhanced keyword filter: 1 articles (removed 5)\n2025-06-05 18:38:19,294 - INFO -    After enhanced keyword filter: 1 articles (removed 5)\n[2025-06-05 18:38:19] 📅 Applying temporal relevance filter...\n2025-06-05 18:38:19,295 - INFO - 📅 Applying temporal relevance filter...\n[2025-06-05 18:38:19]    After temporal filter: 1 articles (removed 0)\n2025-06-05 18:38:19,295 - INFO -    After temporal filter: 1 articles (removed 0)\n[2025-06-05 18:38:19] 👥 Applying enhanced victim validation...\n2025-06-05 18:38:19,295 - INFO - 👥 Applying enhanced victim validation...\n[2025-06-05 18:38:19]    After victim validation: 1 articles (removed 0)\n2025-06-05 18:38:19,295 - INFO -    After victim validation: 1 articles (removed 0)\n[2025-06-05 18:38:19] ⭐ Calculating enhanced relevance scores...\n2025-06-05 18:38:19,295 - INFO - ⭐ Calculating enhanced relevance scores...\n[2025-06-05 18:38:19]    After relevance score filter (min 2): 1 articles (removed 0)\n2025-06-05 18:38:19,296 - INFO -    After relevance score filter (min 2): 1 articles (removed 0)\n[2025-06-05 18:38:19] 🔄 Removing duplicates with enhanced logic...\n2025-06-05 18:38:19,296 - INFO - 🔄 Removing duplicates with enhanced logic...\n[2025-06-05 18:38:19]    After URL deduplication: 1 articles (removed 0)\n2025-06-05 18:38:19,296 - INFO -    After URL deduplication: 1 articles (removed 0)\n[2025-06-05 18:38:19]    After content similarity deduplication: 1 articles (removed 0)\n2025-06-05 18:38:19,297 - INFO -    After content similarity deduplication: 1 articles (removed 0)\n[2025-06-05 18:38:19] 🌦️ Enhanced climate event identification...\n2025-06-05 18:38:19,297 - INFO - 🌦️ Enhanced climate event identification...\n[2025-06-05 18:38:19] ==================================================\n2025-06-05 18:38:19,308 - INFO - ==================================================\n[2025-06-05 18:38:19] Enhanced Filtering Results\n2025-06-05 18:38:19,308 - INFO - Enhanced Filtering Results\n[2025-06-05 18:38:19] ==================================================\n2025-06-05 18:38:19,308 - INFO - ==================================================\n[2025-06-05 18:38:19]   Articles After Enhanced Filters: 1\n2025-06-05 18:38:19,308 - INFO -   Articles After Enhanced Filters: 1\n[2025-06-05 18:38:19]   Articles with Victims: 1\n2025-06-05 18:38:19,308 - INFO -   Articles with Victims: 1\n[2025-06-05 18:38:19]   Articles without Victims: 0\n2025-06-05 18:38:19,308 - INFO -   Articles without Victims: 0\n[2025-06-05 18:38:19]   Total Fatalities: 0\n2025-06-05 18:38:19,308 - INFO -   Total Fatalities: 0\n[2025-06-05 18:38:19]   Total Injured: 8\n2025-06-05 18:38:19,308 - INFO -   Total Injured: 8\n[2025-06-05 18:38:19]   Total Evacuated: 0\n2025-06-05 18:38:19,308 - INFO -   Total Evacuated: 0\n[2025-06-05 18:38:19]   Total Displaced: 0\n2025-06-05 18:38:19,308 - INFO -   Total Displaced: 0\n[2025-06-05 18:38:19]   Total Missing: 0\n2025-06-05 18:38:19,308 - INFO -   Total Missing: 0\n[2025-06-05 18:38:19]   Average Relevance Score: 6.00\n2025-06-05 18:38:19,308 - INFO -   Average Relevance Score: 6.00\n[2025-06-05 18:38:19]   Top Event Types: {'desconhecido': 1}\n2025-06-05 18:38:19,308 - INFO -   Top Event Types: {'desconhecido': 1}\n[2025-06-05 18:38:19] ==================================================\n2025-06-05 18:38:19,308 - INFO - ==================================================\n[2025-06-05 18:38:19] 💾 Saving enhanced filtered articles...\n2025-06-05 18:38:19,308 - INFO - 💾 Saving enhanced filtered articles...\n📥 Novos artigos recebidos: 1\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 1\n💾 Guardados 1 artigos no arquivo /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n📥 Novos artigos recebidos: 1\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/05/artigos_vitimas_filtrados.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 1\n💾 Guardados 1 artigos no arquivo /opt/airflow/data/structured/2025/06/05/artigos_vitimas_filtrados.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/structured/2025/06/05/artigos_vitimas_filtrados.csv\n[2025-06-05 18:38:19] ✅ Filtered articles with victims saved: 1 articles\n2025-06-05 18:38:19,310 - INFO - ✅ Filtered articles with victims saved: 1 articles\n[2025-06-05 18:38:19] ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n2025-06-05 18:38:19,311 - INFO - ✅ Filtering statistics saved: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n[2025-06-05 18:38:19] ==================================================\n2025-06-05 18:38:19,311 - INFO - ==================================================\n[2025-06-05 18:38:19] Enhanced Filtering Completed Successfully\n2025-06-05 18:38:19,311 - INFO - Enhanced Filtering Completed Successfully\n[2025-06-05 18:38:19] ==================================================\n2025-06-05 18:38:19,311 - INFO - ==================================================\n[2025-06-05 18:38:19]   Articles with Victims: 1\n2025-06-05 18:38:19,311 - INFO -   Articles with Victims: 1\n[2025-06-05 18:38:19]   Articles without Victims: 0\n2025-06-05 18:38:19,311 - INFO -   Articles without Victims: 0\n[2025-06-05 18:38:19]   Total Articles Processed: 1\n2025-06-05 18:38:19,311 - INFO -   Total Articles Processed: 1\n[2025-06-05 18:38:19]   Enhanced Filter Rate: 14.3%\n2025-06-05 18:38:19,311 - INFO -   Enhanced Filter Rate: 14.3%\n[2025-06-05 18:38:19]   Victim Rate: 100.0%\n2025-06-05 18:38:19,311 - INFO -   Victim Rate: 100.0%\n[2025-06-05 18:38:19]   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n2025-06-05 18:38:19,311 - INFO -   Main Output File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/artigos_vitimas_filtrados_2025-06-05.csv\n[2025-06-05 18:38:19]   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n2025-06-05 18:38:19,311 - INFO -   Statistics File: /opt/airflow/scripts/google_scraper/data/processed/2025/06/05/filtering_stats_20250605.json\n[2025-06-05 18:38:19] ==================================================\n2025-06-05 18:38:19,311 - INFO - ==================================================\n[2025-06-05 18:38:19] ✅ Filtering completed. Found 1 articles with victims\n2025-06-05 18:38:19,311 - INFO - ✅ Filtering completed. Found 1 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
