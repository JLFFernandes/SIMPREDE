{"timestamp":"2025-06-05T17:37:59.217650","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-05T17:37:59.217958","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-05T17:37:59.242642Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:37:59.242835Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:37:59.245015Z","level":"info","event":"📅 Using provided execution date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:37:59.245406Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/scripts/google_scraper/data/raw/2025/06/05', '/opt/airflow/scripts/google_scraper/data/structured/2025/06/05', '/opt/airflow/scripts/google_scraper/data/processed/2025/06/05']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:37:59.245849Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:37:59.245934Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:37:59.246192Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:37:59.246308Z","level":"info","event":"  - Target date: 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:37:59.246403Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:37:59.246468Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:37:59.246542Z","level":"info","event":"✅ Found input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:37:59.246630Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:37:59.246695Z","level":"info","event":"  - relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:37:59.246760Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:37:59.246833Z","level":"info","event":"  - processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:37:59.246900Z","level":"info","event":"  - stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:37:59.246971Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv --output_dir /opt/airflow/scripts/google_scraper/data/structured/2025/06/05 --date_str 2025-06-05 --date 2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:37:59.247054Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.486099Z","level":"info","event":"📋 [2025-06-05 18:38:00] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.486341Z","level":"info","event":"📋 2025-06-05 18:38:00,485 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.486632Z","level":"info","event":"📋 [2025-06-05 18:38:00] Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.486728Z","level":"info","event":"📋 2025-06-05 18:38:00,486 - INFO - Parameters: dias=1, date=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.486798Z","level":"info","event":"📋 [2025-06-05 18:38:00] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.486847Z","level":"info","event":"📋 2025-06-05 18:38:00,486 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.486964Z","level":"info","event":"📋 [2025-06-05 18:38:00] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.487048Z","level":"info","event":"📋 2025-06-05 18:38:00,486 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.487154Z","level":"info","event":"📋 [2025-06-05 18:38:00] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.487245Z","level":"info","event":"📋 2025-06-05 18:38:00,486 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.487325Z","level":"info","event":"📋 [2025-06-05 18:38:00] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.487749Z","level":"info","event":"📋 2025-06-05 18:38:00,486 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.487796Z","level":"info","event":"📋 [2025-06-05 18:38:00] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.487833Z","level":"info","event":"📋 2025-06-05 18:38:00,486 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.487869Z","level":"info","event":"📋 [2025-06-05 18:38:00] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.487904Z","level":"info","event":"📋 2025-06-05 18:38:00,486 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.488178Z","level":"info","event":"📋 [2025-06-05 18:38:00] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.488245Z","level":"info","event":"📋 2025-06-05 18:38:00,486 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.488475Z","level":"info","event":"📋 [2025-06-05 18:38:00] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.488576Z","level":"info","event":"📋 2025-06-05 18:38:00,486 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.488643Z","level":"info","event":"📋 [2025-06-05 18:38:00] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.488760Z","level":"info","event":"📋 2025-06-05 18:38:00,487 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.490380Z","level":"info","event":"📋 [2025-06-05 18:38:00] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.492614Z","level":"info","event":"📋 2025-06-05 18:38:00,487 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.493739Z","level":"info","event":"📋 [2025-06-05 18:38:00] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.493928Z","level":"info","event":"📋 2025-06-05 18:38:00,488 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.494614Z","level":"info","event":"📋 [2025-06-05 18:38:00] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.495376Z","level":"info","event":"📋 2025-06-05 18:38:00,488 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.495533Z","level":"info","event":"📋 [2025-06-05 18:38:00] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.495721Z","level":"info","event":"📋 2025-06-05 18:38:00,488 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.496017Z","level":"info","event":"📋 [2025-06-05 18:38:00] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.496355Z","level":"info","event":"📋 2025-06-05 18:38:00,495 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.496520Z","level":"info","event":"📋 [2025-06-05 18:38:00] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.497624Z","level":"info","event":"📋 2025-06-05 18:38:00,495 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.497713Z","level":"info","event":"📋 [2025-06-05 18:38:00] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.498166Z","level":"info","event":"📋 2025-06-05 18:38:00,495 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.498315Z","level":"info","event":"📋 [2025-06-05 18:38:00] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.498366Z","level":"info","event":"📋 2025-06-05 18:38:00,495 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.498415Z","level":"info","event":"📋 [2025-06-05 18:38:00]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.498918Z","level":"info","event":"📋 2025-06-05 18:38:00,495 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.498966Z","level":"info","event":"📋 [2025-06-05 18:38:00]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.499004Z","level":"info","event":"📋 2025-06-05 18:38:00,495 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.499042Z","level":"info","event":"📋 [2025-06-05 18:38:00]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.499079Z","level":"info","event":"📋 2025-06-05 18:38:00,495 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.499145Z","level":"info","event":"📋 [2025-06-05 18:38:00]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.499183Z","level":"info","event":"📋 2025-06-05 18:38:00,495 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.499223Z","level":"info","event":"📋 [2025-06-05 18:38:00]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.499260Z","level":"info","event":"📋 2025-06-05 18:38:00,495 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.499296Z","level":"info","event":"📋 [2025-06-05 18:38:00] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.499330Z","level":"info","event":"📋 2025-06-05 18:38:00,495 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.499386Z","level":"info","event":"📋 [2025-06-05 18:38:00] ✅ Ficheiro CSV válido com 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.499464Z","level":"info","event":"📋 2025-06-05 18:38:00,499 - INFO - ✅ Ficheiro CSV válido com 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.499535Z","level":"info","event":"📋 [2025-06-05 18:38:00] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.499612Z","level":"info","event":"📋 2025-06-05 18:38:00,499 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.500079Z","level":"info","event":"📋 [2025-06-05 18:38:00] 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.500124Z","level":"info","event":"📋 2025-06-05 18:38:00,499 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.500161Z","level":"info","event":"📋 [2025-06-05 18:38:00] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.500195Z","level":"info","event":"📋 2025-06-05 18:38:00,499 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.500229Z","level":"info","event":"📋 [2025-06-05 18:38:00] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.500263Z","level":"info","event":"📋 2025-06-05 18:38:00,499 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.500296Z","level":"info","event":"📋 [2025-06-05 18:38:00] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.500330Z","level":"info","event":"📋 2025-06-05 18:38:00,499 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.500365Z","level":"info","event":"📋 [2025-06-05 18:38:00]   Total de Artigos para Processar: 12","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.500399Z","level":"info","event":"📋 2025-06-05 18:38:00,499 - INFO -   Total de Artigos para Processar: 12","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.500432Z","level":"info","event":"📋 [2025-06-05 18:38:00]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.500469Z","level":"info","event":"📋 2025-06-05 18:38:00,499 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.500542Z","level":"info","event":"📋 [2025-06-05 18:38:00]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.501172Z","level":"info","event":"📋 2025-06-05 18:38:00,499 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.501222Z","level":"info","event":"📋 [2025-06-05 18:38:00]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.501263Z","level":"info","event":"📋 2025-06-05 18:38:00,499 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.501299Z","level":"info","event":"📋 [2025-06-05 18:38:00]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.501333Z","level":"info","event":"📋 2025-06-05 18:38:00,499 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.501367Z","level":"info","event":"📋 [2025-06-05 18:38:00] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.501401Z","level":"info","event":"📋 2025-06-05 18:38:00,499 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.501801Z","level":"info","event":"📋 [2025-06-05 18:38:00] ⏩ A retomar do índice 2 após o ID: 6df4e1edab7c3f38b5c3d13d41396b0b","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.501849Z","level":"info","event":"📋 2025-06-05 18:38:00,501 - INFO - ⏩ A retomar do índice 2 após o ID: 6df4e1edab7c3f38b5c3d13d41396b0b","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.502835Z","level":"info","event":"📋 [2025-06-05 18:38:00] 📦 A processar lote 1/1 (10 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:00.505623Z","level":"info","event":"📋 2025-06-05 18:38:00,502 - INFO - 📦 A processar lote 1/1 (10 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:03.447327Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:03.452144Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:03.462460Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:03.462832Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:03.504746Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:03.504954Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:03.882366Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:03.961742Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:06.786091Z","level":"info","event":"📋 [2025-06-05 18:38:06] 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:06.793335Z","level":"info","event":"📋 2025-06-05 18:38:06,775 - INFO - 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:07.448472Z","level":"info","event":"📋 [2025-06-05 18:38:07] ⚠️ Artigo ignorado após extração: Domingo e segunda-feira traz mais calor, mas semana poderá ser instável - O Amarense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:07.448646Z","level":"info","event":"📋 2025-06-05 18:38:07,448 - WARNING - ⚠️ Artigo ignorado após extração: Domingo e segunda-feira traz mais calor, mas semana poderá ser instável - O Amarense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:08.311957Z","level":"info","event":"📋 [2025-06-05 18:38:08] ⚠️ Artigo ignorado após extração: Beja Inaugura Agência do Banco de Tempo - Rádio Pax","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:08.312239Z","level":"info","event":"📋 2025-06-05 18:38:08,311 - WARNING - ⚠️ Artigo ignorado após extração: Beja Inaugura Agência do Banco de Tempo - Rádio Pax","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:08.716035Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:08.825774Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:08.962193Z","level":"info","event":"📋 [2025-06-05 18:38:08] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:08.962400Z","level":"info","event":"📋 2025-06-05 18:38:08,962 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:08.963018Z","level":"info","event":"📋 [2025-06-05 18:38:08] 🔄 Processado: Previsão do tempo - UOL Notícias...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:08.963122Z","level":"info","event":"📋 2025-06-05 18:38:08,962 - INFO - 🔄 Processado: Previsão do tempo - UOL Notícias...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:09.308509Z","level":"info","event":"📋 [2025-06-05 18:38:09] ⚠️ Artigo ignorado após extração: Domingo e segunda-feira traz mais calor, mas semana poderá ser instável - O Amarense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:09.308762Z","level":"info","event":"📋 2025-06-05 18:38:09,307 - WARNING - ⚠️ Artigo ignorado após extração: Domingo e segunda-feira traz mais calor, mas semana poderá ser instável - O Amarense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:09.557853Z","level":"info","event":"📋 [2025-06-05 18:38:09] ⚠️ Artigo ignorado após extração: Terras de Bouro tem inscrições abertas para ATL Férias de Verão - O Amarense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:09.558034Z","level":"info","event":"📋 2025-06-05 18:38:09,557 - WARNING - ⚠️ Artigo ignorado após extração: Terras de Bouro tem inscrições abertas para ATL Férias de Verão - O Amarense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:09.783318Z","level":"info","event":"📋 [2025-06-05 18:38:09] ⚠️ Artigo ignorado após extração: Terras de Bouro tem inscrições abertas para ATL Férias de Verão - O Amarense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:09.783549Z","level":"info","event":"📋 2025-06-05 18:38:09,783 - WARNING - ⚠️ Artigo ignorado após extração: Terras de Bouro tem inscrições abertas para ATL Férias de Verão - O Amarense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:10.051091Z","level":"info","event":"📋 [2025-06-05 18:38:10] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva de granizo envia guarda-redes do Alemanha-Portugal para os balneários - Abola.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:10.051354Z","level":"info","event":"📋 2025-06-05 18:38:10,050 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva de granizo envia guarda-redes do Alemanha-Portugal para os balneários - Abola.pt","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:10.052101Z","level":"info","event":"📋 [2025-06-05 18:38:10] 🔄 Processado: Chuva de granizo envia guarda-redes do Alemanha-Po...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:10.052313Z","level":"info","event":"📋 2025-06-05 18:38:10,051 - INFO - 🔄 Processado: Chuva de granizo envia guarda-redes do Alemanha-Po...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:11.071532Z","level":"info","event":"📋 [2025-06-05 18:38:11] 🔄 Processado: Água potável responsável por 18% dos óbitos por di...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:11.071912Z","level":"info","event":"📋 2025-06-05 18:38:11,071 - INFO - 🔄 Processado: Água potável responsável por 18% dos óbitos por di...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.062821Z","level":"info","event":"📋 [2025-06-05 18:38:13] 🔄 Processado: Escocês desaparecido em Albufeira foi encontrado m...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.063325Z","level":"info","event":"📋 2025-06-05 18:38:13,062 - INFO - 🔄 Processado: Escocês desaparecido em Albufeira foi encontrado m...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.080951Z","level":"info","event":"📋 📥 Novos artigos recebidos: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.081054Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.081129Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.081178Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.081239Z","level":"info","event":"📋 💾 Guardados 4 artigos no arquivo /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.081294Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.081341Z","level":"info","event":"📋 📥 Novos artigos recebidos: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.081383Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.081434Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.081492Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.081540Z","level":"info","event":"📋 💾 Guardados 4 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.081581Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.081635Z","level":"info","event":"📋 [2025-06-05 18:38:13] ✅ Relevant articles saved: 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.081770Z","level":"info","event":"📋 2025-06-05 18:38:13,067 - INFO - ✅ Relevant articles saved: 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.081820Z","level":"info","event":"📋 [2025-06-05 18:38:13] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.081879Z","level":"info","event":"📋 2025-06-05 18:38:13,068 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.082027Z","level":"info","event":"📋 [2025-06-05 18:38:13] ✅ Lote 1 concluído: 4 artigos (total: 4)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:13.082096Z","level":"info","event":"📋 2025-06-05 18:38:13,068 - INFO - ✅ Lote 1 concluído: 4 artigos (total: 4)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.373339Z","level":"info","event":"📋 📥 Novos artigos recebidos: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.375771Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.377095Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.377609Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.378334Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.378895Z","level":"info","event":"📋 📥 Novos artigos recebidos: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.379633Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.380872Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.381236Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.381811Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.382073Z","level":"info","event":"📋 [2025-06-05 18:38:16] ✅ Relevant articles saved: 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.382796Z","level":"info","event":"📋 2025-06-05 18:38:16,380 - INFO - ✅ Relevant articles saved: 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.384176Z","level":"info","event":"📋 [2025-06-05 18:38:16] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.386161Z","level":"info","event":"📋 2025-06-05 18:38:16,383 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.388027Z","level":"info","event":"📋 [2025-06-05 18:38:16] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.390457Z","level":"info","event":"📋 2025-06-05 18:38:16,385 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.390893Z","level":"info","event":"📋 [2025-06-05 18:38:16] Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.391870Z","level":"info","event":"📋 2025-06-05 18:38:16,385 - INFO - Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.395822Z","level":"info","event":"📋 [2025-06-05 18:38:16] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.396068Z","level":"info","event":"📋 2025-06-05 18:38:16,385 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.396247Z","level":"info","event":"📋 [2025-06-05 18:38:16]   Total de Artigos Processados: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.396326Z","level":"info","event":"📋 2025-06-05 18:38:16,385 - INFO -   Total de Artigos Processados: 4","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.396423Z","level":"info","event":"📋 [2025-06-05 18:38:16]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.396507Z","level":"info","event":"📋 2025-06-05 18:38:16,385 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.396615Z","level":"info","event":"📋 [2025-06-05 18:38:16]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.396687Z","level":"info","event":"📋 2025-06-05 18:38:16,385 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.396773Z","level":"info","event":"📋 [2025-06-05 18:38:16]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.396866Z","level":"info","event":"📋 2025-06-05 18:38:16,385 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.396951Z","level":"info","event":"📋 [2025-06-05 18:38:16]   Taxa de Sucesso: 33.3%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.397018Z","level":"info","event":"📋 2025-06-05 18:38:16,385 - INFO -   Taxa de Sucesso: 33.3%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.397084Z","level":"info","event":"📋 [2025-06-05 18:38:16] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.397387Z","level":"info","event":"📋 2025-06-05 18:38:16,385 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.397753Z","level":"info","event":"📋 [2025-06-05 18:38:16] ✅ Processing completed. Processed 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.397959Z","level":"info","event":"📋 2025-06-05 18:38:16,390 - INFO - ✅ Processing completed. Processed 4 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.565528Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.565849Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:16.566834Z","level":"info","event":"✅ relevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (1915 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:17.379829Z","level":"info","event":"📊 Number of processed articles: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:17.380322Z","level":"info","event":"📊 Columns: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:17.380457Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_irrelevantes_2025-06-05.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:17.381318Z","level":"info","event":"⚠️ processing_log: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_log_20250605.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:17.381450Z","level":"info","event":"✅ stats_json: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json (416 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-05T17:38:17.380867","level":"info","event":"Done. Returned value was: [2025-06-05 18:38:00] Starting processar_relevantes_airflow\n2025-06-05 18:38:00,485 - INFO - Starting processar_relevantes_airflow\n[2025-06-05 18:38:00] Parameters: dias=1, date=2025-06-05\n2025-06-05 18:38:00,486 - INFO - Parameters: dias=1, date=2025-06-05\n[2025-06-05 18:38:00] Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n2025-06-05 18:38:00,486 - INFO - Paths: input_file=/opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv, output_dir=/opt/airflow/scripts/google_scraper/data/structured/2025/06/05, date_str=2025-06-05\n[2025-06-05 18:38:00] 🚀 A iniciar processar_relevantes_airflow\n2025-06-05 18:38:00,486 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-05 18:38:00] 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 18:38:00,486 - INFO - 📁 Using controlled output directory: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 18:38:00] 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 18:38:00,486 - INFO - 📁 Using provided input file: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 18:38:00] 🔧 A carregar ficheiros de configuração...\n2025-06-05 18:38:00,486 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-05 18:38:00] 🔍 Checking config path: /opt/airflow/config\n2025-06-05 18:38:00,486 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-05 18:38:00] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-05 18:38:00,486 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-05 18:38:00] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-05 18:38:00,486 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-05 18:38:00] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-05 18:38:00,487 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-05 18:38:00] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-05 18:38:00,487 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-05 18:38:00] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-05 18:38:00,488 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-05 18:38:00] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-05 18:38:00,488 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-05 18:38:00] ✅ Loaded 6 keywords\n2025-06-05 18:38:00,488 - INFO - ✅ Loaded 6 keywords\n[2025-06-05 18:38:00] ✅ Loaded 3614 DICOFREG codes\n2025-06-05 18:38:00,495 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-05 18:38:00] ==================================================\n2025-06-05 18:38:00,495 - INFO - ==================================================\n[2025-06-05 18:38:00] Configuration Loaded\n2025-06-05 18:38:00,495 - INFO - Configuration Loaded\n[2025-06-05 18:38:00] ==================================================\n2025-06-05 18:38:00,495 - INFO - ==================================================\n[2025-06-05 18:38:00]   Parishes: 306\n2025-06-05 18:38:00,495 - INFO -   Parishes: 306\n[2025-06-05 18:38:00]   Municipalities: 306\n2025-06-05 18:38:00,495 - INFO -   Municipalities: 306\n[2025-06-05 18:38:00]   Districts: 29\n2025-06-05 18:38:00,495 - INFO -   Districts: 29\n[2025-06-05 18:38:00]   Keywords: 6\n2025-06-05 18:38:00,495 - INFO -   Keywords: 6\n[2025-06-05 18:38:00]   DICOFREG Codes: 3614\n2025-06-05 18:38:00,495 - INFO -   DICOFREG Codes: 3614\n[2025-06-05 18:38:00] ==================================================\n2025-06-05 18:38:00,495 - INFO - ==================================================\n[2025-06-05 18:38:00] ✅ Ficheiro CSV válido com 12 artigos\n2025-06-05 18:38:00,499 - INFO - ✅ Ficheiro CSV válido com 12 artigos\n[2025-06-05 18:38:00] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-05 18:38:00,499 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-05 18:38:00] 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos\n2025-06-05 18:38:00,499 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 12 artigos\n[2025-06-05 18:38:00] ==================================================\n2025-06-05 18:38:00,499 - INFO - ==================================================\n[2025-06-05 18:38:00] Processamento Iniciado\n2025-06-05 18:38:00,499 - INFO - Processamento Iniciado\n[2025-06-05 18:38:00] ==================================================\n2025-06-05 18:38:00,499 - INFO - ==================================================\n[2025-06-05 18:38:00]   Total de Artigos para Processar: 12\n2025-06-05 18:38:00,499 - INFO -   Total de Artigos para Processar: 12\n[2025-06-05 18:38:00]   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n2025-06-05 18:38:00,499 - INFO -   Ficheiro de Entrada: /opt/airflow/scripts/google_scraper/data/raw/2025/06/05/google_news_articles_20250605.csv\n[2025-06-05 18:38:00]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:38:00,499 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:38:00]   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n2025-06-05 18:38:00,499 - INFO -   Diretoria de Saída: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05\n[2025-06-05 18:38:00]   Filtro de Dias: 1\n2025-06-05 18:38:00,499 - INFO -   Filtro de Dias: 1\n[2025-06-05 18:38:00] ==================================================\n2025-06-05 18:38:00,499 - INFO - ==================================================\n[2025-06-05 18:38:00] ⏩ A retomar do índice 2 após o ID: 6df4e1edab7c3f38b5c3d13d41396b0b\n2025-06-05 18:38:00,501 - INFO - ⏩ A retomar do índice 2 após o ID: 6df4e1edab7c3f38b5c3d13d41396b0b\n[2025-06-05 18:38:00] 📦 A processar lote 1/1 (10 artigos)\n2025-06-05 18:38:00,502 - INFO - 📦 A processar lote 1/1 (10 artigos)\n[2025-06-05 18:38:06] 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...\n2025-06-05 18:38:06,775 - INFO - 🔄 Processado: Surpreendido pela chuva? Conte com ela por estes d...\n[2025-06-05 18:38:07] ⚠️ Artigo ignorado após extração: Domingo e segunda-feira traz mais calor, mas semana poderá ser instável - O Amarense\n2025-06-05 18:38:07,448 - WARNING - ⚠️ Artigo ignorado após extração: Domingo e segunda-feira traz mais calor, mas semana poderá ser instável - O Amarense\n[2025-06-05 18:38:08] ⚠️ Artigo ignorado após extração: Beja Inaugura Agência do Banco de Tempo - Rádio Pax\n2025-06-05 18:38:08,311 - WARNING - ⚠️ Artigo ignorado após extração: Beja Inaugura Agência do Banco de Tempo - Rádio Pax\n[2025-06-05 18:38:08] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo - UOL Notícias\n2025-06-05 18:38:08,962 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo - UOL Notícias\n[2025-06-05 18:38:08] 🔄 Processado: Previsão do tempo - UOL Notícias...\n2025-06-05 18:38:08,962 - INFO - 🔄 Processado: Previsão do tempo - UOL Notícias...\n[2025-06-05 18:38:09] ⚠️ Artigo ignorado após extração: Domingo e segunda-feira traz mais calor, mas semana poderá ser instável - O Amarense\n2025-06-05 18:38:09,307 - WARNING - ⚠️ Artigo ignorado após extração: Domingo e segunda-feira traz mais calor, mas semana poderá ser instável - O Amarense\n[2025-06-05 18:38:09] ⚠️ Artigo ignorado após extração: Terras de Bouro tem inscrições abertas para ATL Férias de Verão - O Amarense\n2025-06-05 18:38:09,557 - WARNING - ⚠️ Artigo ignorado após extração: Terras de Bouro tem inscrições abertas para ATL Férias de Verão - O Amarense\n[2025-06-05 18:38:09] ⚠️ Artigo ignorado após extração: Terras de Bouro tem inscrições abertas para ATL Férias de Verão - O Amarense\n2025-06-05 18:38:09,783 - WARNING - ⚠️ Artigo ignorado após extração: Terras de Bouro tem inscrições abertas para ATL Férias de Verão - O Amarense\n[2025-06-05 18:38:10] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva de granizo envia guarda-redes do Alemanha-Portugal para os balneários - Abola.pt\n2025-06-05 18:38:10,050 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Chuva de granizo envia guarda-redes do Alemanha-Portugal para os balneários - Abola.pt\n[2025-06-05 18:38:10] 🔄 Processado: Chuva de granizo envia guarda-redes do Alemanha-Po...\n2025-06-05 18:38:10,051 - INFO - 🔄 Processado: Chuva de granizo envia guarda-redes do Alemanha-Po...\n[2025-06-05 18:38:11] 🔄 Processado: Água potável responsável por 18% dos óbitos por di...\n2025-06-05 18:38:11,071 - INFO - 🔄 Processado: Água potável responsável por 18% dos óbitos por di...\n[2025-06-05 18:38:13] 🔄 Processado: Escocês desaparecido em Albufeira foi encontrado m...\n2025-06-05 18:38:13,062 - INFO - 🔄 Processado: Escocês desaparecido em Albufeira foi encontrado m...\n📥 Novos artigos recebidos: 4\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 3\n🆕 Artigos únicos para salvar: 4\n💾 Guardados 4 artigos no arquivo /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📥 Novos artigos recebidos: 4\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 3\n🆕 Artigos únicos para salvar: 4\n💾 Guardados 4 artigos no arquivo /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:38:13] ✅ Relevant articles saved: 4 articles\n2025-06-05 18:38:13,067 - INFO - ✅ Relevant articles saved: 4 articles\n[2025-06-05 18:38:13] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n2025-06-05 18:38:13,068 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n[2025-06-05 18:38:13] ✅ Lote 1 concluído: 4 artigos (total: 4)\n2025-06-05 18:38:13,068 - INFO - ✅ Lote 1 concluído: 4 artigos (total: 4)\n📥 Novos artigos recebidos: 4\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 7\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 4\n📂 Organizando saída por ano/mês/dia: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n📂 IDs existentes no arquivo: 7\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-05 18:38:16] ✅ Relevant articles saved: 4 articles\n2025-06-05 18:38:16,380 - INFO - ✅ Relevant articles saved: 4 articles\n[2025-06-05 18:38:16] ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n2025-06-05 18:38:16,383 - INFO - ✅ Processing statistics saved: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n[2025-06-05 18:38:16] ==================================================\n2025-06-05 18:38:16,385 - INFO - ==================================================\n[2025-06-05 18:38:16] Processamento Concluído com Sucesso\n2025-06-05 18:38:16,385 - INFO - Processamento Concluído com Sucesso\n[2025-06-05 18:38:16] ==================================================\n2025-06-05 18:38:16,385 - INFO - ==================================================\n[2025-06-05 18:38:16]   Total de Artigos Processados: 4\n2025-06-05 18:38:16,385 - INFO -   Total de Artigos Processados: 4\n[2025-06-05 18:38:16]   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:38:16,385 - INFO -   Ficheiro de Saída Principal: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:38:16]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n2025-06-05 18:38:16,385 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/05/artigos_google_municipios_pt_2025-06-05.csv\n[2025-06-05 18:38:16]   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n2025-06-05 18:38:16,385 - INFO -   Ficheiro de Estatísticas: /opt/airflow/scripts/google_scraper/data/structured/2025/06/05/processing_stats_20250605.json\n[2025-06-05 18:38:16]   Taxa de Sucesso: 33.3%\n2025-06-05 18:38:16,385 - INFO -   Taxa de Sucesso: 33.3%\n[2025-06-05 18:38:16] ==================================================\n2025-06-05 18:38:16,385 - INFO - ==================================================\n[2025-06-05 18:38:16] ✅ Processing completed. Processed 4 articles\n2025-06-05 18:38:16,390 - INFO - ✅ Processing completed. Processed 4 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
