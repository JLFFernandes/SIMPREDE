{"timestamp":"2025-06-09T08:48:50.628073","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-09T08:48:50.628352","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-09T08:48:50.654980Z","level":"info","event":"🔄 Starting export_to_gcs task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.655868Z","level":"info","event":"📁 Using paths from export_supabase task: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.657935Z","level":"info","event":"📅 Using provided execution date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.658680Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/09', '/opt/airflow/data/structured/2025/06/09', '/opt/airflow/data/processed/2025/06/09']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.658806Z","level":"info","event":"📅 GCS Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.659212Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.659408Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.659498Z","level":"info","event":"  - Target date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.659603Z","level":"info","event":"  - Base data directory: /opt/airflow/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.659707Z","level":"info","event":"  - GCS Project ID: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.659774Z","level":"info","event":"  - GCS Bucket: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.660020Z","level":"info","event":"🔄 Running GCS export command: python /opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py --date 2025-06-09 --base_data_dir /opt/airflow/data --output_dir /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.660353Z","level":"info","event":"⏰ Waiting for GCS export completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.284089Z","level":"info","event":"📋 2025-06-09 09:48:51,283 - INFO - 2025-06-09 09:48:51 - Starting export_to_gcs_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.284961Z","level":"info","event":"📋 2025-06-09 09:48:51,283 - INFO - 2025-06-09 09:48:51 - Parameters: date=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.285125Z","level":"info","event":"📋 2025-06-09 09:48:51,283 - INFO - 2025-06-09 09:48:51 - Paths: base_data_dir=/opt/airflow/data, output_dir=/opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.285236Z","level":"info","event":"📋 2025-06-09 09:48:51,283 - INFO - 2025-06-09 09:48:51 - GCS: project_id=None, bucket=None","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.285489Z","level":"info","event":"📋 2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - Airflow logs: include=True, dir=/opt/airflow/logs","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.288866Z","level":"info","event":"📋 2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - Cleanup: enabled=True, partial_success=False, dry_run=False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.289002Z","level":"info","event":"📋 2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - 🚀 Starting GCS export for date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.289071Z","level":"info","event":"📋 2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - 📁 Base data directory: /opt/airflow/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.289205Z","level":"info","event":"📋 2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - 📋 Include Airflow logs: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.289261Z","level":"info","event":"📋 2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - 🧹 Cleanup after export: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.289329Z","level":"info","event":"📋 2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - 🧹 Cleanup on partial success: False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.289390Z","level":"info","event":"📋 2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - 🧹 Dry run cleanup: False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.289441Z","level":"info","event":"📋 2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - 🔧 GCS Configuration:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.289493Z","level":"info","event":"📋 2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 -   - Project ID: simprede-461309","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.292807Z","level":"info","event":"📋 2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 -   - Bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.292875Z","level":"info","event":"📋 2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 -   - Credentials: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.321688Z","level":"info","event":"📋 2025-06-09 09:48:51,321 - INFO - 2025-06-09 09:48:51 - ✅ Initialized GCS client with service account: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.610568Z","level":"info","event":"📋 2025-06-09 09:48:51,610 - INFO - 2025-06-09 09:48:51 - ✅ Bucket 'simprede-data-pipeline' already exists","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.614836Z","level":"info","event":"📋 2025-06-09 09:48:51,614 - INFO - 2025-06-09 09:48:51 - 📁 Found data directory: /opt/airflow/data/raw/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.615160Z","level":"info","event":"📋 2025-06-09 09:48:51,615 - INFO - 2025-06-09 09:48:51 - 📁 Found data directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.615503Z","level":"info","event":"📋 2025-06-09 09:48:51,615 - INFO - 2025-06-09 09:48:51 - 📁 Found data directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.615629Z","level":"info","event":"📋 2025-06-09 09:48:51,615 - INFO - 2025-06-09 09:48:51 - 📤 Exporting data directory: /opt/airflow/data/raw/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.615809Z","level":"info","event":"📋 2025-06-09 09:48:51,615 - INFO - 2025-06-09 09:48:51 - 📁 Scanning directory: /opt/airflow/data/raw/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.618375Z","level":"info","event":"📋 2025-06-09 09:48:51,615 - INFO - 2025-06-09 09:48:51 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/intermediate_google_news_20250609.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/intermediate_google_news_20250609.csv (0.06 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.869733Z","level":"info","event":"📋 2025-06-09 09:48:51,869 - INFO - 2025-06-09 09:48:51 - ✅ Successfully uploaded: data/raw/2025/06/09/intermediate_google_news_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.870708Z","level":"info","event":"📋 2025-06-09 09:48:51,870 - INFO - 2025-06-09 09:48:51 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.976855Z","level":"info","event":"📋 2025-06-09 09:48:51,976 - INFO - 2025-06-09 09:48:51 - ✅ Successfully uploaded: data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:51.977723Z","level":"info","event":"📋 2025-06-09 09:48:51,977 - INFO - 2025-06-09 09:48:51 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/google_news_articles_20250609.csv (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.088048Z","level":"info","event":"📋 2025-06-09 09:48:52,087 - INFO - 2025-06-09 09:48:52 - ✅ Successfully uploaded: data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.088671Z","level":"info","event":"📋 2025-06-09 09:48:52,088 - INFO - 2025-06-09 09:48:52 - 📤 Exporting data directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.088937Z","level":"info","event":"📋 2025-06-09 09:48:52,088 - INFO - 2025-06-09 09:48:52 - 📁 Scanning directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.089979Z","level":"info","event":"📋 2025-06-09 09:48:52,089 - INFO - 2025-06-09 09:48:52 - 📤 Uploading /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json → gs://simprede-data-pipeline/data/structured/2025/06/09/processing_stats_20250609.json (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.201858Z","level":"info","event":"📋 2025-06-09 09:48:52,201 - INFO - 2025-06-09 09:48:52 - ✅ Successfully uploaded: data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.202691Z","level":"info","event":"📋 2025-06-09 09:48:52,202 - INFO - 2025-06-09 09:48:52 - 📤 Uploading /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv → gs://simprede-data-pipeline/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.313739Z","level":"info","event":"📋 2025-06-09 09:48:52,313 - INFO - 2025-06-09 09:48:52 - ✅ Successfully uploaded: data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.314364Z","level":"info","event":"📋 2025-06-09 09:48:52,313 - INFO - 2025-06-09 09:48:52 - 📤 Exporting data directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.314746Z","level":"info","event":"📋 2025-06-09 09:48:52,314 - INFO - 2025-06-09 09:48:52 - 📁 Scanning directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.315450Z","level":"info","event":"📋 2025-06-09 09:48:52,315 - INFO - 2025-06-09 09:48:52 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/gcs_export_stats_20250609.json → gs://simprede-data-pipeline/data/processed/2025/06/09/gcs_export_stats_20250609.json (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.415045Z","level":"info","event":"📋 2025-06-09 09:48:52,414 - INFO - 2025-06-09 09:48:52 - ✅ Successfully uploaded: data/processed/2025/06/09/gcs_export_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.415383Z","level":"info","event":"📋 2025-06-09 09:48:52,415 - INFO - 2025-06-09 09:48:52 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/export_stats_20250609.json → gs://simprede-data-pipeline/data/processed/2025/06/09/export_stats_20250609.json (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.517914Z","level":"info","event":"📋 2025-06-09 09:48:52,517 - INFO - 2025-06-09 09:48:52 - ✅ Successfully uploaded: data/processed/2025/06/09/export_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.518935Z","level":"info","event":"📋 2025-06-09 09:48:52,518 - INFO - 2025-06-09 09:48:52 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv → gs://simprede-data-pipeline/data/processed/2025/06/09/export_backup_20250609.csv (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.685626Z","level":"info","event":"📋 2025-06-09 09:48:52,685 - INFO - 2025-06-09 09:48:52 - ✅ Successfully uploaded: data/processed/2025/06/09/export_backup_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.688207Z","level":"info","event":"📋 2025-06-09 09:48:52,685 - INFO - 2025-06-09 09:48:52 - 📋 Starting Airflow logs export...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.688936Z","level":"info","event":"📋 2025-06-09 09:48:52,685 - INFO - 2025-06-09 09:48:52 - 📋 Starting Airflow logs export for 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.713114Z","level":"info","event":"📋 2025-06-09 09:48:52,712 - INFO - 2025-06-09 09:48:52 - 📋 Found 1 Airflow log paths for 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.713282Z","level":"info","event":"📋 2025-06-09 09:48:52,713 - INFO - 2025-06-09 09:48:52 -   📄 /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.713423Z","level":"info","event":"📋 2025-06-09 09:48:52,713 - INFO - 2025-06-09 09:48:52 - 📁 Scanning directory: /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.713758Z","level":"info","event":"📋 2025-06-09 09:48:52,713 - INFO - 2025-06-09 09:48:52 - 📤 Uploading /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log (0.01 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.826311Z","level":"info","event":"📋 2025-06-09 09:48:52,826 - INFO - 2025-06-09 09:48:52 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.827362Z","level":"info","event":"📋 2025-06-09 09:48:52,827 - INFO - 2025-06-09 09:48:52 - 📤 Uploading /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log (0.02 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.947497Z","level":"info","event":"📋 2025-06-09 09:48:52,946 - INFO - 2025-06-09 09:48:52 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.948154Z","level":"info","event":"📋 2025-06-09 09:48:52,947 - INFO - 2025-06-09 09:48:52 - 📋 Airflow logs export completed: 2 uploaded, 0 failed","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.948418Z","level":"info","event":"📋 2025-06-09 09:48:52,947 - INFO - 2025-06-09 09:48:52 - 🧹 Starting cleanup of exported data directories...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.949298Z","level":"info","event":"📋 2025-06-09 09:48:52,947 - INFO - 2025-06-09 09:48:52 - 🧹 Starting cleanup of 3 data directories","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.949659Z","level":"info","event":"📋 2025-06-09 09:48:52,947 - INFO - 2025-06-09 09:48:52 - ✅ All files from /opt/airflow/data/raw/2025/06/09 uploaded successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.952384Z","level":"info","event":"📋 2025-06-09 09:48:52,948 - INFO - 2025-06-09 09:48:52 - 🗑️ Deleting directory: /opt/airflow/data/raw/2025/06/09 (0.06 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.954412Z","level":"info","event":"📋 2025-06-09 09:48:52,953 - INFO - 2025-06-09 09:48:52 - ✅ Successfully deleted directory: /opt/airflow/data/raw/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.954825Z","level":"info","event":"📋 2025-06-09 09:48:52,954 - INFO - 2025-06-09 09:48:52 - ✅ All files from /opt/airflow/data/structured/2025/06/09 uploaded successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.955517Z","level":"info","event":"📋 2025-06-09 09:48:52,955 - INFO - 2025-06-09 09:48:52 - 🗑️ Deleting directory: /opt/airflow/data/structured/2025/06/09 (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.956776Z","level":"info","event":"📋 2025-06-09 09:48:52,956 - INFO - 2025-06-09 09:48:52 - ✅ Successfully deleted directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.957343Z","level":"info","event":"📋 2025-06-09 09:48:52,956 - INFO - 2025-06-09 09:48:52 - ✅ All files from /opt/airflow/data/processed/2025/06/09 uploaded successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.958086Z","level":"info","event":"📋 2025-06-09 09:48:52,957 - INFO - 2025-06-09 09:48:52 - 🗑️ Deleting directory: /opt/airflow/data/processed/2025/06/09 (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.960337Z","level":"info","event":"📋 2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 - ✅ Successfully deleted directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.960645Z","level":"info","event":"📋 2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 - 🧹 Cleanup completed: 3/3 directories cleaned","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.960871Z","level":"info","event":"📋 2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 - ✅ Export completed:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.961208Z","level":"info","event":"📋 2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 -   - Data directories: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.961428Z","level":"info","event":"📋 2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 -   - Data files uploaded: 8/8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.961708Z","level":"info","event":"📋 2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 -   - Airflow logs uploaded: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.962010Z","level":"info","event":"📋 2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 -   - Total files uploaded: 10/10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.962157Z","level":"info","event":"📋 2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 -   - Total size: 0.09 MB","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.962330Z","level":"info","event":"📋 2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 -   - Bucket: gs://simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.963415Z","level":"info","event":"📋 2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 -   - Directories cleaned: 3/3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.963694Z","level":"info","event":"📋 2025-06-09 09:48:52,962 - INFO - 2025-06-09 09:48:52 - ✅ Export statistics saved: /opt/airflow/data/processed/2025/06/09/gcs_export_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.964570Z","level":"info","event":"📋 2025-06-09 09:48:52,962 - INFO - 2025-06-09 09:48:52 - ✅ GCS export completed successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.965335Z","level":"info","event":"📋 2025-06-09 09:48:52,962 - INFO - 2025-06-09 09:48:52 - 📊 Summary: 10 files uploaded (2 logs), 0.09 MB","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:52.965550Z","level":"info","event":"📋 2025-06-09 09:48:52,962 - INFO - 2025-06-09 09:48:52 - 🧹 Cleanup: 3 directories cleaned","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:53.048451Z","level":"info","event":"✅ GCS export completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:53.049129Z","level":"info","event":"📊 Successfully uploaded 10 files to GCS","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:53.049239Z","level":"info","event":"📊 Total size uploaded: 0.06 MB","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:53.049362Z","level":"info","event":"☁️ GCS bucket: gs://simprede-data-pipeline/data/raw/2025/06/09/intermediate_google_news_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:53.049529","level":"info","event":"Done. Returned value was: 2025-06-09 09:48:51,283 - INFO - 2025-06-09 09:48:51 - Starting export_to_gcs_airflow\n2025-06-09 09:48:51,283 - INFO - 2025-06-09 09:48:51 - Parameters: date=2025-06-09\n2025-06-09 09:48:51,283 - INFO - 2025-06-09 09:48:51 - Paths: base_data_dir=/opt/airflow/data, output_dir=/opt/airflow/data/processed/2025/06/09\n2025-06-09 09:48:51,283 - INFO - 2025-06-09 09:48:51 - GCS: project_id=None, bucket=None\n2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - Airflow logs: include=True, dir=/opt/airflow/logs\n2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - Cleanup: enabled=True, partial_success=False, dry_run=False\n2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - 🚀 Starting GCS export for date: 2025-06-09\n2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - 📁 Base data directory: /opt/airflow/data\n2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - 📋 Include Airflow logs: True\n2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - 🧹 Cleanup after export: True\n2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - 🧹 Cleanup on partial success: False\n2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - 🧹 Dry run cleanup: False\n2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 - 🔧 GCS Configuration:\n2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 -   - Project ID: simprede-461309\n2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 -   - Bucket: simprede-data-pipeline\n2025-06-09 09:48:51,284 - INFO - 2025-06-09 09:48:51 -   - Credentials: /opt/airflow/config/gcs-credentials.json\n2025-06-09 09:48:51,321 - INFO - 2025-06-09 09:48:51 - ✅ Initialized GCS client with service account: /opt/airflow/config/gcs-credentials.json\n2025-06-09 09:48:51,610 - INFO - 2025-06-09 09:48:51 - ✅ Bucket 'simprede-data-pipeline' already exists\n2025-06-09 09:48:51,614 - INFO - 2025-06-09 09:48:51 - 📁 Found data directory: /opt/airflow/data/raw/2025/06/09\n2025-06-09 09:48:51,615 - INFO - 2025-06-09 09:48:51 - 📁 Found data directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:48:51,615 - INFO - 2025-06-09 09:48:51 - 📁 Found data directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 09:48:51,615 - INFO - 2025-06-09 09:48:51 - 📤 Exporting data directory: /opt/airflow/data/raw/2025/06/09\n2025-06-09 09:48:51,615 - INFO - 2025-06-09 09:48:51 - 📁 Scanning directory: /opt/airflow/data/raw/2025/06/09\n2025-06-09 09:48:51,615 - INFO - 2025-06-09 09:48:51 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/intermediate_google_news_20250609.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/intermediate_google_news_20250609.csv (0.06 MB)\n2025-06-09 09:48:51,869 - INFO - 2025-06-09 09:48:51 - ✅ Successfully uploaded: data/raw/2025/06/09/intermediate_google_news_20250609.csv\n2025-06-09 09:48:51,870 - INFO - 2025-06-09 09:48:51 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (0.00 MB)\n2025-06-09 09:48:51,976 - INFO - 2025-06-09 09:48:51 - ✅ Successfully uploaded: data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:48:51,977 - INFO - 2025-06-09 09:48:51 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/google_news_articles_20250609.csv (0.00 MB)\n2025-06-09 09:48:52,087 - INFO - 2025-06-09 09:48:52 - ✅ Successfully uploaded: data/raw/2025/06/09/google_news_articles_20250609.csv\n2025-06-09 09:48:52,088 - INFO - 2025-06-09 09:48:52 - 📤 Exporting data directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:48:52,088 - INFO - 2025-06-09 09:48:52 - 📁 Scanning directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:48:52,089 - INFO - 2025-06-09 09:48:52 - 📤 Uploading /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json → gs://simprede-data-pipeline/data/structured/2025/06/09/processing_stats_20250609.json (0.00 MB)\n2025-06-09 09:48:52,201 - INFO - 2025-06-09 09:48:52 - ✅ Successfully uploaded: data/structured/2025/06/09/processing_stats_20250609.json\n2025-06-09 09:48:52,202 - INFO - 2025-06-09 09:48:52 - 📤 Uploading /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv → gs://simprede-data-pipeline/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (0.00 MB)\n2025-06-09 09:48:52,313 - INFO - 2025-06-09 09:48:52 - ✅ Successfully uploaded: data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:48:52,313 - INFO - 2025-06-09 09:48:52 - 📤 Exporting data directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 09:48:52,314 - INFO - 2025-06-09 09:48:52 - 📁 Scanning directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 09:48:52,315 - INFO - 2025-06-09 09:48:52 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/gcs_export_stats_20250609.json → gs://simprede-data-pipeline/data/processed/2025/06/09/gcs_export_stats_20250609.json (0.00 MB)\n2025-06-09 09:48:52,414 - INFO - 2025-06-09 09:48:52 - ✅ Successfully uploaded: data/processed/2025/06/09/gcs_export_stats_20250609.json\n2025-06-09 09:48:52,415 - INFO - 2025-06-09 09:48:52 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/export_stats_20250609.json → gs://simprede-data-pipeline/data/processed/2025/06/09/export_stats_20250609.json (0.00 MB)\n2025-06-09 09:48:52,517 - INFO - 2025-06-09 09:48:52 - ✅ Successfully uploaded: data/processed/2025/06/09/export_stats_20250609.json\n2025-06-09 09:48:52,518 - INFO - 2025-06-09 09:48:52 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv → gs://simprede-data-pipeline/data/processed/2025/06/09/export_backup_20250609.csv (0.00 MB)\n2025-06-09 09:48:52,685 - INFO - 2025-06-09 09:48:52 - ✅ Successfully uploaded: data/processed/2025/06/09/export_backup_20250609.csv\n2025-06-09 09:48:52,685 - INFO - 2025-06-09 09:48:52 - 📋 Starting Airflow logs export...\n2025-06-09 09:48:52,685 - INFO - 2025-06-09 09:48:52 - 📋 Starting Airflow logs export for 2025-06-09\n2025-06-09 09:48:52,712 - INFO - 2025-06-09 09:48:52 - 📋 Found 1 Airflow log paths for 2025-06-09\n2025-06-09 09:48:52,713 - INFO - 2025-06-09 09:48:52 -   📄 /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__\n2025-06-09 09:48:52,713 - INFO - 2025-06-09 09:48:52 - 📁 Scanning directory: /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__\n2025-06-09 09:48:52,713 - INFO - 2025-06-09 09:48:52 - 📤 Uploading /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log (0.01 MB)\n2025-06-09 09:48:52,826 - INFO - 2025-06-09 09:48:52 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log\n2025-06-09 09:48:52,827 - INFO - 2025-06-09 09:48:52 - 📤 Uploading /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log (0.02 MB)\n2025-06-09 09:48:52,946 - INFO - 2025-06-09 09:48:52 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log\n2025-06-09 09:48:52,947 - INFO - 2025-06-09 09:48:52 - 📋 Airflow logs export completed: 2 uploaded, 0 failed\n2025-06-09 09:48:52,947 - INFO - 2025-06-09 09:48:52 - 🧹 Starting cleanup of exported data directories...\n2025-06-09 09:48:52,947 - INFO - 2025-06-09 09:48:52 - 🧹 Starting cleanup of 3 data directories\n2025-06-09 09:48:52,947 - INFO - 2025-06-09 09:48:52 - ✅ All files from /opt/airflow/data/raw/2025/06/09 uploaded successfully\n2025-06-09 09:48:52,948 - INFO - 2025-06-09 09:48:52 - 🗑️ Deleting directory: /opt/airflow/data/raw/2025/06/09 (0.06 MB)\n2025-06-09 09:48:52,953 - INFO - 2025-06-09 09:48:52 - ✅ Successfully deleted directory: /opt/airflow/data/raw/2025/06/09\n2025-06-09 09:48:52,954 - INFO - 2025-06-09 09:48:52 - ✅ All files from /opt/airflow/data/structured/2025/06/09 uploaded successfully\n2025-06-09 09:48:52,955 - INFO - 2025-06-09 09:48:52 - 🗑️ Deleting directory: /opt/airflow/data/structured/2025/06/09 (0.00 MB)\n2025-06-09 09:48:52,956 - INFO - 2025-06-09 09:48:52 - ✅ Successfully deleted directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:48:52,956 - INFO - 2025-06-09 09:48:52 - ✅ All files from /opt/airflow/data/processed/2025/06/09 uploaded successfully\n2025-06-09 09:48:52,957 - INFO - 2025-06-09 09:48:52 - 🗑️ Deleting directory: /opt/airflow/data/processed/2025/06/09 (0.00 MB)\n2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 - ✅ Successfully deleted directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 - 🧹 Cleanup completed: 3/3 directories cleaned\n2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 - ✅ Export completed:\n2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 -   - Data directories: 3\n2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 -   - Data files uploaded: 8/8\n2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 -   - Airflow logs uploaded: 2\n2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 -   - Total files uploaded: 10/10\n2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 -   - Total size: 0.09 MB\n2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 -   - Bucket: gs://simprede-data-pipeline\n2025-06-09 09:48:52,960 - INFO - 2025-06-09 09:48:52 -   - Directories cleaned: 3/3\n2025-06-09 09:48:52,962 - INFO - 2025-06-09 09:48:52 - ✅ Export statistics saved: /opt/airflow/data/processed/2025/06/09/gcs_export_stats_20250609.json\n2025-06-09 09:48:52,962 - INFO - 2025-06-09 09:48:52 - ✅ GCS export completed successfully\n2025-06-09 09:48:52,962 - INFO - 2025-06-09 09:48:52 - 📊 Summary: 10 files uploaded (2 logs), 0.09 MB\n2025-06-09 09:48:52,962 - INFO - 2025-06-09 09:48:52 - 🧹 Cleanup: 3 directories cleaned\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
