{"timestamp":"2025-06-09T08:41:12.480104","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-09T08:41:12.480388","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-09T08:41:12.505081Z","level":"info","event":"🔄 Starting export_to_gcs task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:12.506344Z","level":"info","event":"📁 Using paths from export_supabase task: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:12.507443Z","level":"info","event":"📅 Using provided execution date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:12.507939Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/09', '/opt/airflow/data/structured/2025/06/09', '/opt/airflow/data/processed/2025/06/09']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:12.507996Z","level":"info","event":"📅 GCS Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:12.508160Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:12.508254Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:12.508300Z","level":"info","event":"  - Target date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:12.508340Z","level":"info","event":"  - Base data directory: /opt/airflow/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:12.508384Z","level":"info","event":"  - GCS Project ID: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:12.508421Z","level":"info","event":"  - GCS Bucket: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:12.508459Z","level":"info","event":"🔄 Running GCS export command: python /opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py --date 2025-06-09 --base_data_dir /opt/airflow/data --output_dir /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:12.508509Z","level":"info","event":"⏰ Waiting for GCS export completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.085707Z","level":"info","event":"📋 2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - Starting export_to_gcs_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.086029Z","level":"info","event":"📋 2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - Parameters: date=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.086140Z","level":"info","event":"📋 2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - Paths: base_data_dir=/opt/airflow/data, output_dir=/opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.086219Z","level":"info","event":"📋 2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - GCS: project_id=None, bucket=None","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.086748Z","level":"info","event":"📋 2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - Airflow logs: include=True, dir=/opt/airflow/logs","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.086835Z","level":"info","event":"📋 2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - Cleanup: enabled=True, partial_success=False, dry_run=False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.086895Z","level":"info","event":"📋 2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - 🚀 Starting GCS export for date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.087022Z","level":"info","event":"📋 2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - 📁 Base data directory: /opt/airflow/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.087150Z","level":"info","event":"📋 2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - 📋 Include Airflow logs: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.087217Z","level":"info","event":"📋 2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - 🧹 Cleanup after export: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.087642Z","level":"info","event":"📋 2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - 🧹 Cleanup on partial success: False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.087702Z","level":"info","event":"📋 2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - 🧹 Dry run cleanup: False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.087766Z","level":"info","event":"📋 2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - 🔧 GCS Configuration:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.087824Z","level":"info","event":"📋 2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 -   - Project ID: simprede-461309","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.087884Z","level":"info","event":"📋 2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 -   - Bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.087942Z","level":"info","event":"📋 2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 -   - Credentials: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.123647Z","level":"info","event":"📋 2025-06-09 09:41:13,123 - INFO - 2025-06-09 09:41:13 - ✅ Initialized GCS client with service account: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.431713Z","level":"info","event":"📋 2025-06-09 09:41:13,431 - INFO - 2025-06-09 09:41:13 - ✅ Bucket 'simprede-data-pipeline' already exists","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.439719Z","level":"info","event":"📋 2025-06-09 09:41:13,439 - INFO - 2025-06-09 09:41:13 - 📁 Found data directory: /opt/airflow/data/raw/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.440408Z","level":"info","event":"📋 2025-06-09 09:41:13,440 - INFO - 2025-06-09 09:41:13 - 📁 Found data directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.441204Z","level":"info","event":"📋 2025-06-09 09:41:13,440 - INFO - 2025-06-09 09:41:13 - 📁 Found data directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.441438Z","level":"info","event":"📋 2025-06-09 09:41:13,441 - INFO - 2025-06-09 09:41:13 - 📤 Exporting data directory: /opt/airflow/data/raw/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.441585Z","level":"info","event":"📋 2025-06-09 09:41:13,441 - INFO - 2025-06-09 09:41:13 - 📁 Scanning directory: /opt/airflow/data/raw/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.443029Z","level":"info","event":"📋 2025-06-09 09:41:13,442 - INFO - 2025-06-09 09:41:13 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/intermediate_google_news_20250609.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/intermediate_google_news_20250609.csv (0.06 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.764472Z","level":"info","event":"📋 2025-06-09 09:41:13,764 - INFO - 2025-06-09 09:41:13 - ✅ Successfully uploaded: data/raw/2025/06/09/intermediate_google_news_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.765404Z","level":"info","event":"📋 2025-06-09 09:41:13,765 - INFO - 2025-06-09 09:41:13 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.868777Z","level":"info","event":"📋 2025-06-09 09:41:13,868 - INFO - 2025-06-09 09:41:13 - ✅ Successfully uploaded: data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.869251Z","level":"info","event":"📋 2025-06-09 09:41:13,868 - INFO - 2025-06-09 09:41:13 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/google_news_articles_20250609.csv (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.986872Z","level":"info","event":"📋 2025-06-09 09:41:13,986 - INFO - 2025-06-09 09:41:13 - ✅ Successfully uploaded: data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.987391Z","level":"info","event":"📋 2025-06-09 09:41:13,986 - INFO - 2025-06-09 09:41:13 - 📤 Exporting data directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.987598Z","level":"info","event":"📋 2025-06-09 09:41:13,986 - INFO - 2025-06-09 09:41:13 - 📁 Scanning directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:13.988213Z","level":"info","event":"📋 2025-06-09 09:41:13,988 - INFO - 2025-06-09 09:41:13 - 📤 Uploading /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json → gs://simprede-data-pipeline/data/structured/2025/06/09/processing_stats_20250609.json (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.095699Z","level":"info","event":"📋 2025-06-09 09:41:14,095 - INFO - 2025-06-09 09:41:14 - ✅ Successfully uploaded: data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.095991Z","level":"info","event":"📋 2025-06-09 09:41:14,095 - INFO - 2025-06-09 09:41:14 - 📤 Uploading /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv → gs://simprede-data-pipeline/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.201502Z","level":"info","event":"📋 2025-06-09 09:41:14,201 - INFO - 2025-06-09 09:41:14 - ✅ Successfully uploaded: data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.201735Z","level":"info","event":"📋 2025-06-09 09:41:14,201 - INFO - 2025-06-09 09:41:14 - 📤 Exporting data directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.201866Z","level":"info","event":"📋 2025-06-09 09:41:14,201 - INFO - 2025-06-09 09:41:14 - 📁 Scanning directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.202199Z","level":"info","event":"📋 2025-06-09 09:41:14,202 - INFO - 2025-06-09 09:41:14 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/gcs_export_stats_20250609.json → gs://simprede-data-pipeline/data/processed/2025/06/09/gcs_export_stats_20250609.json (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.305149Z","level":"info","event":"📋 2025-06-09 09:41:14,304 - INFO - 2025-06-09 09:41:14 - ✅ Successfully uploaded: data/processed/2025/06/09/gcs_export_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.305817Z","level":"info","event":"📋 2025-06-09 09:41:14,305 - INFO - 2025-06-09 09:41:14 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/export_stats_20250609.json → gs://simprede-data-pipeline/data/processed/2025/06/09/export_stats_20250609.json (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.425216Z","level":"info","event":"📋 2025-06-09 09:41:14,424 - INFO - 2025-06-09 09:41:14 - ✅ Successfully uploaded: data/processed/2025/06/09/export_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.426078Z","level":"info","event":"📋 2025-06-09 09:41:14,425 - INFO - 2025-06-09 09:41:14 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv → gs://simprede-data-pipeline/data/processed/2025/06/09/export_backup_20250609.csv (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.530787Z","level":"info","event":"📋 2025-06-09 09:41:14,530 - INFO - 2025-06-09 09:41:14 - ✅ Successfully uploaded: data/processed/2025/06/09/export_backup_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.534019Z","level":"info","event":"📋 2025-06-09 09:41:14,530 - INFO - 2025-06-09 09:41:14 - 📋 Starting Airflow logs export...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.534240Z","level":"info","event":"📋 2025-06-09 09:41:14,530 - INFO - 2025-06-09 09:41:14 - 📋 Starting Airflow logs export for 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.563042Z","level":"info","event":"📋 2025-06-09 09:41:14,562 - INFO - 2025-06-09 09:41:14 - 📋 Found 1 Airflow log paths for 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.563195Z","level":"info","event":"📋 2025-06-09 09:41:14,562 - INFO - 2025-06-09 09:41:14 -   📄 /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.563306Z","level":"info","event":"📋 2025-06-09 09:41:14,563 - INFO - 2025-06-09 09:41:14 - 📁 Scanning directory: /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.563656Z","level":"info","event":"📋 2025-06-09 09:41:14,563 - INFO - 2025-06-09 09:41:14 - 📤 Uploading /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log (0.01 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.676014Z","level":"info","event":"📋 2025-06-09 09:41:14,675 - INFO - 2025-06-09 09:41:14 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.677000Z","level":"info","event":"📋 2025-06-09 09:41:14,676 - INFO - 2025-06-09 09:41:14 - 📤 Uploading /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log (0.02 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.788485Z","level":"info","event":"📋 2025-06-09 09:41:14,788 - INFO - 2025-06-09 09:41:14 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.789197Z","level":"info","event":"📋 2025-06-09 09:41:14,788 - INFO - 2025-06-09 09:41:14 - 📋 Airflow logs export completed: 2 uploaded, 0 failed","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.789450Z","level":"info","event":"📋 2025-06-09 09:41:14,788 - INFO - 2025-06-09 09:41:14 - 🧹 Starting cleanup of exported data directories...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.789892Z","level":"info","event":"📋 2025-06-09 09:41:14,788 - INFO - 2025-06-09 09:41:14 - 🧹 Starting cleanup of 3 data directories","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.790169Z","level":"info","event":"📋 2025-06-09 09:41:14,788 - INFO - 2025-06-09 09:41:14 - ✅ All files from /opt/airflow/data/raw/2025/06/09 uploaded successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.790508Z","level":"info","event":"📋 2025-06-09 09:41:14,789 - INFO - 2025-06-09 09:41:14 - 🗑️ Deleting directory: /opt/airflow/data/raw/2025/06/09 (0.06 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.792256Z","level":"info","event":"📋 2025-06-09 09:41:14,792 - INFO - 2025-06-09 09:41:14 - ✅ Successfully deleted directory: /opt/airflow/data/raw/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.792551Z","level":"info","event":"📋 2025-06-09 09:41:14,792 - INFO - 2025-06-09 09:41:14 - ✅ All files from /opt/airflow/data/structured/2025/06/09 uploaded successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.793021Z","level":"info","event":"📋 2025-06-09 09:41:14,792 - INFO - 2025-06-09 09:41:14 - 🗑️ Deleting directory: /opt/airflow/data/structured/2025/06/09 (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.795350Z","level":"info","event":"📋 2025-06-09 09:41:14,795 - INFO - 2025-06-09 09:41:14 - ✅ Successfully deleted directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.795701Z","level":"info","event":"📋 2025-06-09 09:41:14,795 - INFO - 2025-06-09 09:41:14 - ✅ All files from /opt/airflow/data/processed/2025/06/09 uploaded successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.796133Z","level":"info","event":"📋 2025-06-09 09:41:14,795 - INFO - 2025-06-09 09:41:14 - 🗑️ Deleting directory: /opt/airflow/data/processed/2025/06/09 (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.797628Z","level":"info","event":"📋 2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 - ✅ Successfully deleted directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.797982Z","level":"info","event":"📋 2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 - 🧹 Cleanup completed: 3/3 directories cleaned","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.798202Z","level":"info","event":"📋 2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 - ✅ Export completed:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.798613Z","level":"info","event":"📋 2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 -   - Data directories: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.798855Z","level":"info","event":"📋 2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 -   - Data files uploaded: 8/8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.799318Z","level":"info","event":"📋 2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 -   - Airflow logs uploaded: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.799521Z","level":"info","event":"📋 2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 -   - Total files uploaded: 10/10","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.799803Z","level":"info","event":"📋 2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 -   - Total size: 0.09 MB","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.799978Z","level":"info","event":"📋 2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 -   - Bucket: gs://simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.800219Z","level":"info","event":"📋 2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 -   - Directories cleaned: 3/3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.800549Z","level":"info","event":"📋 2025-06-09 09:41:14,800 - INFO - 2025-06-09 09:41:14 - ✅ Export statistics saved: /opt/airflow/data/processed/2025/06/09/gcs_export_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.800974Z","level":"info","event":"📋 2025-06-09 09:41:14,800 - INFO - 2025-06-09 09:41:14 - ✅ GCS export completed successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.801357Z","level":"info","event":"📋 2025-06-09 09:41:14,800 - INFO - 2025-06-09 09:41:14 - 📊 Summary: 10 files uploaded (2 logs), 0.09 MB","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.801703Z","level":"info","event":"📋 2025-06-09 09:41:14,800 - INFO - 2025-06-09 09:41:14 - 🧹 Cleanup: 3 directories cleaned","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.889782Z","level":"info","event":"✅ GCS export completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.890475Z","level":"info","event":"📊 Successfully uploaded 10 files to GCS","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.890574Z","level":"info","event":"📊 Total size uploaded: 0.06 MB","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.890687Z","level":"info","event":"☁️ GCS bucket: gs://simprede-data-pipeline/data/raw/2025/06/09/intermediate_google_news_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:14.890792","level":"info","event":"Done. Returned value was: 2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - Starting export_to_gcs_airflow\n2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - Parameters: date=2025-06-09\n2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - Paths: base_data_dir=/opt/airflow/data, output_dir=/opt/airflow/data/processed/2025/06/09\n2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - GCS: project_id=None, bucket=None\n2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - Airflow logs: include=True, dir=/opt/airflow/logs\n2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - Cleanup: enabled=True, partial_success=False, dry_run=False\n2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - 🚀 Starting GCS export for date: 2025-06-09\n2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - 📁 Base data directory: /opt/airflow/data\n2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - 📋 Include Airflow logs: True\n2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - 🧹 Cleanup after export: True\n2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - 🧹 Cleanup on partial success: False\n2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - 🧹 Dry run cleanup: False\n2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 - 🔧 GCS Configuration:\n2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 -   - Project ID: simprede-461309\n2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 -   - Bucket: simprede-data-pipeline\n2025-06-09 09:41:13,085 - INFO - 2025-06-09 09:41:13 -   - Credentials: /opt/airflow/config/gcs-credentials.json\n2025-06-09 09:41:13,123 - INFO - 2025-06-09 09:41:13 - ✅ Initialized GCS client with service account: /opt/airflow/config/gcs-credentials.json\n2025-06-09 09:41:13,431 - INFO - 2025-06-09 09:41:13 - ✅ Bucket 'simprede-data-pipeline' already exists\n2025-06-09 09:41:13,439 - INFO - 2025-06-09 09:41:13 - 📁 Found data directory: /opt/airflow/data/raw/2025/06/09\n2025-06-09 09:41:13,440 - INFO - 2025-06-09 09:41:13 - 📁 Found data directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:41:13,440 - INFO - 2025-06-09 09:41:13 - 📁 Found data directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 09:41:13,441 - INFO - 2025-06-09 09:41:13 - 📤 Exporting data directory: /opt/airflow/data/raw/2025/06/09\n2025-06-09 09:41:13,441 - INFO - 2025-06-09 09:41:13 - 📁 Scanning directory: /opt/airflow/data/raw/2025/06/09\n2025-06-09 09:41:13,442 - INFO - 2025-06-09 09:41:13 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/intermediate_google_news_20250609.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/intermediate_google_news_20250609.csv (0.06 MB)\n2025-06-09 09:41:13,764 - INFO - 2025-06-09 09:41:13 - ✅ Successfully uploaded: data/raw/2025/06/09/intermediate_google_news_20250609.csv\n2025-06-09 09:41:13,765 - INFO - 2025-06-09 09:41:13 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (0.00 MB)\n2025-06-09 09:41:13,868 - INFO - 2025-06-09 09:41:13 - ✅ Successfully uploaded: data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:41:13,868 - INFO - 2025-06-09 09:41:13 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/google_news_articles_20250609.csv (0.00 MB)\n2025-06-09 09:41:13,986 - INFO - 2025-06-09 09:41:13 - ✅ Successfully uploaded: data/raw/2025/06/09/google_news_articles_20250609.csv\n2025-06-09 09:41:13,986 - INFO - 2025-06-09 09:41:13 - 📤 Exporting data directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:41:13,986 - INFO - 2025-06-09 09:41:13 - 📁 Scanning directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:41:13,988 - INFO - 2025-06-09 09:41:13 - 📤 Uploading /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json → gs://simprede-data-pipeline/data/structured/2025/06/09/processing_stats_20250609.json (0.00 MB)\n2025-06-09 09:41:14,095 - INFO - 2025-06-09 09:41:14 - ✅ Successfully uploaded: data/structured/2025/06/09/processing_stats_20250609.json\n2025-06-09 09:41:14,095 - INFO - 2025-06-09 09:41:14 - 📤 Uploading /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv → gs://simprede-data-pipeline/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (0.00 MB)\n2025-06-09 09:41:14,201 - INFO - 2025-06-09 09:41:14 - ✅ Successfully uploaded: data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:41:14,201 - INFO - 2025-06-09 09:41:14 - 📤 Exporting data directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 09:41:14,201 - INFO - 2025-06-09 09:41:14 - 📁 Scanning directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 09:41:14,202 - INFO - 2025-06-09 09:41:14 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/gcs_export_stats_20250609.json → gs://simprede-data-pipeline/data/processed/2025/06/09/gcs_export_stats_20250609.json (0.00 MB)\n2025-06-09 09:41:14,304 - INFO - 2025-06-09 09:41:14 - ✅ Successfully uploaded: data/processed/2025/06/09/gcs_export_stats_20250609.json\n2025-06-09 09:41:14,305 - INFO - 2025-06-09 09:41:14 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/export_stats_20250609.json → gs://simprede-data-pipeline/data/processed/2025/06/09/export_stats_20250609.json (0.00 MB)\n2025-06-09 09:41:14,424 - INFO - 2025-06-09 09:41:14 - ✅ Successfully uploaded: data/processed/2025/06/09/export_stats_20250609.json\n2025-06-09 09:41:14,425 - INFO - 2025-06-09 09:41:14 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv → gs://simprede-data-pipeline/data/processed/2025/06/09/export_backup_20250609.csv (0.00 MB)\n2025-06-09 09:41:14,530 - INFO - 2025-06-09 09:41:14 - ✅ Successfully uploaded: data/processed/2025/06/09/export_backup_20250609.csv\n2025-06-09 09:41:14,530 - INFO - 2025-06-09 09:41:14 - 📋 Starting Airflow logs export...\n2025-06-09 09:41:14,530 - INFO - 2025-06-09 09:41:14 - 📋 Starting Airflow logs export for 2025-06-09\n2025-06-09 09:41:14,562 - INFO - 2025-06-09 09:41:14 - 📋 Found 1 Airflow log paths for 2025-06-09\n2025-06-09 09:41:14,562 - INFO - 2025-06-09 09:41:14 -   📄 /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__\n2025-06-09 09:41:14,563 - INFO - 2025-06-09 09:41:14 - 📁 Scanning directory: /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__\n2025-06-09 09:41:14,563 - INFO - 2025-06-09 09:41:14 - 📤 Uploading /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log (0.01 MB)\n2025-06-09 09:41:14,675 - INFO - 2025-06-09 09:41:14 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log\n2025-06-09 09:41:14,676 - INFO - 2025-06-09 09:41:14 - 📤 Uploading /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log (0.02 MB)\n2025-06-09 09:41:14,788 - INFO - 2025-06-09 09:41:14 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log\n2025-06-09 09:41:14,788 - INFO - 2025-06-09 09:41:14 - 📋 Airflow logs export completed: 2 uploaded, 0 failed\n2025-06-09 09:41:14,788 - INFO - 2025-06-09 09:41:14 - 🧹 Starting cleanup of exported data directories...\n2025-06-09 09:41:14,788 - INFO - 2025-06-09 09:41:14 - 🧹 Starting cleanup of 3 data directories\n2025-06-09 09:41:14,788 - INFO - 2025-06-09 09:41:14 - ✅ All files from /opt/airflow/data/raw/2025/06/09 uploaded successfully\n2025-06-09 09:41:14,789 - INFO - 2025-06-09 09:41:14 - 🗑️ Deleting directory: /opt/airflow/data/raw/2025/06/09 (0.06 MB)\n2025-06-09 09:41:14,792 - INFO - 2025-06-09 09:41:14 - ✅ Successfully deleted directory: /opt/airflow/data/raw/2025/06/09\n2025-06-09 09:41:14,792 - INFO - 2025-06-09 09:41:14 - ✅ All files from /opt/airflow/data/structured/2025/06/09 uploaded successfully\n2025-06-09 09:41:14,792 - INFO - 2025-06-09 09:41:14 - 🗑️ Deleting directory: /opt/airflow/data/structured/2025/06/09 (0.00 MB)\n2025-06-09 09:41:14,795 - INFO - 2025-06-09 09:41:14 - ✅ Successfully deleted directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:41:14,795 - INFO - 2025-06-09 09:41:14 - ✅ All files from /opt/airflow/data/processed/2025/06/09 uploaded successfully\n2025-06-09 09:41:14,795 - INFO - 2025-06-09 09:41:14 - 🗑️ Deleting directory: /opt/airflow/data/processed/2025/06/09 (0.00 MB)\n2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 - ✅ Successfully deleted directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 - 🧹 Cleanup completed: 3/3 directories cleaned\n2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 - ✅ Export completed:\n2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 -   - Data directories: 3\n2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 -   - Data files uploaded: 8/8\n2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 -   - Airflow logs uploaded: 2\n2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 -   - Total files uploaded: 10/10\n2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 -   - Total size: 0.09 MB\n2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 -   - Bucket: gs://simprede-data-pipeline\n2025-06-09 09:41:14,797 - INFO - 2025-06-09 09:41:14 -   - Directories cleaned: 3/3\n2025-06-09 09:41:14,800 - INFO - 2025-06-09 09:41:14 - ✅ Export statistics saved: /opt/airflow/data/processed/2025/06/09/gcs_export_stats_20250609.json\n2025-06-09 09:41:14,800 - INFO - 2025-06-09 09:41:14 - ✅ GCS export completed successfully\n2025-06-09 09:41:14,800 - INFO - 2025-06-09 09:41:14 - 📊 Summary: 10 files uploaded (2 logs), 0.09 MB\n2025-06-09 09:41:14,800 - INFO - 2025-06-09 09:41:14 - 🧹 Cleanup: 3 directories cleaned\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
