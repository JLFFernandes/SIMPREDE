{"timestamp":"2025-06-09T08:27:23.705530","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-09T08:27:23.706009","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-09T08:27:23.762627Z","level":"info","event":"🔄 Starting export_to_gcs task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:23.766144Z","level":"info","event":"📁 Using paths from export_supabase task: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:23.767225Z","level":"info","event":"📅 Using provided execution date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:23.767721Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/09', '/opt/airflow/data/structured/2025/06/09', '/opt/airflow/data/processed/2025/06/09']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:23.768375Z","level":"info","event":"📅 GCS Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:23.768790Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:23.769012Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:23.769181Z","level":"info","event":"  - Target date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:23.769418Z","level":"info","event":"  - Base data directory: /opt/airflow/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:23.769555Z","level":"info","event":"  - GCS Project ID: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:23.769693Z","level":"info","event":"  - GCS Bucket: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:23.769804Z","level":"info","event":"🔄 Running GCS export command: python /opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py --date 2025-06-09 --base_data_dir /opt/airflow/data --output_dir /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:23.769934Z","level":"info","event":"⏰ Waiting for GCS export completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:25.766763Z","level":"info","event":"📋 2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - Starting export_to_gcs_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:25.767618Z","level":"info","event":"📋 2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - Parameters: date=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:25.767778Z","level":"info","event":"📋 2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - Paths: base_data_dir=/opt/airflow/data, output_dir=/opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:25.768030Z","level":"info","event":"📋 2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - GCS: project_id=None, bucket=None","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:25.770744Z","level":"info","event":"📋 2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - Airflow logs: include=True, dir=/opt/airflow/logs","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:25.770871Z","level":"info","event":"📋 2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - Cleanup: enabled=True, partial_success=False, dry_run=False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:25.770950Z","level":"info","event":"📋 2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - 🚀 Starting GCS export for date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:25.771907Z","level":"info","event":"📋 2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - 📁 Base data directory: /opt/airflow/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:25.772241Z","level":"info","event":"📋 2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - 📋 Include Airflow logs: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:25.772312Z","level":"info","event":"📋 2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - 🧹 Cleanup after export: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:25.772394Z","level":"info","event":"📋 2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - 🧹 Cleanup on partial success: False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:25.772897Z","level":"info","event":"📋 2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - 🧹 Dry run cleanup: False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:25.772978Z","level":"info","event":"📋 2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - 🔧 GCS Configuration:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:25.773071Z","level":"info","event":"📋 2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 -   - Project ID: simprede-461309","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:25.773606Z","level":"info","event":"📋 2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 -   - Bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:25.773670Z","level":"info","event":"📋 2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 -   - Credentials: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:25.834099Z","level":"info","event":"📋 2025-06-09 09:27:25,833 - INFO - 2025-06-09 09:27:25 - ✅ Initialized GCS client with service account: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:26.245400Z","level":"info","event":"📋 2025-06-09 09:27:26,244 - INFO - 2025-06-09 09:27:26 - ✅ Bucket 'simprede-data-pipeline' already exists","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:26.256506Z","level":"info","event":"📋 2025-06-09 09:27:26,256 - INFO - 2025-06-09 09:27:26 - 📁 Found data directory: /opt/airflow/data/raw/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:26.257624Z","level":"info","event":"📋 2025-06-09 09:27:26,257 - INFO - 2025-06-09 09:27:26 - 📁 Found data directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:26.258524Z","level":"info","event":"📋 2025-06-09 09:27:26,258 - INFO - 2025-06-09 09:27:26 - 📁 Found data directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:26.258781Z","level":"info","event":"📋 2025-06-09 09:27:26,258 - INFO - 2025-06-09 09:27:26 - 📤 Exporting data directory: /opt/airflow/data/raw/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:26.258937Z","level":"info","event":"📋 2025-06-09 09:27:26,258 - INFO - 2025-06-09 09:27:26 - 📁 Scanning directory: /opt/airflow/data/raw/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:26.262591Z","level":"info","event":"📋 2025-06-09 09:27:26,259 - INFO - 2025-06-09 09:27:26 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/intermediate_google_news_20250609.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/intermediate_google_news_20250609.csv (0.12 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:26.548004Z","level":"info","event":"📋 2025-06-09 09:27:26,547 - INFO - 2025-06-09 09:27:26 - ✅ Successfully uploaded: data/raw/2025/06/09/intermediate_google_news_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:26.549075Z","level":"info","event":"📋 2025-06-09 09:27:26,548 - INFO - 2025-06-09 09:27:26 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:26.658020Z","level":"info","event":"📋 2025-06-09 09:27:26,657 - INFO - 2025-06-09 09:27:26 - ✅ Successfully uploaded: data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:26.659000Z","level":"info","event":"📋 2025-06-09 09:27:26,658 - INFO - 2025-06-09 09:27:26 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/google_news_articles_20250609.csv (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:26.808033Z","level":"info","event":"📋 2025-06-09 09:27:26,807 - INFO - 2025-06-09 09:27:26 - ✅ Successfully uploaded: data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:26.808743Z","level":"info","event":"📋 2025-06-09 09:27:26,807 - INFO - 2025-06-09 09:27:26 - 📤 Exporting data directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:26.809028Z","level":"info","event":"📋 2025-06-09 09:27:26,808 - INFO - 2025-06-09 09:27:26 - 📁 Scanning directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:26.809805Z","level":"info","event":"📋 2025-06-09 09:27:26,809 - INFO - 2025-06-09 09:27:26 - 📤 Uploading /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json → gs://simprede-data-pipeline/data/structured/2025/06/09/processing_stats_20250609.json (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:26.964305Z","level":"info","event":"📋 2025-06-09 09:27:26,964 - INFO - 2025-06-09 09:27:26 - ✅ Successfully uploaded: data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:26.964892Z","level":"info","event":"📋 2025-06-09 09:27:26,964 - INFO - 2025-06-09 09:27:26 - 📤 Uploading /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv → gs://simprede-data-pipeline/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.077669Z","level":"info","event":"📋 2025-06-09 09:27:27,077 - INFO - 2025-06-09 09:27:27 - ✅ Successfully uploaded: data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.079985Z","level":"info","event":"📋 2025-06-09 09:27:27,077 - INFO - 2025-06-09 09:27:27 - 📤 Exporting data directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.080287Z","level":"info","event":"📋 2025-06-09 09:27:27,077 - INFO - 2025-06-09 09:27:27 - 📁 Scanning directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.081252Z","level":"info","event":"📋 2025-06-09 09:27:27,081 - INFO - 2025-06-09 09:27:27 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/export_stats_20250609.json → gs://simprede-data-pipeline/data/processed/2025/06/09/export_stats_20250609.json (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.188464Z","level":"info","event":"📋 2025-06-09 09:27:27,187 - INFO - 2025-06-09 09:27:27 - ✅ Successfully uploaded: data/processed/2025/06/09/export_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.189447Z","level":"info","event":"📋 2025-06-09 09:27:27,188 - INFO - 2025-06-09 09:27:27 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv → gs://simprede-data-pipeline/data/processed/2025/06/09/export_backup_20250609.csv (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.295955Z","level":"info","event":"📋 2025-06-09 09:27:27,295 - INFO - 2025-06-09 09:27:27 - ✅ Successfully uploaded: data/processed/2025/06/09/export_backup_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.300268Z","level":"info","event":"📋 2025-06-09 09:27:27,296 - INFO - 2025-06-09 09:27:27 - 📋 Starting Airflow logs export...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.300924Z","level":"info","event":"📋 2025-06-09 09:27:27,296 - INFO - 2025-06-09 09:27:27 - 📋 Starting Airflow logs export for 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.331337Z","level":"info","event":"📋 2025-06-09 09:27:27,331 - INFO - 2025-06-09 09:27:27 - 📋 Found 1 Airflow log paths for 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.331510Z","level":"info","event":"📋 2025-06-09 09:27:27,331 - INFO - 2025-06-09 09:27:27 -   📄 /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.331732Z","level":"info","event":"📋 2025-06-09 09:27:27,331 - INFO - 2025-06-09 09:27:27 - 📁 Scanning directory: /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.332213Z","level":"info","event":"📋 2025-06-09 09:27:27,331 - INFO - 2025-06-09 09:27:27 - 📤 Uploading /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log (0.01 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.435448Z","level":"info","event":"📋 2025-06-09 09:27:27,435 - INFO - 2025-06-09 09:27:27 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.436796Z","level":"info","event":"📋 2025-06-09 09:27:27,436 - INFO - 2025-06-09 09:27:27 - 📤 Uploading /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log (0.02 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.554601Z","level":"info","event":"📋 2025-06-09 09:27:27,553 - INFO - 2025-06-09 09:27:27 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.555482Z","level":"info","event":"📋 2025-06-09 09:27:27,554 - INFO - 2025-06-09 09:27:27 - 📋 Airflow logs export completed: 2 uploaded, 0 failed","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.555707Z","level":"info","event":"📋 2025-06-09 09:27:27,554 - INFO - 2025-06-09 09:27:27 - 🧹 Starting cleanup of exported data directories...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.555893Z","level":"info","event":"📋 2025-06-09 09:27:27,554 - INFO - 2025-06-09 09:27:27 - 🧹 Starting cleanup of 3 data directories","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.556298Z","level":"info","event":"📋 2025-06-09 09:27:27,554 - INFO - 2025-06-09 09:27:27 - ✅ All files from /opt/airflow/data/raw/2025/06/09 uploaded successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.556512Z","level":"info","event":"📋 2025-06-09 09:27:27,556 - INFO - 2025-06-09 09:27:27 - 🗑️ Deleting directory: /opt/airflow/data/raw/2025/06/09 (0.12 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.561760Z","level":"info","event":"📋 2025-06-09 09:27:27,561 - INFO - 2025-06-09 09:27:27 - ✅ Successfully deleted directory: /opt/airflow/data/raw/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.562525Z","level":"info","event":"📋 2025-06-09 09:27:27,561 - INFO - 2025-06-09 09:27:27 - ✅ All files from /opt/airflow/data/structured/2025/06/09 uploaded successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.563141Z","level":"info","event":"📋 2025-06-09 09:27:27,562 - INFO - 2025-06-09 09:27:27 - 🗑️ Deleting directory: /opt/airflow/data/structured/2025/06/09 (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.564829Z","level":"info","event":"📋 2025-06-09 09:27:27,564 - INFO - 2025-06-09 09:27:27 - ✅ Successfully deleted directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.565102Z","level":"info","event":"📋 2025-06-09 09:27:27,564 - INFO - 2025-06-09 09:27:27 - ✅ All files from /opt/airflow/data/processed/2025/06/09 uploaded successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.565526Z","level":"info","event":"📋 2025-06-09 09:27:27,565 - INFO - 2025-06-09 09:27:27 - 🗑️ Deleting directory: /opt/airflow/data/processed/2025/06/09 (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.567046Z","level":"info","event":"📋 2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 - ✅ Successfully deleted directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.567260Z","level":"info","event":"📋 2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 - 🧹 Cleanup completed: 3/3 directories cleaned","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.567513Z","level":"info","event":"📋 2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 - ✅ Export completed:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.567706Z","level":"info","event":"📋 2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 -   - Data directories: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.567946Z","level":"info","event":"📋 2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 -   - Data files uploaded: 7/7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.568048Z","level":"info","event":"📋 2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 -   - Airflow logs uploaded: 2","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.568318Z","level":"info","event":"📋 2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 -   - Total files uploaded: 9/9","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.568564Z","level":"info","event":"📋 2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 -   - Total size: 0.16 MB","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.568750Z","level":"info","event":"📋 2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 -   - Bucket: gs://simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.568994Z","level":"info","event":"📋 2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 -   - Directories cleaned: 3/3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.569492Z","level":"info","event":"📋 2025-06-09 09:27:27,568 - INFO - 2025-06-09 09:27:27 - ✅ Export statistics saved: /opt/airflow/data/processed/2025/06/09/gcs_export_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.572260Z","level":"info","event":"📋 2025-06-09 09:27:27,568 - INFO - 2025-06-09 09:27:27 - ✅ GCS export completed successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.572376Z","level":"info","event":"📋 2025-06-09 09:27:27,569 - INFO - 2025-06-09 09:27:27 - 📊 Summary: 9 files uploaded (2 logs), 0.16 MB","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.573398Z","level":"info","event":"📋 2025-06-09 09:27:27,569 - INFO - 2025-06-09 09:27:27 - 🧹 Cleanup: 3 directories cleaned","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.683637Z","level":"info","event":"✅ GCS export completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.685453Z","level":"info","event":"📊 Successfully uploaded 9 files to GCS","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.685624Z","level":"info","event":"📊 Total size uploaded: 0.12 MB","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.685781Z","level":"info","event":"☁️ GCS bucket: gs://simprede-data-pipeline/data/raw/2025/06/09/intermediate_google_news_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:27.687986","level":"info","event":"Done. Returned value was: 2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - Starting export_to_gcs_airflow\n2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - Parameters: date=2025-06-09\n2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - Paths: base_data_dir=/opt/airflow/data, output_dir=/opt/airflow/data/processed/2025/06/09\n2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - GCS: project_id=None, bucket=None\n2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - Airflow logs: include=True, dir=/opt/airflow/logs\n2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - Cleanup: enabled=True, partial_success=False, dry_run=False\n2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - 🚀 Starting GCS export for date: 2025-06-09\n2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - 📁 Base data directory: /opt/airflow/data\n2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - 📋 Include Airflow logs: True\n2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - 🧹 Cleanup after export: True\n2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - 🧹 Cleanup on partial success: False\n2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - 🧹 Dry run cleanup: False\n2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 - 🔧 GCS Configuration:\n2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 -   - Project ID: simprede-461309\n2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 -   - Bucket: simprede-data-pipeline\n2025-06-09 09:27:25,766 - INFO - 2025-06-09 09:27:25 -   - Credentials: /opt/airflow/config/gcs-credentials.json\n2025-06-09 09:27:25,833 - INFO - 2025-06-09 09:27:25 - ✅ Initialized GCS client with service account: /opt/airflow/config/gcs-credentials.json\n2025-06-09 09:27:26,244 - INFO - 2025-06-09 09:27:26 - ✅ Bucket 'simprede-data-pipeline' already exists\n2025-06-09 09:27:26,256 - INFO - 2025-06-09 09:27:26 - 📁 Found data directory: /opt/airflow/data/raw/2025/06/09\n2025-06-09 09:27:26,257 - INFO - 2025-06-09 09:27:26 - 📁 Found data directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:27:26,258 - INFO - 2025-06-09 09:27:26 - 📁 Found data directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 09:27:26,258 - INFO - 2025-06-09 09:27:26 - 📤 Exporting data directory: /opt/airflow/data/raw/2025/06/09\n2025-06-09 09:27:26,258 - INFO - 2025-06-09 09:27:26 - 📁 Scanning directory: /opt/airflow/data/raw/2025/06/09\n2025-06-09 09:27:26,259 - INFO - 2025-06-09 09:27:26 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/intermediate_google_news_20250609.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/intermediate_google_news_20250609.csv (0.12 MB)\n2025-06-09 09:27:26,547 - INFO - 2025-06-09 09:27:26 - ✅ Successfully uploaded: data/raw/2025/06/09/intermediate_google_news_20250609.csv\n2025-06-09 09:27:26,548 - INFO - 2025-06-09 09:27:26 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (0.00 MB)\n2025-06-09 09:27:26,657 - INFO - 2025-06-09 09:27:26 - ✅ Successfully uploaded: data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:27:26,658 - INFO - 2025-06-09 09:27:26 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/google_news_articles_20250609.csv (0.00 MB)\n2025-06-09 09:27:26,807 - INFO - 2025-06-09 09:27:26 - ✅ Successfully uploaded: data/raw/2025/06/09/google_news_articles_20250609.csv\n2025-06-09 09:27:26,807 - INFO - 2025-06-09 09:27:26 - 📤 Exporting data directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:27:26,808 - INFO - 2025-06-09 09:27:26 - 📁 Scanning directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:27:26,809 - INFO - 2025-06-09 09:27:26 - 📤 Uploading /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json → gs://simprede-data-pipeline/data/structured/2025/06/09/processing_stats_20250609.json (0.00 MB)\n2025-06-09 09:27:26,964 - INFO - 2025-06-09 09:27:26 - ✅ Successfully uploaded: data/structured/2025/06/09/processing_stats_20250609.json\n2025-06-09 09:27:26,964 - INFO - 2025-06-09 09:27:26 - 📤 Uploading /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv → gs://simprede-data-pipeline/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (0.00 MB)\n2025-06-09 09:27:27,077 - INFO - 2025-06-09 09:27:27 - ✅ Successfully uploaded: data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:27:27,077 - INFO - 2025-06-09 09:27:27 - 📤 Exporting data directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 09:27:27,077 - INFO - 2025-06-09 09:27:27 - 📁 Scanning directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 09:27:27,081 - INFO - 2025-06-09 09:27:27 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/export_stats_20250609.json → gs://simprede-data-pipeline/data/processed/2025/06/09/export_stats_20250609.json (0.00 MB)\n2025-06-09 09:27:27,187 - INFO - 2025-06-09 09:27:27 - ✅ Successfully uploaded: data/processed/2025/06/09/export_stats_20250609.json\n2025-06-09 09:27:27,188 - INFO - 2025-06-09 09:27:27 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv → gs://simprede-data-pipeline/data/processed/2025/06/09/export_backup_20250609.csv (0.00 MB)\n2025-06-09 09:27:27,295 - INFO - 2025-06-09 09:27:27 - ✅ Successfully uploaded: data/processed/2025/06/09/export_backup_20250609.csv\n2025-06-09 09:27:27,296 - INFO - 2025-06-09 09:27:27 - 📋 Starting Airflow logs export...\n2025-06-09 09:27:27,296 - INFO - 2025-06-09 09:27:27 - 📋 Starting Airflow logs export for 2025-06-09\n2025-06-09 09:27:27,331 - INFO - 2025-06-09 09:27:27 - 📋 Found 1 Airflow log paths for 2025-06-09\n2025-06-09 09:27:27,331 - INFO - 2025-06-09 09:27:27 -   📄 /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__\n2025-06-09 09:27:27,331 - INFO - 2025-06-09 09:27:27 - 📁 Scanning directory: /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__\n2025-06-09 09:27:27,331 - INFO - 2025-06-09 09:27:27 - 📤 Uploading /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log (0.01 MB)\n2025-06-09 09:27:27,435 - INFO - 2025-06-09 09:27:27 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log\n2025-06-09 09:27:27,436 - INFO - 2025-06-09 09:27:27 - 📤 Uploading /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log (0.02 MB)\n2025-06-09 09:27:27,553 - INFO - 2025-06-09 09:27:27 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log\n2025-06-09 09:27:27,554 - INFO - 2025-06-09 09:27:27 - 📋 Airflow logs export completed: 2 uploaded, 0 failed\n2025-06-09 09:27:27,554 - INFO - 2025-06-09 09:27:27 - 🧹 Starting cleanup of exported data directories...\n2025-06-09 09:27:27,554 - INFO - 2025-06-09 09:27:27 - 🧹 Starting cleanup of 3 data directories\n2025-06-09 09:27:27,554 - INFO - 2025-06-09 09:27:27 - ✅ All files from /opt/airflow/data/raw/2025/06/09 uploaded successfully\n2025-06-09 09:27:27,556 - INFO - 2025-06-09 09:27:27 - 🗑️ Deleting directory: /opt/airflow/data/raw/2025/06/09 (0.12 MB)\n2025-06-09 09:27:27,561 - INFO - 2025-06-09 09:27:27 - ✅ Successfully deleted directory: /opt/airflow/data/raw/2025/06/09\n2025-06-09 09:27:27,561 - INFO - 2025-06-09 09:27:27 - ✅ All files from /opt/airflow/data/structured/2025/06/09 uploaded successfully\n2025-06-09 09:27:27,562 - INFO - 2025-06-09 09:27:27 - 🗑️ Deleting directory: /opt/airflow/data/structured/2025/06/09 (0.00 MB)\n2025-06-09 09:27:27,564 - INFO - 2025-06-09 09:27:27 - ✅ Successfully deleted directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:27:27,564 - INFO - 2025-06-09 09:27:27 - ✅ All files from /opt/airflow/data/processed/2025/06/09 uploaded successfully\n2025-06-09 09:27:27,565 - INFO - 2025-06-09 09:27:27 - 🗑️ Deleting directory: /opt/airflow/data/processed/2025/06/09 (0.00 MB)\n2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 - ✅ Successfully deleted directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 - 🧹 Cleanup completed: 3/3 directories cleaned\n2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 - ✅ Export completed:\n2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 -   - Data directories: 3\n2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 -   - Data files uploaded: 7/7\n2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 -   - Airflow logs uploaded: 2\n2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 -   - Total files uploaded: 9/9\n2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 -   - Total size: 0.16 MB\n2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 -   - Bucket: gs://simprede-data-pipeline\n2025-06-09 09:27:27,566 - INFO - 2025-06-09 09:27:27 -   - Directories cleaned: 3/3\n2025-06-09 09:27:27,568 - INFO - 2025-06-09 09:27:27 - ✅ Export statistics saved: /opt/airflow/data/processed/2025/06/09/gcs_export_stats_20250609.json\n2025-06-09 09:27:27,568 - INFO - 2025-06-09 09:27:27 - ✅ GCS export completed successfully\n2025-06-09 09:27:27,569 - INFO - 2025-06-09 09:27:27 - 📊 Summary: 9 files uploaded (2 logs), 0.16 MB\n2025-06-09 09:27:27,569 - INFO - 2025-06-09 09:27:27 - 🧹 Cleanup: 3 directories cleaned\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-06-09T19:37:29.135952","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-09T19:37:29.136219","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-09T19:37:29.163411Z","level":"info","event":"🔄 Starting export_to_gcs task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.164793Z","level":"info","event":"📁 Using paths from export_supabase task: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.165872Z","level":"info","event":"📅 Using provided execution date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.166236Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/09', '/opt/airflow/data/structured/2025/06/09', '/opt/airflow/data/processed/2025/06/09']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.166630Z","level":"info","event":"📅 GCS Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.166825Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.166925Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.166981Z","level":"info","event":"  - Target date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.167040Z","level":"info","event":"  - Base data directory: /opt/airflow/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.167081Z","level":"info","event":"  - GCS Project ID: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.167119Z","level":"info","event":"  - GCS Bucket: From config/environment","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.167157Z","level":"info","event":"🔄 Running GCS export command: python /opt/airflow/scripts/google_scraper/exportador_gcs/export_to_gcs_airflow.py --date 2025-06-09 --base_data_dir /opt/airflow/data --output_dir /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.167209Z","level":"info","event":"⏰ Waiting for GCS export completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.863946Z","level":"info","event":"📋 2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - Starting export_to_gcs_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.865640Z","level":"info","event":"📋 2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - Parameters: date=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.865771Z","level":"info","event":"📋 2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - Paths: base_data_dir=/opt/airflow/data, output_dir=/opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.865929Z","level":"info","event":"📋 2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - GCS: project_id=None, bucket=None","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.866023Z","level":"info","event":"📋 2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - Airflow logs: include=True, dir=/opt/airflow/logs","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.866090Z","level":"info","event":"📋 2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - Cleanup: enabled=True, partial_success=False, dry_run=False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.866166Z","level":"info","event":"📋 2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - 🚀 Starting GCS export for date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.866497Z","level":"info","event":"📋 2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - 📁 Base data directory: /opt/airflow/data","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.866566Z","level":"info","event":"📋 2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - 📋 Include Airflow logs: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.866626Z","level":"info","event":"📋 2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - 🧹 Cleanup after export: True","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.866679Z","level":"info","event":"📋 2025-06-09 20:37:29,864 - INFO - 2025-06-09 20:37:29 - 🧹 Cleanup on partial success: False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.866754Z","level":"info","event":"📋 2025-06-09 20:37:29,864 - INFO - 2025-06-09 20:37:29 - 🧹 Dry run cleanup: False","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.867149Z","level":"info","event":"📋 2025-06-09 20:37:29,864 - INFO - 2025-06-09 20:37:29 - 🔧 GCS Configuration:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.867207Z","level":"info","event":"📋 2025-06-09 20:37:29,864 - INFO - 2025-06-09 20:37:29 -   - Project ID: simprede-461309","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.867290Z","level":"info","event":"📋 2025-06-09 20:37:29,864 - INFO - 2025-06-09 20:37:29 -   - Bucket: simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.867335Z","level":"info","event":"📋 2025-06-09 20:37:29,864 - INFO - 2025-06-09 20:37:29 -   - Credentials: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:29.911037Z","level":"info","event":"📋 2025-06-09 20:37:29,910 - INFO - 2025-06-09 20:37:29 - ✅ Initialized GCS client with service account: /opt/airflow/config/gcs-credentials.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:30.223526Z","level":"info","event":"📋 2025-06-09 20:37:30,223 - INFO - 2025-06-09 20:37:30 - ✅ Bucket 'simprede-data-pipeline' already exists","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:30.230125Z","level":"info","event":"📋 2025-06-09 20:37:30,229 - INFO - 2025-06-09 20:37:30 - 📁 Found data directory: /opt/airflow/data/raw/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:30.230836Z","level":"info","event":"📋 2025-06-09 20:37:30,230 - INFO - 2025-06-09 20:37:30 - 📁 Found data directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:30.231686Z","level":"info","event":"📋 2025-06-09 20:37:30,231 - INFO - 2025-06-09 20:37:30 - 📁 Found data directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:30.231969Z","level":"info","event":"📋 2025-06-09 20:37:30,231 - INFO - 2025-06-09 20:37:30 - 📤 Exporting data directory: /opt/airflow/data/raw/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:30.232115Z","level":"info","event":"📋 2025-06-09 20:37:30,231 - INFO - 2025-06-09 20:37:30 - 📁 Scanning directory: /opt/airflow/data/raw/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:30.234781Z","level":"info","event":"📋 2025-06-09 20:37:30,232 - INFO - 2025-06-09 20:37:30 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/intermediate_google_news_20250609.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/intermediate_google_news_20250609.csv (0.31 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:30.561498Z","level":"info","event":"📋 2025-06-09 20:37:30,561 - INFO - 2025-06-09 20:37:30 - ✅ Successfully uploaded: data/raw/2025/06/09/intermediate_google_news_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:30.562133Z","level":"info","event":"📋 2025-06-09 20:37:30,561 - INFO - 2025-06-09 20:37:30 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:30.718758Z","level":"info","event":"📋 2025-06-09 20:37:30,718 - INFO - 2025-06-09 20:37:30 - ✅ Successfully uploaded: data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:30.719445Z","level":"info","event":"📋 2025-06-09 20:37:30,719 - INFO - 2025-06-09 20:37:30 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/google_news_articles_20250609.csv (0.01 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:30.900519Z","level":"info","event":"📋 2025-06-09 20:37:30,900 - INFO - 2025-06-09 20:37:30 - ✅ Successfully uploaded: data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:30.901346Z","level":"info","event":"📋 2025-06-09 20:37:30,900 - INFO - 2025-06-09 20:37:30 - 📤 Exporting data directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:30.901524Z","level":"info","event":"📋 2025-06-09 20:37:30,900 - INFO - 2025-06-09 20:37:30 - 📁 Scanning directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:30.902165Z","level":"info","event":"📋 2025-06-09 20:37:30,901 - INFO - 2025-06-09 20:37:30 - 📤 Uploading /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json → gs://simprede-data-pipeline/data/structured/2025/06/09/processing_stats_20250609.json (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.094524Z","level":"info","event":"📋 2025-06-09 20:37:31,094 - INFO - 2025-06-09 20:37:31 - ✅ Successfully uploaded: data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.095187Z","level":"info","event":"📋 2025-06-09 20:37:31,094 - INFO - 2025-06-09 20:37:31 - 📤 Uploading /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv → gs://simprede-data-pipeline/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.205539Z","level":"info","event":"📋 2025-06-09 20:37:31,205 - INFO - 2025-06-09 20:37:31 - ✅ Successfully uploaded: data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.205965Z","level":"info","event":"📋 2025-06-09 20:37:31,205 - INFO - 2025-06-09 20:37:31 - 📤 Exporting data directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.206458Z","level":"info","event":"📋 2025-06-09 20:37:31,205 - INFO - 2025-06-09 20:37:31 - 📁 Scanning directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.207064Z","level":"info","event":"📋 2025-06-09 20:37:31,206 - INFO - 2025-06-09 20:37:31 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/gcs_export_stats_20250609.json → gs://simprede-data-pipeline/data/processed/2025/06/09/gcs_export_stats_20250609.json (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.320059Z","level":"info","event":"📋 2025-06-09 20:37:31,319 - INFO - 2025-06-09 20:37:31 - ✅ Successfully uploaded: data/processed/2025/06/09/gcs_export_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.320499Z","level":"info","event":"📋 2025-06-09 20:37:31,320 - INFO - 2025-06-09 20:37:31 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/export_stats_20250609.json → gs://simprede-data-pipeline/data/processed/2025/06/09/export_stats_20250609.json (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.431147Z","level":"info","event":"📋 2025-06-09 20:37:31,430 - INFO - 2025-06-09 20:37:31 - ✅ Successfully uploaded: data/processed/2025/06/09/export_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.431813Z","level":"info","event":"📋 2025-06-09 20:37:31,431 - INFO - 2025-06-09 20:37:31 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv → gs://simprede-data-pipeline/data/processed/2025/06/09/export_backup_20250609.csv (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.535840Z","level":"info","event":"📋 2025-06-09 20:37:31,535 - INFO - 2025-06-09 20:37:31 - ✅ Successfully uploaded: data/processed/2025/06/09/export_backup_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.537359Z","level":"info","event":"📋 2025-06-09 20:37:31,535 - INFO - 2025-06-09 20:37:31 - 📋 Starting Airflow logs export...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.537637Z","level":"info","event":"📋 2025-06-09 20:37:31,535 - INFO - 2025-06-09 20:37:31 - 📋 Starting Airflow logs export for 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.564253Z","level":"info","event":"📋 2025-06-09 20:37:31,564 - INFO - 2025-06-09 20:37:31 - 📋 Found 3 Airflow log paths for 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.564368Z","level":"info","event":"📋 2025-06-09 20:37:31,564 - INFO - 2025-06-09 20:37:31 -   📄 /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.564419Z","level":"info","event":"📋 2025-06-09 20:37:31,564 - INFO - 2025-06-09 20:37:31 -   📄 /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.564476Z","level":"info","event":"📋 2025-06-09 20:37:31,564 - INFO - 2025-06-09 20:37:31 -   📄 /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T20:32:24.251142+01:00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.564537Z","level":"info","event":"📋 2025-06-09 20:37:31,564 - INFO - 2025-06-09 20:37:31 - 📁 Scanning directory: /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.564822Z","level":"info","event":"📋 2025-06-09 20:37:31,564 - INFO - 2025-06-09 20:37:31 - 📤 Uploading /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log (0.01 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.688939Z","level":"info","event":"📋 2025-06-09 20:37:31,688 - INFO - 2025-06-09 20:37:31 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.689680Z","level":"info","event":"📋 2025-06-09 20:37:31,689 - INFO - 2025-06-09 20:37:31 - 📤 Uploading /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log (0.02 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.802550Z","level":"info","event":"📋 2025-06-09 20:37:31,802 - INFO - 2025-06-09 20:37:31 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.803234Z","level":"info","event":"📋 2025-06-09 20:37:31,802 - INFO - 2025-06-09 20:37:31 - 📁 Scanning directory: /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.805718Z","level":"info","event":"📋 2025-06-09 20:37:31,805 - INFO - 2025-06-09 20:37:31 - 📤 Uploading /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=check_providers/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=check_providers/attempt=1.log (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.912616Z","level":"info","event":"📋 2025-06-09 20:37:31,912 - INFO - 2025-06-09 20:37:31 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=check_providers/attempt=1.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:31.913933Z","level":"info","event":"📋 2025-06-09 20:37:31,913 - INFO - 2025-06-09 20:37:31 - 📤 Uploading /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=setup_supabase_connection/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=setup_supabase_connection/attempt=1.log (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.024427Z","level":"info","event":"📋 2025-06-09 20:37:32,024 - INFO - 2025-06-09 20:37:32 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=setup_supabase_connection/attempt=1.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.024717Z","level":"info","event":"📋 2025-06-09 20:37:32,024 - INFO - 2025-06-09 20:37:32 - 📤 Uploading /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=setup_supabase_connection/attempt=2.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=setup_supabase_connection/attempt=2.log (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.165928Z","level":"info","event":"📋 2025-06-09 20:37:32,165 - INFO - 2025-06-09 20:37:32 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=setup_supabase_connection/attempt=2.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.166296Z","level":"info","event":"📋 2025-06-09 20:37:32,166 - INFO - 2025-06-09 20:37:32 - 📁 Scanning directory: /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T20:32:24.251142+01:00","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.167500Z","level":"info","event":"📋 2025-06-09 20:37:32,167 - INFO - 2025-06-09 20:37:32 - 📤 Uploading /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T20:32:24.251142+01:00/task_id=check_providers/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T20:32:24.251142+01:00/task_id=check_providers/attempt=1.log (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.266723Z","level":"info","event":"📋 2025-06-09 20:37:32,266 - INFO - 2025-06-09 20:37:32 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T20:32:24.251142+01:00/task_id=check_providers/attempt=1.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.267967Z","level":"info","event":"📋 2025-06-09 20:37:32,267 - INFO - 2025-06-09 20:37:32 - 📤 Uploading /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T20:32:24.251142+01:00/task_id=setup_supabase_connection/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T20:32:24.251142+01:00/task_id=setup_supabase_connection/attempt=1.log (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.382380Z","level":"info","event":"📋 2025-06-09 20:37:32,382 - INFO - 2025-06-09 20:37:32 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T20:32:24.251142+01:00/task_id=setup_supabase_connection/attempt=1.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.382914Z","level":"info","event":"📋 2025-06-09 20:37:32,382 - INFO - 2025-06-09 20:37:32 - 📋 Airflow logs export completed: 7 uploaded, 0 failed","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.383223Z","level":"info","event":"📋 2025-06-09 20:37:32,382 - INFO - 2025-06-09 20:37:32 - 🧹 Starting cleanup of exported data directories...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.383491Z","level":"info","event":"📋 2025-06-09 20:37:32,382 - INFO - 2025-06-09 20:37:32 - 🧹 Starting cleanup of 3 data directories","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.383644Z","level":"info","event":"📋 2025-06-09 20:37:32,382 - INFO - 2025-06-09 20:37:32 - ✅ All files from /opt/airflow/data/raw/2025/06/09 uploaded successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.383834Z","level":"info","event":"📋 2025-06-09 20:37:32,383 - INFO - 2025-06-09 20:37:32 - 🗑️ Deleting directory: /opt/airflow/data/raw/2025/06/09 (0.32 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.385095Z","level":"info","event":"📋 2025-06-09 20:37:32,384 - INFO - 2025-06-09 20:37:32 - ✅ Successfully deleted directory: /opt/airflow/data/raw/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.385336Z","level":"info","event":"📋 2025-06-09 20:37:32,385 - INFO - 2025-06-09 20:37:32 - ✅ All files from /opt/airflow/data/structured/2025/06/09 uploaded successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.385716Z","level":"info","event":"📋 2025-06-09 20:37:32,385 - INFO - 2025-06-09 20:37:32 - 🗑️ Deleting directory: /opt/airflow/data/structured/2025/06/09 (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.386795Z","level":"info","event":"📋 2025-06-09 20:37:32,386 - INFO - 2025-06-09 20:37:32 - ✅ Successfully deleted directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.387043Z","level":"info","event":"📋 2025-06-09 20:37:32,386 - INFO - 2025-06-09 20:37:32 - ✅ All files from /opt/airflow/data/processed/2025/06/09 uploaded successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.387421Z","level":"info","event":"📋 2025-06-09 20:37:32,387 - INFO - 2025-06-09 20:37:32 - 🗑️ Deleting directory: /opt/airflow/data/processed/2025/06/09 (0.00 MB)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.390943Z","level":"info","event":"📋 2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 - ✅ Successfully deleted directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.391100Z","level":"info","event":"📋 2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 - 🧹 Cleanup completed: 3/3 directories cleaned","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.391255Z","level":"info","event":"📋 2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 - ✅ Export completed:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.391578Z","level":"info","event":"📋 2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 -   - Data directories: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.391812Z","level":"info","event":"📋 2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 -   - Data files uploaded: 8/8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.392101Z","level":"info","event":"📋 2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 -   - Airflow logs uploaded: 7","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.392536Z","level":"info","event":"📋 2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 -   - Total files uploaded: 15/15","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.392825Z","level":"info","event":"📋 2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 -   - Total size: 0.37 MB","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.393033Z","level":"info","event":"📋 2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 -   - Bucket: gs://simprede-data-pipeline","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.393273Z","level":"info","event":"📋 2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 -   - Directories cleaned: 3/3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.395930Z","level":"info","event":"📋 2025-06-09 20:37:32,393 - INFO - 2025-06-09 20:37:32 - ✅ Export statistics saved: /opt/airflow/data/processed/2025/06/09/gcs_export_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.396245Z","level":"info","event":"📋 2025-06-09 20:37:32,393 - INFO - 2025-06-09 20:37:32 - ✅ GCS export completed successfully","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.396509Z","level":"info","event":"📋 2025-06-09 20:37:32,393 - INFO - 2025-06-09 20:37:32 - 📊 Summary: 15 files uploaded (7 logs), 0.37 MB","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.397803Z","level":"info","event":"📋 2025-06-09 20:37:32,393 - INFO - 2025-06-09 20:37:32 - 🧹 Cleanup: 3 directories cleaned","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.482474Z","level":"info","event":"✅ GCS export completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.483094Z","level":"info","event":"📊 Successfully uploaded 15 files to GCS","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.483176Z","level":"info","event":"📊 Total size uploaded: 0.31 MB","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.483271Z","level":"info","event":"☁️ GCS bucket: gs://simprede-data-pipeline/data/raw/2025/06/09/intermediate_google_news_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T19:37:32.483444","level":"info","event":"Done. Returned value was: 2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - Starting export_to_gcs_airflow\n2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - Parameters: date=2025-06-09\n2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - Paths: base_data_dir=/opt/airflow/data, output_dir=/opt/airflow/data/processed/2025/06/09\n2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - GCS: project_id=None, bucket=None\n2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - Airflow logs: include=True, dir=/opt/airflow/logs\n2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - Cleanup: enabled=True, partial_success=False, dry_run=False\n2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - 🚀 Starting GCS export for date: 2025-06-09\n2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - 📁 Base data directory: /opt/airflow/data\n2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - 📋 Include Airflow logs: True\n2025-06-09 20:37:29,863 - INFO - 2025-06-09 20:37:29 - 🧹 Cleanup after export: True\n2025-06-09 20:37:29,864 - INFO - 2025-06-09 20:37:29 - 🧹 Cleanup on partial success: False\n2025-06-09 20:37:29,864 - INFO - 2025-06-09 20:37:29 - 🧹 Dry run cleanup: False\n2025-06-09 20:37:29,864 - INFO - 2025-06-09 20:37:29 - 🔧 GCS Configuration:\n2025-06-09 20:37:29,864 - INFO - 2025-06-09 20:37:29 -   - Project ID: simprede-461309\n2025-06-09 20:37:29,864 - INFO - 2025-06-09 20:37:29 -   - Bucket: simprede-data-pipeline\n2025-06-09 20:37:29,864 - INFO - 2025-06-09 20:37:29 -   - Credentials: /opt/airflow/config/gcs-credentials.json\n2025-06-09 20:37:29,910 - INFO - 2025-06-09 20:37:29 - ✅ Initialized GCS client with service account: /opt/airflow/config/gcs-credentials.json\n2025-06-09 20:37:30,223 - INFO - 2025-06-09 20:37:30 - ✅ Bucket 'simprede-data-pipeline' already exists\n2025-06-09 20:37:30,229 - INFO - 2025-06-09 20:37:30 - 📁 Found data directory: /opt/airflow/data/raw/2025/06/09\n2025-06-09 20:37:30,230 - INFO - 2025-06-09 20:37:30 - 📁 Found data directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 20:37:30,231 - INFO - 2025-06-09 20:37:30 - 📁 Found data directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 20:37:30,231 - INFO - 2025-06-09 20:37:30 - 📤 Exporting data directory: /opt/airflow/data/raw/2025/06/09\n2025-06-09 20:37:30,231 - INFO - 2025-06-09 20:37:30 - 📁 Scanning directory: /opt/airflow/data/raw/2025/06/09\n2025-06-09 20:37:30,232 - INFO - 2025-06-09 20:37:30 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/intermediate_google_news_20250609.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/intermediate_google_news_20250609.csv (0.31 MB)\n2025-06-09 20:37:30,561 - INFO - 2025-06-09 20:37:30 - ✅ Successfully uploaded: data/raw/2025/06/09/intermediate_google_news_20250609.csv\n2025-06-09 20:37:30,561 - INFO - 2025-06-09 20:37:30 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (0.00 MB)\n2025-06-09 20:37:30,718 - INFO - 2025-06-09 20:37:30 - ✅ Successfully uploaded: data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 20:37:30,719 - INFO - 2025-06-09 20:37:30 - 📤 Uploading /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv → gs://simprede-data-pipeline/data/raw/2025/06/09/google_news_articles_20250609.csv (0.01 MB)\n2025-06-09 20:37:30,900 - INFO - 2025-06-09 20:37:30 - ✅ Successfully uploaded: data/raw/2025/06/09/google_news_articles_20250609.csv\n2025-06-09 20:37:30,900 - INFO - 2025-06-09 20:37:30 - 📤 Exporting data directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 20:37:30,900 - INFO - 2025-06-09 20:37:30 - 📁 Scanning directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 20:37:30,901 - INFO - 2025-06-09 20:37:30 - 📤 Uploading /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json → gs://simprede-data-pipeline/data/structured/2025/06/09/processing_stats_20250609.json (0.00 MB)\n2025-06-09 20:37:31,094 - INFO - 2025-06-09 20:37:31 - ✅ Successfully uploaded: data/structured/2025/06/09/processing_stats_20250609.json\n2025-06-09 20:37:31,094 - INFO - 2025-06-09 20:37:31 - 📤 Uploading /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv → gs://simprede-data-pipeline/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (0.00 MB)\n2025-06-09 20:37:31,205 - INFO - 2025-06-09 20:37:31 - ✅ Successfully uploaded: data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 20:37:31,205 - INFO - 2025-06-09 20:37:31 - 📤 Exporting data directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 20:37:31,205 - INFO - 2025-06-09 20:37:31 - 📁 Scanning directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 20:37:31,206 - INFO - 2025-06-09 20:37:31 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/gcs_export_stats_20250609.json → gs://simprede-data-pipeline/data/processed/2025/06/09/gcs_export_stats_20250609.json (0.00 MB)\n2025-06-09 20:37:31,319 - INFO - 2025-06-09 20:37:31 - ✅ Successfully uploaded: data/processed/2025/06/09/gcs_export_stats_20250609.json\n2025-06-09 20:37:31,320 - INFO - 2025-06-09 20:37:31 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/export_stats_20250609.json → gs://simprede-data-pipeline/data/processed/2025/06/09/export_stats_20250609.json (0.00 MB)\n2025-06-09 20:37:31,430 - INFO - 2025-06-09 20:37:31 - ✅ Successfully uploaded: data/processed/2025/06/09/export_stats_20250609.json\n2025-06-09 20:37:31,431 - INFO - 2025-06-09 20:37:31 - 📤 Uploading /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv → gs://simprede-data-pipeline/data/processed/2025/06/09/export_backup_20250609.csv (0.00 MB)\n2025-06-09 20:37:31,535 - INFO - 2025-06-09 20:37:31 - ✅ Successfully uploaded: data/processed/2025/06/09/export_backup_20250609.csv\n2025-06-09 20:37:31,535 - INFO - 2025-06-09 20:37:31 - 📋 Starting Airflow logs export...\n2025-06-09 20:37:31,535 - INFO - 2025-06-09 20:37:31 - 📋 Starting Airflow logs export for 2025-06-09\n2025-06-09 20:37:31,564 - INFO - 2025-06-09 20:37:31 - 📋 Found 3 Airflow log paths for 2025-06-09\n2025-06-09 20:37:31,564 - INFO - 2025-06-09 20:37:31 -   📄 /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__\n2025-06-09 20:37:31,564 - INFO - 2025-06-09 20:37:31 -   📄 /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00\n2025-06-09 20:37:31,564 - INFO - 2025-06-09 20:37:31 -   📄 /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T20:32:24.251142+01:00\n2025-06-09 20:37:31,564 - INFO - 2025-06-09 20:37:31 - 📁 Scanning directory: /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__\n2025-06-09 20:37:31,564 - INFO - 2025-06-09 20:37:31 - 📤 Uploading /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log (0.01 MB)\n2025-06-09 20:37:31,688 - INFO - 2025-06-09 20:37:31 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=verificar_directorio_dados/attempt=1.log\n2025-06-09 20:37:31,689 - INFO - 2025-06-09 20:37:31 - 📤 Uploading /opt/airflow/logs/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log (0.02 MB)\n2025-06-09 20:37:31,802 - INFO - 2025-06-09 20:37:31 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=pipeline_scraper_google/run_id=__airflow_temporary_run_2025-06-09T09:20:45.263813+01:00__/task_id=executar_scraper_airflow/attempt=1.log\n2025-06-09 20:37:31,802 - INFO - 2025-06-09 20:37:31 - 📁 Scanning directory: /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00\n2025-06-09 20:37:31,805 - INFO - 2025-06-09 20:37:31 - 📤 Uploading /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=check_providers/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=check_providers/attempt=1.log (0.00 MB)\n2025-06-09 20:37:31,912 - INFO - 2025-06-09 20:37:31 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=check_providers/attempt=1.log\n2025-06-09 20:37:31,913 - INFO - 2025-06-09 20:37:31 - 📤 Uploading /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=setup_supabase_connection/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=setup_supabase_connection/attempt=1.log (0.00 MB)\n2025-06-09 20:37:32,024 - INFO - 2025-06-09 20:37:32 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=setup_supabase_connection/attempt=1.log\n2025-06-09 20:37:32,024 - INFO - 2025-06-09 20:37:32 - 📤 Uploading /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=setup_supabase_connection/attempt=2.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=setup_supabase_connection/attempt=2.log (0.00 MB)\n2025-06-09 20:37:32,165 - INFO - 2025-06-09 20:37:32 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T12:28:16.318191+01:00/task_id=setup_supabase_connection/attempt=2.log\n2025-06-09 20:37:32,166 - INFO - 2025-06-09 20:37:32 - 📁 Scanning directory: /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T20:32:24.251142+01:00\n2025-06-09 20:37:32,167 - INFO - 2025-06-09 20:37:32 - 📤 Uploading /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T20:32:24.251142+01:00/task_id=check_providers/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T20:32:24.251142+01:00/task_id=check_providers/attempt=1.log (0.00 MB)\n2025-06-09 20:37:32,266 - INFO - 2025-06-09 20:37:32 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T20:32:24.251142+01:00/task_id=check_providers/attempt=1.log\n2025-06-09 20:37:32,267 - INFO - 2025-06-09 20:37:32 - 📤 Uploading /opt/airflow/logs/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T20:32:24.251142+01:00/task_id=setup_supabase_connection/attempt=1.log → gs://simprede-data-pipeline/airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T20:32:24.251142+01:00/task_id=setup_supabase_connection/attempt=1.log (0.00 MB)\n2025-06-09 20:37:32,382 - INFO - 2025-06-09 20:37:32 - ✅ Successfully uploaded: airflow-logs/2025-06-09/dag_id=sql_queries_pipeline/run_id=manual__2025-06-09T20:32:24.251142+01:00/task_id=setup_supabase_connection/attempt=1.log\n2025-06-09 20:37:32,382 - INFO - 2025-06-09 20:37:32 - 📋 Airflow logs export completed: 7 uploaded, 0 failed\n2025-06-09 20:37:32,382 - INFO - 2025-06-09 20:37:32 - 🧹 Starting cleanup of exported data directories...\n2025-06-09 20:37:32,382 - INFO - 2025-06-09 20:37:32 - 🧹 Starting cleanup of 3 data directories\n2025-06-09 20:37:32,382 - INFO - 2025-06-09 20:37:32 - ✅ All files from /opt/airflow/data/raw/2025/06/09 uploaded successfully\n2025-06-09 20:37:32,383 - INFO - 2025-06-09 20:37:32 - 🗑️ Deleting directory: /opt/airflow/data/raw/2025/06/09 (0.32 MB)\n2025-06-09 20:37:32,384 - INFO - 2025-06-09 20:37:32 - ✅ Successfully deleted directory: /opt/airflow/data/raw/2025/06/09\n2025-06-09 20:37:32,385 - INFO - 2025-06-09 20:37:32 - ✅ All files from /opt/airflow/data/structured/2025/06/09 uploaded successfully\n2025-06-09 20:37:32,385 - INFO - 2025-06-09 20:37:32 - 🗑️ Deleting directory: /opt/airflow/data/structured/2025/06/09 (0.00 MB)\n2025-06-09 20:37:32,386 - INFO - 2025-06-09 20:37:32 - ✅ Successfully deleted directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 20:37:32,386 - INFO - 2025-06-09 20:37:32 - ✅ All files from /opt/airflow/data/processed/2025/06/09 uploaded successfully\n2025-06-09 20:37:32,387 - INFO - 2025-06-09 20:37:32 - 🗑️ Deleting directory: /opt/airflow/data/processed/2025/06/09 (0.00 MB)\n2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 - ✅ Successfully deleted directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 - 🧹 Cleanup completed: 3/3 directories cleaned\n2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 - ✅ Export completed:\n2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 -   - Data directories: 3\n2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 -   - Data files uploaded: 8/8\n2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 -   - Airflow logs uploaded: 7\n2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 -   - Total files uploaded: 15/15\n2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 -   - Total size: 0.37 MB\n2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 -   - Bucket: gs://simprede-data-pipeline\n2025-06-09 20:37:32,390 - INFO - 2025-06-09 20:37:32 -   - Directories cleaned: 3/3\n2025-06-09 20:37:32,393 - INFO - 2025-06-09 20:37:32 - ✅ Export statistics saved: /opt/airflow/data/processed/2025/06/09/gcs_export_stats_20250609.json\n2025-06-09 20:37:32,393 - INFO - 2025-06-09 20:37:32 - ✅ GCS export completed successfully\n2025-06-09 20:37:32,393 - INFO - 2025-06-09 20:37:32 - 📊 Summary: 15 files uploaded (7 logs), 0.37 MB\n2025-06-09 20:37:32,393 - INFO - 2025-06-09 20:37:32 - 🧹 Cleanup: 3 directories cleaned\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
