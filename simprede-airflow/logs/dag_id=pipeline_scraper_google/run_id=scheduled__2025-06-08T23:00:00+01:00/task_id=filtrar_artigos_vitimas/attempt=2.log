{"timestamp":"2025-06-09T08:27:17.374211","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-09T08:27:17.374899","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-09T08:27:17.439220Z","level":"info","event":"🔄 Starting filtrar_vitimas task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:17.443116Z","level":"info","event":"📁 Using paths from processar task: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:17.443458Z","level":"info","event":"📅 Using provided execution date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:17.444139Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/09', '/opt/airflow/data/structured/2025/06/09', '/opt/airflow/data/processed/2025/06/09']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:17.444306Z","level":"info","event":"📅 Filtrar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:17.444403Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:17.444528Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:17.444624Z","level":"info","event":"  - Target date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:17.444721Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:17.449926Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:17.450084Z","level":"info","event":"✅ Found input file: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:17.450446Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:17.450609Z","level":"info","event":"  - victims_articles: /opt/airflow/data/processed/2025/06/09/artigos_vitimas_filtrados_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:17.450721Z","level":"info","event":"  - no_victims_articles: /opt/airflow/data/processed/2025/06/09/artigos_sem_vitimas_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:17.450823Z","level":"info","event":"  - filtering_log: /opt/airflow/data/processed/2025/06/09/filtering_log_20250609.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:17.450926Z","level":"info","event":"  - stats_json: /opt/airflow/data/processed/2025/06/09/filtering_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:17.451036Z","level":"info","event":"🔄 Running filtering command: python /opt/airflow/scripts/google_scraper/processador/filtrar_artigos_vitimas_airflow.py --dias 1 --input_file /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv --output_dir /opt/airflow/data/processed/2025/06/09 --date_str 2025-06-09 --date 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:17.451181Z","level":"info","event":"⏰ Waiting for filtering completion with timeout: 900 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.386927Z","level":"info","event":"📋 [2025-06-09 09:27:19] Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.387578Z","level":"info","event":"📋 2025-06-09 09:27:19,386 - INFO - Starting filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.388104Z","level":"info","event":"📋 [2025-06-09 09:27:19] Parameters: dias=1, date=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.388367Z","level":"info","event":"📋 2025-06-09 09:27:19,386 - INFO - Parameters: dias=1, date=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.388514Z","level":"info","event":"📋 [2025-06-09 09:27:19] Paths: input_file=/opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv, output_dir=/opt/airflow/data/processed/2025/06/09, date_str=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.388592Z","level":"info","event":"📋 2025-06-09 09:27:19,386 - INFO - Paths: input_file=/opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv, output_dir=/opt/airflow/data/processed/2025/06/09, date_str=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.390084Z","level":"info","event":"📋 [2025-06-09 09:27:19] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.390172Z","level":"info","event":"📋 2025-06-09 09:27:19,387 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.390242Z","level":"info","event":"📋 [2025-06-09 09:27:19] 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.390311Z","level":"info","event":"📋 2025-06-09 09:27:19,387 - INFO - 🔍 Path setup:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.390389Z","level":"info","event":"📋 [2025-06-09 09:27:19]    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.390474Z","level":"info","event":"📋 2025-06-09 09:27:19,387 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.390550Z","level":"info","event":"📋 [2025-06-09 09:27:19]    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.390617Z","level":"info","event":"📋 2025-06-09 09:27:19,387 - INFO -    Project root: /opt/airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.390681Z","level":"info","event":"📋 [2025-06-09 09:27:19] 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.390746Z","level":"info","event":"📋 2025-06-09 09:27:19,387 - INFO - 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.390845Z","level":"info","event":"📋 [2025-06-09 09:27:19] 📁 Using provided input file: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.390914Z","level":"info","event":"📋 2025-06-09 09:27:19,387 - INFO - 📁 Using provided input file: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.391021Z","level":"info","event":"📋 [2025-06-09 09:27:19] 📂 Loading articles from: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.391168Z","level":"info","event":"📋 2025-06-09 09:27:19,387 - INFO - 📂 Loading articles from: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.391243Z","level":"info","event":"📋 [2025-06-09 09:27:19] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.391313Z","level":"info","event":"📋 2025-06-09 09:27:19,390 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.391379Z","level":"info","event":"📋 [2025-06-09 09:27:19] Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.391518Z","level":"info","event":"📋 2025-06-09 09:27:19,390 - INFO - Enhanced Filtering Started","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.391585Z","level":"info","event":"📋 [2025-06-09 09:27:19] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.391651Z","level":"info","event":"📋 2025-06-09 09:27:19,391 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.391730Z","level":"info","event":"📋 [2025-06-09 09:27:19]   Total Articles Loaded: 17","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.391864Z","level":"info","event":"📋 2025-06-09 09:27:19,391 - INFO -   Total Articles Loaded: 17","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.391939Z","level":"info","event":"📋 [2025-06-09 09:27:19]   Input File: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.392005Z","level":"info","event":"📋 2025-06-09 09:27:19,391 - INFO -   Input File: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.392092Z","level":"info","event":"📋 [2025-06-09 09:27:19]   Output File: /opt/airflow/data/processed/2025/06/09/artigos_vitimas_filtrados_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.392169Z","level":"info","event":"📋 2025-06-09 09:27:19,391 - INFO -   Output File: /opt/airflow/data/processed/2025/06/09/artigos_vitimas_filtrados_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.392298Z","level":"info","event":"📋 [2025-06-09 09:27:19]   Processed Data Directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.392591Z","level":"info","event":"📋 2025-06-09 09:27:19,392 - INFO -   Processed Data Directory: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.392712Z","level":"info","event":"📋 [2025-06-09 09:27:19]   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.392803Z","level":"info","event":"📋 2025-06-09 09:27:19,392 - INFO -   Days Filter: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.392984Z","level":"info","event":"📋 [2025-06-09 09:27:19] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.393135Z","level":"info","event":"📋 2025-06-09 09:27:19,392 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.393250Z","level":"info","event":"📋 [2025-06-09 09:27:19] 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.393953Z","level":"info","event":"📋 2025-06-09 09:27:19,392 - INFO - 🔍 Applying enhanced comprehensive filtering logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.394031Z","level":"info","event":"📋 [2025-06-09 09:27:19] 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.394109Z","level":"info","event":"📋 2025-06-09 09:27:19,392 - INFO - 🔧 Loading configuration data for enhanced filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.394177Z","level":"info","event":"📋 [2025-06-09 09:27:19] 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.394242Z","level":"info","event":"📋 2025-06-09 09:27:19,392 - INFO - 🔍 Looking for config files in multiple paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.394307Z","level":"info","event":"📋 [2025-06-09 09:27:19]    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.394483Z","level":"info","event":"📋 2025-06-09 09:27:19,392 - INFO -    Checking: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.394580Z","level":"info","event":"📋 [2025-06-09 09:27:19]    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.394892Z","level":"info","event":"📋 2025-06-09 09:27:19,392 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.396119Z","level":"info","event":"📋 [2025-06-09 09:27:19]    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.398083Z","level":"info","event":"📋 2025-06-09 09:27:19,392 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.398176Z","level":"info","event":"📋 [2025-06-09 09:27:19]    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.398237Z","level":"info","event":"📋 2025-06-09 09:27:19,392 - INFO -    Checking: config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.398326Z","level":"info","event":"📋 [2025-06-09 09:27:19] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.398386Z","level":"info","event":"📋 2025-06-09 09:27:19,392 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.398444Z","level":"info","event":"📋 [2025-06-09 09:27:19]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.398499Z","level":"info","event":"📋 2025-06-09 09:27:19,392 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.398556Z","level":"info","event":"📋 [2025-06-09 09:27:19]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.398612Z","level":"info","event":"📋 2025-06-09 09:27:19,392 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.398667Z","level":"info","event":"📋 [2025-06-09 09:27:19] ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.398722Z","level":"info","event":"📋 2025-06-09 09:27:19,394 - INFO - ✅ Loaded municipios config with 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.398779Z","level":"info","event":"📋 [2025-06-09 09:27:19] ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.398834Z","level":"info","event":"📋 2025-06-09 09:27:19,394 - INFO - ✅ Loaded eventos config with 14 events","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.398889Z","level":"info","event":"📋 [2025-06-09 09:27:19] 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.398944Z","level":"info","event":"📋 2025-06-09 09:27:19,395 - INFO - 📊 Config summary: 29 districts, 306 parishes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.398999Z","level":"info","event":"📋 [2025-06-09 09:27:19] 📊 Starting enhanced comprehensive filtering with 17 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.399062Z","level":"info","event":"📋 2025-06-09 09:27:19,395 - INFO - 📊 Starting enhanced comprehensive filtering with 17 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.399118Z","level":"info","event":"📋 [2025-06-09 09:27:19] 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.399209Z","level":"info","event":"📋 2025-06-09 09:27:19,396 - INFO - 🇵🇹 Applying enhanced geographic filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.399265Z","level":"info","event":"📋 [2025-06-09 09:27:19]    After enhanced geographic filter: 16 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.399320Z","level":"info","event":"📋 2025-06-09 09:27:19,397 - INFO -    After enhanced geographic filter: 16 articles (removed 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.399374Z","level":"info","event":"📋 [2025-06-09 09:27:19] ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.399436Z","level":"info","event":"📋 2025-06-09 09:27:19,397 - INFO - ✨ Applying content quality filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.399567Z","level":"info","event":"📋 [2025-06-09 09:27:19]    After quality filter: 8 articles (removed 8)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.399634Z","level":"info","event":"📋 2025-06-09 09:27:19,399 - INFO -    After quality filter: 8 articles (removed 8)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.399713Z","level":"info","event":"📋 [2025-06-09 09:27:19] 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.399843Z","level":"info","event":"📋 2025-06-09 09:27:19,399 - INFO - 🔍 Applying enhanced keyword filtering...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.400321Z","level":"info","event":"📋 [2025-06-09 09:27:19]    After enhanced keyword filter: 0 articles (removed 8)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.400402Z","level":"info","event":"📋 2025-06-09 09:27:19,400 - INFO -    After enhanced keyword filter: 0 articles (removed 8)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.400484Z","level":"info","event":"📋 [2025-06-09 09:27:19] 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.400616Z","level":"info","event":"📋 2025-06-09 09:27:19,400 - INFO - 📅 Applying temporal relevance filter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.401265Z","level":"info","event":"📋 [2025-06-09 09:27:19]    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.401349Z","level":"info","event":"📋 2025-06-09 09:27:19,401 - INFO -    After temporal filter: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.401433Z","level":"info","event":"📋 [2025-06-09 09:27:19] 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.401567Z","level":"info","event":"📋 2025-06-09 09:27:19,401 - INFO - 👥 Applying enhanced victim validation...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.401944Z","level":"info","event":"📋 [2025-06-09 09:27:19]    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.402025Z","level":"info","event":"📋 2025-06-09 09:27:19,401 - INFO -    After victim validation: 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.402104Z","level":"info","event":"📋 [2025-06-09 09:27:19] ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.402240Z","level":"info","event":"📋 2025-06-09 09:27:19,402 - INFO - ⭐ Calculating enhanced relevance scores...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.403137Z","level":"info","event":"📋 [2025-06-09 09:27:19]    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.407083Z","level":"info","event":"📋 2025-06-09 09:27:19,402 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.407175Z","level":"info","event":"📋 [2025-06-09 09:27:19] 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.407240Z","level":"info","event":"📋 2025-06-09 09:27:19,402 - INFO - 🔄 Removing duplicates with enhanced logic...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.407326Z","level":"info","event":"📋 [2025-06-09 09:27:19] 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.407389Z","level":"info","event":"📋 2025-06-09 09:27:19,403 - INFO - 🌦️ Enhanced climate event identification...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.407450Z","level":"info","event":"📋 [2025-06-09 09:27:19] ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.407510Z","level":"info","event":"📋 2025-06-09 09:27:19,403 - WARNING - ⚠️ No articles remaining after enhanced filtering.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.409082Z","level":"info","event":"📋 [2025-06-09 09:27:19] ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.409163Z","level":"info","event":"📋 2025-06-09 09:27:19,403 - INFO - ✅ Filtering completed. Found 0 articles with victims","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.505260Z","level":"info","event":"✅ Filtering completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.505510Z","level":"info","event":"🔍 Verifying filtrar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.505686Z","level":"info","event":"⚠️ victims_articles: /opt/airflow/data/processed/2025/06/09/artigos_vitimas_filtrados_20250609.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.505808Z","level":"info","event":"⚠️ no_victims_articles: /opt/airflow/data/processed/2025/06/09/artigos_sem_vitimas_20250609.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.505918Z","level":"info","event":"⚠️ filtering_log: /opt/airflow/data/processed/2025/06/09/filtering_log_20250609.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.506021Z","level":"info","event":"⚠️ stats_json: /opt/airflow/data/processed/2025/06/09/filtering_stats_20250609.json (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:27:19.506211","level":"info","event":"Done. Returned value was: [2025-06-09 09:27:19] Starting filtrar_artigos_vitimas_airflow\n2025-06-09 09:27:19,386 - INFO - Starting filtrar_artigos_vitimas_airflow\n[2025-06-09 09:27:19] Parameters: dias=1, date=2025-06-09\n2025-06-09 09:27:19,386 - INFO - Parameters: dias=1, date=2025-06-09\n[2025-06-09 09:27:19] Paths: input_file=/opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv, output_dir=/opt/airflow/data/processed/2025/06/09, date_str=2025-06-09\n2025-06-09 09:27:19,386 - INFO - Paths: input_file=/opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv, output_dir=/opt/airflow/data/processed/2025/06/09, date_str=2025-06-09\n[2025-06-09 09:27:19] 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n2025-06-09 09:27:19,387 - INFO - 🚀 Starting enhanced filtrar_artigos_vitimas_airflow\n[2025-06-09 09:27:19] 🔍 Path setup:\n2025-06-09 09:27:19,387 - INFO - 🔍 Path setup:\n[2025-06-09 09:27:19]    Script dir: /opt/airflow/scripts/google_scraper/processador\n2025-06-09 09:27:19,387 - INFO -    Script dir: /opt/airflow/scripts/google_scraper/processador\n[2025-06-09 09:27:19]    Project root: /opt/airflow\n2025-06-09 09:27:19,387 - INFO -    Project root: /opt/airflow\n[2025-06-09 09:27:19] 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 09:27:19,387 - INFO - 📁 Using controlled output directory: /opt/airflow/data/processed/2025/06/09\n[2025-06-09 09:27:19] 📁 Using provided input file: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:27:19,387 - INFO - 📁 Using provided input file: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n[2025-06-09 09:27:19] 📂 Loading articles from: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:27:19,387 - INFO - 📂 Loading articles from: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n[2025-06-09 09:27:19] ==================================================\n2025-06-09 09:27:19,390 - INFO - ==================================================\n[2025-06-09 09:27:19] Enhanced Filtering Started\n2025-06-09 09:27:19,390 - INFO - Enhanced Filtering Started\n[2025-06-09 09:27:19] ==================================================\n2025-06-09 09:27:19,391 - INFO - ==================================================\n[2025-06-09 09:27:19]   Total Articles Loaded: 17\n2025-06-09 09:27:19,391 - INFO -   Total Articles Loaded: 17\n[2025-06-09 09:27:19]   Input File: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:27:19,391 - INFO -   Input File: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n[2025-06-09 09:27:19]   Output File: /opt/airflow/data/processed/2025/06/09/artigos_vitimas_filtrados_2025-06-09.csv\n2025-06-09 09:27:19,391 - INFO -   Output File: /opt/airflow/data/processed/2025/06/09/artigos_vitimas_filtrados_2025-06-09.csv\n[2025-06-09 09:27:19]   Processed Data Directory: /opt/airflow/data/processed/2025/06/09\n2025-06-09 09:27:19,392 - INFO -   Processed Data Directory: /opt/airflow/data/processed/2025/06/09\n[2025-06-09 09:27:19]   Days Filter: 1\n2025-06-09 09:27:19,392 - INFO -   Days Filter: 1\n[2025-06-09 09:27:19] ==================================================\n2025-06-09 09:27:19,392 - INFO - ==================================================\n[2025-06-09 09:27:19] 🔍 Applying enhanced comprehensive filtering logic...\n2025-06-09 09:27:19,392 - INFO - 🔍 Applying enhanced comprehensive filtering logic...\n[2025-06-09 09:27:19] 🔧 Loading configuration data for enhanced filtering...\n2025-06-09 09:27:19,392 - INFO - 🔧 Loading configuration data for enhanced filtering...\n[2025-06-09 09:27:19] 🔍 Looking for config files in multiple paths:\n2025-06-09 09:27:19,392 - INFO - 🔍 Looking for config files in multiple paths:\n[2025-06-09 09:27:19]    Checking: /opt/airflow/config\n2025-06-09 09:27:19,392 - INFO -    Checking: /opt/airflow/config\n[2025-06-09 09:27:19]    Checking: /opt/airflow/scripts/google_scraper/processador/config\n2025-06-09 09:27:19,392 - INFO -    Checking: /opt/airflow/scripts/google_scraper/processador/config\n[2025-06-09 09:27:19]    Checking: /opt/airflow/scripts/google_scraper/config\n2025-06-09 09:27:19,392 - INFO -    Checking: /opt/airflow/scripts/google_scraper/config\n[2025-06-09 09:27:19]    Checking: config\n2025-06-09 09:27:19,392 - INFO -    Checking: config\n[2025-06-09 09:27:19] ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n2025-06-09 09:27:19,392 - INFO - ✅ Found config files in: /opt/airflow/scripts/google_scraper/config\n[2025-06-09 09:27:19]    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n2025-06-09 09:27:19,392 - INFO -    Municipios: /opt/airflow/scripts/google_scraper/config/municipios_por_distrito.json\n[2025-06-09 09:27:19]    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n2025-06-09 09:27:19,392 - INFO -    Eventos: /opt/airflow/scripts/google_scraper/config/eventos_climaticos.json\n[2025-06-09 09:27:19] ✅ Loaded municipios config with 29 districts\n2025-06-09 09:27:19,394 - INFO - ✅ Loaded municipios config with 29 districts\n[2025-06-09 09:27:19] ✅ Loaded eventos config with 14 events\n2025-06-09 09:27:19,394 - INFO - ✅ Loaded eventos config with 14 events\n[2025-06-09 09:27:19] 📊 Config summary: 29 districts, 306 parishes\n2025-06-09 09:27:19,395 - INFO - 📊 Config summary: 29 districts, 306 parishes\n[2025-06-09 09:27:19] 📊 Starting enhanced comprehensive filtering with 17 articles\n2025-06-09 09:27:19,395 - INFO - 📊 Starting enhanced comprehensive filtering with 17 articles\n[2025-06-09 09:27:19] 🇵🇹 Applying enhanced geographic filter...\n2025-06-09 09:27:19,396 - INFO - 🇵🇹 Applying enhanced geographic filter...\n[2025-06-09 09:27:19]    After enhanced geographic filter: 16 articles (removed 1)\n2025-06-09 09:27:19,397 - INFO -    After enhanced geographic filter: 16 articles (removed 1)\n[2025-06-09 09:27:19] ✨ Applying content quality filter...\n2025-06-09 09:27:19,397 - INFO - ✨ Applying content quality filter...\n[2025-06-09 09:27:19]    After quality filter: 8 articles (removed 8)\n2025-06-09 09:27:19,399 - INFO -    After quality filter: 8 articles (removed 8)\n[2025-06-09 09:27:19] 🔍 Applying enhanced keyword filtering...\n2025-06-09 09:27:19,399 - INFO - 🔍 Applying enhanced keyword filtering...\n[2025-06-09 09:27:19]    After enhanced keyword filter: 0 articles (removed 8)\n2025-06-09 09:27:19,400 - INFO -    After enhanced keyword filter: 0 articles (removed 8)\n[2025-06-09 09:27:19] 📅 Applying temporal relevance filter...\n2025-06-09 09:27:19,400 - INFO - 📅 Applying temporal relevance filter...\n[2025-06-09 09:27:19]    After temporal filter: 0 articles (removed 0)\n2025-06-09 09:27:19,401 - INFO -    After temporal filter: 0 articles (removed 0)\n[2025-06-09 09:27:19] 👥 Applying enhanced victim validation...\n2025-06-09 09:27:19,401 - INFO - 👥 Applying enhanced victim validation...\n[2025-06-09 09:27:19]    After victim validation: 0 articles (removed 0)\n2025-06-09 09:27:19,401 - INFO -    After victim validation: 0 articles (removed 0)\n[2025-06-09 09:27:19] ⭐ Calculating enhanced relevance scores...\n2025-06-09 09:27:19,402 - INFO - ⭐ Calculating enhanced relevance scores...\n[2025-06-09 09:27:19]    After relevance score filter (min 2): 0 articles (removed 0)\n2025-06-09 09:27:19,402 - INFO -    After relevance score filter (min 2): 0 articles (removed 0)\n[2025-06-09 09:27:19] 🔄 Removing duplicates with enhanced logic...\n2025-06-09 09:27:19,402 - INFO - 🔄 Removing duplicates with enhanced logic...\n[2025-06-09 09:27:19] 🌦️ Enhanced climate event identification...\n2025-06-09 09:27:19,403 - INFO - 🌦️ Enhanced climate event identification...\n[2025-06-09 09:27:19] ⚠️ No articles remaining after enhanced filtering.\n2025-06-09 09:27:19,403 - WARNING - ⚠️ No articles remaining after enhanced filtering.\n[2025-06-09 09:27:19] ✅ Filtering completed. Found 0 articles with victims\n2025-06-09 09:27:19,403 - INFO - ✅ Filtering completed. Found 0 articles with victims\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
