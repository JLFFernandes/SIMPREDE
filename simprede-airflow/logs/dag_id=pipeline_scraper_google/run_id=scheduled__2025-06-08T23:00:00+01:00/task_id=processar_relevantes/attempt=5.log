{"timestamp":"2025-06-09T08:39:41.240533","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-09T08:39:41.241120","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-09T08:39:42.389139Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:42.389500Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:42.392506Z","level":"info","event":"📅 Using provided execution date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:42.393396Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/09', '/opt/airflow/data/structured/2025/06/09', '/opt/airflow/data/processed/2025/06/09']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:42.393502Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:42.393711Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:42.394092Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:42.394175Z","level":"info","event":"  - Target date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:42.394382Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:42.394455Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:42.394592Z","level":"info","event":"✅ Found input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:42.394672Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:42.394728Z","level":"info","event":"  - relevant_articles: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:42.394774Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/data/structured/2025/06/09/artigos_irrelevantes_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:42.394812Z","level":"info","event":"  - processing_log: /opt/airflow/data/structured/2025/06/09/processing_log_20250609.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:42.394848Z","level":"info","event":"  - stats_json: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:42.394887Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv --output_dir /opt/airflow/data/structured/2025/06/09 --date_str 2025-06-09 --date 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:42.394945Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.934455Z","level":"info","event":"📋 [2025-06-09 09:39:43] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.934753Z","level":"info","event":"📋 2025-06-09 09:39:43,934 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.934839Z","level":"info","event":"📋 [2025-06-09 09:39:43] Parameters: dias=1, date=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.935006Z","level":"info","event":"📋 2025-06-09 09:39:43,934 - INFO - Parameters: dias=1, date=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.935166Z","level":"info","event":"📋 [2025-06-09 09:39:43] Paths: input_file=/opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv, output_dir=/opt/airflow/data/structured/2025/06/09, date_str=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.935214Z","level":"info","event":"📋 2025-06-09 09:39:43,934 - INFO - Paths: input_file=/opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv, output_dir=/opt/airflow/data/structured/2025/06/09, date_str=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.935317Z","level":"info","event":"📋 [2025-06-09 09:39:43] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.935405Z","level":"info","event":"📋 2025-06-09 09:39:43,934 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.935882Z","level":"info","event":"📋 [2025-06-09 09:39:43] 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.935924Z","level":"info","event":"📋 2025-06-09 09:39:43,934 - INFO - 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.935985Z","level":"info","event":"📋 [2025-06-09 09:39:43] 📁 Using provided input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.936026Z","level":"info","event":"📋 2025-06-09 09:39:43,934 - INFO - 📁 Using provided input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.936063Z","level":"info","event":"📋 [2025-06-09 09:39:43] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.936098Z","level":"info","event":"📋 2025-06-09 09:39:43,934 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.936135Z","level":"info","event":"📋 [2025-06-09 09:39:43] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.936171Z","level":"info","event":"📋 2025-06-09 09:39:43,934 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.936207Z","level":"info","event":"📋 [2025-06-09 09:39:43] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.936241Z","level":"info","event":"📋 2025-06-09 09:39:43,935 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.936284Z","level":"info","event":"📋 [2025-06-09 09:39:43] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.936324Z","level":"info","event":"📋 2025-06-09 09:39:43,935 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.936372Z","level":"info","event":"📋 [2025-06-09 09:39:43] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.936412Z","level":"info","event":"📋 2025-06-09 09:39:43,935 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.936446Z","level":"info","event":"📋 [2025-06-09 09:39:43] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.936506Z","level":"info","event":"📋 2025-06-09 09:39:43,935 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.936689Z","level":"info","event":"📋 [2025-06-09 09:39:43] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.936741Z","level":"info","event":"📋 2025-06-09 09:39:43,936 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.936891Z","level":"info","event":"📋 [2025-06-09 09:39:43] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.937123Z","level":"info","event":"📋 2025-06-09 09:39:43,936 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.937314Z","level":"info","event":"📋 [2025-06-09 09:39:43] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.937415Z","level":"info","event":"📋 2025-06-09 09:39:43,937 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.942818Z","level":"info","event":"📋 [2025-06-09 09:39:43] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.943183Z","level":"info","event":"📋 2025-06-09 09:39:43,942 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.943420Z","level":"info","event":"📋 [2025-06-09 09:39:43] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.943852Z","level":"info","event":"📋 2025-06-09 09:39:43,942 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.943900Z","level":"info","event":"📋 [2025-06-09 09:39:43] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.943937Z","level":"info","event":"📋 2025-06-09 09:39:43,942 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.943971Z","level":"info","event":"📋 [2025-06-09 09:39:43] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.944006Z","level":"info","event":"📋 2025-06-09 09:39:43,942 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.944041Z","level":"info","event":"📋 [2025-06-09 09:39:43]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.944406Z","level":"info","event":"📋 2025-06-09 09:39:43,942 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.944587Z","level":"info","event":"📋 [2025-06-09 09:39:43]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.944839Z","level":"info","event":"📋 2025-06-09 09:39:43,942 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.945088Z","level":"info","event":"📋 [2025-06-09 09:39:43]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.945559Z","level":"info","event":"📋 2025-06-09 09:39:43,942 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.945648Z","level":"info","event":"📋 [2025-06-09 09:39:43]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.945699Z","level":"info","event":"📋 2025-06-09 09:39:43,942 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.945781Z","level":"info","event":"📋 [2025-06-09 09:39:43]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.945871Z","level":"info","event":"📋 2025-06-09 09:39:43,942 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.945927Z","level":"info","event":"📋 [2025-06-09 09:39:43] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.946035Z","level":"info","event":"📋 2025-06-09 09:39:43,942 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.947048Z","level":"info","event":"📋 [2025-06-09 09:39:43] ✅ Ficheiro CSV válido com 8 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.947525Z","level":"info","event":"📋 2025-06-09 09:39:43,946 - INFO - ✅ Ficheiro CSV válido com 8 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.947572Z","level":"info","event":"📋 [2025-06-09 09:39:43] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.947612Z","level":"info","event":"📋 2025-06-09 09:39:43,946 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.947652Z","level":"info","event":"📋 [2025-06-09 09:39:43] 📅 Filtrado para artigos dos últimos 1 dias: 8 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.947687Z","level":"info","event":"📋 2025-06-09 09:39:43,946 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 8 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.947722Z","level":"info","event":"📋 [2025-06-09 09:39:43] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.947765Z","level":"info","event":"📋 2025-06-09 09:39:43,946 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.947805Z","level":"info","event":"📋 [2025-06-09 09:39:43] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.947881Z","level":"info","event":"📋 2025-06-09 09:39:43,946 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.947920Z","level":"info","event":"📋 [2025-06-09 09:39:43] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.947955Z","level":"info","event":"📋 2025-06-09 09:39:43,946 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.947991Z","level":"info","event":"📋 [2025-06-09 09:39:43]   Total de Artigos para Processar: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.948025Z","level":"info","event":"📋 2025-06-09 09:39:43,946 - INFO -   Total de Artigos para Processar: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.948060Z","level":"info","event":"📋 [2025-06-09 09:39:43]   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.948095Z","level":"info","event":"📋 2025-06-09 09:39:43,946 - INFO -   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.948129Z","level":"info","event":"📋 [2025-06-09 09:39:43]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.948164Z","level":"info","event":"📋 2025-06-09 09:39:43,946 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.951208Z","level":"info","event":"📋 [2025-06-09 09:39:43]   Diretoria de Saída: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.951462Z","level":"info","event":"📋 2025-06-09 09:39:43,946 - INFO -   Diretoria de Saída: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.951860Z","level":"info","event":"📋 [2025-06-09 09:39:43]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.951984Z","level":"info","event":"📋 2025-06-09 09:39:43,946 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.952105Z","level":"info","event":"📋 [2025-06-09 09:39:43] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.952260Z","level":"info","event":"📋 2025-06-09 09:39:43,946 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.952482Z","level":"info","event":"📋 [2025-06-09 09:39:43] 📦 A processar lote 1/1 (8 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:43.952551Z","level":"info","event":"📋 2025-06-09 09:39:43,947 - INFO - 📦 A processar lote 1/1 (8 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:46.652744Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:46.669916Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:46.738894Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:46.801937Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:46.829212Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:46.846179Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:46.902504Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:46.925843Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:48.750850Z","level":"info","event":"📋 [2025-06-09 09:39:48] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Adeus, calor! Chuva e trovoada regressam já na terça-feira - Notícias ao Minuto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:48.751220Z","level":"info","event":"📋 2025-06-09 09:39:48,750 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Adeus, calor! Chuva e trovoada regressam já na terça-feira - Notícias ao Minuto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:48.753185Z","level":"info","event":"📋 [2025-06-09 09:39:48] 🔄 Processado: Adeus, calor! Chuva e trovoada regressam já na ter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:48.753413Z","level":"info","event":"📋 2025-06-09 09:39:48,753 - INFO - 🔄 Processado: Adeus, calor! Chuva e trovoada regressam já na ter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:48.784873Z","level":"info","event":"⚠️ ⚠️ Error fetching URL https://www.guimaraesdigital.pt/index.php/informacao/desporto/93675-vitoria-apontado-como-um-dos-interessados-em-timothy-fayulu: 403 Client Error: Forbidden for url: https://www.guimaraesdigital.pt/index.php/informacao/desporto/93675-vitoria-apontado-como-um-dos-interessados-em-timothy-fayulu","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:48.785168Z","level":"info","event":"📋 [2025-06-09 09:39:48] ⚠️ Artigo ignorado após extração: Vitória apontado como um dos interessados em Timothy Fayulu - Guimarães Digital","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:48.785430Z","level":"info","event":"📋 2025-06-09 09:39:48,784 - WARNING - ⚠️ Artigo ignorado após extração: Vitória apontado como um dos interessados em Timothy Fayulu - Guimarães Digital","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:50.278453Z","level":"info","event":"📋 [2025-06-09 09:39:50] ⚠️ Artigo ignorado após extração: Incêndio em armazém provoca morte de 19 animais em Moimenta da Beira - Renascença","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:50.279380Z","level":"info","event":"📋 2025-06-09 09:39:50,275 - WARNING - ⚠️ Artigo ignorado após extração: Incêndio em armazém provoca morte de 19 animais em Moimenta da Beira - Renascença","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:50.762521Z","level":"info","event":"⚠️ ⚠️ Error fetching URL https://www.guimaraesdigital.pt/index.php/informacao/sociedade/93668-viatura-da-vmer-de-guimaraes-perdeu-uma-roda-e-ficou-inoperacional: 403 Client Error: Forbidden for url: https://www.guimaraesdigital.pt/index.php/informacao/sociedade/93668-viatura-da-vmer-de-guimaraes-perdeu-uma-roda-e-ficou-inoperacional","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:50.762760Z","level":"info","event":"📋 [2025-06-09 09:39:50] ⚠️ Artigo ignorado após extração: Viatura da VMER de Guimarães perdeu uma roda e ficou inoperacional - Guimarães Digital","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:50.762906Z","level":"info","event":"📋 2025-06-09 09:39:50,762 - WARNING - ⚠️ Artigo ignorado após extração: Viatura da VMER de Guimarães perdeu uma roda e ficou inoperacional - Guimarães Digital","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:50.765366Z","level":"info","event":"⚠️ ⚠️ Error fetching URL https://www.guimaraesdigital.pt/index.php/informacao/sociedade/93669-conheca-o-cartaz-final-do-rock-no-rio-febras-2025-com-bandas-a-serio: 403 Client Error: Forbidden for url: https://www.guimaraesdigital.pt/index.php/informacao/sociedade/93669-conheca-o-cartaz-final-do-rock-no-rio-febras-2025-com-bandas-a-serio","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:50.765542Z","level":"info","event":"📋 [2025-06-09 09:39:50] ⚠️ Artigo ignorado após extração: Conheça o cartaz final do Rock no Rio Febras 2025 com bandas a sério - Guimarães Digital","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:50.765622Z","level":"info","event":"📋 2025-06-09 09:39:50,765 - WARNING - ⚠️ Artigo ignorado após extração: Conheça o cartaz final do Rock no Rio Febras 2025 com bandas a sério - Guimarães Digital","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:50.830559Z","level":"info","event":"📋 [2025-06-09 09:39:50] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Resende (RJ) terá dia de chuva hoje (09); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:50.830868Z","level":"info","event":"📋 2025-06-09 09:39:50,830 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Resende (RJ) terá dia de chuva hoje (09); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:50.831666Z","level":"info","event":"📋 [2025-06-09 09:39:50] 🔄 Processado: Resende (RJ) terá dia de chuva hoje (09); veja pre...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:50.831858Z","level":"info","event":"📋 2025-06-09 09:39:50,831 - INFO - 🔄 Processado: Resende (RJ) terá dia de chuva hoje (09); veja pre...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:52.872268Z","level":"info","event":"📋 [2025-06-09 09:39:52] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Resende (RJ) terá dia de chuva hoje (09); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:52.872479Z","level":"info","event":"📋 2025-06-09 09:39:52,872 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Resende (RJ) terá dia de chuva hoje (09); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:52.879766Z","level":"info","event":"📋 [2025-06-09 09:39:52] 🔄 Processado: Resende (RJ) terá dia de chuva hoje (09); veja pre...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:39:52.879845Z","level":"info","event":"📋 2025-06-09 09:39:52,873 - INFO - 🔄 Processado: Resende (RJ) terá dia de chuva hoje (09); veja pre...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.894854Z","level":"info","event":"📋 [2025-06-09 09:41:03] ⚠️ Artigo ignorado após extração: Um fim de semana entre o Zêzere e o Tejo - SÁBADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.896050Z","level":"info","event":"📋 2025-06-09 09:41:03,894 - WARNING - ⚠️ Artigo ignorado após extração: Um fim de semana entre o Zêzere e o Tejo - SÁBADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901110Z","level":"info","event":"📋 📥 Novos artigos recebidos: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901198Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901279Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901330Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901377Z","level":"info","event":"📋 💾 Guardados 3 artigos no arquivo /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901419Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901464Z","level":"info","event":"📋 📥 Novos artigos recebidos: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901509Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901549Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901592Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901642Z","level":"info","event":"📋 💾 Guardados 3 artigos no arquivo /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901686Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901725Z","level":"info","event":"📋 [2025-06-09 09:41:03] ✅ Relevant articles saved: 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901766Z","level":"info","event":"📋 2025-06-09 09:41:03,898 - INFO - ✅ Relevant articles saved: 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901806Z","level":"info","event":"📋 [2025-06-09 09:41:03] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901871Z","level":"info","event":"📋 2025-06-09 09:41:03,898 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901909Z","level":"info","event":"📋 [2025-06-09 09:41:03] ✅ Lote 1 concluído: 3 artigos (total: 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:03.901956Z","level":"info","event":"📋 2025-06-09 09:41:03,898 - INFO - ✅ Lote 1 concluído: 3 artigos (total: 3)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.146776Z","level":"info","event":"📋 📥 Novos artigos recebidos: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.147613Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.149204Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.149501Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.149704Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.149986Z","level":"info","event":"📋 📥 Novos artigos recebidos: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.150318Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.151507Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.151965Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.152616Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.152808Z","level":"info","event":"📋 [2025-06-09 09:41:07] ✅ Relevant articles saved: 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.153129Z","level":"info","event":"📋 2025-06-09 09:41:07,150 - INFO - ✅ Relevant articles saved: 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.154173Z","level":"info","event":"📋 [2025-06-09 09:41:07] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.162134Z","level":"info","event":"📋 2025-06-09 09:41:07,154 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.162421Z","level":"info","event":"📋 [2025-06-09 09:41:07] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.162563Z","level":"info","event":"📋 2025-06-09 09:41:07,154 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.162734Z","level":"info","event":"📋 [2025-06-09 09:41:07] Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.162883Z","level":"info","event":"📋 2025-06-09 09:41:07,154 - INFO - Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.163045Z","level":"info","event":"📋 [2025-06-09 09:41:07] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.163281Z","level":"info","event":"📋 2025-06-09 09:41:07,154 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.163412Z","level":"info","event":"📋 [2025-06-09 09:41:07]   Total de Artigos Processados: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.163547Z","level":"info","event":"📋 2025-06-09 09:41:07,154 - INFO -   Total de Artigos Processados: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.163696Z","level":"info","event":"📋 [2025-06-09 09:41:07]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.163828Z","level":"info","event":"📋 2025-06-09 09:41:07,154 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.163999Z","level":"info","event":"📋 [2025-06-09 09:41:07]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.164145Z","level":"info","event":"📋 2025-06-09 09:41:07,154 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.164279Z","level":"info","event":"📋 [2025-06-09 09:41:07]   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.164411Z","level":"info","event":"📋 2025-06-09 09:41:07,154 - INFO -   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.164529Z","level":"info","event":"📋 [2025-06-09 09:41:07]   Taxa de Sucesso: 37.5%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.164646Z","level":"info","event":"📋 2025-06-09 09:41:07,154 - INFO -   Taxa de Sucesso: 37.5%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.164820Z","level":"info","event":"📋 [2025-06-09 09:41:07] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.164943Z","level":"info","event":"📋 2025-06-09 09:41:07,154 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.165345Z","level":"info","event":"📋 [2025-06-09 09:41:07] ✅ Processing completed. Processed 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.165530Z","level":"info","event":"📋 2025-06-09 09:41:07,157 - INFO - ✅ Processing completed. Processed 3 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.272851Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.273002Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.273113Z","level":"info","event":"✅ relevant_articles: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (938 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.779743Z","level":"info","event":"📊 Number of processed articles: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.779890Z","level":"info","event":"📊 Columns: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.780057Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/data/structured/2025/06/09/artigos_irrelevantes_2025-06-09.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.781613Z","level":"info","event":"⚠️ processing_log: /opt/airflow/data/structured/2025/06/09/processing_log_20250609.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.781738Z","level":"info","event":"✅ stats_json: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json (393 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:41:07.780681","level":"info","event":"Done. Returned value was: [2025-06-09 09:39:43] Starting processar_relevantes_airflow\n2025-06-09 09:39:43,934 - INFO - Starting processar_relevantes_airflow\n[2025-06-09 09:39:43] Parameters: dias=1, date=2025-06-09\n2025-06-09 09:39:43,934 - INFO - Parameters: dias=1, date=2025-06-09\n[2025-06-09 09:39:43] Paths: input_file=/opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv, output_dir=/opt/airflow/data/structured/2025/06/09, date_str=2025-06-09\n2025-06-09 09:39:43,934 - INFO - Paths: input_file=/opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv, output_dir=/opt/airflow/data/structured/2025/06/09, date_str=2025-06-09\n[2025-06-09 09:39:43] 🚀 A iniciar processar_relevantes_airflow\n2025-06-09 09:39:43,934 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-09 09:39:43] 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:39:43,934 - INFO - 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/09\n[2025-06-09 09:39:43] 📁 Using provided input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv\n2025-06-09 09:39:43,934 - INFO - 📁 Using provided input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv\n[2025-06-09 09:39:43] 🔧 A carregar ficheiros de configuração...\n2025-06-09 09:39:43,934 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-09 09:39:43] 🔍 Checking config path: /opt/airflow/config\n2025-06-09 09:39:43,934 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-09 09:39:43] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-09 09:39:43,935 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-09 09:39:43] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-09 09:39:43,935 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-09 09:39:43] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-09 09:39:43,935 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-09 09:39:43] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-09 09:39:43,935 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-09 09:39:43] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-09 09:39:43,936 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-09 09:39:43] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-09 09:39:43,936 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-09 09:39:43] ✅ Loaded 6 keywords\n2025-06-09 09:39:43,937 - INFO - ✅ Loaded 6 keywords\n[2025-06-09 09:39:43] ✅ Loaded 3614 DICOFREG codes\n2025-06-09 09:39:43,942 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-09 09:39:43] ==================================================\n2025-06-09 09:39:43,942 - INFO - ==================================================\n[2025-06-09 09:39:43] Configuration Loaded\n2025-06-09 09:39:43,942 - INFO - Configuration Loaded\n[2025-06-09 09:39:43] ==================================================\n2025-06-09 09:39:43,942 - INFO - ==================================================\n[2025-06-09 09:39:43]   Parishes: 306\n2025-06-09 09:39:43,942 - INFO -   Parishes: 306\n[2025-06-09 09:39:43]   Municipalities: 306\n2025-06-09 09:39:43,942 - INFO -   Municipalities: 306\n[2025-06-09 09:39:43]   Districts: 29\n2025-06-09 09:39:43,942 - INFO -   Districts: 29\n[2025-06-09 09:39:43]   Keywords: 6\n2025-06-09 09:39:43,942 - INFO -   Keywords: 6\n[2025-06-09 09:39:43]   DICOFREG Codes: 3614\n2025-06-09 09:39:43,942 - INFO -   DICOFREG Codes: 3614\n[2025-06-09 09:39:43] ==================================================\n2025-06-09 09:39:43,942 - INFO - ==================================================\n[2025-06-09 09:39:43] ✅ Ficheiro CSV válido com 8 artigos\n2025-06-09 09:39:43,946 - INFO - ✅ Ficheiro CSV válido com 8 artigos\n[2025-06-09 09:39:43] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-09 09:39:43,946 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-09 09:39:43] 📅 Filtrado para artigos dos últimos 1 dias: 8 artigos\n2025-06-09 09:39:43,946 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 8 artigos\n[2025-06-09 09:39:43] ==================================================\n2025-06-09 09:39:43,946 - INFO - ==================================================\n[2025-06-09 09:39:43] Processamento Iniciado\n2025-06-09 09:39:43,946 - INFO - Processamento Iniciado\n[2025-06-09 09:39:43] ==================================================\n2025-06-09 09:39:43,946 - INFO - ==================================================\n[2025-06-09 09:39:43]   Total de Artigos para Processar: 8\n2025-06-09 09:39:43,946 - INFO -   Total de Artigos para Processar: 8\n[2025-06-09 09:39:43]   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv\n2025-06-09 09:39:43,946 - INFO -   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv\n[2025-06-09 09:39:43]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:39:43,946 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n[2025-06-09 09:39:43]   Diretoria de Saída: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:39:43,946 - INFO -   Diretoria de Saída: /opt/airflow/data/structured/2025/06/09\n[2025-06-09 09:39:43]   Filtro de Dias: 1\n2025-06-09 09:39:43,946 - INFO -   Filtro de Dias: 1\n[2025-06-09 09:39:43] ==================================================\n2025-06-09 09:39:43,946 - INFO - ==================================================\n[2025-06-09 09:39:43] 📦 A processar lote 1/1 (8 artigos)\n2025-06-09 09:39:43,947 - INFO - 📦 A processar lote 1/1 (8 artigos)\n[2025-06-09 09:39:48] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Adeus, calor! Chuva e trovoada regressam já na terça-feira - Notícias ao Minuto\n2025-06-09 09:39:48,750 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Adeus, calor! Chuva e trovoada regressam já na terça-feira - Notícias ao Minuto\n[2025-06-09 09:39:48] 🔄 Processado: Adeus, calor! Chuva e trovoada regressam já na ter...\n2025-06-09 09:39:48,753 - INFO - 🔄 Processado: Adeus, calor! Chuva e trovoada regressam já na ter...\n[2025-06-09 09:39:48] ⚠️ Artigo ignorado após extração: Vitória apontado como um dos interessados em Timothy Fayulu - Guimarães Digital\n2025-06-09 09:39:48,784 - WARNING - ⚠️ Artigo ignorado após extração: Vitória apontado como um dos interessados em Timothy Fayulu - Guimarães Digital\n[2025-06-09 09:39:50] ⚠️ Artigo ignorado após extração: Incêndio em armazém provoca morte de 19 animais em Moimenta da Beira - Renascença\n2025-06-09 09:39:50,275 - WARNING - ⚠️ Artigo ignorado após extração: Incêndio em armazém provoca morte de 19 animais em Moimenta da Beira - Renascença\n[2025-06-09 09:39:50] ⚠️ Artigo ignorado após extração: Viatura da VMER de Guimarães perdeu uma roda e ficou inoperacional - Guimarães Digital\n2025-06-09 09:39:50,762 - WARNING - ⚠️ Artigo ignorado após extração: Viatura da VMER de Guimarães perdeu uma roda e ficou inoperacional - Guimarães Digital\n[2025-06-09 09:39:50] ⚠️ Artigo ignorado após extração: Conheça o cartaz final do Rock no Rio Febras 2025 com bandas a sério - Guimarães Digital\n2025-06-09 09:39:50,765 - WARNING - ⚠️ Artigo ignorado após extração: Conheça o cartaz final do Rock no Rio Febras 2025 com bandas a sério - Guimarães Digital\n[2025-06-09 09:39:50] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Resende (RJ) terá dia de chuva hoje (09); veja previsão do tempo - UOL Notícias\n2025-06-09 09:39:50,830 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Resende (RJ) terá dia de chuva hoje (09); veja previsão do tempo - UOL Notícias\n[2025-06-09 09:39:50] 🔄 Processado: Resende (RJ) terá dia de chuva hoje (09); veja pre...\n2025-06-09 09:39:50,831 - INFO - 🔄 Processado: Resende (RJ) terá dia de chuva hoje (09); veja pre...\n[2025-06-09 09:39:52] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Resende (RJ) terá dia de chuva hoje (09); veja previsão do tempo - UOL Notícias\n2025-06-09 09:39:52,872 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Resende (RJ) terá dia de chuva hoje (09); veja previsão do tempo - UOL Notícias\n[2025-06-09 09:39:52] 🔄 Processado: Resende (RJ) terá dia de chuva hoje (09); veja pre...\n2025-06-09 09:39:52,873 - INFO - 🔄 Processado: Resende (RJ) terá dia de chuva hoje (09); veja pre...\n[2025-06-09 09:41:03] ⚠️ Artigo ignorado após extração: Um fim de semana entre o Zêzere e o Tejo - SÁBADO\n2025-06-09 09:41:03,894 - WARNING - ⚠️ Artigo ignorado após extração: Um fim de semana entre o Zêzere e o Tejo - SÁBADO\n📥 Novos artigos recebidos: 3\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 3\n💾 Guardados 3 artigos no arquivo /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n📥 Novos artigos recebidos: 3\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 3\n💾 Guardados 3 artigos no arquivo /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n[2025-06-09 09:41:03] ✅ Relevant articles saved: 3 articles\n2025-06-09 09:41:03,898 - INFO - ✅ Relevant articles saved: 3 articles\n[2025-06-09 09:41:03] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json\n2025-06-09 09:41:03,898 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json\n[2025-06-09 09:41:03] ✅ Lote 1 concluído: 3 artigos (total: 3)\n2025-06-09 09:41:03,898 - INFO - ✅ Lote 1 concluído: 3 artigos (total: 3)\n📥 Novos artigos recebidos: 3\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n📂 IDs existentes no arquivo: 3\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 3\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n📂 IDs existentes no arquivo: 3\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-09 09:41:07] ✅ Relevant articles saved: 3 articles\n2025-06-09 09:41:07,150 - INFO - ✅ Relevant articles saved: 3 articles\n[2025-06-09 09:41:07] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json\n2025-06-09 09:41:07,154 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json\n[2025-06-09 09:41:07] ==================================================\n2025-06-09 09:41:07,154 - INFO - ==================================================\n[2025-06-09 09:41:07] Processamento Concluído com Sucesso\n2025-06-09 09:41:07,154 - INFO - Processamento Concluído com Sucesso\n[2025-06-09 09:41:07] ==================================================\n2025-06-09 09:41:07,154 - INFO - ==================================================\n[2025-06-09 09:41:07]   Total de Artigos Processados: 3\n2025-06-09 09:41:07,154 - INFO -   Total de Artigos Processados: 3\n[2025-06-09 09:41:07]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:41:07,154 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n[2025-06-09 09:41:07]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:41:07,154 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n[2025-06-09 09:41:07]   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json\n2025-06-09 09:41:07,154 - INFO -   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json\n[2025-06-09 09:41:07]   Taxa de Sucesso: 37.5%\n2025-06-09 09:41:07,154 - INFO -   Taxa de Sucesso: 37.5%\n[2025-06-09 09:41:07] ==================================================\n2025-06-09 09:41:07,154 - INFO - ==================================================\n[2025-06-09 09:41:07] ✅ Processing completed. Processed 3 articles\n2025-06-09 09:41:07,157 - INFO - ✅ Processing completed. Processed 3 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
