{"timestamp":"2025-06-09T08:47:21.534551","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-09T08:47:21.534837","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-09T08:47:21.569302Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:21.571706Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:21.571800Z","level":"info","event":"📅 Using provided execution date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:21.572310Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/09', '/opt/airflow/data/structured/2025/06/09', '/opt/airflow/data/processed/2025/06/09']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:21.572394Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:21.572627Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:21.572736Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:21.572792Z","level":"info","event":"  - Target date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:21.572843Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:21.572916Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:21.572963Z","level":"info","event":"✅ Found input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:21.573013Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:21.573055Z","level":"info","event":"  - relevant_articles: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:21.573097Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/data/structured/2025/06/09/artigos_irrelevantes_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:21.573141Z","level":"info","event":"  - processing_log: /opt/airflow/data/structured/2025/06/09/processing_log_20250609.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:21.573190Z","level":"info","event":"  - stats_json: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:21.573232Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv --output_dir /opt/airflow/data/structured/2025/06/09 --date_str 2025-06-09 --date 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:21.573302Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.768442Z","level":"info","event":"📋 [2025-06-09 09:47:22] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.768665Z","level":"info","event":"📋 2025-06-09 09:47:22,768 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.768783Z","level":"info","event":"📋 [2025-06-09 09:47:22] Parameters: dias=1, date=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.769033Z","level":"info","event":"📋 2025-06-09 09:47:22,768 - INFO - Parameters: dias=1, date=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.769153Z","level":"info","event":"📋 [2025-06-09 09:47:22] Paths: input_file=/opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv, output_dir=/opt/airflow/data/structured/2025/06/09, date_str=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.769282Z","level":"info","event":"📋 2025-06-09 09:47:22,768 - INFO - Paths: input_file=/opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv, output_dir=/opt/airflow/data/structured/2025/06/09, date_str=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.769356Z","level":"info","event":"📋 [2025-06-09 09:47:22] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.769468Z","level":"info","event":"📋 2025-06-09 09:47:22,768 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.769567Z","level":"info","event":"📋 [2025-06-09 09:47:22] 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.769640Z","level":"info","event":"📋 2025-06-09 09:47:22,768 - INFO - 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.769686Z","level":"info","event":"📋 [2025-06-09 09:47:22] 📁 Using provided input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.770079Z","level":"info","event":"📋 2025-06-09 09:47:22,768 - INFO - 📁 Using provided input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.770143Z","level":"info","event":"📋 [2025-06-09 09:47:22] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.770188Z","level":"info","event":"📋 2025-06-09 09:47:22,768 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.770236Z","level":"info","event":"📋 [2025-06-09 09:47:22] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.770282Z","level":"info","event":"📋 2025-06-09 09:47:22,768 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.770350Z","level":"info","event":"📋 [2025-06-09 09:47:22] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.770395Z","level":"info","event":"📋 2025-06-09 09:47:22,769 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.770441Z","level":"info","event":"📋 [2025-06-09 09:47:22] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.770489Z","level":"info","event":"📋 2025-06-09 09:47:22,769 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.770534Z","level":"info","event":"📋 [2025-06-09 09:47:22] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.770579Z","level":"info","event":"📋 2025-06-09 09:47:22,769 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.770625Z","level":"info","event":"📋 [2025-06-09 09:47:22] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.770906Z","level":"info","event":"📋 2025-06-09 09:47:22,769 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.771185Z","level":"info","event":"📋 [2025-06-09 09:47:22] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.771252Z","level":"info","event":"📋 2025-06-09 09:47:22,770 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.771400Z","level":"info","event":"📋 [2025-06-09 09:47:22] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.771474Z","level":"info","event":"📋 2025-06-09 09:47:22,770 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.771863Z","level":"info","event":"📋 [2025-06-09 09:47:22] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.772556Z","level":"info","event":"📋 2025-06-09 09:47:22,771 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.775408Z","level":"info","event":"📋 [2025-06-09 09:47:22] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.775463Z","level":"info","event":"📋 2025-06-09 09:47:22,775 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.775502Z","level":"info","event":"📋 [2025-06-09 09:47:22] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.775537Z","level":"info","event":"📋 2025-06-09 09:47:22,775 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.775571Z","level":"info","event":"📋 [2025-06-09 09:47:22] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.775606Z","level":"info","event":"📋 2025-06-09 09:47:22,775 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.775640Z","level":"info","event":"📋 [2025-06-09 09:47:22] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.775674Z","level":"info","event":"📋 2025-06-09 09:47:22,775 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.775885Z","level":"info","event":"📋 [2025-06-09 09:47:22]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.776020Z","level":"info","event":"📋 2025-06-09 09:47:22,775 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.776056Z","level":"info","event":"📋 [2025-06-09 09:47:22]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.776089Z","level":"info","event":"📋 2025-06-09 09:47:22,775 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.776124Z","level":"info","event":"📋 [2025-06-09 09:47:22]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.776729Z","level":"info","event":"📋 2025-06-09 09:47:22,775 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.776780Z","level":"info","event":"📋 [2025-06-09 09:47:22]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.776817Z","level":"info","event":"📋 2025-06-09 09:47:22,775 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.776883Z","level":"info","event":"📋 [2025-06-09 09:47:22]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.776918Z","level":"info","event":"📋 2025-06-09 09:47:22,775 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.776953Z","level":"info","event":"📋 [2025-06-09 09:47:22] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.776987Z","level":"info","event":"📋 2025-06-09 09:47:22,775 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.777132Z","level":"info","event":"📋 [2025-06-09 09:47:22] ✅ Ficheiro CSV válido com 8 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.777181Z","level":"info","event":"📋 2025-06-09 09:47:22,777 - INFO - ✅ Ficheiro CSV válido com 8 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.777256Z","level":"info","event":"📋 [2025-06-09 09:47:22] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.777307Z","level":"info","event":"📋 2025-06-09 09:47:22,777 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.777590Z","level":"info","event":"📋 [2025-06-09 09:47:22] 📅 Filtrado para artigos dos últimos 1 dias: 8 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.777671Z","level":"info","event":"📋 2025-06-09 09:47:22,777 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 8 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.777749Z","level":"info","event":"📋 [2025-06-09 09:47:22] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.777820Z","level":"info","event":"📋 2025-06-09 09:47:22,777 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.777911Z","level":"info","event":"📋 [2025-06-09 09:47:22] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.778109Z","level":"info","event":"📋 2025-06-09 09:47:22,777 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.778152Z","level":"info","event":"📋 [2025-06-09 09:47:22] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.778191Z","level":"info","event":"📋 2025-06-09 09:47:22,777 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.778228Z","level":"info","event":"📋 [2025-06-09 09:47:22]   Total de Artigos para Processar: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.778631Z","level":"info","event":"📋 2025-06-09 09:47:22,777 - INFO -   Total de Artigos para Processar: 8","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.778676Z","level":"info","event":"📋 [2025-06-09 09:47:22]   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.778712Z","level":"info","event":"📋 2025-06-09 09:47:22,778 - INFO -   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.778784Z","level":"info","event":"📋 [2025-06-09 09:47:22]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.778851Z","level":"info","event":"📋 2025-06-09 09:47:22,778 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.778924Z","level":"info","event":"📋 [2025-06-09 09:47:22]   Diretoria de Saída: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.778963Z","level":"info","event":"📋 2025-06-09 09:47:22,778 - INFO -   Diretoria de Saída: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.779000Z","level":"info","event":"📋 [2025-06-09 09:47:22]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.779039Z","level":"info","event":"📋 2025-06-09 09:47:22,778 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.779077Z","level":"info","event":"📋 [2025-06-09 09:47:22] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.779111Z","level":"info","event":"📋 2025-06-09 09:47:22,778 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.779163Z","level":"info","event":"📋 [2025-06-09 09:47:22] 📦 A processar lote 1/1 (8 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:22.779807Z","level":"info","event":"📋 2025-06-09 09:47:22,778 - INFO - 📦 A processar lote 1/1 (8 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:24.952646Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:24.986132Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:25.079158Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:25.306060Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:25.401961Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:25.424280Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:25.461870Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:25.576236Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:27.682054Z","level":"info","event":"📋 [2025-06-09 09:47:27] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Adeus, calor! Chuva e trovoada regressam já na terça-feira - Notícias ao Minuto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:27.685619Z","level":"info","event":"📋 2025-06-09 09:47:27,679 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Adeus, calor! Chuva e trovoada regressam já na terça-feira - Notícias ao Minuto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:27.742273Z","level":"info","event":"📋 [2025-06-09 09:47:27] 🔄 Processado: Adeus, calor! Chuva e trovoada regressam já na ter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:27.742664Z","level":"info","event":"📋 2025-06-09 09:47:27,684 - INFO - 🔄 Processado: Adeus, calor! Chuva e trovoada regressam já na ter...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:29.064152Z","level":"info","event":"📋 [2025-06-09 09:47:29] ⚠️ Artigo ignorado após extração: Formação em “Técnicas de Resgate em Águas Bravas e Inundações” - Diário de Aveiro","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:29.065396Z","level":"info","event":"📋 2025-06-09 09:47:29,061 - WARNING - ⚠️ Artigo ignorado após extração: Formação em “Técnicas de Resgate em Águas Bravas e Inundações” - Diário de Aveiro","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:29.164319Z","level":"info","event":"📋 [2025-06-09 09:47:29] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo severo, com fortes trovoadas, risco de granizo grande e até tornados - potencial tempestade no Dia de Portugal, 10 de junho de 2025 - Luso Meteo","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:29.167902Z","level":"info","event":"📋 2025-06-09 09:47:29,159 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo severo, com fortes trovoadas, risco de granizo grande e até tornados - potencial tempestade no Dia de Portugal, 10 de junho de 2025 - Luso Meteo","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:29.168988Z","level":"info","event":"📋 [2025-06-09 09:47:29] 🔄 Processado: Tempo severo, com fortes trovoadas, risco de grani...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:29.171720Z","level":"info","event":"📋 2025-06-09 09:47:29,164 - INFO - 🔄 Processado: Tempo severo, com fortes trovoadas, risco de grani...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:29.562178Z","level":"info","event":"📋 [2025-06-09 09:47:29] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Calor vai apertar, mas há ameaça de chuva e trovoada - O Amarense – Jornal","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:29.563799Z","level":"info","event":"📋 2025-06-09 09:47:29,560 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Calor vai apertar, mas há ameaça de chuva e trovoada - O Amarense – Jornal","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:29.563967Z","level":"info","event":"📋 [2025-06-09 09:47:29] 🔄 Processado: Tempo. Calor vai apertar, mas há ameaça de chuva e...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:29.564078Z","level":"info","event":"📋 2025-06-09 09:47:29,560 - INFO - 🔄 Processado: Tempo. Calor vai apertar, mas há ameaça de chuva e...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:30.683616Z","level":"info","event":"📋 [2025-06-09 09:47:30] ⚠️ Artigo ignorado após extração: DESPORTO (Futebol) - Esta já cá canta. Vila Verde celebra mais um título de Portugal - O Vilaverdense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:30.685127Z","level":"info","event":"📋 2025-06-09 09:47:30,683 - WARNING - ⚠️ Artigo ignorado após extração: DESPORTO (Futebol) - Esta já cá canta. Vila Verde celebra mais um título de Portugal - O Vilaverdense","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:32.517666Z","level":"info","event":"📋 [2025-06-09 09:47:32] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Crato (CE) terá dia ensolarado hoje (09); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:32.517897Z","level":"info","event":"📋 2025-06-09 09:47:32,517 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Crato (CE) terá dia ensolarado hoje (09); veja previsão do tempo - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:32.518807Z","level":"info","event":"📋 [2025-06-09 09:47:32] 🔄 Processado: Crato (CE) terá dia ensolarado hoje (09); veja pre...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:32.518896Z","level":"info","event":"📋 2025-06-09 09:47:32,518 - INFO - 🔄 Processado: Crato (CE) terá dia ensolarado hoje (09); veja pre...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:34.535022Z","level":"info","event":"📋 [2025-06-09 09:47:34] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (08) para Crato (CE) - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:34.535828Z","level":"info","event":"📋 2025-06-09 09:47:34,534 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (08) para Crato (CE) - UOL Notícias","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:34.561935Z","level":"info","event":"📋 [2025-06-09 09:47:34] 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (08) ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:47:34.562218Z","level":"info","event":"📋 2025-06-09 09:47:34,535 - INFO - 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (08) ...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.350595Z","level":"info","event":"📋 [2025-06-09 09:48:42] ⚠️ Artigo ignorado após extração: Um fim de semana entre o Zêzere e o Tejo - SÁBADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.353577Z","level":"info","event":"📋 2025-06-09 09:48:42,349 - WARNING - ⚠️ Artigo ignorado após extração: Um fim de semana entre o Zêzere e o Tejo - SÁBADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.353749Z","level":"info","event":"📋 📥 Novos artigos recebidos: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.353935Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.354040Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.354174Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.354659Z","level":"info","event":"📋 💾 Guardados 5 artigos no arquivo /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.354860Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.354921Z","level":"info","event":"📋 📥 Novos artigos recebidos: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.355077Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.355210Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.355326Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.355536Z","level":"info","event":"📋 💾 Guardados 5 artigos no arquivo /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (batch 1)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.355756Z","level":"info","event":"📋 ✅ Arquivo salvo com sucesso em: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.355884Z","level":"info","event":"📋 [2025-06-09 09:48:42] ✅ Relevant articles saved: 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.355959Z","level":"info","event":"📋 2025-06-09 09:48:42,355 - INFO - ✅ Relevant articles saved: 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.356285Z","level":"info","event":"📋 [2025-06-09 09:48:42] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.356377Z","level":"info","event":"📋 2025-06-09 09:48:42,356 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.356422Z","level":"info","event":"📋 [2025-06-09 09:48:42] ✅ Lote 1 concluído: 5 artigos (total: 5)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:42.356461Z","level":"info","event":"📋 2025-06-09 09:48:42,356 - INFO - ✅ Lote 1 concluído: 5 artigos (total: 5)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.546338Z","level":"info","event":"📋 📥 Novos artigos recebidos: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.554558Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.559859Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.559973Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.560137Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.560285Z","level":"info","event":"📋 📥 Novos artigos recebidos: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.560360Z","level":"info","event":"📋 📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.560467Z","level":"info","event":"📋 📂 IDs existentes no arquivo: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.560541Z","level":"info","event":"📋 🆕 Artigos únicos para salvar: 0","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.560611Z","level":"info","event":"📋 ⚠️ Nenhum artigo único para salvar.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.560740Z","level":"info","event":"📋 [2025-06-09 09:48:45] ✅ Relevant articles saved: 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.560891Z","level":"info","event":"📋 2025-06-09 09:48:45,548 - INFO - ✅ Relevant articles saved: 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.560989Z","level":"info","event":"📋 [2025-06-09 09:48:45] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.561060Z","level":"info","event":"📋 2025-06-09 09:48:45,549 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.561127Z","level":"info","event":"📋 [2025-06-09 09:48:45] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.561192Z","level":"info","event":"📋 2025-06-09 09:48:45,549 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.561250Z","level":"info","event":"📋 [2025-06-09 09:48:45] Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.561313Z","level":"info","event":"📋 2025-06-09 09:48:45,549 - INFO - Processamento Concluído com Sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.561386Z","level":"info","event":"📋 [2025-06-09 09:48:45] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.561459Z","level":"info","event":"📋 2025-06-09 09:48:45,549 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.561584Z","level":"info","event":"📋 [2025-06-09 09:48:45]   Total de Artigos Processados: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.561659Z","level":"info","event":"📋 2025-06-09 09:48:45,549 - INFO -   Total de Artigos Processados: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.561726Z","level":"info","event":"📋 [2025-06-09 09:48:45]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.561802Z","level":"info","event":"📋 2025-06-09 09:48:45,549 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.561867Z","level":"info","event":"📋 [2025-06-09 09:48:45]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.561945Z","level":"info","event":"📋 2025-06-09 09:48:45,549 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.562015Z","level":"info","event":"📋 [2025-06-09 09:48:45]   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.562100Z","level":"info","event":"📋 2025-06-09 09:48:45,549 - INFO -   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.562253Z","level":"info","event":"📋 [2025-06-09 09:48:45]   Taxa de Sucesso: 62.5%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.562462Z","level":"info","event":"📋 2025-06-09 09:48:45,549 - INFO -   Taxa de Sucesso: 62.5%","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.562640Z","level":"info","event":"📋 [2025-06-09 09:48:45] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.562809Z","level":"info","event":"📋 2025-06-09 09:48:45,549 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.562901Z","level":"info","event":"📋 [2025-06-09 09:48:45] ✅ Processing completed. Processed 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.562992Z","level":"info","event":"📋 2025-06-09 09:48:45,553 - INFO - ✅ Processing completed. Processed 5 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.700912Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.701112Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:45.701268Z","level":"info","event":"✅ relevant_articles: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (1330 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:46.413824Z","level":"info","event":"📊 Number of processed articles: 5","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:46.413965Z","level":"info","event":"📊 Columns: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:46.414102Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/data/structured/2025/06/09/artigos_irrelevantes_2025-06-09.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:46.414906Z","level":"info","event":"⚠️ processing_log: /opt/airflow/data/structured/2025/06/09/processing_log_20250609.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:46.416075Z","level":"info","event":"✅ stats_json: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json (393 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:46.414457","level":"info","event":"Done. Returned value was: [2025-06-09 09:47:22] Starting processar_relevantes_airflow\n2025-06-09 09:47:22,768 - INFO - Starting processar_relevantes_airflow\n[2025-06-09 09:47:22] Parameters: dias=1, date=2025-06-09\n2025-06-09 09:47:22,768 - INFO - Parameters: dias=1, date=2025-06-09\n[2025-06-09 09:47:22] Paths: input_file=/opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv, output_dir=/opt/airflow/data/structured/2025/06/09, date_str=2025-06-09\n2025-06-09 09:47:22,768 - INFO - Paths: input_file=/opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv, output_dir=/opt/airflow/data/structured/2025/06/09, date_str=2025-06-09\n[2025-06-09 09:47:22] 🚀 A iniciar processar_relevantes_airflow\n2025-06-09 09:47:22,768 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-09 09:47:22] 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:47:22,768 - INFO - 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/09\n[2025-06-09 09:47:22] 📁 Using provided input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv\n2025-06-09 09:47:22,768 - INFO - 📁 Using provided input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv\n[2025-06-09 09:47:22] 🔧 A carregar ficheiros de configuração...\n2025-06-09 09:47:22,768 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-09 09:47:22] 🔍 Checking config path: /opt/airflow/config\n2025-06-09 09:47:22,768 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-09 09:47:22] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-09 09:47:22,769 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-09 09:47:22] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-09 09:47:22,769 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-09 09:47:22] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-09 09:47:22,769 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-09 09:47:22] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-09 09:47:22,769 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-09 09:47:22] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-09 09:47:22,770 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-09 09:47:22] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-09 09:47:22,770 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-09 09:47:22] ✅ Loaded 6 keywords\n2025-06-09 09:47:22,771 - INFO - ✅ Loaded 6 keywords\n[2025-06-09 09:47:22] ✅ Loaded 3614 DICOFREG codes\n2025-06-09 09:47:22,775 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-09 09:47:22] ==================================================\n2025-06-09 09:47:22,775 - INFO - ==================================================\n[2025-06-09 09:47:22] Configuration Loaded\n2025-06-09 09:47:22,775 - INFO - Configuration Loaded\n[2025-06-09 09:47:22] ==================================================\n2025-06-09 09:47:22,775 - INFO - ==================================================\n[2025-06-09 09:47:22]   Parishes: 306\n2025-06-09 09:47:22,775 - INFO -   Parishes: 306\n[2025-06-09 09:47:22]   Municipalities: 306\n2025-06-09 09:47:22,775 - INFO -   Municipalities: 306\n[2025-06-09 09:47:22]   Districts: 29\n2025-06-09 09:47:22,775 - INFO -   Districts: 29\n[2025-06-09 09:47:22]   Keywords: 6\n2025-06-09 09:47:22,775 - INFO -   Keywords: 6\n[2025-06-09 09:47:22]   DICOFREG Codes: 3614\n2025-06-09 09:47:22,775 - INFO -   DICOFREG Codes: 3614\n[2025-06-09 09:47:22] ==================================================\n2025-06-09 09:47:22,775 - INFO - ==================================================\n[2025-06-09 09:47:22] ✅ Ficheiro CSV válido com 8 artigos\n2025-06-09 09:47:22,777 - INFO - ✅ Ficheiro CSV válido com 8 artigos\n[2025-06-09 09:47:22] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-09 09:47:22,777 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-09 09:47:22] 📅 Filtrado para artigos dos últimos 1 dias: 8 artigos\n2025-06-09 09:47:22,777 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 8 artigos\n[2025-06-09 09:47:22] ==================================================\n2025-06-09 09:47:22,777 - INFO - ==================================================\n[2025-06-09 09:47:22] Processamento Iniciado\n2025-06-09 09:47:22,777 - INFO - Processamento Iniciado\n[2025-06-09 09:47:22] ==================================================\n2025-06-09 09:47:22,777 - INFO - ==================================================\n[2025-06-09 09:47:22]   Total de Artigos para Processar: 8\n2025-06-09 09:47:22,777 - INFO -   Total de Artigos para Processar: 8\n[2025-06-09 09:47:22]   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv\n2025-06-09 09:47:22,778 - INFO -   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv\n[2025-06-09 09:47:22]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:47:22,778 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n[2025-06-09 09:47:22]   Diretoria de Saída: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:47:22,778 - INFO -   Diretoria de Saída: /opt/airflow/data/structured/2025/06/09\n[2025-06-09 09:47:22]   Filtro de Dias: 1\n2025-06-09 09:47:22,778 - INFO -   Filtro de Dias: 1\n[2025-06-09 09:47:22] ==================================================\n2025-06-09 09:47:22,778 - INFO - ==================================================\n[2025-06-09 09:47:22] 📦 A processar lote 1/1 (8 artigos)\n2025-06-09 09:47:22,778 - INFO - 📦 A processar lote 1/1 (8 artigos)\n[2025-06-09 09:47:27] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Adeus, calor! Chuva e trovoada regressam já na terça-feira - Notícias ao Minuto\n2025-06-09 09:47:27,679 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Adeus, calor! Chuva e trovoada regressam já na terça-feira - Notícias ao Minuto\n[2025-06-09 09:47:27] 🔄 Processado: Adeus, calor! Chuva e trovoada regressam já na ter...\n2025-06-09 09:47:27,684 - INFO - 🔄 Processado: Adeus, calor! Chuva e trovoada regressam já na ter...\n[2025-06-09 09:47:29] ⚠️ Artigo ignorado após extração: Formação em “Técnicas de Resgate em Águas Bravas e Inundações” - Diário de Aveiro\n2025-06-09 09:47:29,061 - WARNING - ⚠️ Artigo ignorado após extração: Formação em “Técnicas de Resgate em Águas Bravas e Inundações” - Diário de Aveiro\n[2025-06-09 09:47:29] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo severo, com fortes trovoadas, risco de granizo grande e até tornados - potencial tempestade no Dia de Portugal, 10 de junho de 2025 - Luso Meteo\n2025-06-09 09:47:29,159 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo severo, com fortes trovoadas, risco de granizo grande e até tornados - potencial tempestade no Dia de Portugal, 10 de junho de 2025 - Luso Meteo\n[2025-06-09 09:47:29] 🔄 Processado: Tempo severo, com fortes trovoadas, risco de grani...\n2025-06-09 09:47:29,164 - INFO - 🔄 Processado: Tempo severo, com fortes trovoadas, risco de grani...\n[2025-06-09 09:47:29] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Calor vai apertar, mas há ameaça de chuva e trovoada - O Amarense – Jornal\n2025-06-09 09:47:29,560 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Calor vai apertar, mas há ameaça de chuva e trovoada - O Amarense – Jornal\n[2025-06-09 09:47:29] 🔄 Processado: Tempo. Calor vai apertar, mas há ameaça de chuva e...\n2025-06-09 09:47:29,560 - INFO - 🔄 Processado: Tempo. Calor vai apertar, mas há ameaça de chuva e...\n[2025-06-09 09:47:30] ⚠️ Artigo ignorado após extração: DESPORTO (Futebol) - Esta já cá canta. Vila Verde celebra mais um título de Portugal - O Vilaverdense\n2025-06-09 09:47:30,683 - WARNING - ⚠️ Artigo ignorado após extração: DESPORTO (Futebol) - Esta já cá canta. Vila Verde celebra mais um título de Portugal - O Vilaverdense\n[2025-06-09 09:47:32] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Crato (CE) terá dia ensolarado hoje (09); veja previsão do tempo - UOL Notícias\n2025-06-09 09:47:32,517 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Crato (CE) terá dia ensolarado hoje (09); veja previsão do tempo - UOL Notícias\n[2025-06-09 09:47:32] 🔄 Processado: Crato (CE) terá dia ensolarado hoje (09); veja pre...\n2025-06-09 09:47:32,518 - INFO - 🔄 Processado: Crato (CE) terá dia ensolarado hoje (09); veja pre...\n[2025-06-09 09:47:34] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (08) para Crato (CE) - UOL Notícias\n2025-06-09 09:47:34,534 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Previsão do tempo aponta dia ensolarado hoje (08) para Crato (CE) - UOL Notícias\n[2025-06-09 09:47:34] 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (08) ...\n2025-06-09 09:47:34,535 - INFO - 🔄 Processado: Previsão do tempo aponta dia ensolarado hoje (08) ...\n[2025-06-09 09:48:42] ⚠️ Artigo ignorado após extração: Um fim de semana entre o Zêzere e o Tejo - SÁBADO\n2025-06-09 09:48:42,349 - WARNING - ⚠️ Artigo ignorado após extração: Um fim de semana entre o Zêzere e o Tejo - SÁBADO\n📥 Novos artigos recebidos: 5\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 5\n💾 Guardados 5 artigos no arquivo /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n📥 Novos artigos recebidos: 5\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n📂 IDs existentes no arquivo: 0\n🆕 Artigos únicos para salvar: 5\n💾 Guardados 5 artigos no arquivo /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (batch 1)\n✅ Arquivo salvo com sucesso em: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n[2025-06-09 09:48:42] ✅ Relevant articles saved: 5 articles\n2025-06-09 09:48:42,355 - INFO - ✅ Relevant articles saved: 5 articles\n[2025-06-09 09:48:42] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json\n2025-06-09 09:48:42,356 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json\n[2025-06-09 09:48:42] ✅ Lote 1 concluído: 5 artigos (total: 5)\n2025-06-09 09:48:42,356 - INFO - ✅ Lote 1 concluído: 5 artigos (total: 5)\n📥 Novos artigos recebidos: 5\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n📂 IDs existentes no arquivo: 5\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n📥 Novos artigos recebidos: 5\n📂 Organizando saída por ano/mês/dia: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n📂 IDs existentes no arquivo: 5\n🆕 Artigos únicos para salvar: 0\n⚠️ Nenhum artigo único para salvar.\n[2025-06-09 09:48:45] ✅ Relevant articles saved: 5 articles\n2025-06-09 09:48:45,548 - INFO - ✅ Relevant articles saved: 5 articles\n[2025-06-09 09:48:45] ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json\n2025-06-09 09:48:45,549 - INFO - ✅ Processing statistics saved: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json\n[2025-06-09 09:48:45] ==================================================\n2025-06-09 09:48:45,549 - INFO - ==================================================\n[2025-06-09 09:48:45] Processamento Concluído com Sucesso\n2025-06-09 09:48:45,549 - INFO - Processamento Concluído com Sucesso\n[2025-06-09 09:48:45] ==================================================\n2025-06-09 09:48:45,549 - INFO - ==================================================\n[2025-06-09 09:48:45]   Total de Artigos Processados: 5\n2025-06-09 09:48:45,549 - INFO -   Total de Artigos Processados: 5\n[2025-06-09 09:48:45]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:48:45,549 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n[2025-06-09 09:48:45]   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:48:45,549 - INFO -   Ficheiro de Saída Raw: /opt/airflow/data/raw/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n[2025-06-09 09:48:45]   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json\n2025-06-09 09:48:45,549 - INFO -   Ficheiro de Estatísticas: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json\n[2025-06-09 09:48:45]   Taxa de Sucesso: 62.5%\n2025-06-09 09:48:45,549 - INFO -   Taxa de Sucesso: 62.5%\n[2025-06-09 09:48:45] ==================================================\n2025-06-09 09:48:45,549 - INFO - ==================================================\n[2025-06-09 09:48:45] ✅ Processing completed. Processed 5 articles\n2025-06-09 09:48:45,553 - INFO - ✅ Processing completed. Processed 5 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
