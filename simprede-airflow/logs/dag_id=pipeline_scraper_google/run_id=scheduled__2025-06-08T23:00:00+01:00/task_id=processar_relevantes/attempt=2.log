{"timestamp":"2025-06-09T08:21:49.490675","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-09T08:21:49.491332","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-09T08:21:49.556623Z","level":"info","event":"🔄 Starting processar_relevantes task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:49.557369Z","level":"info","event":"📁 Using paths from scraper task: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:49.562753Z","level":"info","event":"📅 Using provided execution date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:49.563373Z","level":"info","event":"📁 Ensured directories exist: ['/opt/airflow/data/raw/2025/06/09', '/opt/airflow/data/structured/2025/06/09', '/opt/airflow/data/processed/2025/06/09']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:49.564050Z","level":"info","event":"📅 Processar Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:49.564174Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:49.564637Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:49.564848Z","level":"info","event":"  - Target date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:49.564998Z","level":"info","event":"📁 Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:49.565092Z","level":"info","event":"🔍 Checking for input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:49.565161Z","level":"info","event":"✅ Found input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:49.565261Z","level":"info","event":"📁 Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:49.565353Z","level":"info","event":"  - relevant_articles: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:49.565437Z","level":"info","event":"  - irrelevant_articles: /opt/airflow/data/structured/2025/06/09/artigos_irrelevantes_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:49.565513Z","level":"info","event":"  - processing_log: /opt/airflow/data/structured/2025/06/09/processing_log_20250609.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:49.565588Z","level":"info","event":"  - stats_json: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:49.565651Z","level":"info","event":"🔄 Running processing command: python /opt/airflow/scripts/google_scraper/processador/processar_relevantes_airflow.py --dias 1 --input_file /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv --output_dir /opt/airflow/data/structured/2025/06/09 --date_str 2025-06-09 --date 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:49.565786Z","level":"info","event":"⏰ Waiting for processing completion with timeout: 1800 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.658363Z","level":"info","event":"📋 [2025-06-09 09:21:51] Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.658657Z","level":"info","event":"📋 2025-06-09 09:21:51,657 - INFO - Starting processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.659009Z","level":"info","event":"📋 [2025-06-09 09:21:51] Parameters: dias=1, date=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.659129Z","level":"info","event":"📋 2025-06-09 09:21:51,658 - INFO - Parameters: dias=1, date=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.659329Z","level":"info","event":"📋 [2025-06-09 09:21:51] Paths: input_file=/opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv, output_dir=/opt/airflow/data/structured/2025/06/09, date_str=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.659448Z","level":"info","event":"📋 2025-06-09 09:21:51,658 - INFO - Paths: input_file=/opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv, output_dir=/opt/airflow/data/structured/2025/06/09, date_str=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.659609Z","level":"info","event":"📋 [2025-06-09 09:21:51] 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.659719Z","level":"info","event":"📋 2025-06-09 09:21:51,658 - INFO - 🚀 A iniciar processar_relevantes_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.660600Z","level":"info","event":"📋 [2025-06-09 09:21:51] 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.660681Z","level":"info","event":"📋 2025-06-09 09:21:51,658 - INFO - 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.660750Z","level":"info","event":"📋 [2025-06-09 09:21:51] 📁 Using provided input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.660821Z","level":"info","event":"📋 2025-06-09 09:21:51,658 - INFO - 📁 Using provided input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.661214Z","level":"info","event":"📋 [2025-06-09 09:21:51] 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.661388Z","level":"info","event":"📋 2025-06-09 09:21:51,658 - INFO - 🔧 A carregar ficheiros de configuração...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.661609Z","level":"info","event":"📋 [2025-06-09 09:21:51] 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.661795Z","level":"info","event":"📋 2025-06-09 09:21:51,658 - INFO - 🔍 Checking config path: /opt/airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.662025Z","level":"info","event":"📋 [2025-06-09 09:21:51] 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.665178Z","level":"info","event":"📋 2025-06-09 09:21:51,659 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.665294Z","level":"info","event":"📋 [2025-06-09 09:21:51] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.665381Z","level":"info","event":"📋 2025-06-09 09:21:51,659 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.665459Z","level":"info","event":"📋 [2025-06-09 09:21:51] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.665552Z","level":"info","event":"📋 2025-06-09 09:21:51,659 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.665621Z","level":"info","event":"📋 [2025-06-09 09:21:51] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.665746Z","level":"info","event":"📋 2025-06-09 09:21:51,659 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.665850Z","level":"info","event":"📋 [2025-06-09 09:21:51] ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.665917Z","level":"info","event":"📋 2025-06-09 09:21:51,661 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.665981Z","level":"info","event":"📋 [2025-06-09 09:21:51] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.666047Z","level":"info","event":"📋 2025-06-09 09:21:51,661 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.666112Z","level":"info","event":"📋 [2025-06-09 09:21:51] ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.666178Z","level":"info","event":"📋 2025-06-09 09:21:51,661 - INFO - ✅ Loaded 6 keywords","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.668526Z","level":"info","event":"📋 [2025-06-09 09:21:51] ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.668612Z","level":"info","event":"📋 2025-06-09 09:21:51,668 - INFO - ✅ Loaded 3614 DICOFREG codes","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.668705Z","level":"info","event":"📋 [2025-06-09 09:21:51] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.668849Z","level":"info","event":"📋 2025-06-09 09:21:51,668 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.668922Z","level":"info","event":"📋 [2025-06-09 09:21:51] Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.668987Z","level":"info","event":"📋 2025-06-09 09:21:51,668 - INFO - Configuration Loaded","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.669068Z","level":"info","event":"📋 [2025-06-09 09:21:51] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.669135Z","level":"info","event":"📋 2025-06-09 09:21:51,668 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.669214Z","level":"info","event":"📋 [2025-06-09 09:21:51]   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.669351Z","level":"info","event":"📋 2025-06-09 09:21:51,669 - INFO -   Parishes: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.669420Z","level":"info","event":"📋 [2025-06-09 09:21:51]   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.669502Z","level":"info","event":"📋 2025-06-09 09:21:51,669 - INFO -   Municipalities: 306","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.669595Z","level":"info","event":"📋 [2025-06-09 09:21:51]   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.669664Z","level":"info","event":"📋 2025-06-09 09:21:51,669 - INFO -   Districts: 29","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.669761Z","level":"info","event":"📋 [2025-06-09 09:21:51]   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.669856Z","level":"info","event":"📋 2025-06-09 09:21:51,669 - INFO -   Keywords: 6","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.670021Z","level":"info","event":"📋 [2025-06-09 09:21:51]   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.670093Z","level":"info","event":"📋 2025-06-09 09:21:51,669 - INFO -   DICOFREG Codes: 3614","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.670176Z","level":"info","event":"📋 [2025-06-09 09:21:51] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.670268Z","level":"info","event":"📋 2025-06-09 09:21:51,670 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.674493Z","level":"info","event":"📋 [2025-06-09 09:21:51] ✅ Ficheiro CSV válido com 3 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.675277Z","level":"info","event":"📋 2025-06-09 09:21:51,674 - INFO - ✅ Ficheiro CSV válido com 3 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.676338Z","level":"info","event":"📋 [2025-06-09 09:21:51] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.676424Z","level":"info","event":"📋 2025-06-09 09:21:51,674 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.676488Z","level":"info","event":"📋 [2025-06-09 09:21:51] 📅 Filtrado para artigos dos últimos 1 dias: 3 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.676548Z","level":"info","event":"📋 2025-06-09 09:21:51,674 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 3 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.676607Z","level":"info","event":"📋 [2025-06-09 09:21:51] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.676663Z","level":"info","event":"📋 2025-06-09 09:21:51,674 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.676722Z","level":"info","event":"📋 [2025-06-09 09:21:51] Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.676781Z","level":"info","event":"📋 2025-06-09 09:21:51,674 - INFO - Processamento Iniciado","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.676840Z","level":"info","event":"📋 [2025-06-09 09:21:51] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.676898Z","level":"info","event":"📋 2025-06-09 09:21:51,674 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.676955Z","level":"info","event":"📋 [2025-06-09 09:21:51]   Total de Artigos para Processar: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.677014Z","level":"info","event":"📋 2025-06-09 09:21:51,674 - INFO -   Total de Artigos para Processar: 3","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.677072Z","level":"info","event":"📋 [2025-06-09 09:21:51]   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.677130Z","level":"info","event":"📋 2025-06-09 09:21:51,675 - INFO -   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.677188Z","level":"info","event":"📋 [2025-06-09 09:21:51]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.677255Z","level":"info","event":"📋 2025-06-09 09:21:51,675 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.677357Z","level":"info","event":"📋 [2025-06-09 09:21:51]   Diretoria de Saída: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.677416Z","level":"info","event":"📋 2025-06-09 09:21:51,675 - INFO -   Diretoria de Saída: /opt/airflow/data/structured/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.677476Z","level":"info","event":"📋 [2025-06-09 09:21:51]   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.677532Z","level":"info","event":"📋 2025-06-09 09:21:51,675 - INFO -   Filtro de Dias: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.677589Z","level":"info","event":"📋 [2025-06-09 09:21:51] ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.677646Z","level":"info","event":"📋 2025-06-09 09:21:51,675 - INFO - ==================================================","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.678343Z","level":"info","event":"📋 [2025-06-09 09:21:51] ⚠️ Último ID não encontrado em relevantes. A começar do início.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.678417Z","level":"info","event":"📋 2025-06-09 09:21:51,678 - WARNING - ⚠️ Último ID não encontrado em relevantes. A começar do início.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.679758Z","level":"info","event":"📋 [2025-06-09 09:21:51] 📦 A processar lote 1/1 (3 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:51.683281Z","level":"info","event":"📋 2025-06-09 09:21:51,679 - INFO - 📦 A processar lote 1/1 (3 artigos)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:53.185742Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:53.214480Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:53.242321Z","level":"info","event":"⚠️ ⚠️ Página de consentimento detectada. Tentando aceitar...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:55.749582Z","level":"info","event":"📋 [2025-06-09 09:21:55] ⚠️ Artigo ignorado após extração: Incêndio em armazém provoca morte de 19 animais em Moimenta da Beira - Renascença","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:55.750126Z","level":"info","event":"📋 2025-06-09 09:21:55,749 - WARNING - ⚠️ Artigo ignorado após extração: Incêndio em armazém provoca morte de 19 animais em Moimenta da Beira - Renascença","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:55.856277Z","level":"info","event":"📋 [2025-06-09 09:21:55] ⚠️ Artigo ignorado após extração: Formação em “Técnicas de Resgate em Águas Bravas e Inundações” - Diário de Aveiro","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:55.856497Z","level":"info","event":"📋 2025-06-09 09:21:55,856 - WARNING - ⚠️ Artigo ignorado após extração: Formação em “Técnicas de Resgate em Águas Bravas e Inundações” - Diário de Aveiro","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:56.761411Z","level":"info","event":"📋 [2025-06-09 09:21:56] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Calor vai apertar, mas há ameaça de chuva e trovoada - O Amarense – Jornal","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:56.763305Z","level":"info","event":"📋 2025-06-09 09:21:56,759 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Calor vai apertar, mas há ameaça de chuva e trovoada - O Amarense – Jornal","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:56.764192Z","level":"info","event":"📋 [2025-06-09 09:21:56] 🔄 Processado: Tempo. Calor vai apertar, mas há ameaça de chuva e...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:56.764407Z","level":"info","event":"📋 2025-06-09 09:21:56,764 - INFO - 🔄 Processado: Tempo. Calor vai apertar, mas há ameaça de chuva e...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:56.765481Z","level":"info","event":"📋 [2025-06-09 09:21:56] ⚠️ Nenhum artigo foi processado com sucesso.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:56.765701Z","level":"info","event":"📋 2025-06-09 09:21:56,765 - WARNING - ⚠️ Nenhum artigo foi processado com sucesso.","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:56.766159Z","level":"info","event":"📋 [2025-06-09 09:21:56] ✅ Processing completed. Processed 0 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:56.766351Z","level":"info","event":"📋 2025-06-09 09:21:56,766 - INFO - ✅ Processing completed. Processed 0 articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:56.906577Z","level":"info","event":"✅ Processing completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:56.906833Z","level":"info","event":"🔍 Verifying processar outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:56.907074Z","level":"info","event":"✅ relevant_articles: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (4353 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:57.776999Z","level":"info","event":"📊 Number of processed articles: 17","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:57.777199Z","level":"info","event":"📊 Columns: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:57.778401Z","level":"info","event":"⚠️ irrelevant_articles: /opt/airflow/data/structured/2025/06/09/artigos_irrelevantes_2025-06-09.csv (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:57.778637Z","level":"info","event":"⚠️ processing_log: /opt/airflow/data/structured/2025/06/09/processing_log_20250609.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:57.779448Z","level":"info","event":"✅ stats_json: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json (395 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:21:57.777943","level":"info","event":"Done. Returned value was: [2025-06-09 09:21:51] Starting processar_relevantes_airflow\n2025-06-09 09:21:51,657 - INFO - Starting processar_relevantes_airflow\n[2025-06-09 09:21:51] Parameters: dias=1, date=2025-06-09\n2025-06-09 09:21:51,658 - INFO - Parameters: dias=1, date=2025-06-09\n[2025-06-09 09:21:51] Paths: input_file=/opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv, output_dir=/opt/airflow/data/structured/2025/06/09, date_str=2025-06-09\n2025-06-09 09:21:51,658 - INFO - Paths: input_file=/opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv, output_dir=/opt/airflow/data/structured/2025/06/09, date_str=2025-06-09\n[2025-06-09 09:21:51] 🚀 A iniciar processar_relevantes_airflow\n2025-06-09 09:21:51,658 - INFO - 🚀 A iniciar processar_relevantes_airflow\n[2025-06-09 09:21:51] 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:21:51,658 - INFO - 📁 Using controlled output directory: /opt/airflow/data/structured/2025/06/09\n[2025-06-09 09:21:51] 📁 Using provided input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv\n2025-06-09 09:21:51,658 - INFO - 📁 Using provided input file: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv\n[2025-06-09 09:21:51] 🔧 A carregar ficheiros de configuração...\n2025-06-09 09:21:51,658 - INFO - 🔧 A carregar ficheiros de configuração...\n[2025-06-09 09:21:51] 🔍 Checking config path: /opt/airflow/config\n2025-06-09 09:21:51,658 - INFO - 🔍 Checking config path: /opt/airflow/config\n[2025-06-09 09:21:51] 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n2025-06-09 09:21:51,659 - INFO - 🔍 Checking config path: /opt/airflow/simprede-airflow/config\n[2025-06-09 09:21:51] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n2025-06-09 09:21:51,659 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../../../config\n[2025-06-09 09:21:51] 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n2025-06-09 09:21:51,659 - INFO - 🔍 Checking config path: /opt/airflow/scripts/google_scraper/processador/../config\n[2025-06-09 09:21:51] 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n2025-06-09 09:21:51,659 - INFO - 📁 Loading locations from: /opt/airflow/scripts/google_scraper/processador/../config/municipios_por_distrito.json\n[2025-06-09 09:21:51] ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n2025-06-09 09:21:51,661 - INFO - ✅ Loaded 306 parishes, 306 municipalities, 29 districts\n[2025-06-09 09:21:51] 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n2025-06-09 09:21:51,661 - INFO - 📁 Loading keywords from: /opt/airflow/scripts/google_scraper/processador/../config/keywords.json\n[2025-06-09 09:21:51] ✅ Loaded 6 keywords\n2025-06-09 09:21:51,661 - INFO - ✅ Loaded 6 keywords\n[2025-06-09 09:21:51] ✅ Loaded 3614 DICOFREG codes\n2025-06-09 09:21:51,668 - INFO - ✅ Loaded 3614 DICOFREG codes\n[2025-06-09 09:21:51] ==================================================\n2025-06-09 09:21:51,668 - INFO - ==================================================\n[2025-06-09 09:21:51] Configuration Loaded\n2025-06-09 09:21:51,668 - INFO - Configuration Loaded\n[2025-06-09 09:21:51] ==================================================\n2025-06-09 09:21:51,668 - INFO - ==================================================\n[2025-06-09 09:21:51]   Parishes: 306\n2025-06-09 09:21:51,669 - INFO -   Parishes: 306\n[2025-06-09 09:21:51]   Municipalities: 306\n2025-06-09 09:21:51,669 - INFO -   Municipalities: 306\n[2025-06-09 09:21:51]   Districts: 29\n2025-06-09 09:21:51,669 - INFO -   Districts: 29\n[2025-06-09 09:21:51]   Keywords: 6\n2025-06-09 09:21:51,669 - INFO -   Keywords: 6\n[2025-06-09 09:21:51]   DICOFREG Codes: 3614\n2025-06-09 09:21:51,669 - INFO -   DICOFREG Codes: 3614\n[2025-06-09 09:21:51] ==================================================\n2025-06-09 09:21:51,670 - INFO - ==================================================\n[2025-06-09 09:21:51] ✅ Ficheiro CSV válido com 3 artigos\n2025-06-09 09:21:51,674 - INFO - ✅ Ficheiro CSV válido com 3 artigos\n[2025-06-09 09:21:51] 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n2025-06-09 09:21:51,674 - INFO - 📋 Colunas: ['ID', 'keyword', 'localidade', 'title', 'link', 'published', 'collection_date']\n[2025-06-09 09:21:51] 📅 Filtrado para artigos dos últimos 1 dias: 3 artigos\n2025-06-09 09:21:51,674 - INFO - 📅 Filtrado para artigos dos últimos 1 dias: 3 artigos\n[2025-06-09 09:21:51] ==================================================\n2025-06-09 09:21:51,674 - INFO - ==================================================\n[2025-06-09 09:21:51] Processamento Iniciado\n2025-06-09 09:21:51,674 - INFO - Processamento Iniciado\n[2025-06-09 09:21:51] ==================================================\n2025-06-09 09:21:51,674 - INFO - ==================================================\n[2025-06-09 09:21:51]   Total de Artigos para Processar: 3\n2025-06-09 09:21:51,674 - INFO -   Total de Artigos para Processar: 3\n[2025-06-09 09:21:51]   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv\n2025-06-09 09:21:51,675 - INFO -   Ficheiro de Entrada: /opt/airflow/data/raw/2025/06/09/google_news_articles_20250609.csv\n[2025-06-09 09:21:51]   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:21:51,675 - INFO -   Ficheiro de Saída Principal: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n[2025-06-09 09:21:51]   Diretoria de Saída: /opt/airflow/data/structured/2025/06/09\n2025-06-09 09:21:51,675 - INFO -   Diretoria de Saída: /opt/airflow/data/structured/2025/06/09\n[2025-06-09 09:21:51]   Filtro de Dias: 1\n2025-06-09 09:21:51,675 - INFO -   Filtro de Dias: 1\n[2025-06-09 09:21:51] ==================================================\n2025-06-09 09:21:51,675 - INFO - ==================================================\n[2025-06-09 09:21:51] ⚠️ Último ID não encontrado em relevantes. A começar do início.\n2025-06-09 09:21:51,678 - WARNING - ⚠️ Último ID não encontrado em relevantes. A começar do início.\n[2025-06-09 09:21:51] 📦 A processar lote 1/1 (3 artigos)\n2025-06-09 09:21:51,679 - INFO - 📦 A processar lote 1/1 (3 artigos)\n[2025-06-09 09:21:55] ⚠️ Artigo ignorado após extração: Incêndio em armazém provoca morte de 19 animais em Moimenta da Beira - Renascença\n2025-06-09 09:21:55,749 - WARNING - ⚠️ Artigo ignorado após extração: Incêndio em armazém provoca morte de 19 animais em Moimenta da Beira - Renascença\n[2025-06-09 09:21:55] ⚠️ Artigo ignorado após extração: Formação em “Técnicas de Resgate em Águas Bravas e Inundações” - Diário de Aveiro\n2025-06-09 09:21:55,856 - WARNING - ⚠️ Artigo ignorado após extração: Formação em “Técnicas de Resgate em Águas Bravas e Inundações” - Diário de Aveiro\n[2025-06-09 09:21:56] 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Calor vai apertar, mas há ameaça de chuva e trovoada - O Amarense – Jornal\n2025-06-09 09:21:56,759 - INFO - 🔍 Nenhuma vítima detectada no texto, tentando extrair do título: Tempo. Calor vai apertar, mas há ameaça de chuva e trovoada - O Amarense – Jornal\n[2025-06-09 09:21:56] 🔄 Processado: Tempo. Calor vai apertar, mas há ameaça de chuva e...\n2025-06-09 09:21:56,764 - INFO - 🔄 Processado: Tempo. Calor vai apertar, mas há ameaça de chuva e...\n[2025-06-09 09:21:56] ⚠️ Nenhum artigo foi processado com sucesso.\n2025-06-09 09:21:56,765 - WARNING - ⚠️ Nenhum artigo foi processado com sucesso.\n[2025-06-09 09:21:56] ✅ Processing completed. Processed 0 articles\n2025-06-09 09:21:56,766 - INFO - ✅ Processing completed. Processed 0 articles\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
