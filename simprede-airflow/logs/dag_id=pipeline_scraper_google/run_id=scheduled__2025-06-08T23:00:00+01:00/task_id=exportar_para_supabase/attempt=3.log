{"timestamp":"2025-06-09T08:48:48.472288","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-06-09T08:48:48.472568","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/google_scraper_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-06-09T08:48:48.512929Z","level":"info","event":"ğŸ”„ Starting export_supabase task","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.514127Z","level":"info","event":"ğŸ“… Using current date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.514433Z","level":"info","event":"ğŸ“ Ensured directories exist: ['/opt/airflow/data/raw/2025/06/09', '/opt/airflow/data/structured/2025/06/09', '/opt/airflow/data/processed/2025/06/09']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.514498Z","level":"info","event":"ğŸ“… Export Parameters:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.514549Z","level":"info","event":"  - Days: 1","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.514599Z","level":"info","event":"  - Specific date: None (use execution_date)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.514661Z","level":"info","event":"  - Target date: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.514727Z","level":"info","event":"  - Database table: artigos_filtrados_20250609_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.514784Z","level":"info","event":"ğŸ“ Input/Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.521214Z","level":"info","event":"ğŸ“‹ Found 2 files from processar task via XCom","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.521315Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/data/processed/2025/06/09/artigos_vitimas_filtrados_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.521731Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/data/processed/2025/06/09/artigos_sem_vitimas_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.521990Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.522119Z","level":"info","event":"âœ… Found file: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (1330 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.522198Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.522258Z","level":"info","event":"âœ… Found file: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (1330 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.522319Z","level":"info","event":"ğŸ” Checking for input file: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.522397Z","level":"info","event":"âœ… Found file: /opt/airflow/data/structured/2025/06/09/processing_stats_20250609.json (393 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.522469Z","level":"info","event":"ğŸ“‹ Selected input file: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv (1330 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.522530Z","level":"info","event":"ğŸ“Š Processing all relevant disaster-related articles","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.522592Z","level":"info","event":"ğŸ“ Output paths:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.522652Z","level":"info","event":"  - export_log: /opt/airflow/data/processed/2025/06/09/export_log_20250609.log","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.522768Z","level":"info","event":"  - export_stats: /opt/airflow/data/processed/2025/06/09/export_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.522820Z","level":"info","event":"  - backup_csv: /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.522869Z","level":"info","event":"ğŸ”„ Running export command: python /opt/airflow/scripts/google_scraper/exportador_bd/export_to_supabase_airflow.py --output_dir /opt/airflow/data/processed/2025/06/09 --date_str 2025-06-09 --input_file /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv --date 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:48.522943Z","level":"info","event":"â° Waiting for export completion with timeout: 600 seconds","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.341255Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] A iniciar export_to_supabase_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.341595Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,341 - INFO - A iniciar export_to_supabase_airflow","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.341851Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] ParÃ¢metros: date=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.341963Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,341 - INFO - ParÃ¢metros: date=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.342020Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] Caminhos: input_file=/opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv, output_dir=/opt/airflow/data/processed/2025/06/09, date_str=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.342832Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,341 - INFO - Caminhos: input_file=/opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv, output_dir=/opt/airflow/data/processed/2025/06/09, date_str=2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.342898Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] ğŸš€ A iniciar exportaÃ§Ã£o para Supabase para a data: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.342953Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,341 - INFO - ğŸš€ A iniciar exportaÃ§Ã£o para Supabase para a data: 2025-06-09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.343015Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] ğŸ“‹ Tabela de destino: artigos_filtrados_20250609_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.343067Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,341 - INFO - ğŸ“‹ Tabela de destino: artigos_filtrados_20250609_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.343116Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] ğŸ“ A usar diretÃ³rio de saÃ­da controlado: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.343166Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,341 - INFO - ğŸ“ A usar diretÃ³rio de saÃ­da controlado: /opt/airflow/data/processed/2025/06/09","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.343217Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] âœ… A usar ficheiro de entrada fornecido: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.343263Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,341 - INFO - âœ… A usar ficheiro de entrada fornecido: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.343314Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] ğŸ“‚ A carregar artigos de: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.343411Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,341 - INFO - ğŸ“‚ A carregar artigos de: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.343479Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] ğŸ“Š Carregados 5 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.343533Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,343 - INFO - ğŸ“Š Carregados 5 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.343584Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] ğŸ“‹ A processar todos os artigos relevantes relacionados com desastres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.343630Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,343 - INFO - ğŸ“‹ A processar todos os artigos relevantes relacionados com desastres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.343675Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] ğŸ” VerificaÃ§Ã£o inicial do ambiente...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.343734Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,343 - INFO - ğŸ” VerificaÃ§Ã£o inicial do ambiente...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.343819Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   DB_HOST do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.343915Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,343 - INFO -   DB_HOST do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.343991Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   DB_USER do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.344080Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,343 - INFO -   DB_USER do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.344304Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   DB_PASSWORD do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.344418Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,344 - INFO -   DB_PASSWORD do ambiente: NÃƒO_ENCONTRADO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.344489Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] ğŸ” ConfiguraÃ§Ã£o da base de dados nÃ£o encontrada no ambiente, procurando ficheiro .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.345357Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,344 - INFO - ğŸ” ConfiguraÃ§Ã£o da base de dados nÃ£o encontrada no ambiente, procurando ficheiro .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.345534Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] ğŸ” Verificando 6 localizaÃ§Ãµes possÃ­veis do .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.345590Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,344 - INFO - ğŸ” Verificando 6 localizaÃ§Ãµes possÃ­veis do .env...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.345640Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   A verificar: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.345686Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,344 - INFO -   A verificar: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.346197Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   âŒ NÃ£o encontrado: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.346361Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,344 - INFO -   âŒ NÃ£o encontrado: /opt/airflow/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.346433Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   A verificar: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.346526Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,344 - INFO -   A verificar: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.346614Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] âœ… Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.346706Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,344 - INFO - âœ… Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.346782Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] ğŸ“„ Tamanho do ficheiro .env: 210 caracteres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.346873Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,345 - INFO - ğŸ“„ Tamanho do ficheiro .env: 210 caracteres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.346940Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   âœ… Definido DB_USER do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.347009Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,345 - INFO -   âœ… Definido DB_USER do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.347068Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   âœ… Definido DB_PASSWORD do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.347121Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,345 - INFO -   âœ… Definido DB_PASSWORD do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.347199Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   âœ… Definido DB_HOST do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.347261Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,345 - INFO -   âœ… Definido DB_HOST do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.347320Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   âœ… Definido DB_PORT do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.347376Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,345 - INFO -   âœ… Definido DB_PORT do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.347433Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   âœ… Definido DB_NAME do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.347489Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,345 - INFO -   âœ… Definido DB_NAME do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.347546Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   âœ… Definido DB_SCHEMA do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.347602Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,345 - INFO -   âœ… Definido DB_SCHEMA do .env","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.347665Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] ğŸ” VerificaÃ§Ã£o final da configuraÃ§Ã£o...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.347725Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,345 - INFO - ğŸ” VerificaÃ§Ã£o final da configuraÃ§Ã£o...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.347777Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   DB_HOST: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.347902Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,345 - INFO -   DB_HOST: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.347962Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   DB_USER: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.348016Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,345 - INFO -   DB_USER: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.348074Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   DB_PASSWORD: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.348148Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,345 - INFO -   DB_PASSWORD: DEFINIDO","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.348210Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   DB_PORT: 6543","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.348285Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,345 - INFO -   DB_PORT: 6543","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.348348Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   DB_NAME: postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.348409Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,345 - INFO -   DB_NAME: postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.348452Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49]   DB_SCHEMA: google_scraper","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.348502Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,345 - INFO -   DB_SCHEMA: google_scraper","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.348546Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] âœ… ConfiguraÃ§Ã£o da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.348598Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,345 - INFO - âœ… ConfiguraÃ§Ã£o da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.348642Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] ğŸ”— A conectar Ã  base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.348700Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,345 - INFO - ğŸ”— A conectar Ã  base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.637667Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] âœ… Conectado Ã  base de dados com sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.638151Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,637 - INFO - âœ… Conectado Ã  base de dados com sucesso","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.704041Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] ğŸ—‘ï¸ Tabela existente google_scraper.artigos_filtrados_20250609_staging eliminada se existia","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.705024Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,703 - INFO - ğŸ—‘ï¸ Tabela existente google_scraper.artigos_filtrados_20250609_staging eliminada se existia","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.786551Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] âœ… Tabela google_scraper.artigos_filtrados_20250609_staging criada com esquema correto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.787563Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,786 - INFO - âœ… Tabela google_scraper.artigos_filtrados_20250609_staging criada com esquema correto","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.886276Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] âœ… Ãndices criados para a tabela google_scraper.artigos_filtrados_20250609_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.888987Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,886 - INFO - âœ… Ãndices criados para a tabela google_scraper.artigos_filtrados_20250609_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.892869Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] ğŸ”§ A preparar dataframe para inserÃ§Ã£o na base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.893106Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,886 - INFO - ğŸ”§ A preparar dataframe para inserÃ§Ã£o na base de dados...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.893244Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] ğŸ“… A converter formatos de data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.893359Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,886 - INFO - ğŸ“… A converter formatos de data...","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.894441Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:49] âœ… Preparadas 5 linhas para inserÃ§Ã£o","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:49.894633Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:49,894 - INFO - âœ… Preparadas 5 linhas para inserÃ§Ã£o","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.126584Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:50] âœ… Inseridos/atualizados 5 artigos (falharam: 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.127759Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:50,126 - INFO - âœ… Inseridos/atualizados 5 artigos (falharam: 0)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.136609Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:50] ğŸ’¾ Backup de exportaÃ§Ã£o guardado: /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.137114Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:50,136 - INFO - ğŸ’¾ Backup de exportaÃ§Ã£o guardado: /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.138575Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:50] âœ… EstatÃ­sticas de exportaÃ§Ã£o guardadas: /opt/airflow/data/processed/2025/06/09/export_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.141991Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:50,138 - INFO - âœ… EstatÃ­sticas de exportaÃ§Ã£o guardadas: /opt/airflow/data/processed/2025/06/09/export_stats_20250609.json","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.142266Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:50] ğŸ“‹ LocalizaÃ§Ã£o de backup de exportaÃ§Ã£o preparada: /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.142901Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:50,138 - INFO - ğŸ“‹ LocalizaÃ§Ã£o de backup de exportaÃ§Ã£o preparada: /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.143137Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:50] âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Inseridos/atualizados 5 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250609_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.143371Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:50,138 - INFO - âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Inseridos/atualizados 5 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250609_staging","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.143708Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:50] ğŸ”— LigaÃ§Ã£o Ã  base de dados fechada","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.143906Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:50,139 - INFO - ğŸ”— LigaÃ§Ã£o Ã  base de dados fechada","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.144124Z","level":"info","event":"ğŸ“‹ [2025-06-09 09:48:50] âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Processados 5 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.145047Z","level":"info","event":"ğŸ“‹ 2025-06-09 09:48:50,139 - INFO - âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Processados 5 artigos","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.225754Z","level":"info","event":"âœ… Export completed successfully!","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.225948Z","level":"info","event":"ğŸ” Verifying export outputs:","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.226068Z","level":"info","event":"âš ï¸ export_log: /opt/airflow/data/processed/2025/06/09/export_log_20250609.log (not found)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.226163Z","level":"info","event":"âœ… export_stats: /opt/airflow/data/processed/2025/06/09/export_stats_20250609.json (883 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.226283Z","level":"info","event":"âœ… backup_csv: /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv (1326 bytes)","chan":"stdout","logger":"task"}
{"timestamp":"2025-06-09T08:48:50.226635","level":"info","event":"Done. Returned value was: [2025-06-09 09:48:49] A iniciar export_to_supabase_airflow\n2025-06-09 09:48:49,341 - INFO - A iniciar export_to_supabase_airflow\n[2025-06-09 09:48:49] ParÃ¢metros: date=2025-06-09\n2025-06-09 09:48:49,341 - INFO - ParÃ¢metros: date=2025-06-09\n[2025-06-09 09:48:49] Caminhos: input_file=/opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv, output_dir=/opt/airflow/data/processed/2025/06/09, date_str=2025-06-09\n2025-06-09 09:48:49,341 - INFO - Caminhos: input_file=/opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv, output_dir=/opt/airflow/data/processed/2025/06/09, date_str=2025-06-09\n[2025-06-09 09:48:49] ğŸš€ A iniciar exportaÃ§Ã£o para Supabase para a data: 2025-06-09\n2025-06-09 09:48:49,341 - INFO - ğŸš€ A iniciar exportaÃ§Ã£o para Supabase para a data: 2025-06-09\n[2025-06-09 09:48:49] ğŸ“‹ Tabela de destino: artigos_filtrados_20250609_staging\n2025-06-09 09:48:49,341 - INFO - ğŸ“‹ Tabela de destino: artigos_filtrados_20250609_staging\n[2025-06-09 09:48:49] ğŸ“ A usar diretÃ³rio de saÃ­da controlado: /opt/airflow/data/processed/2025/06/09\n2025-06-09 09:48:49,341 - INFO - ğŸ“ A usar diretÃ³rio de saÃ­da controlado: /opt/airflow/data/processed/2025/06/09\n[2025-06-09 09:48:49] âœ… A usar ficheiro de entrada fornecido: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:48:49,341 - INFO - âœ… A usar ficheiro de entrada fornecido: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n[2025-06-09 09:48:49] ğŸ“‚ A carregar artigos de: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n2025-06-09 09:48:49,341 - INFO - ğŸ“‚ A carregar artigos de: /opt/airflow/data/structured/2025/06/09/artigos_google_municipios_pt_2025-06-09.csv\n[2025-06-09 09:48:49] ğŸ“Š Carregados 5 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']\n2025-06-09 09:48:49,343 - INFO - ğŸ“Š Carregados 5 artigos com colunas: ['ID', 'type', 'subtype', 'date', 'year', 'month', 'day', 'hour', 'georef', 'district', 'municipali', 'parish', 'DICOFREG', 'source', 'sourcedate', 'sourcetype', 'page', 'fatalities', 'injured', 'evacuated', 'displaced', 'missing']\n[2025-06-09 09:48:49] ğŸ“‹ A processar todos os artigos relevantes relacionados com desastres\n2025-06-09 09:48:49,343 - INFO - ğŸ“‹ A processar todos os artigos relevantes relacionados com desastres\n[2025-06-09 09:48:49] ğŸ” VerificaÃ§Ã£o inicial do ambiente...\n2025-06-09 09:48:49,343 - INFO - ğŸ” VerificaÃ§Ã£o inicial do ambiente...\n[2025-06-09 09:48:49]   DB_HOST do ambiente: NÃƒO_ENCONTRADO\n2025-06-09 09:48:49,343 - INFO -   DB_HOST do ambiente: NÃƒO_ENCONTRADO\n[2025-06-09 09:48:49]   DB_USER do ambiente: NÃƒO_ENCONTRADO\n2025-06-09 09:48:49,343 - INFO -   DB_USER do ambiente: NÃƒO_ENCONTRADO\n[2025-06-09 09:48:49]   DB_PASSWORD do ambiente: NÃƒO_ENCONTRADO\n2025-06-09 09:48:49,344 - INFO -   DB_PASSWORD do ambiente: NÃƒO_ENCONTRADO\n[2025-06-09 09:48:49] ğŸ” ConfiguraÃ§Ã£o da base de dados nÃ£o encontrada no ambiente, procurando ficheiro .env...\n2025-06-09 09:48:49,344 - INFO - ğŸ” ConfiguraÃ§Ã£o da base de dados nÃ£o encontrada no ambiente, procurando ficheiro .env...\n[2025-06-09 09:48:49] ğŸ” Verificando 6 localizaÃ§Ãµes possÃ­veis do .env...\n2025-06-09 09:48:49,344 - INFO - ğŸ” Verificando 6 localizaÃ§Ãµes possÃ­veis do .env...\n[2025-06-09 09:48:49]   A verificar: /opt/airflow/.env\n2025-06-09 09:48:49,344 - INFO -   A verificar: /opt/airflow/.env\n[2025-06-09 09:48:49]   âŒ NÃ£o encontrado: /opt/airflow/.env\n2025-06-09 09:48:49,344 - INFO -   âŒ NÃ£o encontrado: /opt/airflow/.env\n[2025-06-09 09:48:49]   A verificar: /opt/airflow/scripts/google_scraper/.env\n2025-06-09 09:48:49,344 - INFO -   A verificar: /opt/airflow/scripts/google_scraper/.env\n[2025-06-09 09:48:49] âœ… Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env\n2025-06-09 09:48:49,344 - INFO - âœ… Ficheiro .env encontrado em: /opt/airflow/scripts/google_scraper/.env\n[2025-06-09 09:48:49] ğŸ“„ Tamanho do ficheiro .env: 210 caracteres\n2025-06-09 09:48:49,345 - INFO - ğŸ“„ Tamanho do ficheiro .env: 210 caracteres\n[2025-06-09 09:48:49]   âœ… Definido DB_USER do .env\n2025-06-09 09:48:49,345 - INFO -   âœ… Definido DB_USER do .env\n[2025-06-09 09:48:49]   âœ… Definido DB_PASSWORD do .env\n2025-06-09 09:48:49,345 - INFO -   âœ… Definido DB_PASSWORD do .env\n[2025-06-09 09:48:49]   âœ… Definido DB_HOST do .env\n2025-06-09 09:48:49,345 - INFO -   âœ… Definido DB_HOST do .env\n[2025-06-09 09:48:49]   âœ… Definido DB_PORT do .env\n2025-06-09 09:48:49,345 - INFO -   âœ… Definido DB_PORT do .env\n[2025-06-09 09:48:49]   âœ… Definido DB_NAME do .env\n2025-06-09 09:48:49,345 - INFO -   âœ… Definido DB_NAME do .env\n[2025-06-09 09:48:49]   âœ… Definido DB_SCHEMA do .env\n2025-06-09 09:48:49,345 - INFO -   âœ… Definido DB_SCHEMA do .env\n[2025-06-09 09:48:49] ğŸ” VerificaÃ§Ã£o final da configuraÃ§Ã£o...\n2025-06-09 09:48:49,345 - INFO - ğŸ” VerificaÃ§Ã£o final da configuraÃ§Ã£o...\n[2025-06-09 09:48:49]   DB_HOST: DEFINIDO\n2025-06-09 09:48:49,345 - INFO -   DB_HOST: DEFINIDO\n[2025-06-09 09:48:49]   DB_USER: DEFINIDO\n2025-06-09 09:48:49,345 - INFO -   DB_USER: DEFINIDO\n[2025-06-09 09:48:49]   DB_PASSWORD: DEFINIDO\n2025-06-09 09:48:49,345 - INFO -   DB_PASSWORD: DEFINIDO\n[2025-06-09 09:48:49]   DB_PORT: 6543\n2025-06-09 09:48:49,345 - INFO -   DB_PORT: 6543\n[2025-06-09 09:48:49]   DB_NAME: postgres\n2025-06-09 09:48:49,345 - INFO -   DB_NAME: postgres\n[2025-06-09 09:48:49]   DB_SCHEMA: google_scraper\n2025-06-09 09:48:49,345 - INFO -   DB_SCHEMA: google_scraper\n[2025-06-09 09:48:49] âœ… ConfiguraÃ§Ã£o da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres\n2025-06-09 09:48:49,345 - INFO - âœ… ConfiguraÃ§Ã£o da base de dados carregada: aws-0-eu-west-3.pooler.supabase.com:6543/postgres\n[2025-06-09 09:48:49] ğŸ”— A conectar Ã  base de dados...\n2025-06-09 09:48:49,345 - INFO - ğŸ”— A conectar Ã  base de dados...\n[2025-06-09 09:48:49] âœ… Conectado Ã  base de dados com sucesso\n2025-06-09 09:48:49,637 - INFO - âœ… Conectado Ã  base de dados com sucesso\n[2025-06-09 09:48:49] ğŸ—‘ï¸ Tabela existente google_scraper.artigos_filtrados_20250609_staging eliminada se existia\n2025-06-09 09:48:49,703 - INFO - ğŸ—‘ï¸ Tabela existente google_scraper.artigos_filtrados_20250609_staging eliminada se existia\n[2025-06-09 09:48:49] âœ… Tabela google_scraper.artigos_filtrados_20250609_staging criada com esquema correto\n2025-06-09 09:48:49,786 - INFO - âœ… Tabela google_scraper.artigos_filtrados_20250609_staging criada com esquema correto\n[2025-06-09 09:48:49] âœ… Ãndices criados para a tabela google_scraper.artigos_filtrados_20250609_staging\n2025-06-09 09:48:49,886 - INFO - âœ… Ãndices criados para a tabela google_scraper.artigos_filtrados_20250609_staging\n[2025-06-09 09:48:49] ğŸ”§ A preparar dataframe para inserÃ§Ã£o na base de dados...\n2025-06-09 09:48:49,886 - INFO - ğŸ”§ A preparar dataframe para inserÃ§Ã£o na base de dados...\n[2025-06-09 09:48:49] ğŸ“… A converter formatos de data...\n2025-06-09 09:48:49,886 - INFO - ğŸ“… A converter formatos de data...\n[2025-06-09 09:48:49] âœ… Preparadas 5 linhas para inserÃ§Ã£o\n2025-06-09 09:48:49,894 - INFO - âœ… Preparadas 5 linhas para inserÃ§Ã£o\n[2025-06-09 09:48:50] âœ… Inseridos/atualizados 5 artigos (falharam: 0)\n2025-06-09 09:48:50,126 - INFO - âœ… Inseridos/atualizados 5 artigos (falharam: 0)\n[2025-06-09 09:48:50] ğŸ’¾ Backup de exportaÃ§Ã£o guardado: /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv\n2025-06-09 09:48:50,136 - INFO - ğŸ’¾ Backup de exportaÃ§Ã£o guardado: /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv\n[2025-06-09 09:48:50] âœ… EstatÃ­sticas de exportaÃ§Ã£o guardadas: /opt/airflow/data/processed/2025/06/09/export_stats_20250609.json\n2025-06-09 09:48:50,138 - INFO - âœ… EstatÃ­sticas de exportaÃ§Ã£o guardadas: /opt/airflow/data/processed/2025/06/09/export_stats_20250609.json\n[2025-06-09 09:48:50] ğŸ“‹ LocalizaÃ§Ã£o de backup de exportaÃ§Ã£o preparada: /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv\n2025-06-09 09:48:50,138 - INFO - ğŸ“‹ LocalizaÃ§Ã£o de backup de exportaÃ§Ã£o preparada: /opt/airflow/data/processed/2025/06/09/export_backup_20250609.csv\n[2025-06-09 09:48:50] âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Inseridos/atualizados 5 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250609_staging\n2025-06-09 09:48:50,138 - INFO - âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Inseridos/atualizados 5 todos os artigos relevantes relacionados com desastres na tabela artigos_filtrados_20250609_staging\n[2025-06-09 09:48:50] ğŸ”— LigaÃ§Ã£o Ã  base de dados fechada\n2025-06-09 09:48:50,139 - INFO - ğŸ”— LigaÃ§Ã£o Ã  base de dados fechada\n[2025-06-09 09:48:50] âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Processados 5 artigos\n2025-06-09 09:48:50,139 - INFO - âœ… ExportaÃ§Ã£o concluÃ­da com sucesso. Processados 5 artigos\n","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
